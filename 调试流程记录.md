# Trademe å¼€å‘ç¯å¢ƒè°ƒè¯•æµç¨‹è®°å½•

**è®°å½•æ—¶é—´**: 2025-08-21  
**ç‰ˆæœ¬**: v1.0  
**ç¯å¢ƒ**: Ubuntu 22.04, Node.js 20+, Python 3.12+

## ğŸš€ å¿«é€Ÿå¯åŠ¨å‘½ä»¤

### ä¸€é”®å¯åŠ¨å¼€å‘ç¯å¢ƒ
```bash
cd /root/trademe
chmod +x start-dev.sh stop-dev.sh
./start-dev.sh
```

### ä¸€é”®åœæ­¢å¼€å‘ç¯å¢ƒ
```bash
./stop-dev.sh
```

## ğŸ“‹ æœåŠ¡è®¿é—®åœ°å€

| æœåŠ¡ | åœ°å€ | ç«¯å£ | è¯´æ˜ |
|-----|------|------|------|
| å‰ç«¯ç•Œé¢ | http://localhost:3000 | 3000 | React + Vite å¼€å‘æœåŠ¡å™¨ |
| ç”¨æˆ·æœåŠ¡ | http://localhost:3001 | 3001 | Node.js + Express API |
| äº¤æ˜“æœåŠ¡ | http://localhost:8001 | 8001 | Python + FastAPI API |

## ğŸ”§ æ‰‹åŠ¨å¯åŠ¨æµç¨‹ (è°ƒè¯•ç”¨)

### 1. å¯åŠ¨äº¤æ˜“æœåŠ¡ (Python FastAPI)
```bash
cd /root/trademe/backend/trading-service
PYTHONPATH=/root/trademe/backend/trading-service uvicorn app.main:app --host 0.0.0.0 --port 8001 --reload
```
**é¢„æœŸç»“æœ**: `INFO: Uvicorn running on http://0.0.0.0:8001`

### 2. å¯åŠ¨ç”¨æˆ·æœåŠ¡ (Node.js)
```bash
cd /root/trademe/backend/user-service
npm run dev
```
**é¢„æœŸç»“æœ**: `ğŸš€ User Service started successfully!`

### 3. å¯åŠ¨å‰ç«¯æœåŠ¡ (React + Vite)
```bash
cd /root/trademe/frontend
npm run dev
```
**é¢„æœŸç»“æœ**: `VITE v5.4.19 ready in XXXms`

## ğŸ›  å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

### 1. ç«¯å£å ç”¨é—®é¢˜
**ç—‡çŠ¶**: `Address already in use`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
lsof -i:3000
lsof -i:3001
lsof -i:8001

# æ¸…ç†ç«¯å£å ç”¨
lsof -ti:3000 | xargs kill -9
lsof -ti:3001 | xargs kill -9
lsof -ti:8001 | xargs kill -9

# æˆ–ä½¿ç”¨å¼ºåˆ¶æ¸…ç†
pkill -f "vite\|uvicorn\|ts-node\|nodemon"
```

### 2. å‰ç«¯çƒ­æ›´æ–°ä¸ç”Ÿæ•ˆ
**ç—‡çŠ¶**: ä¿®æ”¹ä»£ç åé¡µé¢ä¸è‡ªåŠ¨åˆ·æ–°

**è§£å†³æ–¹æ¡ˆ**:
1. **é‡å¯ViteæœåŠ¡**:
   ```bash
   cd /root/trademe/frontend
   pkill -f "vite.*3000"
   npm run dev
   ```

2. **æ¸…é™¤æµè§ˆå™¨ç¼“å­˜**: 
   - æŒ‰ `Ctrl+F5` (ç¡¬åˆ·æ–°)
   - æˆ– `F12` â†’ å³é”®åˆ·æ–°æŒ‰é’® â†’ "æ¸…ç©ºç¼“å­˜å¹¶ç¡¬æ€§é‡æ–°åŠ è½½"

3. **æ£€æŸ¥æ–‡ä»¶ç›‘å¬**:
   ```bash
   # ç¡®è®¤Viteæ­£åœ¨ç›‘å¬æ–‡ä»¶å˜åŒ–
   cat /proc/sys/fs/inotify/max_user_watches
   # å¦‚æœå€¼å¤ªå°ï¼Œå¢åŠ é™åˆ¶:
   echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf
   sudo sysctl -p
   ```

### 3. æ•°æ®åº“è¿æ¥é—®é¢˜
**ç—‡çŠ¶**: `Database connection failed`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥SQLiteæ•°æ®åº“æ–‡ä»¶
ls -la /root/trademe/data/trademe.db

# æ£€æŸ¥æƒé™
chmod 644 /root/trademe/data/trademe.db

# é‡æ–°åˆå§‹åŒ–æ•°æ®åº“ (å¦‚æœéœ€è¦)
cd /root/trademe/backend/user-service
npm run db:migrate
```

### 4. Pythonæ¨¡å—å¯¼å…¥é—®é¢˜
**ç—‡çŠ¶**: `ModuleNotFoundError: No module named 'app'`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ç¡®ä¿PYTHONPATHè®¾ç½®æ­£ç¡®
cd /root/trademe/backend/trading-service
export PYTHONPATH=/root/trademe/backend/trading-service
python -c "import app.main; print('Import successful')"

# æˆ–ç›´æ¥ä½¿ç”¨å®Œæ•´è·¯å¾„å¯åŠ¨
PYTHONPATH=/root/trademe/backend/trading-service uvicorn app.main:app --host 0.0.0.0 --port 8001 --reload
```

### 5. Redisè¿æ¥é—®é¢˜
**ç—‡çŠ¶**: `Redis connection failed`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥RedisæœåŠ¡çŠ¶æ€
systemctl status redis
sudo systemctl start redis

# æµ‹è¯•Redisè¿æ¥
redis-cli ping
```

## ğŸ” æœåŠ¡å¥åº·æ£€æŸ¥

### æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
```bash
# äº¤æ˜“æœåŠ¡å¥åº·æ£€æŸ¥
curl http://localhost:8001/health

# ç”¨æˆ·æœåŠ¡å¥åº·æ£€æŸ¥  
curl http://localhost:3001/health

# å‰ç«¯æœåŠ¡æ£€æŸ¥
curl -I http://localhost:3000
```

### é¢„æœŸå“åº”
```json
// äº¤æ˜“æœåŠ¡ (8001)
{
  "status": "healthy",
  "timestamp": 1755771910.4083562,
  "environment": "development"
}

// ç”¨æˆ·æœåŠ¡ (3001)
{
  "status": "ok",
  "timestamp": "2025-08-21T10:25:10.272Z",
  "uptime": 47.276356207,
  "services": {
    "database": "healthy",
    "redis": "healthy",
    "upload": "healthy",
    "email": "healthy"
  },
  "version": "1.0.0",
  "environment": "development"
}

// å‰ç«¯æœåŠ¡ (3000)
HTTP/1.1 200 OK
```

## ğŸ“ æ—¥å¿—æ–‡ä»¶ä½ç½®

| æœåŠ¡ | æ—¥å¿—æ–‡ä»¶è·¯å¾„ |
|-----|-------------|
| äº¤æ˜“æœåŠ¡ | `/root/trademe/logs/trading-service.log` |
| ç”¨æˆ·æœåŠ¡ | `/root/trademe/logs/user-service.log` |
| å‰ç«¯æœåŠ¡ | `/root/trademe/logs/frontend.log` |

### æŸ¥çœ‹å®æ—¶æ—¥å¿—
```bash
# æŸ¥çœ‹äº¤æ˜“æœåŠ¡æ—¥å¿—
tail -f /root/trademe/logs/trading-service.log

# æŸ¥çœ‹ç”¨æˆ·æœåŠ¡æ—¥å¿—
tail -f /root/trademe/logs/user-service.log

# æŸ¥çœ‹å‰ç«¯æœåŠ¡æ—¥å¿—
tail -f /root/trademe/logs/frontend.log
```

## ğŸ”„ å¼€å‘å·¥ä½œæµç¨‹

### 1. æ¯æ—¥å¯åŠ¨æµç¨‹
```bash
cd /root/trademe
./start-dev.sh
# ç­‰å¾…æ‰€æœ‰æœåŠ¡å¯åŠ¨å®Œæˆ
# è®¿é—® http://localhost:3000 å¼€å§‹å¼€å‘
```

### 2. ä»£ç ä¿®æ”¹çƒ­æ›´æ–°
- **å‰ç«¯ä¿®æ”¹**: è‡ªåŠ¨çƒ­æ›´æ–°ï¼Œç«‹å³ç”Ÿæ•ˆ
- **ç”¨æˆ·æœåŠ¡ä¿®æ”¹**: nodemonè‡ªåŠ¨é‡å¯
- **äº¤æ˜“æœåŠ¡ä¿®æ”¹**: uvicornè‡ªåŠ¨é‡å¯

### 3. è°ƒè¯•è¿‡ç¨‹
1. **æŸ¥çœ‹å®æ—¶æ—¥å¿—**: `tail -f logs/*.log`
2. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**: è®¿é—®å¥åº·æ£€æŸ¥ç«¯ç‚¹
3. **é‡å¯ç‰¹å®šæœåŠ¡**: åœæ­¢è¿›ç¨‹åé‡æ–°å¯åŠ¨
4. **æ¸…ç†ç¼“å­˜**: æµè§ˆå™¨ç¡¬åˆ·æ–°æˆ–æ¸…é™¤ç¼“å­˜

### 4. ç»“æŸå¼€å‘
```bash
./stop-dev.sh
# ç¡®è®¤æ‰€æœ‰æœåŠ¡å·²åœæ­¢
```

## ğŸš¨ ç´§æ€¥é—®é¢˜å¤„ç†

### ç³»ç»Ÿå®Œå…¨é‡å¯
```bash
# 1. åœæ­¢æ‰€æœ‰æœåŠ¡
./stop-dev.sh

# 2. æ¸…ç†æ‰€æœ‰ç›¸å…³è¿›ç¨‹
pkill -f "node\|python\|vite\|uvicorn"

# 3. æ¸…ç†ç«¯å£å ç”¨
for port in 3000 3001 8001; do
    lsof -ti:$port | xargs -r kill -9
done

# 4. é‡æ–°å¯åŠ¨
./start-dev.sh
```

### æ•°æ®åº“é‡ç½® (è°¨æ…æ“ä½œ)
```bash
# å¤‡ä»½ç°æœ‰æ•°æ®
cp /root/trademe/data/trademe.db /root/trademe/data/trademe.db.backup

# é‡æ–°åˆå§‹åŒ–æ•°æ®åº“
cd /root/trademe/backend/user-service
npm run db:reset
npm run db:migrate
```

## ğŸ“Š æ€§èƒ½ç›‘æ§

### èµ„æºä½¿ç”¨ç›‘æ§
```bash
# æŸ¥çœ‹è¿›ç¨‹èµ„æºå ç”¨
ps aux | grep -E "(node|python|vite|uvicorn)"

# æŸ¥çœ‹ç«¯å£ç›‘å¬çŠ¶æ€
netstat -tlnp | grep -E "(3000|3001|8001)"

# æŸ¥çœ‹ç³»ç»Ÿèµ„æº
htop
```

### æ—¥å¿—å¤§å°ç›‘æ§
```bash
# æ£€æŸ¥æ—¥å¿—æ–‡ä»¶å¤§å°
du -sh /root/trademe/logs/*

# æ¸…ç†å¤§æ—¥å¿—æ–‡ä»¶ (å¦‚æœéœ€è¦)
truncate -s 0 /root/trademe/logs/*.log
```

## ğŸ’¡ æœ€ä½³å®è·µ

1. **æ¯å¤©å¼€å‘å‰**: è¿è¡Œ `./start-dev.sh` ç¡®ä¿ç¯å¢ƒæ­£å¸¸
2. **ä»£ç æäº¤å‰**: ç¡®ä¿æ‰€æœ‰æœåŠ¡æ­£å¸¸è¿è¡Œå’Œå¥åº·æ£€æŸ¥é€šè¿‡
3. **é‡åˆ°é—®é¢˜**: å…ˆæŸ¥çœ‹ç›¸åº”æœåŠ¡çš„æ—¥å¿—æ–‡ä»¶
4. **ç»“æŸå¼€å‘**: è¿è¡Œ `./stop-dev.sh` é‡Šæ”¾ç³»ç»Ÿèµ„æº
5. **å®šæœŸç»´æŠ¤**: æ¸…ç†æ—¥å¿—æ–‡ä»¶ï¼Œæ£€æŸ¥æ•°æ®åº“å¤§å°

---

**ç»´æŠ¤è€…**: Trademeå¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2025-08-21  
**ç‰ˆæœ¬**: v1.0