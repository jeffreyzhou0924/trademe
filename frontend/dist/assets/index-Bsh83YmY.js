var bl=Object.defineProperty;var qa=s=>{throw TypeError(s)};var vl=(s,t,r)=>t in s?bl(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var Le=(s,t,r)=>vl(s,typeof t!="symbol"?t+"":t,r),ta=(s,t,r)=>t.has(s)||qa("Cannot "+r);var U=(s,t,r)=>(ta(s,t,"read from private field"),r?r.call(s):t.get(s)),we=(s,t,r)=>t.has(s)?qa("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,r),ge=(s,t,r,a)=>(ta(s,t,"write to private field"),a?a.call(s,r):t.set(s,r),r),Je=(s,t,r)=>(ta(s,t,"access private method"),r);var ur=(s,t,r,a)=>({set _(n){ge(s,t,n,r)},get _(){return U(s,t,a)}});import{r as y,a as jl,g as Nl,R as ze,u as ot,L as Ke,b as Or,c as li,N as wl,d as kl,e as De,B as _l}from"./vendor-D-qGpst1.js";import{i as yr,L as da,R as Sl}from"./charts-BV7FbyVl.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var oi={exports:{}},Dr={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cl=y,Al=Symbol.for("react.element"),Ll=Symbol.for("react.fragment"),Tl=Object.prototype.hasOwnProperty,El=Cl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ml={key:!0,ref:!0,__self:!0,__source:!0};function ci(s,t,r){var a,n={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(a in t)Tl.call(t,a)&&!Ml.hasOwnProperty(a)&&(n[a]=t[a]);if(s&&s.defaultProps)for(a in t=s.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:Al,type:s,key:i,ref:l,props:n,_owner:El.current}}Dr.Fragment=Ll;Dr.jsx=ci;Dr.jsxs=ci;oi.exports=Dr;var e=oi.exports,ua={},Za=jl;ua.createRoot=Za.createRoot,ua.hydrateRoot=Za.hydrateRoot;var Fr=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(s){return this.listeners.add(s),this.onSubscribe(),()=>{this.listeners.delete(s),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},zr=typeof window>"u"||"Deno"in globalThis;function pt(){}function Il(s,t){return typeof s=="function"?s(t):s}function Rl(s){return typeof s=="number"&&s>=0&&s!==1/0}function Pl(s,t){return Math.max(s+(t||0)-Date.now(),0)}function ma(s,t){return typeof s=="function"?s(t):s}function $l(s,t){return typeof s=="function"?s(t):s}function Ga(s,t){const{type:r="all",exact:a,fetchStatus:n,predicate:i,queryKey:l,stale:o}=s;if(l){if(a){if(t.queryHash!==Ea(l,t.options))return!1}else if(!Js(t.queryKey,l))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||n&&n!==t.state.fetchStatus||i&&!i(t))}function Ka(s,t){const{exact:r,status:a,predicate:n,mutationKey:i}=s;if(i){if(!t.options.mutationKey)return!1;if(r){if(Ks(t.options.mutationKey)!==Ks(i))return!1}else if(!Js(t.options.mutationKey,i))return!1}return!(a&&t.state.status!==a||n&&!n(t))}function Ea(s,t){return((t==null?void 0:t.queryKeyHashFn)||Ks)(s)}function Ks(s){return JSON.stringify(s,(t,r)=>ha(r)?Object.keys(r).sort().reduce((a,n)=>(a[n]=r[n],a),{}):r)}function Js(s,t){return s===t?!0:typeof s!=typeof t?!1:s&&t&&typeof s=="object"&&typeof t=="object"?Object.keys(t).every(r=>Js(s[r],t[r])):!1}function di(s,t){if(s===t)return s;const r=Ja(s)&&Ja(t);if(r||ha(s)&&ha(t)){const a=r?s:Object.keys(s),n=a.length,i=r?t:Object.keys(t),l=i.length,o=r?[]:{},c=new Set(a);let d=0;for(let u=0;u<l;u++){const m=r?u:i[u];(!r&&c.has(m)||r)&&s[m]===void 0&&t[m]===void 0?(o[m]=void 0,d++):(o[m]=di(s[m],t[m]),o[m]===s[m]&&s[m]!==void 0&&d++)}return n===l&&d===n?s:o}return t}function Ja(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function ha(s){if(!Qa(s))return!1;const t=s.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!Qa(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(s)!==Object.prototype)}function Qa(s){return Object.prototype.toString.call(s)==="[object Object]"}function Bl(s){return new Promise(t=>{setTimeout(t,s)})}function Ol(s,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(s,t):r.structuralSharing!==!1?di(s,t):t}function Dl(s,t,r=0){const a=[...s,t];return r&&a.length>r?a.slice(1):a}function Fl(s,t,r=0){const a=[t,...s];return r&&a.length>r?a.slice(0,-1):a}var Ma=Symbol();function ui(s,t){return!s.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!s.queryFn||s.queryFn===Ma?()=>Promise.reject(new Error(`Missing queryFn: '${s.queryHash}'`)):s.queryFn}var us,Gt,ws,Yn,zl=(Yn=class extends Fr{constructor(){super();we(this,us);we(this,Gt);we(this,ws);ge(this,ws,t=>{if(!zr&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){U(this,Gt)||this.setEventListener(U(this,ws))}onUnsubscribe(){var t;this.hasListeners()||((t=U(this,Gt))==null||t.call(this),ge(this,Gt,void 0))}setEventListener(t){var r;ge(this,ws,t),(r=U(this,Gt))==null||r.call(this),ge(this,Gt,t(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(t){U(this,us)!==t&&(ge(this,us,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof U(this,us)=="boolean"?U(this,us):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},us=new WeakMap,Gt=new WeakMap,ws=new WeakMap,Yn),mi=new zl,ks,Kt,_s,ei,Ul=(ei=class extends Fr{constructor(){super();we(this,ks,!0);we(this,Kt);we(this,_s);ge(this,_s,t=>{if(!zr&&window.addEventListener){const r=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",a)}}})}onSubscribe(){U(this,Kt)||this.setEventListener(U(this,_s))}onUnsubscribe(){var t;this.hasListeners()||((t=U(this,Kt))==null||t.call(this),ge(this,Kt,void 0))}setEventListener(t){var r;ge(this,_s,t),(r=U(this,Kt))==null||r.call(this),ge(this,Kt,t(this.setOnline.bind(this)))}setOnline(t){U(this,ks)!==t&&(ge(this,ks,t),this.listeners.forEach(a=>{a(t)}))}isOnline(){return U(this,ks)}},ks=new WeakMap,Kt=new WeakMap,_s=new WeakMap,ei),Sr=new Ul;function Wl(){let s,t;const r=new Promise((n,i)=>{s=n,t=i});r.status="pending",r.catch(()=>{});function a(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{a({status:"fulfilled",value:n}),s(n)},r.reject=n=>{a({status:"rejected",reason:n}),t(n)},r}function Vl(s){return Math.min(1e3*2**s,3e4)}function hi(s){return(s??"online")==="online"?Sr.isOnline():!0}var xi=class extends Error{constructor(s){super("CancelledError"),this.revert=s==null?void 0:s.revert,this.silent=s==null?void 0:s.silent}};function gi(s){let t=!1,r=0,a;const n=Wl(),i=()=>n.status!=="pending",l=g=>{var N;i()||(w(new xi(g)),(N=s.abort)==null||N.call(s))},o=()=>{t=!0},c=()=>{t=!1},d=()=>mi.isFocused()&&(s.networkMode==="always"||Sr.isOnline())&&s.canRun(),u=()=>hi(s.networkMode)&&s.canRun(),m=g=>{i()||(a==null||a(),n.resolve(g))},w=g=>{i()||(a==null||a(),n.reject(g))},x=()=>new Promise(g=>{var N;a=v=>{(i()||d())&&g(v)},(N=s.onPause)==null||N.call(s)}).then(()=>{var g;a=void 0,i()||(g=s.onContinue)==null||g.call(s)}),b=()=>{if(i())return;let g;const N=r===0?s.initialPromise:void 0;try{g=N??s.fn()}catch(v){g=Promise.reject(v)}Promise.resolve(g).then(m).catch(v=>{var p;if(i())return;const L=s.retry??(zr?0:3),_=s.retryDelay??Vl,E=typeof _=="function"?_(r,v):_,A=L===!0||typeof L=="number"&&r<L||typeof L=="function"&&L(r,v);if(t||!A){w(v);return}r++,(p=s.onFail)==null||p.call(s,r,v),Bl(E).then(()=>d()?void 0:x()).then(()=>{t?w(v):b()})})};return{promise:n,status:()=>n.status,cancel:l,continue:()=>(a==null||a(),n),cancelRetry:o,continueRetry:c,canStart:u,start:()=>(u()?b():x().then(b),n)}}var Hl=s=>setTimeout(s,0);function ql(){let s=[],t=0,r=o=>{o()},a=o=>{o()},n=Hl;const i=o=>{t?s.push(o):n(()=>{r(o)})},l=()=>{const o=s;s=[],o.length&&n(()=>{a(()=>{o.forEach(c=>{r(c)})})})};return{batch:o=>{let c;t++;try{c=o()}finally{t--,t||l()}return c},batchCalls:o=>(...c)=>{i(()=>{o(...c)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{a=o},setScheduler:o=>{n=o}}}var st=ql(),ms,ti,fi=(ti=class{constructor(){we(this,ms)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Rl(this.gcTime)&&ge(this,ms,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(s){this.gcTime=Math.max(this.gcTime||0,s??(zr?1/0:5*60*1e3))}clearGcTimeout(){U(this,ms)&&(clearTimeout(U(this,ms)),ge(this,ms,void 0))}},ms=new WeakMap,ti),Ss,Cs,xt,hs,Ze,rr,xs,yt,Ot,si,Zl=(si=class extends fi{constructor(t){super();we(this,yt);we(this,Ss);we(this,Cs);we(this,xt);we(this,hs);we(this,Ze);we(this,rr);we(this,xs);ge(this,xs,!1),ge(this,rr,t.defaultOptions),this.setOptions(t.options),this.observers=[],ge(this,hs,t.client),ge(this,xt,U(this,hs).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,ge(this,Ss,Kl(this.options)),this.state=t.state??U(this,Ss),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=U(this,Ze))==null?void 0:t.promise}setOptions(t){this.options={...U(this,rr),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&U(this,xt).remove(this)}setData(t,r){const a=Ol(this.state.data,t,this.options);return Je(this,yt,Ot).call(this,{data:a,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),a}setState(t,r){Je(this,yt,Ot).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var a,n;const r=(a=U(this,Ze))==null?void 0:a.promise;return(n=U(this,Ze))==null||n.cancel(t),r?r.then(pt).catch(pt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(U(this,Ss))}isActive(){return this.observers.some(t=>$l(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ma||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ma(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Pl(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(a=>a.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=U(this,Ze))==null||r.continue()}onOnline(){var r;const t=this.observers.find(a=>a.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=U(this,Ze))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),U(this,xt).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(U(this,Ze)&&(U(this,xs)?U(this,Ze).cancel({revert:!0}):U(this,Ze).cancelRetry()),this.scheduleGc()),U(this,xt).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Je(this,yt,Ot).call(this,{type:"invalidate"})}async fetch(t,r){var c,d,u,m,w,x,b,g,N,v,L,_;if(this.state.fetchStatus!=="idle"&&((c=U(this,Ze))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(U(this,Ze))return U(this,Ze).continueRetry(),U(this,Ze).promise}if(t&&this.setOptions(t),!this.options.queryFn){const E=this.observers.find(A=>A.options.queryFn);E&&this.setOptions(E.options)}const a=new AbortController,n=E=>{Object.defineProperty(E,"signal",{enumerable:!0,get:()=>(ge(this,xs,!0),a.signal)})},i=()=>{const E=ui(this.options,r),p=(()=>{const k={client:U(this,hs),queryKey:this.queryKey,meta:this.meta};return n(k),k})();return ge(this,xs,!1),this.options.persister?this.options.persister(E,p,this):E(p)},o=(()=>{const E={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:U(this,hs),state:this.state,fetchFn:i};return n(E),E})();(d=this.options.behavior)==null||d.onFetch(o,this),ge(this,Cs,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=o.fetchOptions)==null?void 0:u.meta))&&Je(this,yt,Ot).call(this,{type:"fetch",meta:(m=o.fetchOptions)==null?void 0:m.meta}),ge(this,Ze,gi({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,abort:a.abort.bind(a),onFail:(E,A)=>{Je(this,yt,Ot).call(this,{type:"failed",failureCount:E,error:A})},onPause:()=>{Je(this,yt,Ot).call(this,{type:"pause"})},onContinue:()=>{Je(this,yt,Ot).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const E=await U(this,Ze).start();if(E===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(E),(x=(w=U(this,xt).config).onSuccess)==null||x.call(w,E,this),(g=(b=U(this,xt).config).onSettled)==null||g.call(b,E,this.state.error,this),E}catch(E){if(E instanceof xi){if(E.silent)return U(this,Ze).promise;if(E.revert){if(this.setState({...U(this,Cs),fetchStatus:"idle"}),this.state.data===void 0)throw E;return this.state.data}}throw Je(this,yt,Ot).call(this,{type:"error",error:E}),(v=(N=U(this,xt).config).onError)==null||v.call(N,E,this),(_=(L=U(this,xt).config).onSettled)==null||_.call(L,this.state.data,E,this),E}finally{this.scheduleGc()}}},Ss=new WeakMap,Cs=new WeakMap,xt=new WeakMap,hs=new WeakMap,Ze=new WeakMap,rr=new WeakMap,xs=new WeakMap,yt=new WeakSet,Ot=function(t){const r=a=>{switch(t.type){case"failed":return{...a,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...Gl(a.data,this.options),fetchMeta:t.meta??null};case"success":const n={...a,data:t.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ge(this,Cs,t.manual?n:void 0),n;case"error":const i=t.error;return{...a,error:i,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...t.state}}};this.state=r(this.state),st.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),U(this,xt).notify({query:this,type:"updated",action:t})})},si);function Gl(s,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:hi(t.networkMode)?"fetching":"paused",...s===void 0&&{error:null,status:"pending"}}}function Kl(s){const t=typeof s.initialData=="function"?s.initialData():s.initialData,r=t!==void 0,a=r?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Ct,ri,Jl=(ri=class extends Fr{constructor(t={}){super();we(this,Ct);this.config=t,ge(this,Ct,new Map)}build(t,r,a){const n=r.queryKey,i=r.queryHash??Ea(n,r);let l=this.get(i);return l||(l=new Zl({client:t,queryKey:n,queryHash:i,options:t.defaultQueryOptions(r),state:a,defaultOptions:t.getQueryDefaults(n)}),this.add(l)),l}add(t){U(this,Ct).has(t.queryHash)||(U(this,Ct).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=U(this,Ct).get(t.queryHash);r&&(t.destroy(),r===t&&U(this,Ct).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){st.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return U(this,Ct).get(t)}getAll(){return[...U(this,Ct).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(a=>Ga(r,a))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(a=>Ga(t,a)):r}notify(t){st.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){st.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){st.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Ct=new WeakMap,ri),At,et,gs,Lt,Vt,ai,Ql=(ai=class extends fi{constructor(t){super();we(this,Lt);we(this,At);we(this,et);we(this,gs);this.mutationId=t.mutationId,ge(this,et,t.mutationCache),ge(this,At,[]),this.state=t.state||Xl(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){U(this,At).includes(t)||(U(this,At).push(t),this.clearGcTimeout(),U(this,et).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){ge(this,At,U(this,At).filter(r=>r!==t)),this.scheduleGc(),U(this,et).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){U(this,At).length||(this.state.status==="pending"?this.scheduleGc():U(this,et).remove(this))}continue(){var t;return((t=U(this,gs))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,l,o,c,d,u,m,w,x,b,g,N,v,L,_,E,A,p,k,C;const r=()=>{Je(this,Lt,Vt).call(this,{type:"continue"})};ge(this,gs,gi({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(W,re)=>{Je(this,Lt,Vt).call(this,{type:"failed",failureCount:W,error:re})},onPause:()=>{Je(this,Lt,Vt).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>U(this,et).canRun(this)}));const a=this.state.status==="pending",n=!U(this,gs).canStart();try{if(a)r();else{Je(this,Lt,Vt).call(this,{type:"pending",variables:t,isPaused:n}),await((l=(i=U(this,et).config).onMutate)==null?void 0:l.call(i,t,this));const re=await((c=(o=this.options).onMutate)==null?void 0:c.call(o,t));re!==this.state.context&&Je(this,Lt,Vt).call(this,{type:"pending",context:re,variables:t,isPaused:n})}const W=await U(this,gs).start();return await((u=(d=U(this,et).config).onSuccess)==null?void 0:u.call(d,W,t,this.state.context,this)),await((w=(m=this.options).onSuccess)==null?void 0:w.call(m,W,t,this.state.context)),await((b=(x=U(this,et).config).onSettled)==null?void 0:b.call(x,W,null,this.state.variables,this.state.context,this)),await((N=(g=this.options).onSettled)==null?void 0:N.call(g,W,null,t,this.state.context)),Je(this,Lt,Vt).call(this,{type:"success",data:W}),W}catch(W){try{throw await((L=(v=U(this,et).config).onError)==null?void 0:L.call(v,W,t,this.state.context,this)),await((E=(_=this.options).onError)==null?void 0:E.call(_,W,t,this.state.context)),await((p=(A=U(this,et).config).onSettled)==null?void 0:p.call(A,void 0,W,this.state.variables,this.state.context,this)),await((C=(k=this.options).onSettled)==null?void 0:C.call(k,void 0,W,t,this.state.context)),W}finally{Je(this,Lt,Vt).call(this,{type:"error",error:W})}}finally{U(this,et).runNext(this)}}},At=new WeakMap,et=new WeakMap,gs=new WeakMap,Lt=new WeakSet,Vt=function(t){const r=a=>{switch(t.type){case"failed":return{...a,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...a,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:t.error,failureCount:a.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),st.batch(()=>{U(this,At).forEach(a=>{a.onMutationUpdate(t)}),U(this,et).notify({mutation:this,type:"updated",action:t})})},ai);function Xl(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Dt,bt,ar,ni,Yl=(ni=class extends Fr{constructor(t={}){super();we(this,Dt);we(this,bt);we(this,ar);this.config=t,ge(this,Dt,new Set),ge(this,bt,new Map),ge(this,ar,0)}build(t,r,a){const n=new Ql({mutationCache:this,mutationId:++ur(this,ar)._,options:t.defaultMutationOptions(r),state:a});return this.add(n),n}add(t){U(this,Dt).add(t);const r=mr(t);if(typeof r=="string"){const a=U(this,bt).get(r);a?a.push(t):U(this,bt).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(U(this,Dt).delete(t)){const r=mr(t);if(typeof r=="string"){const a=U(this,bt).get(r);if(a)if(a.length>1){const n=a.indexOf(t);n!==-1&&a.splice(n,1)}else a[0]===t&&U(this,bt).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=mr(t);if(typeof r=="string"){const a=U(this,bt).get(r),n=a==null?void 0:a.find(i=>i.state.status==="pending");return!n||n===t}else return!0}runNext(t){var a;const r=mr(t);if(typeof r=="string"){const n=(a=U(this,bt).get(r))==null?void 0:a.find(i=>i!==t&&i.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){st.batch(()=>{U(this,Dt).forEach(t=>{this.notify({type:"removed",mutation:t})}),U(this,Dt).clear(),U(this,bt).clear()})}getAll(){return Array.from(U(this,Dt))}find(t){const r={exact:!0,...t};return this.getAll().find(a=>Ka(r,a))}findAll(t={}){return this.getAll().filter(r=>Ka(t,r))}notify(t){st.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return st.batch(()=>Promise.all(t.map(r=>r.continue().catch(pt))))}},Dt=new WeakMap,bt=new WeakMap,ar=new WeakMap,ni);function mr(s){var t;return(t=s.options.scope)==null?void 0:t.id}function Xa(s){return{onFetch:(t,r)=>{var u,m,w,x,b;const a=t.options,n=(w=(m=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:m.fetchMore)==null?void 0:w.direction,i=((x=t.state.data)==null?void 0:x.pages)||[],l=((b=t.state.data)==null?void 0:b.pageParams)||[];let o={pages:[],pageParams:[]},c=0;const d=async()=>{let g=!1;const N=_=>{Object.defineProperty(_,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},v=ui(t.options,t.fetchOptions),L=async(_,E,A)=>{if(g)return Promise.reject();if(E==null&&_.pages.length)return Promise.resolve(_);const k=(()=>{const Y={client:t.client,queryKey:t.queryKey,pageParam:E,direction:A?"backward":"forward",meta:t.options.meta};return N(Y),Y})(),C=await v(k),{maxPages:W}=t.options,re=A?Fl:Dl;return{pages:re(_.pages,C,W),pageParams:re(_.pageParams,E,W)}};if(n&&i.length){const _=n==="backward",E=_?eo:Ya,A={pages:i,pageParams:l},p=E(a,A);o=await L(A,p,_)}else{const _=s??i.length;do{const E=c===0?l[0]??a.initialPageParam:Ya(a,o);if(c>0&&E==null)break;o=await L(o,E),c++}while(c<_)}return o};t.options.persister?t.fetchFn=()=>{var g,N;return(N=(g=t.options).persister)==null?void 0:N.call(g,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=d}}}function Ya(s,{pages:t,pageParams:r}){const a=t.length-1;return t.length>0?s.getNextPageParam(t[a],t,r[a],r):void 0}function eo(s,{pages:t,pageParams:r}){var a;return t.length>0?(a=s.getPreviousPageParam)==null?void 0:a.call(s,t[0],t,r[0],r):void 0}var Ee,Jt,Qt,As,Ls,Xt,Ts,Es,ii,to=(ii=class{constructor(s={}){we(this,Ee);we(this,Jt);we(this,Qt);we(this,As);we(this,Ls);we(this,Xt);we(this,Ts);we(this,Es);ge(this,Ee,s.queryCache||new Jl),ge(this,Jt,s.mutationCache||new Yl),ge(this,Qt,s.defaultOptions||{}),ge(this,As,new Map),ge(this,Ls,new Map),ge(this,Xt,0)}mount(){ur(this,Xt)._++,U(this,Xt)===1&&(ge(this,Ts,mi.subscribe(async s=>{s&&(await this.resumePausedMutations(),U(this,Ee).onFocus())})),ge(this,Es,Sr.subscribe(async s=>{s&&(await this.resumePausedMutations(),U(this,Ee).onOnline())})))}unmount(){var s,t;ur(this,Xt)._--,U(this,Xt)===0&&((s=U(this,Ts))==null||s.call(this),ge(this,Ts,void 0),(t=U(this,Es))==null||t.call(this),ge(this,Es,void 0))}isFetching(s){return U(this,Ee).findAll({...s,fetchStatus:"fetching"}).length}isMutating(s){return U(this,Jt).findAll({...s,status:"pending"}).length}getQueryData(s){var r;const t=this.defaultQueryOptions({queryKey:s});return(r=U(this,Ee).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(s){const t=this.defaultQueryOptions(s),r=U(this,Ee).build(this,t),a=r.state.data;return a===void 0?this.fetchQuery(s):(s.revalidateIfStale&&r.isStaleByTime(ma(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(s){return U(this,Ee).findAll(s).map(({queryKey:t,state:r})=>{const a=r.data;return[t,a]})}setQueryData(s,t,r){const a=this.defaultQueryOptions({queryKey:s}),n=U(this,Ee).get(a.queryHash),i=n==null?void 0:n.state.data,l=Il(t,i);if(l!==void 0)return U(this,Ee).build(this,a).setData(l,{...r,manual:!0})}setQueriesData(s,t,r){return st.batch(()=>U(this,Ee).findAll(s).map(({queryKey:a})=>[a,this.setQueryData(a,t,r)]))}getQueryState(s){var r;const t=this.defaultQueryOptions({queryKey:s});return(r=U(this,Ee).get(t.queryHash))==null?void 0:r.state}removeQueries(s){const t=U(this,Ee);st.batch(()=>{t.findAll(s).forEach(r=>{t.remove(r)})})}resetQueries(s,t){const r=U(this,Ee);return st.batch(()=>(r.findAll(s).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...s},t)))}cancelQueries(s,t={}){const r={revert:!0,...t},a=st.batch(()=>U(this,Ee).findAll(s).map(n=>n.cancel(r)));return Promise.all(a).then(pt).catch(pt)}invalidateQueries(s,t={}){return st.batch(()=>(U(this,Ee).findAll(s).forEach(r=>{r.invalidate()}),(s==null?void 0:s.refetchType)==="none"?Promise.resolve():this.refetchQueries({...s,type:(s==null?void 0:s.refetchType)??(s==null?void 0:s.type)??"active"},t)))}refetchQueries(s,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},a=st.batch(()=>U(this,Ee).findAll(s).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let i=n.fetch(void 0,r);return r.throwOnError||(i=i.catch(pt)),n.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(a).then(pt)}fetchQuery(s){const t=this.defaultQueryOptions(s);t.retry===void 0&&(t.retry=!1);const r=U(this,Ee).build(this,t);return r.isStaleByTime(ma(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(s){return this.fetchQuery(s).then(pt).catch(pt)}fetchInfiniteQuery(s){return s.behavior=Xa(s.pages),this.fetchQuery(s)}prefetchInfiniteQuery(s){return this.fetchInfiniteQuery(s).then(pt).catch(pt)}ensureInfiniteQueryData(s){return s.behavior=Xa(s.pages),this.ensureQueryData(s)}resumePausedMutations(){return Sr.isOnline()?U(this,Jt).resumePausedMutations():Promise.resolve()}getQueryCache(){return U(this,Ee)}getMutationCache(){return U(this,Jt)}getDefaultOptions(){return U(this,Qt)}setDefaultOptions(s){ge(this,Qt,s)}setQueryDefaults(s,t){U(this,As).set(Ks(s),{queryKey:s,defaultOptions:t})}getQueryDefaults(s){const t=[...U(this,As).values()],r={};return t.forEach(a=>{Js(s,a.queryKey)&&Object.assign(r,a.defaultOptions)}),r}setMutationDefaults(s,t){U(this,Ls).set(Ks(s),{mutationKey:s,defaultOptions:t})}getMutationDefaults(s){const t=[...U(this,Ls).values()],r={};return t.forEach(a=>{Js(s,a.mutationKey)&&Object.assign(r,a.defaultOptions)}),r}defaultQueryOptions(s){if(s._defaulted)return s;const t={...U(this,Qt).queries,...this.getQueryDefaults(s.queryKey),...s,_defaulted:!0};return t.queryHash||(t.queryHash=Ea(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Ma&&(t.enabled=!1),t}defaultMutationOptions(s){return s!=null&&s._defaulted?s:{...U(this,Qt).mutations,...(s==null?void 0:s.mutationKey)&&this.getMutationDefaults(s.mutationKey),...s,_defaulted:!0}}clear(){U(this,Ee).clear(),U(this,Jt).clear()}},Ee=new WeakMap,Jt=new WeakMap,Qt=new WeakMap,As=new WeakMap,Ls=new WeakMap,Xt=new WeakMap,Ts=new WeakMap,Es=new WeakMap,ii),so=y.createContext(void 0),ro=({client:s,children:t})=>(y.useEffect(()=>(s.mount(),()=>{s.unmount()}),[s]),e.jsx(so.Provider,{value:s,children:t}));let ao={data:""},no=s=>typeof window=="object"?((s?s.querySelector("#_goober"):window._goober)||Object.assign((s||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:s||ao,io=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,lo=/\/\*[^]*?\*\/|  +/g,en=/\n+/g,qt=(s,t)=>{let r="",a="",n="";for(let i in s){let l=s[i];i[0]=="@"?i[1]=="i"?r=i+" "+l+";":a+=i[1]=="f"?qt(l,i):i+"{"+qt(l,i[1]=="k"?"":t)+"}":typeof l=="object"?a+=qt(l,t?t.replace(/([^,])+/g,o=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,o):o?o+" "+c:c)):i):l!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=qt.p?qt.p(i,l):i+":"+l+";")}return r+(t&&n?t+"{"+n+"}":n)+a},Pt={},pi=s=>{if(typeof s=="object"){let t="";for(let r in s)t+=r+pi(s[r]);return t}return s},oo=(s,t,r,a,n)=>{let i=pi(s),l=Pt[i]||(Pt[i]=(c=>{let d=0,u=11;for(;d<c.length;)u=101*u+c.charCodeAt(d++)>>>0;return"go"+u})(i));if(!Pt[l]){let c=i!==s?s:(d=>{let u,m,w=[{}];for(;u=io.exec(d.replace(lo,""));)u[4]?w.shift():u[3]?(m=u[3].replace(en," ").trim(),w.unshift(w[0][m]=w[0][m]||{})):w[0][u[1]]=u[2].replace(en," ").trim();return w[0]})(s);Pt[l]=qt(n?{["@keyframes "+l]:c}:c,r?"":"."+l)}let o=r&&Pt.g?Pt.g:null;return r&&(Pt.g=Pt[l]),((c,d,u,m)=>{m?d.data=d.data.replace(m,c):d.data.indexOf(c)===-1&&(d.data=u?c+d.data:d.data+c)})(Pt[l],t,a,o),l},co=(s,t,r)=>s.reduce((a,n,i)=>{let l=t[i];if(l&&l.call){let o=l(r),c=o&&o.props&&o.props.className||/^go/.test(o)&&o;l=c?"."+c:o&&typeof o=="object"?o.props?"":qt(o,""):o===!1?"":o}return a+n+(l??"")},"");function Ur(s){let t=this||{},r=s.call?s(t.p):s;return oo(r.unshift?r.raw?co(r,[].slice.call(arguments,1),t.p):r.reduce((a,n)=>Object.assign(a,n&&n.call?n(t.p):n),{}):r,no(t.target),t.g,t.o,t.k)}let yi,xa,ga;Ur.bind({g:1});let Ft=Ur.bind({k:1});function uo(s,t,r,a){qt.p=t,yi=s,xa=r,ga=a}function rs(s,t){let r=this||{};return function(){let a=arguments;function n(i,l){let o=Object.assign({},i),c=o.className||n.className;r.p=Object.assign({theme:xa&&xa()},o),r.o=/ *go\d+/.test(c),o.className=Ur.apply(r,a)+(c?" "+c:"");let d=s;return s[0]&&(d=o.as||s,delete o.as),ga&&d[0]&&ga(o),yi(d,o)}return n}}var mo=s=>typeof s=="function",Cr=(s,t)=>mo(s)?s(t):s,ho=(()=>{let s=0;return()=>(++s).toString()})(),bi=(()=>{let s;return()=>{if(s===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");s=!t||t.matches}return s}})(),xo=20,Ia="default",vi=(s,t)=>{let{toastLimit:r}=s.settings;switch(t.type){case 0:return{...s,toasts:[t.toast,...s.toasts].slice(0,r)};case 1:return{...s,toasts:s.toasts.map(l=>l.id===t.toast.id?{...l,...t.toast}:l)};case 2:let{toast:a}=t;return vi(s,{type:s.toasts.find(l=>l.id===a.id)?1:0,toast:a});case 3:let{toastId:n}=t;return{...s,toasts:s.toasts.map(l=>l.id===n||n===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(l=>l.id!==t.toastId)};case 5:return{...s,pausedAt:t.time};case 6:let i=t.time-(s.pausedAt||0);return{...s,pausedAt:void 0,toasts:s.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+i}))}}},br=[],ji={toasts:[],pausedAt:void 0,settings:{toastLimit:xo}},Tt={},Ni=(s,t=Ia)=>{Tt[t]=vi(Tt[t]||ji,s),br.forEach(([r,a])=>{r===t&&a(Tt[t])})},wi=s=>Object.keys(Tt).forEach(t=>Ni(s,t)),go=s=>Object.keys(Tt).find(t=>Tt[t].toasts.some(r=>r.id===s)),Wr=(s=Ia)=>t=>{Ni(t,s)},fo={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},po=(s={},t=Ia)=>{let[r,a]=y.useState(Tt[t]||ji),n=y.useRef(Tt[t]);y.useEffect(()=>(n.current!==Tt[t]&&a(Tt[t]),br.push([t,a]),()=>{let l=br.findIndex(([o])=>o===t);l>-1&&br.splice(l,1)}),[t]);let i=r.toasts.map(l=>{var o,c,d;return{...s,...s[l.type],...l,removeDelay:l.removeDelay||((o=s[l.type])==null?void 0:o.removeDelay)||(s==null?void 0:s.removeDelay),duration:l.duration||((c=s[l.type])==null?void 0:c.duration)||(s==null?void 0:s.duration)||fo[l.type],style:{...s.style,...(d=s[l.type])==null?void 0:d.style,...l.style}}});return{...r,toasts:i}},yo=(s,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:s,pauseDuration:0,...r,id:(r==null?void 0:r.id)||ho()}),nr=s=>(t,r)=>{let a=yo(t,s,r);return Wr(a.toasterId||go(a.id))({type:2,toast:a}),a.id},Ue=(s,t)=>nr("blank")(s,t);Ue.error=nr("error");Ue.success=nr("success");Ue.loading=nr("loading");Ue.custom=nr("custom");Ue.dismiss=(s,t)=>{let r={type:3,toastId:s};t?Wr(t)(r):wi(r)};Ue.dismissAll=s=>Ue.dismiss(void 0,s);Ue.remove=(s,t)=>{let r={type:4,toastId:s};t?Wr(t)(r):wi(r)};Ue.removeAll=s=>Ue.remove(void 0,s);Ue.promise=(s,t,r)=>{let a=Ue.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof s=="function"&&(s=s()),s.then(n=>{let i=t.success?Cr(t.success,n):void 0;return i?Ue.success(i,{id:a,...r,...r==null?void 0:r.success}):Ue.dismiss(a),n}).catch(n=>{let i=t.error?Cr(t.error,n):void 0;i?Ue.error(i,{id:a,...r,...r==null?void 0:r.error}):Ue.dismiss(a)}),s};var bo=1e3,vo=(s,t="default")=>{let{toasts:r,pausedAt:a}=po(s,t),n=y.useRef(new Map).current,i=y.useCallback((m,w=bo)=>{if(n.has(m))return;let x=setTimeout(()=>{n.delete(m),l({type:4,toastId:m})},w);n.set(m,x)},[]);y.useEffect(()=>{if(a)return;let m=Date.now(),w=r.map(x=>{if(x.duration===1/0)return;let b=(x.duration||0)+x.pauseDuration-(m-x.createdAt);if(b<0){x.visible&&Ue.dismiss(x.id);return}return setTimeout(()=>Ue.dismiss(x.id,t),b)});return()=>{w.forEach(x=>x&&clearTimeout(x))}},[r,a,t]);let l=y.useCallback(Wr(t),[t]),o=y.useCallback(()=>{l({type:5,time:Date.now()})},[l]),c=y.useCallback((m,w)=>{l({type:1,toast:{id:m,height:w}})},[l]),d=y.useCallback(()=>{a&&l({type:6,time:Date.now()})},[a,l]),u=y.useCallback((m,w)=>{let{reverseOrder:x=!1,gutter:b=8,defaultPosition:g}=w||{},N=r.filter(_=>(_.position||g)===(m.position||g)&&_.height),v=N.findIndex(_=>_.id===m.id),L=N.filter((_,E)=>E<v&&_.visible).length;return N.filter(_=>_.visible).slice(...x?[L+1]:[0,L]).reduce((_,E)=>_+(E.height||0)+b,0)},[r]);return y.useEffect(()=>{r.forEach(m=>{if(m.dismissed)i(m.id,m.removeDelay);else{let w=n.get(m.id);w&&(clearTimeout(w),n.delete(m.id))}})},[r,i]),{toasts:r,handlers:{updateHeight:c,startPause:o,endPause:d,calculateOffset:u}}},jo=Ft`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,No=Ft`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,wo=Ft`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,ko=rs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${jo} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${No} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${s=>s.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${wo} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,_o=Ft`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,So=rs("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${s=>s.secondary||"#e0e0e0"};
  border-right-color: ${s=>s.primary||"#616161"};
  animation: ${_o} 1s linear infinite;
`,Co=Ft`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Ao=Ft`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Lo=rs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Co} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Ao} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${s=>s.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,To=rs("div")`
  position: absolute;
`,Eo=rs("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Mo=Ft`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Io=rs("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Mo} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Ro=({toast:s})=>{let{icon:t,type:r,iconTheme:a}=s;return t!==void 0?typeof t=="string"?y.createElement(Io,null,t):t:r==="blank"?null:y.createElement(Eo,null,y.createElement(So,{...a}),r!=="loading"&&y.createElement(To,null,r==="error"?y.createElement(ko,{...a}):y.createElement(Lo,{...a})))},Po=s=>`
0% {transform: translate3d(0,${s*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,$o=s=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${s*-150}%,-1px) scale(.6); opacity:0;}
`,Bo="0%{opacity:0;} 100%{opacity:1;}",Oo="0%{opacity:1;} 100%{opacity:0;}",Do=rs("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Fo=rs("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,zo=(s,t)=>{let r=s.includes("top")?1:-1,[a,n]=bi()?[Bo,Oo]:[Po(r),$o(r)];return{animation:t?`${Ft(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ft(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Uo=y.memo(({toast:s,position:t,style:r,children:a})=>{let n=s.height?zo(s.position||t||"top-center",s.visible):{opacity:0},i=y.createElement(Ro,{toast:s}),l=y.createElement(Fo,{...s.ariaProps},Cr(s.message,s));return y.createElement(Do,{className:s.className,style:{...n,...r,...s.style}},typeof a=="function"?a({icon:i,message:l}):y.createElement(y.Fragment,null,i,l))});uo(y.createElement);var Wo=({id:s,className:t,style:r,onHeightUpdate:a,children:n})=>{let i=y.useCallback(l=>{if(l){let o=()=>{let c=l.getBoundingClientRect().height;a(s,c)};o(),new MutationObserver(o).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[s,a]);return y.createElement("div",{ref:i,className:t,style:r},n)},Vo=(s,t)=>{let r=s.includes("top"),a=r?{top:0}:{bottom:0},n=s.includes("center")?{justifyContent:"center"}:s.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:bi()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...a,...n}},Ho=Ur`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,hr=16,qo=({reverseOrder:s,position:t="top-center",toastOptions:r,gutter:a,children:n,toasterId:i,containerStyle:l,containerClassName:o})=>{let{toasts:c,handlers:d}=vo(r,i);return y.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:hr,left:hr,right:hr,bottom:hr,pointerEvents:"none",...l},className:o,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(u=>{let m=u.position||t,w=d.calculateOffset(u,{reverseOrder:s,gutter:a,defaultPosition:t}),x=Vo(m,w);return y.createElement(Wo,{id:u.id,key:u.id,onHeightUpdate:d.updateHeight,className:u.visible?Ho:"",style:x},u.type==="custom"?Cr(u.message,u):n?n(u):y.createElement(Uo,{toast:u,position:m}))}))},M=Ue;const Zo={},tn=s=>{let t;const r=new Set,a=(u,m)=>{const w=typeof u=="function"?u(t):u;if(!Object.is(w,t)){const x=t;t=m??(typeof w!="object"||w===null)?w:Object.assign({},t,w),r.forEach(b=>b(t,x))}},n=()=>t,c={setState:a,getState:n,getInitialState:()=>d,subscribe:u=>(r.add(u),()=>r.delete(u)),destroy:()=>{(Zo?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=t=s(a,n,c);return c},Go=s=>s?tn(s):tn;var ki={exports:{}},_i={},Si={exports:{}},Ci={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ms=y;function Ko(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var Jo=typeof Object.is=="function"?Object.is:Ko,Qo=Ms.useState,Xo=Ms.useEffect,Yo=Ms.useLayoutEffect,ec=Ms.useDebugValue;function tc(s,t){var r=t(),a=Qo({inst:{value:r,getSnapshot:t}}),n=a[0].inst,i=a[1];return Yo(function(){n.value=r,n.getSnapshot=t,sa(n)&&i({inst:n})},[s,r,t]),Xo(function(){return sa(n)&&i({inst:n}),s(function(){sa(n)&&i({inst:n})})},[s]),ec(r),r}function sa(s){var t=s.getSnapshot;s=s.value;try{var r=t();return!Jo(s,r)}catch{return!0}}function sc(s,t){return t()}var rc=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?sc:tc;Ci.useSyncExternalStore=Ms.useSyncExternalStore!==void 0?Ms.useSyncExternalStore:rc;Si.exports=Ci;var ac=Si.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vr=y,nc=ac;function ic(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var lc=typeof Object.is=="function"?Object.is:ic,oc=nc.useSyncExternalStore,cc=Vr.useRef,dc=Vr.useEffect,uc=Vr.useMemo,mc=Vr.useDebugValue;_i.useSyncExternalStoreWithSelector=function(s,t,r,a,n){var i=cc(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=uc(function(){function c(x){if(!d){if(d=!0,u=x,x=a(x),n!==void 0&&l.hasValue){var b=l.value;if(n(b,x))return m=b}return m=x}if(b=m,lc(u,x))return b;var g=a(x);return n!==void 0&&n(b,g)?(u=x,b):(u=x,m=g)}var d=!1,u,m,w=r===void 0?null:r;return[function(){return c(t())},w===null?void 0:function(){return c(w())}]},[t,r,a,n]);var o=oc(s,i[0],i[1]);return dc(function(){l.hasValue=!0,l.value=o},[o]),mc(o),o};ki.exports=_i;var hc=ki.exports;const xc=Nl(hc),Ai={},{useDebugValue:gc}=ze,{useSyncExternalStoreWithSelector:fc}=xc;let sn=!1;const pc=s=>s;function yc(s,t=pc,r){(Ai?"production":void 0)!=="production"&&r&&!sn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),sn=!0);const a=fc(s.subscribe,s.getState,s.getServerState||s.getInitialState,t,r);return gc(a),a}const rn=s=>{(Ai?"production":void 0)!=="production"&&typeof s!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof s=="function"?Go(s):s,r=(a,n)=>yc(t,a,n);return Object.assign(r,t),r},as=s=>s?rn(s):rn,bc={};function vc(s,t){let r;try{r=s()}catch{return}return{getItem:n=>{var i;const l=c=>c===null?null:JSON.parse(c,void 0),o=(i=r.getItem(n))!=null?i:null;return o instanceof Promise?o.then(l):l(o)},setItem:(n,i)=>r.setItem(n,JSON.stringify(i,void 0)),removeItem:n=>r.removeItem(n)}}const Qs=s=>t=>{try{const r=s(t);return r instanceof Promise?r:{then(a){return Qs(a)(r)},catch(a){return this}}}catch(r){return{then(a){return this},catch(a){return Qs(a)(r)}}}},jc=(s,t)=>(r,a,n)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:N=>N,version:0,merge:(N,v)=>({...v,...N}),...t},l=!1;const o=new Set,c=new Set;let d;try{d=i.getStorage()}catch{}if(!d)return s((...N)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...N)},a,n);const u=Qs(i.serialize),m=()=>{const N=i.partialize({...a()});let v;const L=u({state:N,version:i.version}).then(_=>d.setItem(i.name,_)).catch(_=>{v=_});if(v)throw v;return L},w=n.setState;n.setState=(N,v)=>{w(N,v),m()};const x=s((...N)=>{r(...N),m()},a,n);let b;const g=()=>{var N;if(!d)return;l=!1,o.forEach(L=>L(a()));const v=((N=i.onRehydrateStorage)==null?void 0:N.call(i,a()))||void 0;return Qs(d.getItem.bind(d))(i.name).then(L=>{if(L)return i.deserialize(L)}).then(L=>{if(L)if(typeof L.version=="number"&&L.version!==i.version){if(i.migrate)return i.migrate(L.state,L.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return L.state}).then(L=>{var _;return b=i.merge(L,(_=a())!=null?_:x),r(b,!0),m()}).then(()=>{v==null||v(b,void 0),l=!0,c.forEach(L=>L(b))}).catch(L=>{v==null||v(void 0,L)})};return n.persist={setOptions:N=>{i={...i,...N},N.getStorage&&(d=N.getStorage())},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>l,onHydrate:N=>(o.add(N),()=>{o.delete(N)}),onFinishHydration:N=>(c.add(N),()=>{c.delete(N)})},g(),b||x},Nc=(s,t)=>(r,a,n)=>{let i={storage:vc(()=>localStorage),partialize:g=>g,version:0,merge:(g,N)=>({...N,...g}),...t},l=!1;const o=new Set,c=new Set;let d=i.storage;if(!d)return s((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...g)},a,n);const u=()=>{const g=i.partialize({...a()});return d.setItem(i.name,{state:g,version:i.version})},m=n.setState;n.setState=(g,N)=>{m(g,N),u()};const w=s((...g)=>{r(...g),u()},a,n);n.getInitialState=()=>w;let x;const b=()=>{var g,N;if(!d)return;l=!1,o.forEach(L=>{var _;return L((_=a())!=null?_:w)});const v=((N=i.onRehydrateStorage)==null?void 0:N.call(i,(g=a())!=null?g:w))||void 0;return Qs(d.getItem.bind(d))(i.name).then(L=>{if(L)if(typeof L.version=="number"&&L.version!==i.version){if(i.migrate)return[!0,i.migrate(L.state,L.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,L.state];return[!1,void 0]}).then(L=>{var _;const[E,A]=L;if(x=i.merge(A,(_=a())!=null?_:w),r(x,!0),E)return u()}).then(()=>{v==null||v(x,void 0),x=a(),l=!0,c.forEach(L=>L(x))}).catch(L=>{v==null||v(void 0,L)})};return n.persist={setOptions:g=>{i={...i,...g},g.storage&&(d=g.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>b(),hasHydrated:()=>l,onHydrate:g=>(o.add(g),()=>{o.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},i.skipHydration||b(),x||w},wc=(s,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((bc?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),jc(s,t)):Nc(s,t),Bs=wc;function Li(s,t){return function(){return s.apply(t,arguments)}}const{toString:kc}=Object.prototype,{getPrototypeOf:Ra}=Object,{iterator:Hr,toStringTag:Ti}=Symbol,qr=(s=>t=>{const r=kc.call(t);return s[r]||(s[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Nt=s=>(s=s.toLowerCase(),t=>qr(t)===s),Zr=s=>t=>typeof t===s,{isArray:Os}=Array,Xs=Zr("undefined");function ir(s){return s!==null&&!Xs(s)&&s.constructor!==null&&!Xs(s.constructor)&&it(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const Ei=Nt("ArrayBuffer");function _c(s){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(s):t=s&&s.buffer&&Ei(s.buffer),t}const Sc=Zr("string"),it=Zr("function"),Mi=Zr("number"),lr=s=>s!==null&&typeof s=="object",Cc=s=>s===!0||s===!1,vr=s=>{if(qr(s)!=="object")return!1;const t=Ra(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Ti in s)&&!(Hr in s)},Ac=s=>{if(!lr(s)||ir(s))return!1;try{return Object.keys(s).length===0&&Object.getPrototypeOf(s)===Object.prototype}catch{return!1}},Lc=Nt("Date"),Tc=Nt("File"),Ec=Nt("Blob"),Mc=Nt("FileList"),Ic=s=>lr(s)&&it(s.pipe),Rc=s=>{let t;return s&&(typeof FormData=="function"&&s instanceof FormData||it(s.append)&&((t=qr(s))==="formdata"||t==="object"&&it(s.toString)&&s.toString()==="[object FormData]"))},Pc=Nt("URLSearchParams"),[$c,Bc,Oc,Dc]=["ReadableStream","Request","Response","Headers"].map(Nt),Fc=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function or(s,t,{allOwnKeys:r=!1}={}){if(s===null||typeof s>"u")return;let a,n;if(typeof s!="object"&&(s=[s]),Os(s))for(a=0,n=s.length;a<n;a++)t.call(null,s[a],a,s);else{if(ir(s))return;const i=r?Object.getOwnPropertyNames(s):Object.keys(s),l=i.length;let o;for(a=0;a<l;a++)o=i[a],t.call(null,s[o],o,s)}}function Ii(s,t){if(ir(s))return null;t=t.toLowerCase();const r=Object.keys(s);let a=r.length,n;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const cs=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ri=s=>!Xs(s)&&s!==cs;function fa(){const{caseless:s}=Ri(this)&&this||{},t={},r=(a,n)=>{const i=s&&Ii(t,n)||n;vr(t[i])&&vr(a)?t[i]=fa(t[i],a):vr(a)?t[i]=fa({},a):Os(a)?t[i]=a.slice():t[i]=a};for(let a=0,n=arguments.length;a<n;a++)arguments[a]&&or(arguments[a],r);return t}const zc=(s,t,r,{allOwnKeys:a}={})=>(or(t,(n,i)=>{r&&it(n)?s[i]=Li(n,r):s[i]=n},{allOwnKeys:a}),s),Uc=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),Wc=(s,t,r,a)=>{s.prototype=Object.create(t.prototype,a),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:t.prototype}),r&&Object.assign(s.prototype,r)},Vc=(s,t,r,a)=>{let n,i,l;const o={};if(t=t||{},s==null)return t;do{for(n=Object.getOwnPropertyNames(s),i=n.length;i-- >0;)l=n[i],(!a||a(l,s,t))&&!o[l]&&(t[l]=s[l],o[l]=!0);s=r!==!1&&Ra(s)}while(s&&(!r||r(s,t))&&s!==Object.prototype);return t},Hc=(s,t,r)=>{s=String(s),(r===void 0||r>s.length)&&(r=s.length),r-=t.length;const a=s.indexOf(t,r);return a!==-1&&a===r},qc=s=>{if(!s)return null;if(Os(s))return s;let t=s.length;if(!Mi(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=s[t];return r},Zc=(s=>t=>s&&t instanceof s)(typeof Uint8Array<"u"&&Ra(Uint8Array)),Gc=(s,t)=>{const a=(s&&s[Hr]).call(s);let n;for(;(n=a.next())&&!n.done;){const i=n.value;t.call(s,i[0],i[1])}},Kc=(s,t)=>{let r;const a=[];for(;(r=s.exec(t))!==null;)a.push(r);return a},Jc=Nt("HTMLFormElement"),Qc=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),an=(({hasOwnProperty:s})=>(t,r)=>s.call(t,r))(Object.prototype),Xc=Nt("RegExp"),Pi=(s,t)=>{const r=Object.getOwnPropertyDescriptors(s),a={};or(r,(n,i)=>{let l;(l=t(n,i,s))!==!1&&(a[i]=l||n)}),Object.defineProperties(s,a)},Yc=s=>{Pi(s,(t,r)=>{if(it(s)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=s[r];if(it(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},ed=(s,t)=>{const r={},a=n=>{n.forEach(i=>{r[i]=!0})};return Os(s)?a(s):a(String(s).split(t)),r},td=()=>{},sd=(s,t)=>s!=null&&Number.isFinite(s=+s)?s:t;function rd(s){return!!(s&&it(s.append)&&s[Ti]==="FormData"&&s[Hr])}const ad=s=>{const t=new Array(10),r=(a,n)=>{if(lr(a)){if(t.indexOf(a)>=0)return;if(ir(a))return a;if(!("toJSON"in a)){t[n]=a;const i=Os(a)?[]:{};return or(a,(l,o)=>{const c=r(l,n+1);!Xs(c)&&(i[o]=c)}),t[n]=void 0,i}}return a};return r(s,0)},nd=Nt("AsyncFunction"),id=s=>s&&(lr(s)||it(s))&&it(s.then)&&it(s.catch),$i=((s,t)=>s?setImmediate:t?((r,a)=>(cs.addEventListener("message",({source:n,data:i})=>{n===cs&&i===r&&a.length&&a.shift()()},!1),n=>{a.push(n),cs.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",it(cs.postMessage)),ld=typeof queueMicrotask<"u"?queueMicrotask.bind(cs):typeof process<"u"&&process.nextTick||$i,od=s=>s!=null&&it(s[Hr]),P={isArray:Os,isArrayBuffer:Ei,isBuffer:ir,isFormData:Rc,isArrayBufferView:_c,isString:Sc,isNumber:Mi,isBoolean:Cc,isObject:lr,isPlainObject:vr,isEmptyObject:Ac,isReadableStream:$c,isRequest:Bc,isResponse:Oc,isHeaders:Dc,isUndefined:Xs,isDate:Lc,isFile:Tc,isBlob:Ec,isRegExp:Xc,isFunction:it,isStream:Ic,isURLSearchParams:Pc,isTypedArray:Zc,isFileList:Mc,forEach:or,merge:fa,extend:zc,trim:Fc,stripBOM:Uc,inherits:Wc,toFlatObject:Vc,kindOf:qr,kindOfTest:Nt,endsWith:Hc,toArray:qc,forEachEntry:Gc,matchAll:Kc,isHTMLForm:Jc,hasOwnProperty:an,hasOwnProp:an,reduceDescriptors:Pi,freezeMethods:Yc,toObjectSet:ed,toCamelCase:Qc,noop:td,toFiniteNumber:sd,findKey:Ii,global:cs,isContextDefined:Ri,isSpecCompliantForm:rd,toJSONObject:ad,isAsyncFn:nd,isThenable:id,setImmediate:$i,asap:ld,isIterable:od};function pe(s,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}P.inherits(pe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:P.toJSONObject(this.config),code:this.code,status:this.status}}});const Bi=pe.prototype,Oi={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{Oi[s]={value:s}});Object.defineProperties(pe,Oi);Object.defineProperty(Bi,"isAxiosError",{value:!0});pe.from=(s,t,r,a,n,i)=>{const l=Object.create(Bi);return P.toFlatObject(s,l,function(c){return c!==Error.prototype},o=>o!=="isAxiosError"),pe.call(l,s.message,t,r,a,n),l.cause=s,l.name=s.name,i&&Object.assign(l,i),l};const cd=null;function pa(s){return P.isPlainObject(s)||P.isArray(s)}function Di(s){return P.endsWith(s,"[]")?s.slice(0,-2):s}function nn(s,t,r){return s?s.concat(t).map(function(n,i){return n=Di(n),!r&&i?"["+n+"]":n}).join(r?".":""):t}function dd(s){return P.isArray(s)&&!s.some(pa)}const ud=P.toFlatObject(P,{},null,function(t){return/^is[A-Z]/.test(t)});function Gr(s,t,r){if(!P.isObject(s))throw new TypeError("target must be an object");t=t||new FormData,r=P.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,N){return!P.isUndefined(N[g])});const a=r.metaTokens,n=r.visitor||u,i=r.dots,l=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&P.isSpecCompliantForm(t);if(!P.isFunction(n))throw new TypeError("visitor must be a function");function d(b){if(b===null)return"";if(P.isDate(b))return b.toISOString();if(P.isBoolean(b))return b.toString();if(!c&&P.isBlob(b))throw new pe("Blob is not supported. Use a Buffer instead.");return P.isArrayBuffer(b)||P.isTypedArray(b)?c&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function u(b,g,N){let v=b;if(b&&!N&&typeof b=="object"){if(P.endsWith(g,"{}"))g=a?g:g.slice(0,-2),b=JSON.stringify(b);else if(P.isArray(b)&&dd(b)||(P.isFileList(b)||P.endsWith(g,"[]"))&&(v=P.toArray(b)))return g=Di(g),v.forEach(function(_,E){!(P.isUndefined(_)||_===null)&&t.append(l===!0?nn([g],E,i):l===null?g:g+"[]",d(_))}),!1}return pa(b)?!0:(t.append(nn(N,g,i),d(b)),!1)}const m=[],w=Object.assign(ud,{defaultVisitor:u,convertValue:d,isVisitable:pa});function x(b,g){if(!P.isUndefined(b)){if(m.indexOf(b)!==-1)throw Error("Circular reference detected in "+g.join("."));m.push(b),P.forEach(b,function(v,L){(!(P.isUndefined(v)||v===null)&&n.call(t,v,P.isString(L)?L.trim():L,g,w))===!0&&x(v,g?g.concat(L):[L])}),m.pop()}}if(!P.isObject(s))throw new TypeError("data must be an object");return x(s),t}function ln(s){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function Pa(s,t){this._pairs=[],s&&Gr(s,this,t)}const Fi=Pa.prototype;Fi.append=function(t,r){this._pairs.push([t,r])};Fi.toString=function(t){const r=t?function(a){return t.call(this,a,ln)}:ln;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function md(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function zi(s,t,r){if(!t)return s;const a=r&&r.encode||md;P.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let i;if(n?i=n(t,r):i=P.isURLSearchParams(t)?t.toString():new Pa(t,r).toString(a),i){const l=s.indexOf("#");l!==-1&&(s=s.slice(0,l)),s+=(s.indexOf("?")===-1?"?":"&")+i}return s}class on{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){P.forEach(this.handlers,function(a){a!==null&&t(a)})}}const Ui={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},hd=typeof URLSearchParams<"u"?URLSearchParams:Pa,xd=typeof FormData<"u"?FormData:null,gd=typeof Blob<"u"?Blob:null,fd={isBrowser:!0,classes:{URLSearchParams:hd,FormData:xd,Blob:gd},protocols:["http","https","file","blob","url","data"]},$a=typeof window<"u"&&typeof document<"u",ya=typeof navigator=="object"&&navigator||void 0,pd=$a&&(!ya||["ReactNative","NativeScript","NS"].indexOf(ya.product)<0),yd=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",bd=$a&&window.location.href||"http://localhost",vd=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:$a,hasStandardBrowserEnv:pd,hasStandardBrowserWebWorkerEnv:yd,navigator:ya,origin:bd},Symbol.toStringTag,{value:"Module"})),Qe={...vd,...fd};function jd(s,t){return Gr(s,new Qe.classes.URLSearchParams,{visitor:function(r,a,n,i){return Qe.isNode&&P.isBuffer(r)?(this.append(a,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function Nd(s){return P.matchAll(/\w+|\[(\w*)]/g,s).map(t=>t[0]==="[]"?"":t[1]||t[0])}function wd(s){const t={},r=Object.keys(s);let a;const n=r.length;let i;for(a=0;a<n;a++)i=r[a],t[i]=s[i];return t}function Wi(s){function t(r,a,n,i){let l=r[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=i>=r.length;return l=!l&&P.isArray(n)?n.length:l,c?(P.hasOwnProp(n,l)?n[l]=[n[l],a]:n[l]=a,!o):((!n[l]||!P.isObject(n[l]))&&(n[l]=[]),t(r,a,n[l],i)&&P.isArray(n[l])&&(n[l]=wd(n[l])),!o)}if(P.isFormData(s)&&P.isFunction(s.entries)){const r={};return P.forEachEntry(s,(a,n)=>{t(Nd(a),n,r,0)}),r}return null}function kd(s,t,r){if(P.isString(s))try{return(t||JSON.parse)(s),P.trim(s)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(s)}const cr={transitional:Ui,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,i=P.isObject(t);if(i&&P.isHTMLForm(t)&&(t=new FormData(t)),P.isFormData(t))return n?JSON.stringify(Wi(t)):t;if(P.isArrayBuffer(t)||P.isBuffer(t)||P.isStream(t)||P.isFile(t)||P.isBlob(t)||P.isReadableStream(t))return t;if(P.isArrayBufferView(t))return t.buffer;if(P.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return jd(t,this.formSerializer).toString();if((o=P.isFileList(t))||a.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Gr(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||n?(r.setContentType("application/json",!1),kd(t)):t}],transformResponse:[function(t){const r=this.transitional||cr.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(P.isResponse(t)||P.isReadableStream(t))return t;if(t&&P.isString(t)&&(a&&!this.responseType||n)){const l=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(o){if(l)throw o.name==="SyntaxError"?pe.from(o,pe.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Qe.classes.FormData,Blob:Qe.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};P.forEach(["delete","get","head","post","put","patch"],s=>{cr.headers[s]={}});const _d=P.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Sd=s=>{const t={};let r,a,n;return s&&s.split(`
`).forEach(function(l){n=l.indexOf(":"),r=l.substring(0,n).trim().toLowerCase(),a=l.substring(n+1).trim(),!(!r||t[r]&&_d[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},cn=Symbol("internals");function zs(s){return s&&String(s).trim().toLowerCase()}function jr(s){return s===!1||s==null?s:P.isArray(s)?s.map(jr):String(s)}function Cd(s){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(s);)t[a[1]]=a[2];return t}const Ad=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function ra(s,t,r,a,n){if(P.isFunction(a))return a.call(this,t,r);if(n&&(t=r),!!P.isString(t)){if(P.isString(a))return t.indexOf(a)!==-1;if(P.isRegExp(a))return a.test(t)}}function Ld(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function Td(s,t){const r=P.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(s,a+r,{value:function(n,i,l){return this[a].call(this,t,n,i,l)},configurable:!0})})}let lt=class{constructor(t){t&&this.set(t)}set(t,r,a){const n=this;function i(o,c,d){const u=zs(c);if(!u)throw new Error("header name must be a non-empty string");const m=P.findKey(n,u);(!m||n[m]===void 0||d===!0||d===void 0&&n[m]!==!1)&&(n[m||c]=jr(o))}const l=(o,c)=>P.forEach(o,(d,u)=>i(d,u,c));if(P.isPlainObject(t)||t instanceof this.constructor)l(t,r);else if(P.isString(t)&&(t=t.trim())&&!Ad(t))l(Sd(t),r);else if(P.isObject(t)&&P.isIterable(t)){let o={},c,d;for(const u of t){if(!P.isArray(u))throw TypeError("Object iterator must return a key-value pair");o[d=u[0]]=(c=o[d])?P.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}l(o,r)}else t!=null&&i(r,t,a);return this}get(t,r){if(t=zs(t),t){const a=P.findKey(this,t);if(a){const n=this[a];if(!r)return n;if(r===!0)return Cd(n);if(P.isFunction(r))return r.call(this,n,a);if(P.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=zs(t),t){const a=P.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||ra(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let n=!1;function i(l){if(l=zs(l),l){const o=P.findKey(a,l);o&&(!r||ra(a,a[o],o,r))&&(delete a[o],n=!0)}}return P.isArray(t)?t.forEach(i):i(t),n}clear(t){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const i=r[a];(!t||ra(this,this[i],i,t,!0))&&(delete this[i],n=!0)}return n}normalize(t){const r=this,a={};return P.forEach(this,(n,i)=>{const l=P.findKey(a,i);if(l){r[l]=jr(n),delete r[i];return}const o=t?Ld(i):String(i).trim();o!==i&&delete r[i],r[o]=jr(n),a[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return P.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=t&&P.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[cn]=this[cn]={accessors:{}}).accessors,n=this.prototype;function i(l){const o=zs(l);a[o]||(Td(n,l),a[o]=!0)}return P.isArray(t)?t.forEach(i):i(t),this}};lt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);P.reduceDescriptors(lt.prototype,({value:s},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>s,set(a){this[r]=a}}});P.freezeMethods(lt);function aa(s,t){const r=this||cr,a=t||r,n=lt.from(a.headers);let i=a.data;return P.forEach(s,function(o){i=o.call(r,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function Vi(s){return!!(s&&s.__CANCEL__)}function Ds(s,t,r){pe.call(this,s??"canceled",pe.ERR_CANCELED,t,r),this.name="CanceledError"}P.inherits(Ds,pe,{__CANCEL__:!0});function Hi(s,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?s(r):t(new pe("Request failed with status code "+r.status,[pe.ERR_BAD_REQUEST,pe.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Ed(s){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return t&&t[1]||""}function Md(s,t){s=s||10;const r=new Array(s),a=new Array(s);let n=0,i=0,l;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=a[i];l||(l=d),r[n]=c,a[n]=d;let m=i,w=0;for(;m!==n;)w+=r[m++],m=m%s;if(n=(n+1)%s,n===i&&(i=(i+1)%s),d-l<t)return;const x=u&&d-u;return x?Math.round(w*1e3/x):void 0}}function Id(s,t){let r=0,a=1e3/t,n,i;const l=(d,u=Date.now())=>{r=u,n=null,i&&(clearTimeout(i),i=null),s(...d)};return[(...d)=>{const u=Date.now(),m=u-r;m>=a?l(d,u):(n=d,i||(i=setTimeout(()=>{i=null,l(n)},a-m)))},()=>n&&l(n)]}const Ar=(s,t,r=3)=>{let a=0;const n=Md(50,250);return Id(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,c=l-a,d=n(c),u=l<=o;a=l;const m={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:d||void 0,estimated:d&&o&&u?(o-l)/d:void 0,event:i,lengthComputable:o!=null,[t?"download":"upload"]:!0};s(m)},r)},dn=(s,t)=>{const r=s!=null;return[a=>t[0]({lengthComputable:r,total:s,loaded:a}),t[1]]},un=s=>(...t)=>P.asap(()=>s(...t)),Rd=Qe.hasStandardBrowserEnv?((s,t)=>r=>(r=new URL(r,Qe.origin),s.protocol===r.protocol&&s.host===r.host&&(t||s.port===r.port)))(new URL(Qe.origin),Qe.navigator&&/(msie|trident)/i.test(Qe.navigator.userAgent)):()=>!0,Pd=Qe.hasStandardBrowserEnv?{write(s,t,r,a,n,i){const l=[s+"="+encodeURIComponent(t)];P.isNumber(r)&&l.push("expires="+new Date(r).toGMTString()),P.isString(a)&&l.push("path="+a),P.isString(n)&&l.push("domain="+n),i===!0&&l.push("secure"),document.cookie=l.join("; ")},read(s){const t=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function $d(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function Bd(s,t){return t?s.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):s}function qi(s,t,r){let a=!$d(t);return s&&(a||r==!1)?Bd(s,t):t}const mn=s=>s instanceof lt?{...s}:s;function ps(s,t){t=t||{};const r={};function a(d,u,m,w){return P.isPlainObject(d)&&P.isPlainObject(u)?P.merge.call({caseless:w},d,u):P.isPlainObject(u)?P.merge({},u):P.isArray(u)?u.slice():u}function n(d,u,m,w){if(P.isUndefined(u)){if(!P.isUndefined(d))return a(void 0,d,m,w)}else return a(d,u,m,w)}function i(d,u){if(!P.isUndefined(u))return a(void 0,u)}function l(d,u){if(P.isUndefined(u)){if(!P.isUndefined(d))return a(void 0,d)}else return a(void 0,u)}function o(d,u,m){if(m in t)return a(d,u);if(m in s)return a(void 0,d)}const c={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(d,u,m)=>n(mn(d),mn(u),m,!0)};return P.forEach(Object.keys({...s,...t}),function(u){const m=c[u]||n,w=m(s[u],t[u],u);P.isUndefined(w)&&m!==o||(r[u]=w)}),r}const Zi=s=>{const t=ps({},s);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:i,headers:l,auth:o}=t;t.headers=l=lt.from(l),t.url=zi(qi(t.baseURL,t.url,t.allowAbsoluteUrls),s.params,s.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let c;if(P.isFormData(r)){if(Qe.hasStandardBrowserEnv||Qe.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((c=l.getContentType())!==!1){const[d,...u]=c?c.split(";").map(m=>m.trim()).filter(Boolean):[];l.setContentType([d||"multipart/form-data",...u].join("; "))}}if(Qe.hasStandardBrowserEnv&&(a&&P.isFunction(a)&&(a=a(t)),a||a!==!1&&Rd(t.url))){const d=n&&i&&Pd.read(i);d&&l.set(n,d)}return t},Od=typeof XMLHttpRequest<"u",Dd=Od&&function(s){return new Promise(function(r,a){const n=Zi(s);let i=n.data;const l=lt.from(n.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:d}=n,u,m,w,x,b;function g(){x&&x(),b&&b(),n.cancelToken&&n.cancelToken.unsubscribe(u),n.signal&&n.signal.removeEventListener("abort",u)}let N=new XMLHttpRequest;N.open(n.method.toUpperCase(),n.url,!0),N.timeout=n.timeout;function v(){if(!N)return;const _=lt.from("getAllResponseHeaders"in N&&N.getAllResponseHeaders()),A={data:!o||o==="text"||o==="json"?N.responseText:N.response,status:N.status,statusText:N.statusText,headers:_,config:s,request:N};Hi(function(k){r(k),g()},function(k){a(k),g()},A),N=null}"onloadend"in N?N.onloadend=v:N.onreadystatechange=function(){!N||N.readyState!==4||N.status===0&&!(N.responseURL&&N.responseURL.indexOf("file:")===0)||setTimeout(v)},N.onabort=function(){N&&(a(new pe("Request aborted",pe.ECONNABORTED,s,N)),N=null)},N.onerror=function(){a(new pe("Network Error",pe.ERR_NETWORK,s,N)),N=null},N.ontimeout=function(){let E=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const A=n.transitional||Ui;n.timeoutErrorMessage&&(E=n.timeoutErrorMessage),a(new pe(E,A.clarifyTimeoutError?pe.ETIMEDOUT:pe.ECONNABORTED,s,N)),N=null},i===void 0&&l.setContentType(null),"setRequestHeader"in N&&P.forEach(l.toJSON(),function(E,A){N.setRequestHeader(A,E)}),P.isUndefined(n.withCredentials)||(N.withCredentials=!!n.withCredentials),o&&o!=="json"&&(N.responseType=n.responseType),d&&([w,b]=Ar(d,!0),N.addEventListener("progress",w)),c&&N.upload&&([m,x]=Ar(c),N.upload.addEventListener("progress",m),N.upload.addEventListener("loadend",x)),(n.cancelToken||n.signal)&&(u=_=>{N&&(a(!_||_.type?new Ds(null,s,N):_),N.abort(),N=null)},n.cancelToken&&n.cancelToken.subscribe(u),n.signal&&(n.signal.aborted?u():n.signal.addEventListener("abort",u)));const L=Ed(n.url);if(L&&Qe.protocols.indexOf(L)===-1){a(new pe("Unsupported protocol "+L+":",pe.ERR_BAD_REQUEST,s));return}N.send(i||null)})},Fd=(s,t)=>{const{length:r}=s=s?s.filter(Boolean):[];if(t||r){let a=new AbortController,n;const i=function(d){if(!n){n=!0,o();const u=d instanceof Error?d:this.reason;a.abort(u instanceof pe?u:new Ds(u instanceof Error?u.message:u))}};let l=t&&setTimeout(()=>{l=null,i(new pe(`timeout ${t} of ms exceeded`,pe.ETIMEDOUT))},t);const o=()=>{s&&(l&&clearTimeout(l),l=null,s.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),s=null)};s.forEach(d=>d.addEventListener("abort",i));const{signal:c}=a;return c.unsubscribe=()=>P.asap(o),c}},zd=function*(s,t){let r=s.byteLength;if(r<t){yield s;return}let a=0,n;for(;a<r;)n=a+t,yield s.slice(a,n),a=n},Ud=async function*(s,t){for await(const r of Wd(s))yield*zd(r,t)},Wd=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const t=s.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},hn=(s,t,r,a)=>{const n=Ud(s,t);let i=0,l,o=c=>{l||(l=!0,a&&a(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await n.next();if(d){o(),c.close();return}let m=u.byteLength;if(r){let w=i+=m;r(w)}c.enqueue(new Uint8Array(u))}catch(d){throw o(d),d}},cancel(c){return o(c),n.return()}},{highWaterMark:2})},Kr=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Gi=Kr&&typeof ReadableStream=="function",Vd=Kr&&(typeof TextEncoder=="function"?(s=>t=>s.encode(t))(new TextEncoder):async s=>new Uint8Array(await new Response(s).arrayBuffer())),Ki=(s,...t)=>{try{return!!s(...t)}catch{return!1}},Hd=Gi&&Ki(()=>{let s=!1;const t=new Request(Qe.origin,{body:new ReadableStream,method:"POST",get duplex(){return s=!0,"half"}}).headers.has("Content-Type");return s&&!t}),xn=64*1024,ba=Gi&&Ki(()=>P.isReadableStream(new Response("").body)),Lr={stream:ba&&(s=>s.body)};Kr&&(s=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Lr[t]&&(Lr[t]=P.isFunction(s[t])?r=>r[t]():(r,a)=>{throw new pe(`Response type '${t}' is not supported`,pe.ERR_NOT_SUPPORT,a)})})})(new Response);const qd=async s=>{if(s==null)return 0;if(P.isBlob(s))return s.size;if(P.isSpecCompliantForm(s))return(await new Request(Qe.origin,{method:"POST",body:s}).arrayBuffer()).byteLength;if(P.isArrayBufferView(s)||P.isArrayBuffer(s))return s.byteLength;if(P.isURLSearchParams(s)&&(s=s+""),P.isString(s))return(await Vd(s)).byteLength},Zd=async(s,t)=>{const r=P.toFiniteNumber(s.getContentLength());return r??qd(t)},Gd=Kr&&(async s=>{let{url:t,method:r,data:a,signal:n,cancelToken:i,timeout:l,onDownloadProgress:o,onUploadProgress:c,responseType:d,headers:u,withCredentials:m="same-origin",fetchOptions:w}=Zi(s);d=d?(d+"").toLowerCase():"text";let x=Fd([n,i&&i.toAbortSignal()],l),b;const g=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let N;try{if(c&&Hd&&r!=="get"&&r!=="head"&&(N=await Zd(u,a))!==0){let A=new Request(t,{method:"POST",body:a,duplex:"half"}),p;if(P.isFormData(a)&&(p=A.headers.get("content-type"))&&u.setContentType(p),A.body){const[k,C]=dn(N,Ar(un(c)));a=hn(A.body,xn,k,C)}}P.isString(m)||(m=m?"include":"omit");const v="credentials"in Request.prototype;b=new Request(t,{...w,signal:x,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:a,duplex:"half",credentials:v?m:void 0});let L=await fetch(b,w);const _=ba&&(d==="stream"||d==="response");if(ba&&(o||_&&g)){const A={};["status","statusText","headers"].forEach(W=>{A[W]=L[W]});const p=P.toFiniteNumber(L.headers.get("content-length")),[k,C]=o&&dn(p,Ar(un(o),!0))||[];L=new Response(hn(L.body,xn,k,()=>{C&&C(),g&&g()}),A)}d=d||"text";let E=await Lr[P.findKey(Lr,d)||"text"](L,s);return!_&&g&&g(),await new Promise((A,p)=>{Hi(A,p,{data:E,headers:lt.from(L.headers),status:L.status,statusText:L.statusText,config:s,request:b})})}catch(v){throw g&&g(),v&&v.name==="TypeError"&&/Load failed|fetch/i.test(v.message)?Object.assign(new pe("Network Error",pe.ERR_NETWORK,s,b),{cause:v.cause||v}):pe.from(v,v&&v.code,s,b)}}),va={http:cd,xhr:Dd,fetch:Gd};P.forEach(va,(s,t)=>{if(s){try{Object.defineProperty(s,"name",{value:t})}catch{}Object.defineProperty(s,"adapterName",{value:t})}});const gn=s=>`- ${s}`,Kd=s=>P.isFunction(s)||s===null||s===!1,Ji={getAdapter:s=>{s=P.isArray(s)?s:[s];const{length:t}=s;let r,a;const n={};for(let i=0;i<t;i++){r=s[i];let l;if(a=r,!Kd(r)&&(a=va[(l=String(r)).toLowerCase()],a===void 0))throw new pe(`Unknown adapter '${l}'`);if(a)break;n[l||"#"+i]=a}if(!a){const i=Object.entries(n).map(([o,c])=>`adapter ${o} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=t?i.length>1?`since :
`+i.map(gn).join(`
`):" "+gn(i[0]):"as no adapter specified";throw new pe("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return a},adapters:va};function na(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new Ds(null,s)}function fn(s){return na(s),s.headers=lt.from(s.headers),s.data=aa.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),Ji.getAdapter(s.adapter||cr.adapter)(s).then(function(a){return na(s),a.data=aa.call(s,s.transformResponse,a),a.headers=lt.from(a.headers),a},function(a){return Vi(a)||(na(s),a&&a.response&&(a.response.data=aa.call(s,s.transformResponse,a.response),a.response.headers=lt.from(a.response.headers))),Promise.reject(a)})}const Qi="1.11.0",Jr={};["object","boolean","number","function","string","symbol"].forEach((s,t)=>{Jr[s]=function(a){return typeof a===s||"a"+(t<1?"n ":" ")+s}});const pn={};Jr.transitional=function(t,r,a){function n(i,l){return"[Axios v"+Qi+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,o)=>{if(t===!1)throw new pe(n(l," has been removed"+(r?" in "+r:"")),pe.ERR_DEPRECATED);return r&&!pn[l]&&(pn[l]=!0,console.warn(n(l," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,l,o):!0}};Jr.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function Jd(s,t,r){if(typeof s!="object")throw new pe("options must be an object",pe.ERR_BAD_OPTION_VALUE);const a=Object.keys(s);let n=a.length;for(;n-- >0;){const i=a[n],l=t[i];if(l){const o=s[i],c=o===void 0||l(o,i,s);if(c!==!0)throw new pe("option "+i+" must be "+c,pe.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new pe("Unknown option "+i,pe.ERR_BAD_OPTION)}}const Nr={assertOptions:Jd,validators:Jr},kt=Nr.validators;let fs=class{constructor(t){this.defaults=t||{},this.interceptors={request:new on,response:new on}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ps(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:i}=r;a!==void 0&&Nr.assertOptions(a,{silentJSONParsing:kt.transitional(kt.boolean),forcedJSONParsing:kt.transitional(kt.boolean),clarifyTimeoutError:kt.transitional(kt.boolean)},!1),n!=null&&(P.isFunction(n)?r.paramsSerializer={serialize:n}:Nr.assertOptions(n,{encode:kt.function,serialize:kt.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Nr.assertOptions(r,{baseUrl:kt.spelling("baseURL"),withXsrfToken:kt.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=i&&P.merge(i.common,i[r.method]);i&&P.forEach(["delete","get","head","post","put","patch","common"],b=>{delete i[b]}),r.headers=lt.concat(l,i);const o=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,o.unshift(g.fulfilled,g.rejected))});const d=[];this.interceptors.response.forEach(function(g){d.push(g.fulfilled,g.rejected)});let u,m=0,w;if(!c){const b=[fn.bind(this),void 0];for(b.unshift(...o),b.push(...d),w=b.length,u=Promise.resolve(r);m<w;)u=u.then(b[m++],b[m++]);return u}w=o.length;let x=r;for(m=0;m<w;){const b=o[m++],g=o[m++];try{x=b(x)}catch(N){g.call(this,N);break}}try{u=fn.call(this,x)}catch(b){return Promise.reject(b)}for(m=0,w=d.length;m<w;)u=u.then(d[m++],d[m++]);return u}getUri(t){t=ps(this.defaults,t);const r=qi(t.baseURL,t.url,t.allowAbsoluteUrls);return zi(r,t.params,t.paramsSerializer)}};P.forEach(["delete","get","head","options"],function(t){fs.prototype[t]=function(r,a){return this.request(ps(a||{},{method:t,url:r,data:(a||{}).data}))}});P.forEach(["post","put","patch"],function(t){function r(a){return function(i,l,o){return this.request(ps(o||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}fs.prototype[t]=r(),fs.prototype[t+"Form"]=r(!0)});let Qd=class Xi{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const a=this;this.promise.then(n=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](n);a._listeners=null}),this.promise.then=n=>{let i;const l=new Promise(o=>{a.subscribe(o),i=o}).then(n);return l.cancel=function(){a.unsubscribe(i)},l},t(function(i,l,o){a.reason||(a.reason=new Ds(i,l,o),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Xi(function(n){t=n}),cancel:t}}};function Xd(s){return function(r){return s.apply(null,r)}}function Yd(s){return P.isObject(s)&&s.isAxiosError===!0}const ja={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ja).forEach(([s,t])=>{ja[t]=s});function Yi(s){const t=new fs(s),r=Li(fs.prototype.request,t);return P.extend(r,fs.prototype,t,{allOwnKeys:!0}),P.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return Yi(ps(s,n))},r}const Re=Yi(cr);Re.Axios=fs;Re.CanceledError=Ds;Re.CancelToken=Qd;Re.isCancel=Vi;Re.VERSION=Qi;Re.toFormData=Gr;Re.AxiosError=pe;Re.Cancel=Re.CanceledError;Re.all=function(t){return Promise.all(t)};Re.spread=Xd;Re.isAxiosError=Yd;Re.mergeConfig=ps;Re.AxiosHeaders=lt;Re.formToJSON=s=>Wi(P.isHTMLForm(s)?new FormData(s):s);Re.getAdapter=Ji.getAdapter;Re.HttpStatusCode=ja;Re.default=Re;const{Axios:cm,AxiosError:dm,CanceledError:um,isCancel:mm,CancelToken:hm,VERSION:xm,all:gm,Cancel:fm,isAxiosError:pm,spread:ym,toFormData:bm,AxiosHeaders:vm,HttpStatusCode:jm,formToJSON:Nm,getAdapter:wm,mergeConfig:km}=Re;var wr=(s=>(s.NETWORK="network",s.AUTH="auth",s.VALIDATION="validation",s.SERVER="server",s.WEBSOCKET="websocket",s.API="api",s.UNKNOWN="unknown",s))(wr||{});const os=class os{constructor(){Le(this,"errorListeners",[])}static getInstance(){return os.instance||(os.instance=new os),os.instance}handle(t,r,a=!0){const n=this.parseError(t,r);return this.logError(n),a&&this.showErrorToast(n),this.notifyListeners(n),n}parseError(t,r){const a=Date.now();return t!=null&&t.isAxiosError||t!=null&&t.response?this.parseAxiosError(t,r,a):(t==null?void 0:t.type)==="websocket"||r==="websocket"?{type:"websocket",message:this.getWebSocketErrorMessage(t),details:t,timestamp:a,source:r}:t instanceof Error?{type:"unknown",message:t.message,details:{name:t.name,stack:t.stack},timestamp:a,source:r}:typeof t=="string"?{type:"unknown",message:t,timestamp:a,source:r}:{type:"unknown",message:"发生未知错误",details:t,timestamp:a,source:r}}parseAxiosError(t,r,a){const{response:n,request:i,message:l}=t;if(n){const o=n.status,c=n.data;return o===401?{type:"auth",code:o,message:(c==null?void 0:c.message)||"认证失败，请重新登录",details:c,timestamp:a||Date.now(),source:r}:o===403?{type:"auth",code:o,message:(c==null?void 0:c.message)||"权限不足",details:c,timestamp:a||Date.now(),source:r}:o===422||o===400?{type:"validation",code:o,message:(c==null?void 0:c.message)||"请求参数错误",details:c,timestamp:a||Date.now(),source:r}:o===429?{type:"api",code:o,message:(c==null?void 0:c.message)||"请求过于频繁，请稍后再试",details:c,timestamp:a||Date.now(),source:r}:o>=500?{type:"server",code:o,message:(c==null?void 0:c.message)||"服务器内部错误，请稍后再试",details:c,timestamp:a||Date.now(),source:r}:{type:"api",code:o,message:(c==null?void 0:c.message)||`请求失败 (${o})`,details:c,timestamp:a||Date.now(),source:r}}return i?{type:"network",message:"网络连接失败，请检查网络设置",details:{message:l,request:i},timestamp:a||Date.now(),source:r}:{type:"unknown",message:l||"请求配置错误",details:t,timestamp:a||Date.now(),source:r}}getWebSocketErrorMessage(t){if(t!=null&&t.code)switch(t.code){case 1006:return"连接异常关闭，正在尝试重连...";case 1e3:return"连接正常关闭";case 1001:return"服务器端点离线";case 1002:return"协议错误";case 1003:return"不支持的数据类型";case 1005:return"未收到关闭状态码";case 1011:return"服务器遇到意外情况";default:return`WebSocket连接错误 (${t.code})`}return(t==null?void 0:t.message)||"WebSocket连接失败"}showErrorToast(t){const{type:r,message:a}=t;switch(r){case"auth":M.error(a,{id:"auth-error",duration:5e3,icon:"🔒"});break;case"network":M.error(a,{id:"network-error",duration:6e3,icon:"🌐"});break;case"validation":M.error(a,{id:"validation-error",duration:4e3,icon:"⚠️"});break;case"websocket":M.error(a,{id:"websocket-error",duration:3e3,icon:"🔌"});break;case"server":M.error(a,{id:"server-error",duration:5e3,icon:"🔥"});break;default:M.error(a,{duration:4e3,icon:"❌"})}}logError(t){this.getLogLevel(t.type);const r=`[${t.type.toUpperCase()}] ${t.message}`;console.error(r,{type:t.type,code:t.code,source:t.source,timestamp:t.timestamp})}getLogLevel(t){switch(t){case"auth":case"server":return"error";case"network":case"websocket":return"warn";default:return"info"}}addErrorListener(t){this.errorListeners.push(t)}removeErrorListener(t){this.errorListeners=this.errorListeners.filter(r=>r!==t)}notifyListeners(t){this.errorListeners.forEach(r=>{try{r(t)}catch(a){console.error("Error in error listener:",a)}})}createRetryableHandler(t=3,r=1e3){return async(a,n)=>{let i;for(let l=1;l<=t;l++)try{return await a()}catch(o){i=o;const c=this.parseError(o,n);if(c.type==="auth"||c.type==="validation")throw o;if(l===t)throw this.handle(o,n),o;await new Promise(d=>setTimeout(d,r*Math.pow(2,l-1)))}throw i}}};Le(os,"instance");let Na=os;const Ba=Na.getInstance(),el=(s,t,r=!0)=>Ba.handle(s,t,r),e0=(s,t)=>Ba.createRetryableHandler(s,t),tl=(s,t="api")=>{const r=Re.create({baseURL:s,timeout:6e4,headers:{"Content-Type":"application/json"}});return r.interceptors.request.use(a=>{var i;const n=localStorage.getItem("auth-storage");if(n)try{const l=JSON.parse(n),o=((i=l.state)==null?void 0:i.token)||l.token;o?(a.headers.Authorization=`Bearer ${o}`,console.log(`🔑 [${t}] Added token to request:`,o.substring(0,20)+"...")):console.warn(`⚠️ [${t}] No token found in auth data`)}catch(l){console.error(`❌ [${t}] Failed to parse auth data:`,l)}else console.warn(`⚠️ [${t}] No auth data in localStorage`);return a},a=>Promise.reject(a)),r.interceptors.response.use(a=>a,async a=>{var l,o;const n=a.config;if(((l=a.response)==null?void 0:l.status)===401&&!n._retry){if(n._retry=!0,t==="user")try{const c=localStorage.getItem("auth-storage");if(c){const d=JSON.parse(c),u=((o=d.state)==null?void 0:o.token)||d.token;if(u){const w=(await r.post("/auth/refresh",{token:u})).data.token;if(d.state){const x={...d.state,token:w};localStorage.setItem("auth-storage",JSON.stringify({state:x}))}else{const x={...d,token:w};localStorage.setItem("auth-storage",JSON.stringify(x))}return n.headers.Authorization=`Bearer ${w}`,r(n)}}}catch(c){console.error("Token refresh failed:",c)}return console.warn(`${t} service returned 401, clearing auth state`),localStorage.removeItem("auth-storage"),window.location.href="/login",Promise.reject(a)}const i=el(a,"api-client",!1);return Promise.reject(i)}),r},t0="/api/v1",s0="/api/v1",ct=tl(t0,"user"),K=tl(s0,"trading"),q=s=>s.data,H=s=>{if(s!=null&&s.type&&(s!=null&&s.message))throw new Error(s.message);const t=el(s,"api-error",!0);throw new Error(t.message)},Wt={async login(s){try{const t=await ct.post("/auth/login",s),r=q(t);return{user:r.data.user,token:r.data.access_token,refresh_token:r.data.refresh_token}}catch(t){H(t)}},async register(s){try{const t=await ct.post("/auth/register",s),r=q(t);return{user:r.data.user||null,token:r.data.access_token||null,refresh_token:r.data.refresh_token||null}}catch(t){H(t)}},async loginWithGoogle(s){try{const t=await ct.post("/auth/google",{google_token:s}),r=q(t);return{user:r.data.user,token:r.data.access_token,refresh_token:r.data.refresh_token}}catch(t){H(t)}},async forgotPassword(s){try{const t=await ct.post("/auth/forgot-password",{email:s});return q(t)}catch(t){H(t)}},async getProfile(){try{const s=await ct.get("/auth/profile");return q(s)}catch(s){H(s)}},async updateProfile(s){try{const t=await ct.put("/auth/profile",s);return q(t)}catch(t){H(t)}},async refreshToken(){try{const s=await ct.post("/auth/refresh");return q(s)}catch(s){H(s)}},async sendVerificationEmail(){try{const s=await ct.post("/auth/send-verification");return q(s)}catch(s){H(s)}},async verifyEmail(s){try{const t=await ct.post("/auth/verify-email",{token:s});return q(t)}catch(t){H(t)}},async sendPasswordReset(s){try{const t=await ct.post("/auth/password-reset",{email:s});return q(t)}catch(t){H(t)}},async resetPassword(s,t){try{const r=await ct.post("/auth/password-reset/confirm",{token:s,password:t});return q(r)}catch(r){H(r)}},async changePassword(s,t){try{const r=await ct.post("/auth/change-password",{current_password:s,new_password:t});return q(r)}catch(r){H(r)}},async logout(){try{const s=await ct.post("/auth/logout");return q(s)}catch(s){H(s)}}},Xe=as()(Bs((s,t)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,login:async r=>{var a,n;s({isLoading:!0,error:null});try{const i=await Wt.login(r);return s({user:i.user,token:i.token,isAuthenticated:!0,isLoading:!1,error:null}),{success:!0}}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||i.message||"登录失败";let o=l;return l.includes("not found")||l.includes("不存在")?o="用户不存在":(l.includes("password")||l.includes("密码"))&&(o="密码错误"),s({isLoading:!1,error:o}),{success:!1,message:o}}},register:async r=>{var a,n;s({isLoading:!0,error:null});try{const i=await Wt.register(r);return s({user:i.user,token:i.token,isAuthenticated:!0,isLoading:!1,error:null}),{success:!0}}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"注册失败";return s({isLoading:!1,error:l}),{success:!1,message:l}}},loginWithGoogle:async r=>{var a,n;s({isLoading:!0,error:null});try{const i=await Wt.loginWithGoogle(r);return s({user:i.user,token:i.token,isAuthenticated:!0,isLoading:!1,error:null}),{success:!0}}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"Google登录失败";return s({isLoading:!1,error:l}),{success:!1,message:l}}},forgotPassword:async r=>{try{return await Wt.forgotPassword(r),!0}catch{return!1}},resetPassword:async(r,a)=>{try{return await Wt.resetPassword(r,a),!0}catch{return!1}},logout:()=>{s({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null}),M.success("已退出登录")},checkAuth:async()=>{const{token:r,isAuthenticated:a,user:n}=t();if(r&&!(a&&n)){s({isLoading:!0,error:null});try{const i=await Wt.getProfile();s({user:i,isAuthenticated:!0,isLoading:!1,error:null})}catch{s({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:"Token已失效，请重新登录"})}}},updateProfile:async r=>{var a,n;try{const i=await Wt.updateProfile(r);return s(l=>({user:{...l.user,...i},error:null})),M.success("个人资料更新成功"),!0}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"更新失败";return s({error:l}),M.error(l),!1}},refreshToken:async()=>{try{const r=await Wt.refreshToken();return s({token:r.token,error:null}),!0}catch{return t().logout(),!1}},clearError:()=>{s({error:null})}}),{name:"auth-storage",partialize:s=>({token:s.token,user:s.user,isAuthenticated:s.isAuthenticated})})),Qr=as()(Bs(s=>({theme:"light",toggleTheme:()=>s(t=>({theme:t.theme==="light"?"dark":"light"})),setTheme:t=>s({theme:t})}),{name:"theme-storage",getStorage:()=>localStorage}));function r0(s={}){const{nonce:t,onScriptLoadSuccess:r,onScriptLoadError:a}=s,[n,i]=y.useState(!1),l=y.useRef(r);l.current=r;const o=y.useRef(a);return o.current=a,y.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",c.async=!0,c.defer=!0,c.nonce=t,c.onload=()=>{var d;i(!0),(d=l.current)===null||d===void 0||d.call(l)},c.onerror=()=>{var d;i(!1),(d=o.current)===null||d===void 0||d.call(o)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[t]),n}const sl=y.createContext(null);function a0({clientId:s,nonce:t,onScriptLoadSuccess:r,onScriptLoadError:a,children:n}){const i=r0({nonce:t,onScriptLoadSuccess:r,onScriptLoadError:a}),l=y.useMemo(()=>({clientId:s,scriptLoadedSuccessfully:i}),[s,i]);return ze.createElement(sl.Provider,{value:l},n)}function n0(){const s=y.useContext(sl);if(!s)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return s}function i0(s){var t;return(t=s==null?void 0:s.clientId)!==null&&t!==void 0?t:s==null?void 0:s.client_id}const l0={large:40,medium:32,small:20};function o0({onSuccess:s,onError:t,useOneTap:r,promptMomentNotification:a,type:n="standard",theme:i="outline",size:l="large",text:o,shape:c,logo_alignment:d,width:u,locale:m,click_listener:w,containerProps:x,...b}){const g=y.useRef(null),{clientId:N,scriptLoadedSuccessfully:v}=n0(),L=y.useRef(s);L.current=s;const _=y.useRef(t);_.current=t;const E=y.useRef(a);return E.current=a,y.useEffect(()=>{var A,p,k,C,W,re,Y,X,I;if(v)return(k=(p=(A=window==null?void 0:window.google)===null||A===void 0?void 0:A.accounts)===null||p===void 0?void 0:p.id)===null||k===void 0||k.initialize({client_id:N,callback:ie=>{var Q;if(!(ie!=null&&ie.credential))return(Q=_.current)===null||Q===void 0?void 0:Q.call(_);const{credential:xe,select_by:T}=ie;L.current({credential:xe,clientId:i0(ie),select_by:T})},...b}),(re=(W=(C=window==null?void 0:window.google)===null||C===void 0?void 0:C.accounts)===null||W===void 0?void 0:W.id)===null||re===void 0||re.renderButton(g.current,{type:n,theme:i,size:l,text:o,shape:c,logo_alignment:d,width:u,locale:m,click_listener:w}),r&&((I=(X=(Y=window==null?void 0:window.google)===null||Y===void 0?void 0:Y.accounts)===null||X===void 0?void 0:X.id)===null||I===void 0||I.prompt(E.current)),()=>{var ie,Q,xe;r&&((xe=(Q=(ie=window==null?void 0:window.google)===null||ie===void 0?void 0:ie.accounts)===null||Q===void 0?void 0:Q.id)===null||xe===void 0||xe.cancel())}},[N,v,r,n,i,l,o,c,d,u,m]),ze.createElement("div",{...x,ref:g,style:{height:l0[l],...x==null?void 0:x.style}})}const c0={zh:{welcomeTitle:"欢迎来到Trademe",welcomeSubtitle:"专业的数字货币策略交易平台",activeUsers:"活跃用户",tradingVolume:"交易量",uptime:"系统稳定性",platformDescription:"基于人工智能的量化交易平台，支持多交易所、自动化策略和智能风控",createAccount:"创建账户",accountLogin:"账户登录",registerSubtitle:"开始您的智能交易之旅",loginSubtitle:"欢迎回来，请登录您的账户",orContinueWith:"或者使用其他方式",username:"用户名",enterUsername:"请输入用户名",email:"邮箱地址",enterEmail:"请输入邮箱地址",password:"密码",enterPassword:"请输入密码",confirmPassword:"确认密码",enterPasswordAgain:"请再次输入密码",forgotPassword:"忘记密码",enterEmailForReset:"输入邮箱以重置密码",sendReset:"发送重置链接",processing:"处理中...",login:"登录",haveAccount:"已有账户？",noAccount:"还没有账户？",loginNow:"立即登录",registerNow:"立即注册",byRegisteringAgree:"注册即表示您同意我们的",termsOfService:"服务条款",and:"和",privacyPolicy:"隐私政策",userNotFound:"用户不存在，请检查邮箱地址",wrongPassword:"密码错误，请重试或重置密码",loginFailed:"登录失败，请重试",loginSuccess:"登录成功",registerSuccess:"注册成功",authError:"认证错误，请重试",googleLoginSuccess:"Google登录成功",googleLoginFailed:"Google登录失败",googleLoginError:"Google登录出错",passwordResetSent:"密码重置链接已发送到您的邮箱",passwordResetFailed:"发送重置链接失败",passwordResetError:"重置密码时出错",wantToRegister:"该用户不存在，是否要注册新账户？",dashboard:"仪表板",strategies:"策略管理",trading:"实盘交易",backtest:"回测分析",aiAssistant:"AI助手",market:"市场数据",portfolio:"投资组合",settings:"设置",logout:"退出登录",profile:"个人资料",notifications:"通知",help:"帮助中心",about:"关于我们",contact:"联系我们",language_setting:"语言",theme_setting:"主题",lightMode:"浅色模式",darkMode:"深色模式",chartTrading:"图表交易",liveTrading:"实盘交易",tradingNotes:"交易心得",apiManagement:"API管理",accountCenter:"账户中心",membershipManagement:"会员管理",personalSettings:"个人设置",tradingOverview:"交易概览",welcomeBack:"欢迎回来",checkTradingDataAndQuickActions:"查看您的交易数据和快速操作",realTimeConnected:"实时连接",connectionLost:"连接断开",totalStrategies:"策略总数",running:"运行中",totalProfit:"总收益",winRate:"胜率",quickActions:"快捷操作",strategiesManagement:"策略管理",viewAndManageStrategies:"查看和管理您的交易策略",startAutomatedTrading:"开始实盘自动化交易",strategyBacktest:"策略回测",testStrategyPerformance:"测试策略历史表现",getIntelligentTradingAdvice:"获取智能交易建议",recentStrategies:"最近策略",viewAll:"查看全部",loadingStrategies:"加载策略中...",viewDetails:"查看详情",noStrategies:"暂无策略",createFirstStrategy:"开始创建您的第一个交易策略",createStrategy:"创建策略",upgradeToCreate:"升级后创建",createStrategyRequiresPremium:"创建策略需要升级到高级版本",stopped:"已停止",tradingPair:"交易对",timeframe:"周期",monitorRunningStrategies:"监控运行中的实盘交易，查看收益和交易详情",totalLiveStrategies:"总实盘数",runningLive:"运行中",stoppedLive:"已停止",pausedLive:"已暂停",searchStrategies:"搜索策略...",allStatus:"全部",paused:"已暂停",strategyName:"策略名称",status:"状态",profitLoss:"盈亏",lastUpdate:"最近更新",actions:"操作",start:"启动",stop:"停止",pause:"暂停",delete:"删除",confirmDelete:"确定要删除策略",strategyDeleted:"策略已删除",strategyStarted:"已启动",strategyStopped:"已停止",strategyPaused:"已暂停",startStrategyRequiresPremium:"启动策略需要高级版本",loadingStrategiesError:"加载实盘失败",strategiesLoaded:"个实盘",noStrategiesMessage:"暂无策略数据",createFirstStrategyMessage:"创建您的第一个交易策略开始实盘交易",selected:"已选中",currentFilter:"当前筛选",clearFilter:"清除筛选",aiChatWelcome:`您好！我是Trademe AI交易助手。我可以帮您：

• 📈 分析市场趋势和技术指标
• 🤖 生成量化交易策略代码
• 💡 提供交易建议和风险评估
• 📊 解读回测结果和优化建议

请告诉我您需要什么帮助？`,aiChatRequiresPremium:"AI对话功能需要升级到高级版本",aiResponseError:"AI响应出错，请重试",sendMessage:"发送",typeMessage:"输入您的问题...",aiTyping:"AI正在思考...",newChat:"新对话",verifyTradingStrategy:"验证您的交易策略，优化投资决策",totalBacktests:"总回测数",completedSuccessfully:"成功完成",executionFailed:"执行失败",createBacktest:"创建回测",backtestHistory:"回测历史",backtestConfig:"回测配置",selectStrategy:"选择策略",strategyRequired:"请选择策略",confirmDeleteBacktest:"确定要删除这个回测吗？",getStrategiesError:"获取策略列表失败",completed:"已完成",failed:"已失败",unknown:"未知",selectOption:"请选择...",required:"必填项",optional:"可选项",shareTradeThoughts:"分享交易心得，学习交流经验",totalNotes:"心得总数",publicNotes:"公开心得",privateNotes:"私密心得",drafts:"草稿",myNotes:"我的心得",publicDiscussion:"公开讨论",createNote:"创建心得",writeTitle:"写下标题",shareTradeStory:"分享您的交易故事、心得体会",selectCategory:"选择分类",technicalAnalysis:"技术分析",fundamentalAnalysis:"基本面分析",strategyDiscussion:"策略探讨",errorReview:"错误复盘",marketView:"市场观点",tradingPairOptional:"交易对（可选）",entryPrice:"入场价格",exitPrice:"出场价格",stopLoss:"止损价格",takeProfit:"止盈价格",positionSize:"仓位大小",tags:"标签",addTag:"添加标签",publicPost:"公开发布",saveDraft:"保存草稿",publishing:"发布中...",saving:"保存中...",searchNotes:"搜索心得...",allCategories:"全部分类",sortBy:"排序方式",newest:"最新",oldest:"最早",mostLiked:"最受欢迎",noNotesMessage:"还没有心得分享",createFirstNote:"写下您的第一篇交易心得",manageExchangeConnections:"管理交易所连接，配置API密钥",totalAPIs:"API总数",activeAPIs:"活跃API",testConnection:"测试连接",addNewAPI:"添加新API",apiKeyManagement:"API密钥管理",exchangeName:"交易所名称",apiKey:"API密钥",secretKey:"密钥Secret",passphrase:"密码短语",permissions:"权限",connectionStatus:"连接状态",connected:"已连接",disconnected:"未连接",editAPI:"编辑API",deleteAPI:"删除API",confirmDeleteAPI:"确定要删除这个API配置吗？",manageAccountAndSettings:"管理账户信息和系统设置",accountInfo:"账户信息",membershipInfo:"会员信息",securitySettings:"安全设置",systemSettings:"系统设置",basicInfo:"基本信息",avatar:"头像",changePassword:"修改密码",twoFactorAuth:"双重验证",currentPlan:"当前套餐",validUntil:"有效期至",upgrade:"升级",renewMembership:"续费会员",usageStatistics:"使用统计",changeAvatar:"更换头像",uploadImage:"上传图片",currentPassword:"当前密码",newPassword:"新密码",confirmNewPassword:"确认新密码",saveChanges:"保存更改",cancel:"取消",basicUser:"初级用户",premiumUser:"高级用户",professionalUser:"专业用户",monthlyFee:"每月",apiKeyBinding:"个API密钥",dailyAIQuota:"每日AI助手额度",tickBacktestMonthly:"每月Tick级数据回测",tradingNotesStorage:"交易心得记录存储",indicatorsStrategies:"个指标/策略",liveInstances:"个实盘"},en:{welcomeTitle:"Welcome to Trademe",welcomeSubtitle:"Professional Cryptocurrency Strategy Trading Platform",activeUsers:"Active Users",tradingVolume:"Trading Volume",uptime:"System Uptime",platformDescription:"AI-powered quantitative trading platform with multi-exchange support, automated strategies, and intelligent risk control",createAccount:"Create Account",accountLogin:"Account Login",registerSubtitle:"Start your intelligent trading journey",loginSubtitle:"Welcome back, please login to your account",orContinueWith:"Or continue with",username:"Username",enterUsername:"Enter username",email:"Email Address",enterEmail:"Enter email address",password:"Password",enterPassword:"Enter password",confirmPassword:"Confirm Password",enterPasswordAgain:"Enter password again",forgotPassword:"Forgot Password",enterEmailForReset:"Enter email to reset password",sendReset:"Send Reset Link",processing:"Processing...",login:"Login",haveAccount:"Already have an account?",noAccount:"Don't have an account?",loginNow:"Login Now",registerNow:"Register Now",byRegisteringAgree:"By registering, you agree to our ",termsOfService:"Terms of Service",and:" and ",privacyPolicy:"Privacy Policy",userNotFound:"User not found, please check email address",wrongPassword:"Wrong password, please try again or reset password",loginFailed:"Login failed, please try again",loginSuccess:"Login successful",registerSuccess:"Registration successful",authError:"Authentication error, please try again",googleLoginSuccess:"Google login successful",googleLoginFailed:"Google login failed",googleLoginError:"Google login error",passwordResetSent:"Password reset link has been sent to your email",passwordResetFailed:"Failed to send reset link",passwordResetError:"Error resetting password",wantToRegister:"User does not exist, would you like to register a new account?",dashboard:"Dashboard",strategies:"Strategies",trading:"Live Trading",backtest:"Backtest",aiAssistant:"AI Assistant",market:"Market Data",portfolio:"Portfolio",settings:"Settings",logout:"Logout",profile:"Profile",notifications:"Notifications",help:"Help Center",about:"About Us",contact:"Contact Us",language_setting:"Language",theme_setting:"Theme",lightMode:"Light Mode",darkMode:"Dark Mode",chartTrading:"Chart Trading",liveTrading:"Live Trading",tradingNotes:"Trading Notes",apiManagement:"API Management",accountCenter:"Account Center",membershipManagement:"Membership Management",personalSettings:"Personal Settings",tradingOverview:"Trading Overview",welcomeBack:"Welcome back",checkTradingDataAndQuickActions:"View your trading data and quick actions",realTimeConnected:"Real-time Connected",connectionLost:"Connection Lost",totalStrategies:"Total Strategies",running:"Running",totalProfit:"Total Profit",winRate:"Win Rate",quickActions:"Quick Actions",strategiesManagement:"Strategies Management",viewAndManageStrategies:"View and manage your trading strategies",startAutomatedTrading:"Start automated live trading",strategyBacktest:"Strategy Backtest",testStrategyPerformance:"Test strategy historical performance",getIntelligentTradingAdvice:"Get intelligent trading advice",recentStrategies:"Recent Strategies",viewAll:"View All",loadingStrategies:"Loading strategies...",viewDetails:"View Details",noStrategies:"No Strategies",createFirstStrategy:"Start creating your first trading strategy",createStrategy:"Create Strategy",upgradeToCreate:"Upgrade to Create",createStrategyRequiresPremium:"Creating strategies requires premium upgrade",stopped:"Stopped",tradingPair:"Trading Pair",timeframe:"Timeframe",monitorRunningStrategies:"Monitor running live strategies, view profits and trading details",totalLiveStrategies:"Total Live Strategies",runningLive:"Running",stoppedLive:"Stopped",pausedLive:"Paused",searchStrategies:"Search strategies...",allStatus:"All",paused:"Paused",strategyName:"Strategy Name",status:"Status",profitLoss:"P&L",lastUpdate:"Last Update",actions:"Actions",start:"Start",stop:"Stop",pause:"Pause",delete:"Delete",confirmDelete:"Are you sure you want to delete strategy",strategyDeleted:"Strategy deleted",strategyStarted:"started",strategyStopped:"stopped",strategyPaused:"paused",startStrategyRequiresPremium:"Starting strategies requires premium version",loadingStrategiesError:"Failed to load live strategies",strategiesLoaded:"live strategies loaded",noStrategiesMessage:"No strategy data available",createFirstStrategyMessage:"Create your first trading strategy to start live trading",selected:"Selected",currentFilter:"Current filter",clearFilter:"Clear filter",aiChatWelcome:`Hello! I am Trademe AI trading assistant. I can help you:

• 📈 Analyze market trends and technical indicators
• 🤖 Generate quantitative trading strategy code
• 💡 Provide trading advice and risk assessment
• 📊 Interpret backtest results and optimization suggestions

What can I help you with?`,aiChatRequiresPremium:"AI chat feature requires premium version upgrade",aiResponseError:"AI response error, please try again",sendMessage:"Send",typeMessage:"Type your question...",aiTyping:"AI is thinking...",newChat:"New Chat",verifyTradingStrategy:"Verify your trading strategies and optimize investment decisions",totalBacktests:"Total Backtests",completedSuccessfully:"Completed Successfully",executionFailed:"Execution Failed",createBacktest:"Create Backtest",backtestHistory:"Backtest History",backtestConfig:"Backtest Configuration",selectStrategy:"Select Strategy",strategyRequired:"Please select a strategy",confirmDeleteBacktest:"Are you sure you want to delete this backtest?",getStrategiesError:"Failed to get strategy list",completed:"Completed",failed:"Failed",unknown:"Unknown",selectOption:"Please select...",required:"Required",optional:"Optional",shareTradeThoughts:"Share trading insights and learn from experiences",totalNotes:"Total Notes",publicNotes:"Public Notes",privateNotes:"Private Notes",drafts:"Drafts",myNotes:"My Notes",publicDiscussion:"Public Discussion",createNote:"Create Note",writeTitle:"Write title",shareTradeStory:"Share your trading story and insights",selectCategory:"Select Category",technicalAnalysis:"Technical Analysis",fundamentalAnalysis:"Fundamental Analysis",strategyDiscussion:"Strategy Discussion",errorReview:"Error Review",marketView:"Market View",tradingPairOptional:"Trading Pair (Optional)",entryPrice:"Entry Price",exitPrice:"Exit Price",stopLoss:"Stop Loss Price",takeProfit:"Take Profit Price",positionSize:"Position Size",tags:"Tags",addTag:"Add Tag",publicPost:"Publish Publicly",saveDraft:"Save Draft",publishing:"Publishing...",saving:"Saving...",searchNotes:"Search notes...",allCategories:"All Categories",sortBy:"Sort By",newest:"Newest",oldest:"Oldest",mostLiked:"Most Liked",noNotesMessage:"No notes shared yet",createFirstNote:"Write your first trading note",manageExchangeConnections:"Manage exchange connections and configure API keys",totalAPIs:"Total APIs",activeAPIs:"Active APIs",testConnection:"Test Connection",addNewAPI:"Add New API",apiKeyManagement:"API Key Management",exchangeName:"Exchange Name",apiKey:"API Key",secretKey:"Secret Key",passphrase:"Passphrase",permissions:"Permissions",connectionStatus:"Connection Status",connected:"Connected",disconnected:"Disconnected",editAPI:"Edit API",deleteAPI:"Delete API",confirmDeleteAPI:"Are you sure you want to delete this API configuration?",manageAccountAndSettings:"Manage account information and system settings",accountInfo:"Account Information",membershipInfo:"Membership Information",securitySettings:"Security Settings",systemSettings:"System Settings",basicInfo:"Basic Information",avatar:"Avatar",changePassword:"Change Password",twoFactorAuth:"Two-Factor Authentication",currentPlan:"Current Plan",validUntil:"Valid Until",upgrade:"Upgrade",renewMembership:"Renew Membership",usageStatistics:"Usage Statistics",changeAvatar:"Change Avatar",uploadImage:"Upload Image",currentPassword:"Current Password",newPassword:"New Password",confirmNewPassword:"Confirm New Password",saveChanges:"Save Changes",cancel:"Cancel",basicUser:"Basic User",premiumUser:"Premium User",professionalUser:"Professional User",monthlyFee:"per month",apiKeyBinding:"API keys",dailyAIQuota:"daily AI assistant quota",tickBacktestMonthly:"monthly tick-level backtests",tradingNotesStorage:"trading notes storage",indicatorsStrategies:"indicators/strategies",liveInstances:"live instances"}},ns=as()(Bs((s,t)=>({language:"zh",setLanguage:r=>s({language:r}),t:r=>{const a=t().language;return c0[a][r]||r}}),{name:"language-storage",getStorage:()=>localStorage})),d0=({data:s=[],title:t="收益率曲线",width:r="100%",height:a=300,className:n="",showBenchmark:i=!1,benchmarkName:l="基准",loading:o=!1})=>{const c=y.useRef(null),d=y.useRef(null);return y.useEffect(()=>{if(c.current)return d.current=yr(c.current),()=>{var u;(u=d.current)==null||u.dispose()}},[]),y.useEffect(()=>{if(!d.current||o)return;if(s.length===0){d.current.clear();return}const u=s.map(_=>new Date(_.timestamp).toLocaleDateString()),m=s.map(_=>_.value),w=i?s.map(_=>_.benchmark||0):[],x=[],b=[];let g=100,N=100;for(let _=0;_<m.length;_++)_===0?(x.push(g),i&&b.push(N)):(g=g*(1+m[_]/100),x.push(g),i&&w[_]!==void 0&&(N=N*(1+w[_]/100),b.push(N)));const v=[{name:"策略收益",type:"line",data:x,smooth:!0,symbol:"none",lineStyle:{color:"#1a3d7c",width:2},areaStyle:{color:new da(0,0,0,1,[{offset:0,color:"rgba(26, 61, 124, 0.3)"},{offset:1,color:"rgba(26, 61, 124, 0.05)"}])}}];i&&b.length>0&&v.push({name:l,type:"line",data:b,smooth:!0,symbol:"none",lineStyle:{color:"#94a3b8",width:1,type:"dashed"}});const L={title:{text:t,left:0,textStyle:{color:"#1a3d7c",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"#e5e7eb",borderWidth:1,textStyle:{color:"#374151"},formatter:function(_){if(!_||_.length===0)return"";const E=_[0].dataIndex,A=m[E],p=(x[E]-100).toFixed(2);let k=`
            <div style="padding: 8px;">
              <div style="margin-bottom: 4px; font-weight: bold;">${_[0].name}</div>
              <div style="color: #1a3d7c;">
                当日收益: ${A>0?"+":""}${A.toFixed(2)}%
              </div>
              <div style="color: #1a3d7c;">
                累计收益: ${parseFloat(p)>0?"+":""}${p}%
              </div>
          `;if(i&&_.length>1){const C=(b[E]-100).toFixed(2);k+=`
              <div style="color: #94a3b8;">
                ${l}累计: ${parseFloat(C)>0?"+":""}${C}%
              </div>
            `}return k+="</div>",k}},legend:{data:i?["策略收益",l]:["策略收益"],top:35,right:0,textStyle:{color:"#666"}},grid:{left:"3%",right:"4%",bottom:"8%",top:i?"20%":"15%",containLabel:!0},xAxis:{type:"category",data:u,boundaryGap:!1,axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280",fontSize:11},splitLine:{show:!1}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280",fontSize:11,formatter:"{value}%"},splitLine:{lineStyle:{color:"#f3f4f6",type:"dashed"}}},series:v};d.current.setOption(L,!0)},[s,t,i,l,o]),y.useEffect(()=>{const u=()=>{var m;(m=d.current)==null||m.resize()};return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),e.jsxs("div",{className:`relative ${n}`,children:[e.jsx("div",{ref:c,style:{width:r,height:a},className:"bg-white"}),o&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-gray-500 text-sm",children:"加载中..."})]})}),!o&&s.length===0&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("p",{className:"text-gray-500",children:"暂无数据"})]})})]})},u0=({metrics:s,equityCurve:t=[],monthlyReturns:r=[],className:a=""})=>{const n=y.useRef(null),i=y.useRef(null),l=y.useRef(null),o=y.useRef(null),c=y.useRef(null),d=y.useRef(null);return y.useEffect(()=>(n.current&&(o.current=yr(n.current)),i.current&&(c.current=yr(i.current)),l.current&&(d.current=yr(l.current)),()=>{var u,m,w;(u=o.current)==null||u.dispose(),(m=c.current)==null||m.dispose(),(w=d.current)==null||w.dispose()}),[]),y.useEffect(()=>{if(!o.current||t.length===0)return;const u=t.map(g=>new Date(g.timestamp).toLocaleDateString()),m=t.map(g=>g.equity),w=t.map(g=>-Math.abs(g.drawdown)),x=t.map(g=>g.rolling_max),b={title:{text:"权益曲线与回撤分析",left:0,textStyle:{fontSize:16,fontWeight:"bold",color:"#1f2937"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:g=>{const N=g[0].dataIndex;return`
            <div style="padding: 8px;">
              <div style="font-weight: bold; margin-bottom: 4px;">${u[N]}</div>
              <div style="color: #1e40af;">权益: $${m[N].toLocaleString()}</div>
              <div style="color: #dc2626;">回撤: ${w[N].toFixed(2)}%</div>
              <div style="color: #059669;">历史最高: $${x[N].toLocaleString()}</div>
            </div>
          `}},legend:{data:["权益曲线","历史最高","回撤"],top:25},grid:[{left:"8%",right:"8%",top:"15%",height:"50%"},{left:"8%",right:"8%",top:"70%",height:"20%"}],xAxis:[{type:"category",data:u,axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280",interval:"auto"}},{type:"category",data:u,gridIndex:1,axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{show:!1}}],yAxis:[{type:"value",position:"right",axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280",formatter:g=>"$"+g.toLocaleString()},splitLine:{lineStyle:{color:"#f3f4f6",type:"dashed"}}},{type:"value",gridIndex:1,position:"right",axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280",formatter:"{value}%"},max:0,min:Math.min(...w)*1.1}],series:[{name:"权益曲线",type:"line",data:m,smooth:!0,symbol:"none",lineStyle:{color:"#1e40af",width:2},areaStyle:{color:new da(0,0,0,1,[{offset:0,color:"rgba(30, 64, 175, 0.3)"},{offset:1,color:"rgba(30, 64, 175, 0.05)"}])}},{name:"历史最高",type:"line",data:x,smooth:!0,symbol:"none",lineStyle:{color:"#059669",width:1,type:"dashed"}},{name:"回撤",type:"line",data:w,xAxisIndex:1,yAxisIndex:1,smooth:!0,symbol:"none",lineStyle:{color:"#dc2626",width:1},areaStyle:{color:new da(0,0,0,1,[{offset:0,color:"rgba(220, 38, 38, 0.2)"},{offset:1,color:"rgba(220, 38, 38, 0.05)"}])}}],dataZoom:[{type:"inside",xAxisIndex:[0,1],start:0,end:100}]};o.current.setOption(b,!0)},[t]),y.useEffect(()=>{if(!c.current||r.length===0)return;const u=[...new Set(r.map(b=>b.year))].sort(),m=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],w=r.map(b=>[b.month-1,u.indexOf(b.year),b.return]),x={title:{text:"月度收益热力图",left:0,textStyle:{fontSize:16,fontWeight:"bold",color:"#1f2937"}},tooltip:{position:"top",formatter:b=>{const[g,N,v]=b.data,L=u[N],_=m[g],E=v>=0?"#059669":"#dc2626";return`
            <div style="padding: 8px;">
              <div style="font-weight: bold; margin-bottom: 4px;">${L}年${_}</div>
              <div style="color: ${E};">收益率: ${v.toFixed(2)}%</div>
            </div>
          `}},grid:{height:"60%",top:"15%",left:"10%",right:"10%"},xAxis:{type:"category",data:m,splitArea:{show:!1},axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280"}},yAxis:{type:"category",data:u.map(b=>b.toString()),splitArea:{show:!1},axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280"}},visualMap:{min:Math.min(...r.map(b=>b.return)),max:Math.max(...r.map(b=>b.return)),calculable:!0,orient:"horizontal",left:"center",bottom:"5%",inRange:{color:["#dc2626","#ffffff","#059669"]},text:["高收益","低收益"],textStyle:{color:"#6b7280"}},series:[{name:"月度收益",type:"heatmap",data:w,label:{show:!0,formatter:b=>b.data[2].toFixed(1)+"%",color:"#1f2937",fontSize:10},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};c.current.setOption(x,!0)},[r]),y.useEffect(()=>{if(!d.current)return;const u={title:{text:"策略性能雷达图",left:0,textStyle:{fontSize:16,fontWeight:"bold",color:"#1f2937"}},tooltip:{trigger:"item",formatter:m=>{const{name:w,value:x}=m;return`<div style="padding: 8px;"><b>${w}</b><br/>评分: ${x}</div>`}},radar:{radius:"70%",center:["50%","55%"],indicator:[{name:"收益能力",max:100},{name:"风险控制",max:100},{name:"稳定性",max:100},{name:"交易效率",max:100},{name:"回撤控制",max:100},{name:"风险收益比",max:100}],axisName:{color:"#6b7280",fontSize:12},splitArea:{areaStyle:{color:["rgba(59, 130, 246, 0.05)","rgba(59, 130, 246, 0.1)"]}},axisLine:{lineStyle:{color:"#e5e7eb"}},splitLine:{lineStyle:{color:"#e5e7eb"}}},series:[{name:"策略性能",type:"radar",data:[{value:[Math.min(Math.max((s.annual_return+50)*2,0),100),Math.min(Math.max(100-s.volatility*2,0),100),Math.min(Math.max(s.sharpe_ratio*30,0),100),Math.min(Math.max(s.win_rate,0),100),Math.min(Math.max(100-Math.abs(s.max_drawdown)*2,0),100),Math.min(Math.max(s.profit_factor*20,0),100)],name:"当前策略",areaStyle:{color:new Sl(.5,.5,1,[{offset:0,color:"rgba(59, 130, 246, 0.3)"},{offset:1,color:"rgba(59, 130, 246, 0.1)"}])},lineStyle:{color:"#3b82f6",width:2},symbol:"circle",symbolSize:6}]}]};d.current.setOption(u,!0)},[s]),y.useEffect(()=>{const u=()=>{var m,w,x;(m=o.current)==null||m.resize(),(w=c.current)==null||w.resize(),(x=d.current)==null||x.resize()};return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),e.jsxs("div",{className:`space-y-6 ${a}`,children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 text-center",children:[e.jsxs("div",{className:`text-2xl font-bold ${s.total_return>=0?"text-green-600":"text-red-600"}`,children:[s.total_return>=0?"+":"",s.total_return.toFixed(2),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"总收益率"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[s.max_drawdown.toFixed(2),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"最大回撤"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${s.sharpe_ratio>=1?"text-green-600":"text-orange-600"}`,children:s.sharpe_ratio.toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-500",children:"夏普比率"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[s.win_rate.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"胜率"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:s.sortino_ratio.toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-500",children:"索提诺比率"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:s.calmar_ratio.toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-500",children:"卡尔玛比率"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx("div",{ref:n,style:{width:"100%",height:"400px"}})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx("div",{ref:l,style:{width:"100%",height:"400px"}})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx("div",{ref:i,style:{width:"100%",height:"300px"}})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"详细统计"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"收益指标"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"年化收益率:"}),e.jsxs("span",{className:s.annual_return>=0?"text-green-600":"text-red-600",children:[s.annual_return.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"总交易次数:"}),e.jsx("span",{className:"text-gray-900",children:s.total_trades})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"盈亏比:"}),e.jsx("span",{className:"text-gray-900",children:s.profit_factor.toFixed(2)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"风险指标"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"波动率:"}),e.jsxs("span",{className:"text-gray-900",children:[s.volatility.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"VaR (95%):"}),e.jsxs("span",{className:"text-red-600",children:[s.var_95.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"CVaR (95%):"}),e.jsxs("span",{className:"text-red-600",children:[s.cvar_95.toFixed(2),"%"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"交易指标"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"平均盈利:"}),e.jsxs("span",{className:"text-green-600",children:[s.avg_win.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"平均亏损:"}),e.jsxs("span",{className:"text-red-600",children:[s.avg_loss.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"最大连胜:"}),e.jsx("span",{className:"text-green-600",children:s.max_consecutive_wins})]})]})]})]})]})]})},m0=()=>{var g;const s=ot(),{isAuthenticated:t,user:r}=Xe(),{theme:a}=Qr(),{t:n}=ns(),[i,l]=y.useState(null),[o,c]=y.useState([]),[d,u]=y.useState(!1),[m,w]=y.useState(!1),[x,b]=y.useState("90");return y.useEffect(()=>{t&&s("/ai-chat",{replace:!0})},[t,s]),t?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:e.jsxs("div",{className:"w-full max-w-6xl min-h-screen bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 mx-auto transition-colors",children:[e.jsxs("header",{className:"py-4 px-8 flex justify-between items-center border-b border-gray-200 dark:border-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"w-7 h-7 mr-3 text-blue-600 dark:text-blue-400",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),e.jsx("path",{d:"M8 12h8M12 8v8",stroke:"currentColor",strokeWidth:"2"})]}),e.jsx("h1",{className:"text-xl font-bold text-blue-600 dark:text-blue-400 transition-colors",children:"Trademe"})]}),e.jsxs("nav",{className:"flex gap-2",children:[e.jsx("div",{className:"px-4 py-2 rounded-lg text-white font-medium bg-blue-600 dark:bg-blue-600 transition-colors",children:"首页"}),e.jsx(Ke,{to:"/strategies",className:"px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"策略交易"}),e.jsx(Ke,{to:"/trading",className:"px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"图表交易"}),e.jsx(Ke,{to:"/trading-notes",className:"px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"交易心得"}),e.jsx(Ke,{to:"/api-keys",className:"px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"API管理"}),e.jsx(Ke,{to:"/profile",className:"px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"账户中心"})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"w-9 h-9 rounded-full bg-gray-200 overflow-hidden",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-r from-blue-400 to-blue-600 flex items-center justify-center text-white font-semibold",children:(g=r==null?void 0:r.username)==null?void 0:g.charAt(0).toUpperCase()})})})]}),e.jsxs("main",{className:"p-8",children:[e.jsxs("section",{className:"grid grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-xl shadow-sm border border-gray-100 dark:border-gray-600 p-6 flex items-center transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4 bg-blue-100 dark:bg-blue-900",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1721 9z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"APIKEY数量"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d?e.jsx("span",{className:"animate-pulse bg-gray-200 dark:bg-gray-600 rounded h-8 w-16 inline-block"}):e.jsxs(e.Fragment,{children:[(i==null?void 0:i.api_keys.current)||0,e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["/",(i==null?void 0:i.api_keys.limit)||10]})]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-xl shadow-sm border border-gray-100 dark:border-gray-600 p-6 flex items-center transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4 bg-green-100 dark:bg-green-900",children:e.jsx("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"实盘策略数"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d?e.jsx("span",{className:"animate-pulse bg-gray-200 dark:bg-gray-600 rounded h-8 w-12 inline-block"}):(i==null?void 0:i.live_strategies.current)||0})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-xl shadow-sm border border-gray-100 dark:border-gray-600 p-6 flex items-center transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4 bg-yellow-100 dark:bg-yellow-900",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"本月收益率"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d?e.jsx("span",{className:"animate-pulse bg-gray-200 dark:bg-gray-600 rounded h-8 w-20 inline-block"}):e.jsxs("span",{className:`px-2 py-1 rounded-md ${((i==null?void 0:i.monthly_return)||0)>=0?"bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-400":"bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-400"}`,children:[((i==null?void 0:i.monthly_return)||0)>=0?"+":"",((i==null?void 0:i.monthly_return)||0).toFixed(1),"%"]})})]})]})]}),e.jsx("section",{className:"mb-8",children:e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-xl shadow-sm border border-gray-100 dark:border-gray-600 p-6 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:"当前收益率曲线"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>b("7"),className:`px-3 py-1 rounded-lg text-sm transition-colors ${x==="7"?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500"}`,children:"近7天"}),e.jsx("button",{onClick:()=>b("30"),className:`px-3 py-1 rounded-lg text-sm transition-colors ${x==="30"?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500"}`,children:"本月"}),e.jsx("button",{onClick:()=>b("90"),className:`px-3 py-1 rounded-lg text-sm transition-colors ${x==="90"?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500"}`,children:"近3月"})]})]}),m?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-500 dark:text-gray-400",children:"加载收益数据..."})]}):e.jsx(d0,{data:o,title:"",height:250,className:"mt-2"})]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center transition-colors",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-brand-500 rounded-full flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-white font-bold text-xl",children:"T"})}),e.jsxs("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4 transition-colors",children:["欢迎使用 ",e.jsx("span",{className:"text-brand-500",children:"Trademe"})]}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 mb-8 transition-colors",children:"专业的数字货币策略交易平台，集成AI智能分析"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-12",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-200 dark:border-gray-700 transition-colors",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-gradient-to-r from-blue-500 to-cyan-500 rounded-2xl flex items-center justify-center mb-6",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-900 dark:text-white text-center",children:"AI策略回测"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6 leading-relaxed",children:"使用Claude 4先进AI技术，将您的交易想法智能转化为专业策略代码。平台提供tick级别的高精度历史数据回测， 确保策略验证的准确性。回测完成后，可一键部署至实盘交易，实现从想法到盈利的完整闭环。"}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Claude 4智能策略生成"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Tick级别高精度回测"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"一键转实盘运行"]})]}),e.jsx(Ke,{to:"/ai-backtest-intro",className:"block",children:e.jsx("button",{className:"w-full py-3 px-6 bg-gradient-to-r from-blue-500 to-cyan-500 text-white font-medium rounded-lg hover:from-blue-600 hover:to-cyan-600 transition-all transform hover:scale-105",children:"了解详情"})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-200 dark:border-gray-700 transition-colors",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl flex items-center justify-center mb-6",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-900 dark:text-white text-center",children:"AI智能分析"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6 leading-relaxed",children:"通过深度记录和分析您的策略开单情况及手动交易行为，AI助手能够学习您的交易逻辑和风格偏好。 与AI进行深度对话，共同构建个性化的智能交易系统，让AI成为您24小时不间断的专业交易顾问。"}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"智能交易行为分析"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"个性化交易逻辑学习"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"24/7智能交易助手"]})]}),e.jsx(Ke,{to:"/ai-analysis-intro",className:"block",children:e.jsx("button",{className:"w-full py-3 px-6 bg-gradient-to-r from-green-500 to-emerald-500 text-white font-medium rounded-lg hover:from-green-600 hover:to-emerald-600 transition-all transform hover:scale-105",children:"了解详情"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 text-center transition-colors",children:[e.jsx("div",{className:"w-12 h-12 mx-auto bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"多交易所支持"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"支持币安、OKX等主流交易所API，统一管理多个账户"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 text-center transition-colors",children:[e.jsx("div",{className:"w-12 h-12 mx-auto bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"安全可靠"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"银行级别的安全加密，API密钥本地加密存储"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 text-center transition-colors",children:[e.jsx("div",{className:"w-12 h-12 mx-auto bg-indigo-100 dark:bg-indigo-900 rounded-lg flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"实时监控"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"实时监控策略表现，智能风控保护您的资金安全"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center mb-8",children:[e.jsx(Ke,{to:"/login",className:"w-full sm:w-auto",children:e.jsx("button",{className:"w-full sm:w-auto px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all transform hover:scale-105 shadow-lg",children:"免费开始使用"})}),e.jsx(Ke,{to:"/pricing",className:"w-full sm:w-auto",children:e.jsx("button",{className:"w-full sm:w-auto px-8 py-4 bg-transparent border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 font-semibold rounded-xl hover:border-blue-500 dark:hover:border-blue-400 transition-colors",children:"查看会员方案"})})]}),e.jsxs("div",{className:"mt-20 mb-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"AI策略回测 - 让想法变成盈利"}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto",children:"使用Claude 4先进AI技术，将您的交易想法智能转化为专业策略代码"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:"1"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"描述您的策略想法"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:'用自然语言描述您的交易策略思路，比如"当RSI超卖且价格触及支撑位时买入"。 Claude 4能够理解复杂的交易逻辑和技术指标组合。'})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"2"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"AI智能策略生成"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"AI自动将您的想法转换为专业的Python交易策略代码，包含完整的开仓、平仓、止损止盈逻辑， 支持多种技术指标和风控机制。"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-bold",children:"3"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"Tick级别精确回测"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"使用真实的tick级别历史数据进行回测，精确模拟每一笔交易的执行过程， 包含滑点、手续费等真实交易成本，确保回测结果的可靠性。"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-orange-600 dark:text-orange-400 font-bold",children:"4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"一键转实盘运行"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"回测验证策略有效性后，一键部署到实盘交易环境。 平台自动处理API连接、订单执行、风险控制等技术细节，让您专注于策略优化。"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl p-8 text-white",children:[e.jsx("h3",{className:"text-2xl font-bold mb-6",children:"策略回测报告示例"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"总收益率"}),e.jsx("span",{className:"font-bold text-green-300",children:"+156.8%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"夏普比率"}),e.jsx("span",{className:"font-bold",children:"2.34"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"最大回撤"}),e.jsx("span",{className:"font-bold text-red-300",children:"-8.5%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"胜率"}),e.jsx("span",{className:"font-bold",children:"68.2%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"盈亏比"}),e.jsx("span",{className:"font-bold",children:"2.1:1"})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-white/10 rounded-lg",children:[e.jsx("p",{className:"text-sm",children:'"该策略在过去12个月的回测中表现优异，具有较低的风险和稳定的收益。建议配置20%的资金进行实盘交易。"'}),e.jsx("p",{className:"text-xs mt-2 opacity-80",children:"— AI策略分析师"})]})]})]})]}),e.jsxs("div",{className:"mt-20 mb-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"AI智能分析 - 您的24/7交易顾问"}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto",children:"通过深度学习您的交易行为，构建个性化的智能交易系统"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-teal-600 rounded-2xl p-8 text-white",children:[e.jsx("h3",{className:"text-2xl font-bold mb-6",children:"AI学习您的交易模式"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-white/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"交易心得记录"}),e.jsx("p",{className:"text-sm opacity-90",children:'"今天在BTCUSDT 45000附近看到双底形态，结合RSI超卖信号， 决定建立多头仓位。设置止损在44500，目标位46500。"'})]}),e.jsxs("div",{className:"p-4 bg-white/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"AI分析反馈"}),e.jsx("p",{className:"text-sm opacity-90",children:'"您偏好在技术形态确认后进场，风险控制意识较强。 建议在类似条件下可以适当加大仓位，历史胜率达72%。"'})]}),e.jsxs("div",{className:"p-4 bg-white/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"交易建议"}),e.jsx("p",{className:"text-sm opacity-90",children:'"当前ETHUSDT出现类似的双底+RSI超卖组合， 基于您的交易风格，建议关注入场机会。"'})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"1"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"记录交易心得"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"详细记录每次交易的思路、进场逻辑、情绪状态等。 平台支持文字、图片、语音等多种形式，让记录更加便捷真实。"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:"2"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"AI深度学习"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"AI分析您的交易记录，识别成功和失败的交易模式， 学习您的风险偏好、时间习惯、技术分析方法等个性化特征。"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-bold",children:"3"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"智能对话分析"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"与AI进行深度对话，讨论市场观点、交易策略、风险控制等。 AI会根据您的历史表现和当前市况，提供个性化的交易建议。"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-orange-600 dark:text-orange-400 font-bold",children:"4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"构建专属交易系统"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"基于学习结果，AI帮助构建符合您交易风格的智能系统， 包括自动监控、风险提醒、交易机会推送等功能。"})]})]})]})]})]}),e.jsxs("div",{className:"mt-20 mb-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"会员方案"}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300",children:"选择适合您的专业交易方案，开启AI助力的量化交易之旅"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 border border-gray-200 dark:border-gray-700 transition-colors",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"免费用户"}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:["$0",e.jsx("span",{className:"text-lg text-gray-500 dark:text-gray-400",children:"/月"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"体验基础功能"})]}),e.jsxs("ul",{className:"space-y-2 mb-8 text-sm",children:[e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"绑定 1 个API密钥"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"$10 AI对话额度 (总额)"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"无限次K线级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"1KB 交易心得存储"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"1个策略/1个指标"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"1个实盘交易"]})]}),e.jsx("button",{className:"w-full py-3 px-6 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors",children:"免费开始"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 border border-gray-200 dark:border-gray-700 transition-colors",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"初级会员"}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:["$19",e.jsx("span",{className:"text-lg text-gray-500 dark:text-gray-400",children:"/月"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"个人交易者首选"})]}),e.jsxs("ul",{className:"space-y-2 mb-8 text-sm",children:[e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"绑定 1 个API密钥"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"每日 $100 AI助手额度"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"每日 5次 Tick级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"无限次K线级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"1MB 交易心得存储"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"2个策略/2个指标"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"2个实盘交易"]})]}),e.jsx("button",{className:"w-full py-3 px-6 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"选择初级会员"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 border-2 border-blue-500 relative transition-colors",children:[e.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2",children:e.jsx("span",{className:"bg-blue-500 text-white px-4 py-1 rounded-full text-sm font-medium",children:"推荐"})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"高级会员"}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:["$99",e.jsx("span",{className:"text-lg text-gray-500 dark:text-gray-400",children:"/月"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"专业交易团队"})]}),e.jsxs("ul",{className:"space-y-2 mb-8 text-sm",children:[e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"绑定 5 个API密钥"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"每日 $100 AI助手额度"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"每月 30次 Tick级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"无限次K线级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"20MB 交易心得存储"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"10个策略/10个指标"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"10个实盘交易"]})]}),e.jsx("button",{className:"w-full py-3 px-6 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"选择高级会员"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 border border-gray-200 dark:border-gray-700 transition-colors",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"专业会员"}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:["$199",e.jsx("span",{className:"text-lg text-gray-500 dark:text-gray-400",children:"/月"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"机构投资者"})]}),e.jsxs("ul",{className:"space-y-2 mb-8 text-sm",children:[e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"绑定 10 个API密钥"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"每日 $200 AI对话额度"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"每月 100次 Tick级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"无限次K线级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"50MB 交易心得存储"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"20个策略/20个指标"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"20个实盘交易"]})]}),e.jsx("button",{className:"w-full py-3 px-6 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"选择专业会员"})]})]}),e.jsxs("div",{className:"text-center mt-8",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"💡 AI额度已优化至最佳性价比 • 所有方案包含无限K线回测 • 免费用户可体验完整功能"}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 inline-block",children:e.jsx("p",{className:"text-blue-600 dark:text-blue-400 text-sm font-medium",children:"🎯 推荐：先使用免费账户体验，再根据需要升级付费方案"})})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"遇到问题？联系我们的专业团队"}),e.jsxs("a",{href:"https://t.me/+K2JBhvnMW2AwNGZl",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-lg transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 0C5.374 0 0 5.373 0 12s5.374 12 12 12 12-5.373 12-12S18.626 0 12 0zm5.568 8.16l-1.61 7.59c-.12.54-.44.67-.9.42l-2.47-1.82-1.19 1.14c-.13.13-.24.24-.5.24l.18-2.51 4.62-4.18c.2-.18-.04-.28-.32-.1L10.42 13l-2.42-.76c-.53-.16-.54-.53.11-.78l9.46-3.64c.44-.16.82.1.68.78z"})}),"加入 Telegram 群聊"]})]})]})})};var dr=s=>s.type==="checkbox",ds=s=>s instanceof Date,tt=s=>s==null;const rl=s=>typeof s=="object";var Ie=s=>!tt(s)&&!Array.isArray(s)&&rl(s)&&!ds(s),h0=s=>Ie(s)&&s.target?dr(s.target)?s.target.checked:s.target.value:s,x0=s=>s.substring(0,s.search(/\.\d+(\.|$)/))||s,g0=(s,t)=>s.has(x0(t)),f0=s=>{const t=s.constructor&&s.constructor.prototype;return Ie(t)&&t.hasOwnProperty("isPrototypeOf")},Oa=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function qe(s){let t;const r=Array.isArray(s),a=typeof FileList<"u"?s instanceof FileList:!1;if(s instanceof Date)t=new Date(s);else if(!(Oa&&(s instanceof Blob||a))&&(r||Ie(s)))if(t=r?[]:Object.create(Object.getPrototypeOf(s)),!r&&!f0(s))t=s;else for(const n in s)s.hasOwnProperty(n)&&(t[n]=qe(s[n]));else return s;return t}var Xr=s=>/^\w*$/.test(s),Be=s=>s===void 0,Da=s=>Array.isArray(s)?s.filter(Boolean):[],Fa=s=>Da(s.replace(/["|']|\]/g,"").split(/\.|\[/)),se=(s,t,r)=>{if(!t||!Ie(s))return r;const a=(Xr(t)?[t]:Fa(t)).reduce((n,i)=>tt(n)?n:n[i],s);return Be(a)||a===s?Be(s[t])?r:s[t]:a},St=s=>typeof s=="boolean",Se=(s,t,r)=>{let a=-1;const n=Xr(t)?[t]:Fa(t),i=n.length,l=i-1;for(;++a<i;){const o=n[a];let c=r;if(a!==l){const d=s[o];c=Ie(d)||Array.isArray(d)?d:isNaN(+n[a+1])?{}:[]}if(o==="__proto__"||o==="constructor"||o==="prototype")return;s[o]=c,s=s[o]}};const yn={BLUR:"blur",FOCUS_OUT:"focusout"},vt={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},$t={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},p0=ze.createContext(null);p0.displayName="HookFormContext";var y0=(s,t,r,a=!0)=>{const n={defaultValues:t._defaultValues};for(const i in s)Object.defineProperty(n,i,{get:()=>{const l=i;return t._proxyFormState[l]!==vt.all&&(t._proxyFormState[l]=!a||vt.all),s[l]}});return n};const b0=typeof window<"u"?ze.useLayoutEffect:ze.useEffect;var Et=s=>typeof s=="string",v0=(s,t,r,a,n)=>Et(s)?(a&&t.watch.add(s),se(r,s,n)):Array.isArray(s)?s.map(i=>(a&&t.watch.add(i),se(r,i))):(a&&(t.watchAll=!0),r),wa=s=>tt(s)||!rl(s);function Zt(s,t,r=new WeakSet){if(wa(s)||wa(t))return s===t;if(ds(s)&&ds(t))return s.getTime()===t.getTime();const a=Object.keys(s),n=Object.keys(t);if(a.length!==n.length)return!1;if(r.has(s)||r.has(t))return!0;r.add(s),r.add(t);for(const i of a){const l=s[i];if(!n.includes(i))return!1;if(i!=="ref"){const o=t[i];if(ds(l)&&ds(o)||Ie(l)&&Ie(o)||Array.isArray(l)&&Array.isArray(o)?!Zt(l,o,r):l!==o)return!1}}return!0}var al=(s,t,r,a,n)=>t?{...r[s],types:{...r[s]&&r[s].types?r[s].types:{},[a]:n||!0}}:{},qs=s=>Array.isArray(s)?s:[s],bn=()=>{let s=[];return{get observers(){return s},next:n=>{for(const i of s)i.next&&i.next(n)},subscribe:n=>(s.push(n),{unsubscribe:()=>{s=s.filter(i=>i!==n)}}),unsubscribe:()=>{s=[]}}},nt=s=>Ie(s)&&!Object.keys(s).length,za=s=>s.type==="file",jt=s=>typeof s=="function",Tr=s=>{if(!Oa)return!1;const t=s?s.ownerDocument:0;return s instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},nl=s=>s.type==="select-multiple",Ua=s=>s.type==="radio",j0=s=>Ua(s)||dr(s),ia=s=>Tr(s)&&s.isConnected;function N0(s,t){const r=t.slice(0,-1).length;let a=0;for(;a<r;)s=Be(s)?a++:s[t[a++]];return s}function w0(s){for(const t in s)if(s.hasOwnProperty(t)&&!Be(s[t]))return!1;return!0}function Pe(s,t){const r=Array.isArray(t)?t:Xr(t)?[t]:Fa(t),a=r.length===1?s:N0(s,r),n=r.length-1,i=r[n];return a&&delete a[i],n!==0&&(Ie(a)&&nt(a)||Array.isArray(a)&&w0(a))&&Pe(s,r.slice(0,-1)),s}var il=s=>{for(const t in s)if(jt(s[t]))return!0;return!1};function Er(s,t={}){const r=Array.isArray(s);if(Ie(s)||r)for(const a in s)Array.isArray(s[a])||Ie(s[a])&&!il(s[a])?(t[a]=Array.isArray(s[a])?[]:{},Er(s[a],t[a])):tt(s[a])||(t[a]=!0);return t}function ll(s,t,r){const a=Array.isArray(s);if(Ie(s)||a)for(const n in s)Array.isArray(s[n])||Ie(s[n])&&!il(s[n])?Be(t)||wa(r[n])?r[n]=Array.isArray(s[n])?Er(s[n],[]):{...Er(s[n])}:ll(s[n],tt(t)?{}:t[n],r[n]):r[n]=!Zt(s[n],t[n]);return r}var Us=(s,t)=>ll(s,t,Er(t));const vn={value:!1,isValid:!1},jn={value:!0,isValid:!0};var ol=s=>{if(Array.isArray(s)){if(s.length>1){const t=s.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return s[0].checked&&!s[0].disabled?s[0].attributes&&!Be(s[0].attributes.value)?Be(s[0].value)||s[0].value===""?jn:{value:s[0].value,isValid:!0}:jn:vn}return vn},cl=(s,{valueAsNumber:t,valueAsDate:r,setValueAs:a})=>Be(s)?s:t?s===""?NaN:s&&+s:r&&Et(s)?new Date(s):a?a(s):s;const Nn={isValid:!1,value:null};var dl=s=>Array.isArray(s)?s.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,Nn):Nn;function wn(s){const t=s.ref;return za(t)?t.files:Ua(t)?dl(s.refs).value:nl(t)?[...t.selectedOptions].map(({value:r})=>r):dr(t)?ol(s.refs).value:cl(Be(t.value)?s.ref.value:t.value,s)}var k0=(s,t,r,a)=>{const n={};for(const i of s){const l=se(t,i);l&&Se(n,i,l._f)}return{criteriaMode:r,names:[...s],fields:n,shouldUseNativeValidation:a}},Mr=s=>s instanceof RegExp,Ws=s=>Be(s)?s:Mr(s)?s.source:Ie(s)?Mr(s.value)?s.value.source:s.value:s,kn=s=>({isOnSubmit:!s||s===vt.onSubmit,isOnBlur:s===vt.onBlur,isOnChange:s===vt.onChange,isOnAll:s===vt.all,isOnTouch:s===vt.onTouched});const _n="AsyncFunction";var _0=s=>!!s&&!!s.validate&&!!(jt(s.validate)&&s.validate.constructor.name===_n||Ie(s.validate)&&Object.values(s.validate).find(t=>t.constructor.name===_n)),S0=s=>s.mount&&(s.required||s.min||s.max||s.maxLength||s.minLength||s.pattern||s.validate),Sn=(s,t,r)=>!r&&(t.watchAll||t.watch.has(s)||[...t.watch].some(a=>s.startsWith(a)&&/^\.\w+/.test(s.slice(a.length))));const Zs=(s,t,r,a)=>{for(const n of r||Object.keys(s)){const i=se(s,n);if(i){const{_f:l,...o}=i;if(l){if(l.refs&&l.refs[0]&&t(l.refs[0],n)&&!a)return!0;if(l.ref&&t(l.ref,l.name)&&!a)return!0;if(Zs(o,t))break}else if(Ie(o)&&Zs(o,t))break}}};function Cn(s,t,r){const a=se(s,r);if(a||Xr(r))return{error:a,name:r};const n=r.split(".");for(;n.length;){const i=n.join("."),l=se(t,i),o=se(s,i);if(l&&!Array.isArray(l)&&r!==i)return{name:r};if(o&&o.type)return{name:i,error:o};if(o&&o.root&&o.root.type)return{name:`${i}.root`,error:o.root};n.pop()}return{name:r}}var C0=(s,t,r,a)=>{r(s);const{name:n,...i}=s;return nt(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(l=>t[l]===(!a||vt.all))},A0=(s,t,r)=>!s||!t||s===t||qs(s).some(a=>a&&(r?a===t:a.startsWith(t)||t.startsWith(a))),L0=(s,t,r,a,n)=>n.isOnAll?!1:!r&&n.isOnTouch?!(t||s):(r?a.isOnBlur:n.isOnBlur)?!s:(r?a.isOnChange:n.isOnChange)?s:!0,T0=(s,t)=>!Da(se(s,t)).length&&Pe(s,t),E0=(s,t,r)=>{const a=qs(se(s,r));return Se(a,"root",t[r]),Se(s,r,a),s},kr=s=>Et(s);function An(s,t,r="validate"){if(kr(s)||Array.isArray(s)&&s.every(kr)||St(s)&&!s)return{type:r,message:kr(s)?s:"",ref:t}}var vs=s=>Ie(s)&&!Mr(s)?s:{value:s,message:""},Ln=async(s,t,r,a,n,i)=>{const{ref:l,refs:o,required:c,maxLength:d,minLength:u,min:m,max:w,pattern:x,validate:b,name:g,valueAsNumber:N,mount:v}=s._f,L=se(r,g);if(!v||t.has(g))return{};const _=o?o[0]:l,E=X=>{n&&_.reportValidity&&(_.setCustomValidity(St(X)?"":X||""),_.reportValidity())},A={},p=Ua(l),k=dr(l),C=p||k,W=(N||za(l))&&Be(l.value)&&Be(L)||Tr(l)&&l.value===""||L===""||Array.isArray(L)&&!L.length,re=al.bind(null,g,a,A),Y=(X,I,ie,Q=$t.maxLength,xe=$t.minLength)=>{const T=X?I:ie;A[g]={type:X?Q:xe,message:T,ref:l,...re(X?Q:xe,T)}};if(i?!Array.isArray(L)||!L.length:c&&(!C&&(W||tt(L))||St(L)&&!L||k&&!ol(o).isValid||p&&!dl(o).isValid)){const{value:X,message:I}=kr(c)?{value:!!c,message:c}:vs(c);if(X&&(A[g]={type:$t.required,message:I,ref:_,...re($t.required,I)},!a))return E(I),A}if(!W&&(!tt(m)||!tt(w))){let X,I;const ie=vs(w),Q=vs(m);if(!tt(L)&&!isNaN(L)){const xe=l.valueAsNumber||L&&+L;tt(ie.value)||(X=xe>ie.value),tt(Q.value)||(I=xe<Q.value)}else{const xe=l.valueAsDate||new Date(L),T=z=>new Date(new Date().toDateString()+" "+z),Z=l.type=="time",oe=l.type=="week";Et(ie.value)&&L&&(X=Z?T(L)>T(ie.value):oe?L>ie.value:xe>new Date(ie.value)),Et(Q.value)&&L&&(I=Z?T(L)<T(Q.value):oe?L<Q.value:xe<new Date(Q.value))}if((X||I)&&(Y(!!X,ie.message,Q.message,$t.max,$t.min),!a))return E(A[g].message),A}if((d||u)&&!W&&(Et(L)||i&&Array.isArray(L))){const X=vs(d),I=vs(u),ie=!tt(X.value)&&L.length>+X.value,Q=!tt(I.value)&&L.length<+I.value;if((ie||Q)&&(Y(ie,X.message,I.message),!a))return E(A[g].message),A}if(x&&!W&&Et(L)){const{value:X,message:I}=vs(x);if(Mr(X)&&!L.match(X)&&(A[g]={type:$t.pattern,message:I,ref:l,...re($t.pattern,I)},!a))return E(I),A}if(b){if(jt(b)){const X=await b(L,r),I=An(X,_);if(I&&(A[g]={...I,...re($t.validate,I.message)},!a))return E(I.message),A}else if(Ie(b)){let X={};for(const I in b){if(!nt(X)&&!a)break;const ie=An(await b[I](L,r),_,I);ie&&(X={...ie,...re(I,ie.message)},E(ie.message),a&&(A[g]=X))}if(!nt(X)&&(A[g]={ref:_,...X},!a))return A}}return E(!0),A};const M0={mode:vt.onSubmit,reValidateMode:vt.onChange,shouldFocusError:!0};function I0(s={}){let t={...M0,...s},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:jt(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},a={},n=Ie(t.defaultValues)||Ie(t.values)?qe(t.defaultValues||t.values)||{}:{},i=t.shouldUnregister?{}:qe(n),l={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let m={...u};const w={array:bn(),state:bn()},x=t.criteriaMode===vt.all,b=j=>h=>{clearTimeout(d),d=setTimeout(j,h)},g=async j=>{if(!t.disabled&&(u.isValid||m.isValid||j)){const h=t.resolver?nt((await k()).errors):await W(a,!0);h!==r.isValid&&w.state.next({isValid:h})}},N=(j,h)=>{!t.disabled&&(u.isValidating||u.validatingFields||m.isValidating||m.validatingFields)&&((j||Array.from(o.mount)).forEach(S=>{S&&(h?Se(r.validatingFields,S,h):Pe(r.validatingFields,S))}),w.state.next({validatingFields:r.validatingFields,isValidating:!nt(r.validatingFields)}))},v=(j,h=[],S,O,$=!0,F=!0)=>{if(O&&S&&!t.disabled){if(l.action=!0,F&&Array.isArray(se(a,j))){const V=S(se(a,j),O.argA,O.argB);$&&Se(a,j,V)}if(F&&Array.isArray(se(r.errors,j))){const V=S(se(r.errors,j),O.argA,O.argB);$&&Se(r.errors,j,V),T0(r.errors,j)}if((u.touchedFields||m.touchedFields)&&F&&Array.isArray(se(r.touchedFields,j))){const V=S(se(r.touchedFields,j),O.argA,O.argB);$&&Se(r.touchedFields,j,V)}(u.dirtyFields||m.dirtyFields)&&(r.dirtyFields=Us(n,i)),w.state.next({name:j,isDirty:Y(j,h),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Se(i,j,h)},L=(j,h)=>{Se(r.errors,j,h),w.state.next({errors:r.errors})},_=j=>{r.errors=j,w.state.next({errors:r.errors,isValid:!1})},E=(j,h,S,O)=>{const $=se(a,j);if($){const F=se(i,j,Be(S)?se(n,j):S);Be(F)||O&&O.defaultChecked||h?Se(i,j,h?F:wn($._f)):ie(j,F),l.mount&&g()}},A=(j,h,S,O,$)=>{let F=!1,V=!1;const J={name:j};if(!t.disabled){if(!S||O){(u.isDirty||m.isDirty)&&(V=r.isDirty,r.isDirty=J.isDirty=Y(),F=V!==J.isDirty);const ae=Zt(se(n,j),h);V=!!se(r.dirtyFields,j),ae?Pe(r.dirtyFields,j):Se(r.dirtyFields,j,!0),J.dirtyFields=r.dirtyFields,F=F||(u.dirtyFields||m.dirtyFields)&&V!==!ae}if(S){const ae=se(r.touchedFields,j);ae||(Se(r.touchedFields,j,S),J.touchedFields=r.touchedFields,F=F||(u.touchedFields||m.touchedFields)&&ae!==S)}F&&$&&w.state.next(J)}return F?J:{}},p=(j,h,S,O)=>{const $=se(r.errors,j),F=(u.isValid||m.isValid)&&St(h)&&r.isValid!==h;if(t.delayError&&S?(c=b(()=>L(j,S)),c(t.delayError)):(clearTimeout(d),c=null,S?Se(r.errors,j,S):Pe(r.errors,j)),(S?!Zt($,S):$)||!nt(O)||F){const V={...O,...F&&St(h)?{isValid:h}:{},errors:r.errors,name:j};r={...r,...V},w.state.next(V)}},k=async j=>{N(j,!0);const h=await t.resolver(i,t.context,k0(j||o.mount,a,t.criteriaMode,t.shouldUseNativeValidation));return N(j),h},C=async j=>{const{errors:h}=await k(j);if(j)for(const S of j){const O=se(h,S);O?Se(r.errors,S,O):Pe(r.errors,S)}else r.errors=h;return h},W=async(j,h,S={valid:!0})=>{for(const O in j){const $=j[O];if($){const{_f:F,...V}=$;if(F){const J=o.array.has(F.name),ae=$._f&&_0($._f);ae&&u.validatingFields&&N([O],!0);const ee=await Ln($,o.disabled,i,x,t.shouldUseNativeValidation&&!h,J);if(ae&&u.validatingFields&&N([O]),ee[F.name]&&(S.valid=!1,h))break;!h&&(se(ee,F.name)?J?E0(r.errors,ee,F.name):Se(r.errors,F.name,ee[F.name]):Pe(r.errors,F.name))}!nt(V)&&await W(V,h,S)}}return S.valid},re=()=>{for(const j of o.unMount){const h=se(a,j);h&&(h._f.refs?h._f.refs.every(S=>!ia(S)):!ia(h._f.ref))&&ye(j)}o.unMount=new Set},Y=(j,h)=>!t.disabled&&(j&&h&&Se(i,j,h),!Zt(z(),n)),X=(j,h,S)=>v0(j,o,{...l.mount?i:Be(h)?n:Et(j)?{[j]:h}:h},S,h),I=j=>Da(se(l.mount?i:n,j,t.shouldUnregister?se(n,j,[]):[])),ie=(j,h,S={})=>{const O=se(a,j);let $=h;if(O){const F=O._f;F&&(!F.disabled&&Se(i,j,cl(h,F)),$=Tr(F.ref)&&tt(h)?"":h,nl(F.ref)?[...F.ref.options].forEach(V=>V.selected=$.includes(V.value)):F.refs?dr(F.ref)?F.refs.forEach(V=>{(!V.defaultChecked||!V.disabled)&&(Array.isArray($)?V.checked=!!$.find(J=>J===V.value):V.checked=$===V.value||!!$)}):F.refs.forEach(V=>V.checked=V.value===$):za(F.ref)?F.ref.value="":(F.ref.value=$,F.ref.type||w.state.next({name:j,values:qe(i)})))}(S.shouldDirty||S.shouldTouch)&&A(j,$,S.shouldTouch,S.shouldDirty,!0),S.shouldValidate&&oe(j)},Q=(j,h,S)=>{for(const O in h){if(!h.hasOwnProperty(O))return;const $=h[O],F=j+"."+O,V=se(a,F);(o.array.has(j)||Ie($)||V&&!V._f)&&!ds($)?Q(F,$,S):ie(F,$,S)}},xe=(j,h,S={})=>{const O=se(a,j),$=o.array.has(j),F=qe(h);Se(i,j,F),$?(w.array.next({name:j,values:qe(i)}),(u.isDirty||u.dirtyFields||m.isDirty||m.dirtyFields)&&S.shouldDirty&&w.state.next({name:j,dirtyFields:Us(n,i),isDirty:Y(j,F)})):O&&!O._f&&!tt(F)?Q(j,F,S):ie(j,F,S),Sn(j,o)&&w.state.next({...r,name:j}),w.state.next({name:l.mount?j:void 0,values:qe(i)})},T=async j=>{l.mount=!0;const h=j.target;let S=h.name,O=!0;const $=se(a,S),F=ae=>{O=Number.isNaN(ae)||ds(ae)&&isNaN(ae.getTime())||Zt(ae,se(i,S,ae))},V=kn(t.mode),J=kn(t.reValidateMode);if($){let ae,ee;const f=h.type?wn($._f):h0(j),B=j.type===yn.BLUR||j.type===yn.FOCUS_OUT,be=!S0($._f)&&!t.resolver&&!se(r.errors,S)&&!$._f.deps||L0(B,se(r.touchedFields,S),r.isSubmitted,J,V),Te=Sn(S,o,B);Se(i,S,f),B?(!h||!h.readOnly)&&($._f.onBlur&&$._f.onBlur(j),c&&c(0)):$._f.onChange&&$._f.onChange(j);const Oe=A(S,f,B),Fs=!nt(Oe)||Te;if(!B&&w.state.next({name:S,type:j.type,values:qe(i)}),be)return(u.isValid||m.isValid)&&(t.mode==="onBlur"?B&&g():B||g()),Fs&&w.state.next({name:S,...Te?{}:Oe});if(!B&&Te&&w.state.next({...r}),t.resolver){const{errors:ls}=await k([S]);if(F(f),O){const bs=Cn(r.errors,a,S),Yr=Cn(ls,a,bs.name||S);ae=Yr.error,S=Yr.name,ee=nt(ls)}}else N([S],!0),ae=(await Ln($,o.disabled,i,x,t.shouldUseNativeValidation))[S],N([S]),F(f),O&&(ae?ee=!1:(u.isValid||m.isValid)&&(ee=await W(a,!0)));O&&($._f.deps&&oe($._f.deps),p(S,ee,ae,Oe))}},Z=(j,h)=>{if(se(r.errors,h)&&j.focus)return j.focus(),1},oe=async(j,h={})=>{let S,O;const $=qs(j);if(t.resolver){const F=await C(Be(j)?j:$);S=nt(F),O=j?!$.some(V=>se(F,V)):S}else j?(O=(await Promise.all($.map(async F=>{const V=se(a,F);return await W(V&&V._f?{[F]:V}:V)}))).every(Boolean),!(!O&&!r.isValid)&&g()):O=S=await W(a);return w.state.next({...!Et(j)||(u.isValid||m.isValid)&&S!==r.isValid?{}:{name:j},...t.resolver||!j?{isValid:S}:{},errors:r.errors}),h.shouldFocus&&!O&&Zs(a,Z,j?$:o.mount),O},z=j=>{const h={...l.mount?i:n};return Be(j)?h:Et(j)?se(h,j):j.map(S=>se(h,S))},D=(j,h)=>({invalid:!!se((h||r).errors,j),isDirty:!!se((h||r).dirtyFields,j),error:se((h||r).errors,j),isValidating:!!se(r.validatingFields,j),isTouched:!!se((h||r).touchedFields,j)}),ue=j=>{j&&qs(j).forEach(h=>Pe(r.errors,h)),w.state.next({errors:j?r.errors:{}})},_e=(j,h,S)=>{const O=(se(a,j,{_f:{}})._f||{}).ref,$=se(r.errors,j)||{},{ref:F,message:V,type:J,...ae}=$;Se(r.errors,j,{...ae,...h,ref:O}),w.state.next({name:j,errors:r.errors,isValid:!1}),S&&S.shouldFocus&&O&&O.focus&&O.focus()},rt=(j,h)=>jt(j)?w.state.subscribe({next:S=>"values"in S&&j(X(void 0,h),S)}):X(j,h,!0),fe=j=>w.state.subscribe({next:h=>{A0(j.name,h.name,j.exact)&&C0(h,j.formState||u,at,j.reRenderRoot)&&j.callback({values:{...i},...r,...h,defaultValues:n})}}).unsubscribe,We=j=>(l.mount=!0,m={...m,...j.formState},fe({...j,formState:m})),ye=(j,h={})=>{for(const S of j?qs(j):o.mount)o.mount.delete(S),o.array.delete(S),h.keepValue||(Pe(a,S),Pe(i,S)),!h.keepError&&Pe(r.errors,S),!h.keepDirty&&Pe(r.dirtyFields,S),!h.keepTouched&&Pe(r.touchedFields,S),!h.keepIsValidating&&Pe(r.validatingFields,S),!t.shouldUnregister&&!h.keepDefaultValue&&Pe(n,S);w.state.next({values:qe(i)}),w.state.next({...r,...h.keepDirty?{isDirty:Y()}:{}}),!h.keepIsValid&&g()},ce=({disabled:j,name:h})=>{(St(j)&&l.mount||j||o.disabled.has(h))&&(j?o.disabled.add(h):o.disabled.delete(h))},Ce=(j,h={})=>{let S=se(a,j);const O=St(h.disabled)||St(t.disabled);return Se(a,j,{...S||{},_f:{...S&&S._f?S._f:{ref:{name:j}},name:j,mount:!0,...h}}),o.mount.add(j),S?ce({disabled:St(h.disabled)?h.disabled:t.disabled,name:j}):E(j,!0,h.value),{...O?{disabled:h.disabled||t.disabled}:{},...t.progressive?{required:!!h.required,min:Ws(h.min),max:Ws(h.max),minLength:Ws(h.minLength),maxLength:Ws(h.maxLength),pattern:Ws(h.pattern)}:{},name:j,onChange:T,onBlur:T,ref:$=>{if($){Ce(j,h),S=se(a,j);const F=Be($.value)&&$.querySelectorAll&&$.querySelectorAll("input,select,textarea")[0]||$,V=j0(F),J=S._f.refs||[];if(V?J.find(ae=>ae===F):F===S._f.ref)return;Se(a,j,{_f:{...S._f,...V?{refs:[...J.filter(ia),F,...Array.isArray(se(n,j))?[{}]:[]],ref:{type:F.type,name:j}}:{ref:F}}}),E(j,!1,void 0,F)}else S=se(a,j,{}),S._f&&(S._f.mount=!1),(t.shouldUnregister||h.shouldUnregister)&&!(g0(o.array,j)&&l.action)&&o.unMount.add(j)}}},Ge=()=>t.shouldFocusError&&Zs(a,Z,o.mount),Ut=j=>{St(j)&&(w.state.next({disabled:j}),Zs(a,(h,S)=>{const O=se(a,S);O&&(h.disabled=O._f.disabled||j,Array.isArray(O._f.refs)&&O._f.refs.forEach($=>{$.disabled=O._f.disabled||j}))},0,!1))},wt=(j,h)=>async S=>{let O;S&&(S.preventDefault&&S.preventDefault(),S.persist&&S.persist());let $=qe(i);if(w.state.next({isSubmitting:!0}),t.resolver){const{errors:F,values:V}=await k();r.errors=F,$=qe(V)}else await W(a);if(o.disabled.size)for(const F of o.disabled)Pe($,F);if(Pe(r.errors,"root"),nt(r.errors)){w.state.next({errors:{}});try{await j($,S)}catch(F){O=F}}else h&&await h({...r.errors},S),Ge(),setTimeout(Ge);if(w.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:nt(r.errors)&&!O,submitCount:r.submitCount+1,errors:r.errors}),O)throw O},ht=(j,h={})=>{se(a,j)&&(Be(h.defaultValue)?xe(j,qe(se(n,j))):(xe(j,h.defaultValue),Se(n,j,qe(h.defaultValue))),h.keepTouched||Pe(r.touchedFields,j),h.keepDirty||(Pe(r.dirtyFields,j),r.isDirty=h.defaultValue?Y(j,qe(se(n,j))):Y()),h.keepError||(Pe(r.errors,j),u.isValid&&g()),w.state.next({...r}))},R=(j,h={})=>{const S=j?qe(j):n,O=qe(S),$=nt(j),F=$?n:O;if(h.keepDefaultValues||(n=S),!h.keepValues){if(h.keepDirtyValues){const V=new Set([...o.mount,...Object.keys(Us(n,i))]);for(const J of Array.from(V))se(r.dirtyFields,J)?Se(F,J,se(i,J)):xe(J,se(F,J))}else{if(Oa&&Be(j))for(const V of o.mount){const J=se(a,V);if(J&&J._f){const ae=Array.isArray(J._f.refs)?J._f.refs[0]:J._f.ref;if(Tr(ae)){const ee=ae.closest("form");if(ee){ee.reset();break}}}}if(h.keepFieldsRef)for(const V of o.mount)xe(V,se(F,V));else a={}}i=t.shouldUnregister?h.keepDefaultValues?qe(n):{}:qe(F),w.array.next({values:{...F}}),w.state.next({values:{...F}})}o={mount:h.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!u.isValid||!!h.keepIsValid||!!h.keepDirtyValues,l.watch=!!t.shouldUnregister,w.state.next({submitCount:h.keepSubmitCount?r.submitCount:0,isDirty:$?!1:h.keepDirty?r.isDirty:!!(h.keepDefaultValues&&!Zt(j,n)),isSubmitted:h.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:$?{}:h.keepDirtyValues?h.keepDefaultValues&&i?Us(n,i):r.dirtyFields:h.keepDefaultValues&&j?Us(n,j):h.keepDirty?r.dirtyFields:{},touchedFields:h.keepTouched?r.touchedFields:{},errors:h.keepErrors?r.errors:{},isSubmitSuccessful:h.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:n})},de=(j,h)=>R(jt(j)?j(i):j,h),Ve=(j,h={})=>{const S=se(a,j),O=S&&S._f;if(O){const $=O.refs?O.refs[0]:O.ref;$.focus&&($.focus(),h.shouldSelect&&jt($.select)&&$.select())}},at=j=>{r={...r,...j}},Ae={control:{register:Ce,unregister:ye,getFieldState:D,handleSubmit:wt,setError:_e,_subscribe:fe,_runSchema:k,_focusError:Ge,_getWatch:X,_getDirty:Y,_setValid:g,_setFieldArray:v,_setDisabledField:ce,_setErrors:_,_getFieldArray:I,_reset:R,_resetDefaultValues:()=>jt(t.defaultValues)&&t.defaultValues().then(j=>{de(j,t.resetOptions),w.state.next({isLoading:!1})}),_removeUnmounted:re,_disableForm:Ut,_subjects:w,_proxyFormState:u,get _fields(){return a},get _formValues(){return i},get _state(){return l},set _state(j){l=j},get _defaultValues(){return n},get _names(){return o},set _names(j){o=j},get _formState(){return r},get _options(){return t},set _options(j){t={...t,...j}}},subscribe:We,trigger:oe,register:Ce,handleSubmit:wt,watch:rt,setValue:xe,getValues:z,reset:de,resetField:ht,clearErrors:ue,unregister:ye,setError:_e,setFocus:Ve,getFieldState:D};return{...Ae,formControl:Ae}}function R0(s={}){const t=ze.useRef(void 0),r=ze.useRef(void 0),[a,n]=ze.useState({isDirty:!1,isValidating:!1,isLoading:jt(s.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1,isReady:!1,defaultValues:jt(s.defaultValues)?void 0:s.defaultValues});if(!t.current)if(s.formControl)t.current={...s.formControl,formState:a},s.defaultValues&&!jt(s.defaultValues)&&s.formControl.reset(s.defaultValues,s.resetOptions);else{const{formControl:l,...o}=I0(s);t.current={...o,formState:a}}const i=t.current.control;return i._options=s,b0(()=>{const l=i._subscribe({formState:i._proxyFormState,callback:()=>n({...i._formState}),reRenderRoot:!0});return n(o=>({...o,isReady:!0})),i._formState.isReady=!0,l},[i]),ze.useEffect(()=>i._disableForm(s.disabled),[i,s.disabled]),ze.useEffect(()=>{s.mode&&(i._options.mode=s.mode),s.reValidateMode&&(i._options.reValidateMode=s.reValidateMode)},[i,s.mode,s.reValidateMode]),ze.useEffect(()=>{s.errors&&(i._setErrors(s.errors),i._focusError())},[i,s.errors]),ze.useEffect(()=>{s.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,s.shouldUnregister]),ze.useEffect(()=>{if(i._proxyFormState.isDirty){const l=i._getDirty();l!==a.isDirty&&i._subjects.state.next({isDirty:l})}},[i,a.isDirty]),ze.useEffect(()=>{s.values&&!Zt(s.values,r.current)?(i._reset(s.values,{keepFieldsRef:!0,...i._options.resetOptions}),r.current=s.values,n(l=>({...l}))):i._resetDefaultValues()},[i,s.values]),ze.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),t.current.formState=y0(a,i),t.current}const Tn=(s,t,r)=>{if(s&&"reportValidity"in s){const a=se(r,t);s.setCustomValidity(a&&a.message||""),s.reportValidity()}},ul=(s,t)=>{for(const r in t.fields){const a=t.fields[r];a&&a.ref&&"reportValidity"in a.ref?Tn(a.ref,r,s):a.refs&&a.refs.forEach(n=>Tn(n,r,s))}},P0=(s,t)=>{t.shouldUseNativeValidation&&ul(s,t);const r={};for(const a in s){const n=se(t.fields,a),i=Object.assign(s[a]||{},{ref:n&&n.ref});if($0(t.names||Object.keys(s),a)){const l=Object.assign({},se(r,a));Se(l,"root",i),Se(r,a,l)}else Se(r,a,i)}return r},$0=(s,t)=>s.some(r=>r.startsWith(t+"."));var B0=function(s,t){for(var r={};s.length;){var a=s[0],n=a.code,i=a.message,l=a.path.join(".");if(!r[l])if("unionErrors"in a){var o=a.unionErrors[0].errors[0];r[l]={message:o.message,type:o.code}}else r[l]={message:i,type:n};if("unionErrors"in a&&a.unionErrors.forEach(function(u){return u.errors.forEach(function(m){return s.push(m)})}),t){var c=r[l].types,d=c&&c[a.code];r[l]=al(l,t,r,n,d?[].concat(d,a.message):a.message)}s.shift()}return r},O0=function(s,t,r){return r===void 0&&(r={}),function(a,n,i){try{return Promise.resolve(function(l,o){try{var c=Promise.resolve(s[r.mode==="sync"?"parse":"parseAsync"](a,t)).then(function(d){return i.shouldUseNativeValidation&&ul({},i),{errors:{},values:r.raw?a:d}})}catch(d){return o(d)}return c&&c.then?c.then(void 0,o):c}(0,function(l){if(function(o){return Array.isArray(o==null?void 0:o.errors)}(l))return{values:{},errors:P0(B0(l.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw l}))}catch(l){return Promise.reject(l)}}},ke;(function(s){s.assertEqual=n=>{};function t(n){}s.assertIs=t;function r(n){throw new Error}s.assertNever=r,s.arrayToEnum=n=>{const i={};for(const l of n)i[l]=l;return i},s.getValidEnumValues=n=>{const i=s.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),l={};for(const o of i)l[o]=n[o];return s.objectValues(l)},s.objectValues=n=>s.objectKeys(n).map(function(i){return n[i]}),s.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const i=[];for(const l in n)Object.prototype.hasOwnProperty.call(n,l)&&i.push(l);return i},s.find=(n,i)=>{for(const l of n)if(i(l))return l},s.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&Number.isFinite(n)&&Math.floor(n)===n;function a(n,i=" | "){return n.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}s.joinValues=a,s.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(ke||(ke={}));var En;(function(s){s.mergeShapes=(t,r)=>({...t,...r})})(En||(En={}));const ne=ke.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ht=s=>{switch(typeof s){case"undefined":return ne.undefined;case"string":return ne.string;case"number":return Number.isNaN(s)?ne.nan:ne.number;case"boolean":return ne.boolean;case"function":return ne.function;case"bigint":return ne.bigint;case"symbol":return ne.symbol;case"object":return Array.isArray(s)?ne.array:s===null?ne.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?ne.promise:typeof Map<"u"&&s instanceof Map?ne.map:typeof Set<"u"&&s instanceof Set?ne.set:typeof Date<"u"&&s instanceof Date?ne.date:ne.object;default:return ne.unknown}},G=ke.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class zt extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},a={_errors:[]},n=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(n);else if(l.code==="invalid_return_type")n(l.returnTypeError);else if(l.code==="invalid_arguments")n(l.argumentsError);else if(l.path.length===0)a._errors.push(r(l));else{let o=a,c=0;for(;c<l.path.length;){const d=l.path[c];c===l.path.length-1?(o[d]=o[d]||{_errors:[]},o[d]._errors.push(r(l))):o[d]=o[d]||{_errors:[]},o=o[d],c++}}};return n(this),a}static assert(t){if(!(t instanceof zt))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ke.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},a=[];for(const n of this.issues)if(n.path.length>0){const i=n.path[0];r[i]=r[i]||[],r[i].push(t(n))}else a.push(t(n));return{formErrors:a,fieldErrors:r}}get formErrors(){return this.flatten()}}zt.create=s=>new zt(s);const ka=(s,t)=>{let r;switch(s.code){case G.invalid_type:s.received===ne.undefined?r="Required":r=`Expected ${s.expected}, received ${s.received}`;break;case G.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(s.expected,ke.jsonStringifyReplacer)}`;break;case G.unrecognized_keys:r=`Unrecognized key(s) in object: ${ke.joinValues(s.keys,", ")}`;break;case G.invalid_union:r="Invalid input";break;case G.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ke.joinValues(s.options)}`;break;case G.invalid_enum_value:r=`Invalid enum value. Expected ${ke.joinValues(s.options)}, received '${s.received}'`;break;case G.invalid_arguments:r="Invalid function arguments";break;case G.invalid_return_type:r="Invalid function return type";break;case G.invalid_date:r="Invalid date";break;case G.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(r=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?r=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?r=`Invalid input: must end with "${s.validation.endsWith}"`:ke.assertNever(s.validation):s.validation!=="regex"?r=`Invalid ${s.validation}`:r="Invalid";break;case G.too_small:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="bigint"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:r="Invalid input";break;case G.too_big:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?r=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:r="Invalid input";break;case G.custom:r="Invalid input";break;case G.invalid_intersection_types:r="Intersection results could not be merged";break;case G.not_multiple_of:r=`Number must be a multiple of ${s.multipleOf}`;break;case G.not_finite:r="Number must be finite";break;default:r=t.defaultError,ke.assertNever(s)}return{message:r}};let D0=ka;function F0(){return D0}const z0=s=>{const{data:t,path:r,errorMaps:a,issueData:n}=s,i=[...r,...n.path||[]],l={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let o="";const c=a.filter(d=>!!d).slice().reverse();for(const d of c)o=d(l,{data:t,defaultError:o}).message;return{...n,path:i,message:o}};function te(s,t){const r=F0(),a=z0({issueData:t,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,r,r===ka?void 0:ka].filter(n=>!!n)});s.common.issues.push(a)}class mt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const a=[];for(const n of r){if(n.status==="aborted")return me;n.status==="dirty"&&t.dirty(),a.push(n.value)}return{status:t.value,value:a}}static async mergeObjectAsync(t,r){const a=[];for(const n of r){const i=await n.key,l=await n.value;a.push({key:i,value:l})}return mt.mergeObjectSync(t,a)}static mergeObjectSync(t,r){const a={};for(const n of r){const{key:i,value:l}=n;if(i.status==="aborted"||l.status==="aborted")return me;i.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof l.value<"u"||n.alwaysSet)&&(a[i.value]=l.value)}return{status:t.value,value:a}}}const me=Object.freeze({status:"aborted"}),Vs=s=>({status:"dirty",value:s}),gt=s=>({status:"valid",value:s}),Mn=s=>s.status==="aborted",In=s=>s.status==="dirty",Is=s=>s.status==="valid",Ir=s=>typeof Promise<"u"&&s instanceof Promise;var le;(function(s){s.errToObj=t=>typeof t=="string"?{message:t}:t||{},s.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(le||(le={}));class ts{constructor(t,r,a,n){this._cachedPath=[],this.parent=t,this.data=r,this._path=a,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Rn=(s,t)=>{if(Is(t))return{success:!0,data:t.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new zt(s.common.issues);return this._error=r,this._error}}};function ve(s){if(!s)return{};const{errorMap:t,invalid_type_error:r,required_error:a,description:n}=s;if(t&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:n}:{errorMap:(l,o)=>{const{message:c}=s;return l.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:c??a??o.defaultError}:l.code!=="invalid_type"?{message:o.defaultError}:{message:c??r??o.defaultError}},description:n}}class Ne{get description(){return this._def.description}_getType(t){return Ht(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Ht(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new mt,ctx:{common:t.parent.common,data:t.data,parsedType:Ht(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(Ir(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const a=this.safeParse(t,r);if(a.success)return a.data;throw a.error}safeParse(t,r){const a={common:{issues:[],async:(r==null?void 0:r.async)??!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ht(t)},n=this._parseSync({data:t,path:a.path,parent:a});return Rn(a,n)}"~validate"(t){var a,n;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ht(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:r});return Is(i)?{value:i.value}:{issues:r.common.issues}}catch(i){(n=(a=i==null?void 0:i.message)==null?void 0:a.toLowerCase())!=null&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(i=>Is(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(t,r){const a=await this.safeParseAsync(t,r);if(a.success)return a.data;throw a.error}async safeParseAsync(t,r){const a={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ht(t)},n=this._parse({data:t,path:a.path,parent:a}),i=await(Ir(n)?n:Promise.resolve(n));return Rn(a,i)}refine(t,r){const a=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,i)=>{const l=t(n),o=()=>i.addIssue({code:G.custom,...a(n)});return typeof Promise<"u"&&l instanceof Promise?l.then(c=>c?!0:(o(),!1)):l?!0:(o(),!1)})}refinement(t,r){return this._refinement((a,n)=>t(a)?!0:(n.addIssue(typeof r=="function"?r(a,n):r),!1))}_refinement(t){return new Ps({schema:this,typeName:he.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return es.create(this,this._def)}nullable(){return $s.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Mt.create(this)}promise(){return Br.create(this,this._def)}or(t){return Pr.create([this,t],this._def)}and(t){return $r.create(this,t,this._def)}transform(t){return new Ps({...ve(this._def),schema:this,typeName:he.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new Sa({...ve(this._def),innerType:this,defaultValue:r,typeName:he.ZodDefault})}brand(){return new du({typeName:he.ZodBranded,type:this,...ve(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new Ca({...ve(this._def),innerType:this,catchValue:r,typeName:he.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return Wa.create(this,t)}readonly(){return Aa.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const U0=/^c[^\s-]{8,}$/i,W0=/^[0-9a-z]+$/,V0=/^[0-9A-HJKMNP-TV-Z]{26}$/i,H0=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,q0=/^[a-z0-9_-]{21}$/i,Z0=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,G0=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,K0=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,J0="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let la;const Q0=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,X0=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Y0=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,eu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,tu=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,su=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ml="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ru=new RegExp(`^${ml}$`);function hl(s){let t="[0-5]\\d";s.precision?t=`${t}\\.\\d{${s.precision}}`:s.precision==null&&(t=`${t}(\\.\\d+)?`);const r=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function au(s){return new RegExp(`^${hl(s)}$`)}function nu(s){let t=`${ml}T${hl(s)}`;const r=[];return r.push(s.local?"Z?":"Z"),s.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function iu(s,t){return!!((t==="v4"||!t)&&Q0.test(s)||(t==="v6"||!t)&&Y0.test(s))}function lu(s,t){if(!Z0.test(s))return!1;try{const[r]=s.split(".");if(!r)return!1;const a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(a));return!(typeof n!="object"||n===null||"typ"in n&&(n==null?void 0:n.typ)!=="JWT"||!n.alg||t&&n.alg!==t)}catch{return!1}}function ou(s,t){return!!((t==="v4"||!t)&&X0.test(s)||(t==="v6"||!t)&&eu.test(s))}class Yt extends Ne{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ne.string){const i=this._getOrReturnCtx(t);return te(i,{code:G.invalid_type,expected:ne.string,received:i.parsedType}),me}const a=new mt;let n;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(n=this._getOrReturnCtx(t,n),te(n,{code:G.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),a.dirty());else if(i.kind==="max")t.data.length>i.value&&(n=this._getOrReturnCtx(t,n),te(n,{code:G.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),a.dirty());else if(i.kind==="length"){const l=t.data.length>i.value,o=t.data.length<i.value;(l||o)&&(n=this._getOrReturnCtx(t,n),l?te(n,{code:G.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&te(n,{code:G.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),a.dirty())}else if(i.kind==="email")K0.test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"email",code:G.invalid_string,message:i.message}),a.dirty());else if(i.kind==="emoji")la||(la=new RegExp(J0,"u")),la.test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"emoji",code:G.invalid_string,message:i.message}),a.dirty());else if(i.kind==="uuid")H0.test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"uuid",code:G.invalid_string,message:i.message}),a.dirty());else if(i.kind==="nanoid")q0.test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"nanoid",code:G.invalid_string,message:i.message}),a.dirty());else if(i.kind==="cuid")U0.test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"cuid",code:G.invalid_string,message:i.message}),a.dirty());else if(i.kind==="cuid2")W0.test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"cuid2",code:G.invalid_string,message:i.message}),a.dirty());else if(i.kind==="ulid")V0.test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"ulid",code:G.invalid_string,message:i.message}),a.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{n=this._getOrReturnCtx(t,n),te(n,{validation:"url",code:G.invalid_string,message:i.message}),a.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"regex",code:G.invalid_string,message:i.message}),a.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(t,n),te(n,{code:G.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),a.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(n=this._getOrReturnCtx(t,n),te(n,{code:G.invalid_string,validation:{startsWith:i.value},message:i.message}),a.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(n=this._getOrReturnCtx(t,n),te(n,{code:G.invalid_string,validation:{endsWith:i.value},message:i.message}),a.dirty()):i.kind==="datetime"?nu(i).test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{code:G.invalid_string,validation:"datetime",message:i.message}),a.dirty()):i.kind==="date"?ru.test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{code:G.invalid_string,validation:"date",message:i.message}),a.dirty()):i.kind==="time"?au(i).test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{code:G.invalid_string,validation:"time",message:i.message}),a.dirty()):i.kind==="duration"?G0.test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"duration",code:G.invalid_string,message:i.message}),a.dirty()):i.kind==="ip"?iu(t.data,i.version)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"ip",code:G.invalid_string,message:i.message}),a.dirty()):i.kind==="jwt"?lu(t.data,i.alg)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"jwt",code:G.invalid_string,message:i.message}),a.dirty()):i.kind==="cidr"?ou(t.data,i.version)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"cidr",code:G.invalid_string,message:i.message}),a.dirty()):i.kind==="base64"?tu.test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"base64",code:G.invalid_string,message:i.message}),a.dirty()):i.kind==="base64url"?su.test(t.data)||(n=this._getOrReturnCtx(t,n),te(n,{validation:"base64url",code:G.invalid_string,message:i.message}),a.dirty()):ke.assertNever(i);return{status:a.value,value:t.data}}_regex(t,r,a){return this.refinement(n=>t.test(n),{validation:r,code:G.invalid_string,...le.errToObj(a)})}_addCheck(t){return new Yt({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...le.errToObj(t)})}url(t){return this._addCheck({kind:"url",...le.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...le.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...le.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...le.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...le.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...le.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...le.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...le.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...le.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...le.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...le.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...le.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...le.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...le.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...le.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...le.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...le.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...le.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...le.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...le.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...le.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...le.errToObj(r)})}nonempty(t){return this.min(1,le.errToObj(t))}trim(){return new Yt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Yt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Yt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Yt.create=s=>new Yt({checks:[],typeName:he.ZodString,coerce:(s==null?void 0:s.coerce)??!1,...ve(s)});function cu(s,t){const r=(s.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,n=r>a?r:a,i=Number.parseInt(s.toFixed(n).replace(".","")),l=Number.parseInt(t.toFixed(n).replace(".",""));return i%l/10**n}class Ys extends Ne{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ne.number){const i=this._getOrReturnCtx(t);return te(i,{code:G.invalid_type,expected:ne.number,received:i.parsedType}),me}let a;const n=new mt;for(const i of this._def.checks)i.kind==="int"?ke.isInteger(t.data)||(a=this._getOrReturnCtx(t,a),te(a,{code:G.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(a=this._getOrReturnCtx(t,a),te(a,{code:G.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(a=this._getOrReturnCtx(t,a),te(a,{code:G.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?cu(t.data,i.value)!==0&&(a=this._getOrReturnCtx(t,a),te(a,{code:G.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(a=this._getOrReturnCtx(t,a),te(a,{code:G.not_finite,message:i.message}),n.dirty()):ke.assertNever(i);return{status:n.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,le.toString(r))}gt(t,r){return this.setLimit("min",t,!1,le.toString(r))}lte(t,r){return this.setLimit("max",t,!0,le.toString(r))}lt(t,r){return this.setLimit("max",t,!1,le.toString(r))}setLimit(t,r,a,n){return new Ys({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:a,message:le.toString(n)}]})}_addCheck(t){return new Ys({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:le.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:le.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:le.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:le.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:le.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:le.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:le.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:le.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:le.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ke.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return!0;a.kind==="min"?(r===null||a.value>r)&&(r=a.value):a.kind==="max"&&(t===null||a.value<t)&&(t=a.value)}return Number.isFinite(r)&&Number.isFinite(t)}}Ys.create=s=>new Ys({checks:[],typeName:he.ZodNumber,coerce:(s==null?void 0:s.coerce)||!1,...ve(s)});class er extends Ne{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==ne.bigint)return this._getInvalidInput(t);let a;const n=new mt;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(a=this._getOrReturnCtx(t,a),te(a,{code:G.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(a=this._getOrReturnCtx(t,a),te(a,{code:G.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(a=this._getOrReturnCtx(t,a),te(a,{code:G.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):ke.assertNever(i);return{status:n.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return te(r,{code:G.invalid_type,expected:ne.bigint,received:r.parsedType}),me}gte(t,r){return this.setLimit("min",t,!0,le.toString(r))}gt(t,r){return this.setLimit("min",t,!1,le.toString(r))}lte(t,r){return this.setLimit("max",t,!0,le.toString(r))}lt(t,r){return this.setLimit("max",t,!1,le.toString(r))}setLimit(t,r,a,n){return new er({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:a,message:le.toString(n)}]})}_addCheck(t){return new er({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:le.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:le.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:le.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:le.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:le.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}er.create=s=>new er({checks:[],typeName:he.ZodBigInt,coerce:(s==null?void 0:s.coerce)??!1,...ve(s)});class Pn extends Ne{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==ne.boolean){const a=this._getOrReturnCtx(t);return te(a,{code:G.invalid_type,expected:ne.boolean,received:a.parsedType}),me}return gt(t.data)}}Pn.create=s=>new Pn({typeName:he.ZodBoolean,coerce:(s==null?void 0:s.coerce)||!1,...ve(s)});class Rr extends Ne{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ne.date){const i=this._getOrReturnCtx(t);return te(i,{code:G.invalid_type,expected:ne.date,received:i.parsedType}),me}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return te(i,{code:G.invalid_date}),me}const a=new mt;let n;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(n=this._getOrReturnCtx(t,n),te(n,{code:G.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),a.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(n=this._getOrReturnCtx(t,n),te(n,{code:G.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),a.dirty()):ke.assertNever(i);return{status:a.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Rr({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:le.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:le.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}Rr.create=s=>new Rr({checks:[],coerce:(s==null?void 0:s.coerce)||!1,typeName:he.ZodDate,...ve(s)});class $n extends Ne{_parse(t){if(this._getType(t)!==ne.symbol){const a=this._getOrReturnCtx(t);return te(a,{code:G.invalid_type,expected:ne.symbol,received:a.parsedType}),me}return gt(t.data)}}$n.create=s=>new $n({typeName:he.ZodSymbol,...ve(s)});class Bn extends Ne{_parse(t){if(this._getType(t)!==ne.undefined){const a=this._getOrReturnCtx(t);return te(a,{code:G.invalid_type,expected:ne.undefined,received:a.parsedType}),me}return gt(t.data)}}Bn.create=s=>new Bn({typeName:he.ZodUndefined,...ve(s)});class On extends Ne{_parse(t){if(this._getType(t)!==ne.null){const a=this._getOrReturnCtx(t);return te(a,{code:G.invalid_type,expected:ne.null,received:a.parsedType}),me}return gt(t.data)}}On.create=s=>new On({typeName:he.ZodNull,...ve(s)});class Dn extends Ne{constructor(){super(...arguments),this._any=!0}_parse(t){return gt(t.data)}}Dn.create=s=>new Dn({typeName:he.ZodAny,...ve(s)});class Fn extends Ne{constructor(){super(...arguments),this._unknown=!0}_parse(t){return gt(t.data)}}Fn.create=s=>new Fn({typeName:he.ZodUnknown,...ve(s)});class ss extends Ne{_parse(t){const r=this._getOrReturnCtx(t);return te(r,{code:G.invalid_type,expected:ne.never,received:r.parsedType}),me}}ss.create=s=>new ss({typeName:he.ZodNever,...ve(s)});class zn extends Ne{_parse(t){if(this._getType(t)!==ne.undefined){const a=this._getOrReturnCtx(t);return te(a,{code:G.invalid_type,expected:ne.void,received:a.parsedType}),me}return gt(t.data)}}zn.create=s=>new zn({typeName:he.ZodVoid,...ve(s)});class Mt extends Ne{_parse(t){const{ctx:r,status:a}=this._processInputParams(t),n=this._def;if(r.parsedType!==ne.array)return te(r,{code:G.invalid_type,expected:ne.array,received:r.parsedType}),me;if(n.exactLength!==null){const l=r.data.length>n.exactLength.value,o=r.data.length<n.exactLength.value;(l||o)&&(te(r,{code:l?G.too_big:G.too_small,minimum:o?n.exactLength.value:void 0,maximum:l?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),a.dirty())}if(n.minLength!==null&&r.data.length<n.minLength.value&&(te(r,{code:G.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),a.dirty()),n.maxLength!==null&&r.data.length>n.maxLength.value&&(te(r,{code:G.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),a.dirty()),r.common.async)return Promise.all([...r.data].map((l,o)=>n.type._parseAsync(new ts(r,l,r.path,o)))).then(l=>mt.mergeArray(a,l));const i=[...r.data].map((l,o)=>n.type._parseSync(new ts(r,l,r.path,o)));return mt.mergeArray(a,i)}get element(){return this._def.type}min(t,r){return new Mt({...this._def,minLength:{value:t,message:le.toString(r)}})}max(t,r){return new Mt({...this._def,maxLength:{value:t,message:le.toString(r)}})}length(t,r){return new Mt({...this._def,exactLength:{value:t,message:le.toString(r)}})}nonempty(t){return this.min(1,t)}}Mt.create=(s,t)=>new Mt({type:s,minLength:null,maxLength:null,exactLength:null,typeName:he.ZodArray,...ve(t)});function js(s){if(s instanceof $e){const t={};for(const r in s.shape){const a=s.shape[r];t[r]=es.create(js(a))}return new $e({...s._def,shape:()=>t})}else return s instanceof Mt?new Mt({...s._def,type:js(s.element)}):s instanceof es?es.create(js(s.unwrap())):s instanceof $s?$s.create(js(s.unwrap())):s instanceof ys?ys.create(s.items.map(t=>js(t))):s}class $e extends Ne{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=ke.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==ne.object){const d=this._getOrReturnCtx(t);return te(d,{code:G.invalid_type,expected:ne.object,received:d.parsedType}),me}const{status:a,ctx:n}=this._processInputParams(t),{shape:i,keys:l}=this._getCached(),o=[];if(!(this._def.catchall instanceof ss&&this._def.unknownKeys==="strip"))for(const d in n.data)l.includes(d)||o.push(d);const c=[];for(const d of l){const u=i[d],m=n.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new ts(n,m,n.path,d)),alwaysSet:d in n.data})}if(this._def.catchall instanceof ss){const d=this._def.unknownKeys;if(d==="passthrough")for(const u of o)c.push({key:{status:"valid",value:u},value:{status:"valid",value:n.data[u]}});else if(d==="strict")o.length>0&&(te(n,{code:G.unrecognized_keys,keys:o}),a.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const u of o){const m=n.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new ts(n,m,n.path,u)),alwaysSet:u in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const d=[];for(const u of c){const m=await u.key,w=await u.value;d.push({key:m,value:w,alwaysSet:u.alwaysSet})}return d}).then(d=>mt.mergeObjectSync(a,d)):mt.mergeObjectSync(a,c)}get shape(){return this._def.shape()}strict(t){return le.errToObj,new $e({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,a)=>{var i,l;const n=((l=(i=this._def).errorMap)==null?void 0:l.call(i,r,a).message)??a.defaultError;return r.code==="unrecognized_keys"?{message:le.errToObj(t).message??n}:{message:n}}}:{}})}strip(){return new $e({...this._def,unknownKeys:"strip"})}passthrough(){return new $e({...this._def,unknownKeys:"passthrough"})}extend(t){return new $e({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new $e({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:he.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new $e({...this._def,catchall:t})}pick(t){const r={};for(const a of ke.objectKeys(t))t[a]&&this.shape[a]&&(r[a]=this.shape[a]);return new $e({...this._def,shape:()=>r})}omit(t){const r={};for(const a of ke.objectKeys(this.shape))t[a]||(r[a]=this.shape[a]);return new $e({...this._def,shape:()=>r})}deepPartial(){return js(this)}partial(t){const r={};for(const a of ke.objectKeys(this.shape)){const n=this.shape[a];t&&!t[a]?r[a]=n:r[a]=n.optional()}return new $e({...this._def,shape:()=>r})}required(t){const r={};for(const a of ke.objectKeys(this.shape))if(t&&!t[a])r[a]=this.shape[a];else{let i=this.shape[a];for(;i instanceof es;)i=i._def.innerType;r[a]=i}return new $e({...this._def,shape:()=>r})}keyof(){return xl(ke.objectKeys(this.shape))}}$e.create=(s,t)=>new $e({shape:()=>s,unknownKeys:"strip",catchall:ss.create(),typeName:he.ZodObject,...ve(t)});$e.strictCreate=(s,t)=>new $e({shape:()=>s,unknownKeys:"strict",catchall:ss.create(),typeName:he.ZodObject,...ve(t)});$e.lazycreate=(s,t)=>new $e({shape:s,unknownKeys:"strip",catchall:ss.create(),typeName:he.ZodObject,...ve(t)});class Pr extends Ne{_parse(t){const{ctx:r}=this._processInputParams(t),a=this._def.options;function n(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const l=i.map(o=>new zt(o.ctx.common.issues));return te(r,{code:G.invalid_union,unionErrors:l}),me}if(r.common.async)return Promise.all(a.map(async i=>{const l={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:l}),ctx:l}})).then(n);{let i;const l=[];for(const c of a){const d={...r,common:{...r.common,issues:[]},parent:null},u=c._parseSync({data:r.data,path:r.path,parent:d});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:d}),d.common.issues.length&&l.push(d.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const o=l.map(c=>new zt(c));return te(r,{code:G.invalid_union,unionErrors:o}),me}}get options(){return this._def.options}}Pr.create=(s,t)=>new Pr({options:s,typeName:he.ZodUnion,...ve(t)});function _a(s,t){const r=Ht(s),a=Ht(t);if(s===t)return{valid:!0,data:s};if(r===ne.object&&a===ne.object){const n=ke.objectKeys(t),i=ke.objectKeys(s).filter(o=>n.indexOf(o)!==-1),l={...s,...t};for(const o of i){const c=_a(s[o],t[o]);if(!c.valid)return{valid:!1};l[o]=c.data}return{valid:!0,data:l}}else if(r===ne.array&&a===ne.array){if(s.length!==t.length)return{valid:!1};const n=[];for(let i=0;i<s.length;i++){const l=s[i],o=t[i],c=_a(l,o);if(!c.valid)return{valid:!1};n.push(c.data)}return{valid:!0,data:n}}else return r===ne.date&&a===ne.date&&+s==+t?{valid:!0,data:s}:{valid:!1}}class $r extends Ne{_parse(t){const{status:r,ctx:a}=this._processInputParams(t),n=(i,l)=>{if(Mn(i)||Mn(l))return me;const o=_a(i.value,l.value);return o.valid?((In(i)||In(l))&&r.dirty(),{status:r.value,value:o.data}):(te(a,{code:G.invalid_intersection_types}),me)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([i,l])=>n(i,l)):n(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}$r.create=(s,t,r)=>new $r({left:s,right:t,typeName:he.ZodIntersection,...ve(r)});class ys extends Ne{_parse(t){const{status:r,ctx:a}=this._processInputParams(t);if(a.parsedType!==ne.array)return te(a,{code:G.invalid_type,expected:ne.array,received:a.parsedType}),me;if(a.data.length<this._def.items.length)return te(a,{code:G.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),me;!this._def.rest&&a.data.length>this._def.items.length&&(te(a,{code:G.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...a.data].map((l,o)=>{const c=this._def.items[o]||this._def.rest;return c?c._parse(new ts(a,l,a.path,o)):null}).filter(l=>!!l);return a.common.async?Promise.all(i).then(l=>mt.mergeArray(r,l)):mt.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new ys({...this._def,rest:t})}}ys.create=(s,t)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ys({items:s,typeName:he.ZodTuple,rest:null,...ve(t)})};class Un extends Ne{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:a}=this._processInputParams(t);if(a.parsedType!==ne.map)return te(a,{code:G.invalid_type,expected:ne.map,received:a.parsedType}),me;const n=this._def.keyType,i=this._def.valueType,l=[...a.data.entries()].map(([o,c],d)=>({key:n._parse(new ts(a,o,a.path,[d,"key"])),value:i._parse(new ts(a,c,a.path,[d,"value"]))}));if(a.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const c of l){const d=await c.key,u=await c.value;if(d.status==="aborted"||u.status==="aborted")return me;(d.status==="dirty"||u.status==="dirty")&&r.dirty(),o.set(d.value,u.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const c of l){const d=c.key,u=c.value;if(d.status==="aborted"||u.status==="aborted")return me;(d.status==="dirty"||u.status==="dirty")&&r.dirty(),o.set(d.value,u.value)}return{status:r.value,value:o}}}}Un.create=(s,t,r)=>new Un({valueType:t,keyType:s,typeName:he.ZodMap,...ve(r)});class tr extends Ne{_parse(t){const{status:r,ctx:a}=this._processInputParams(t);if(a.parsedType!==ne.set)return te(a,{code:G.invalid_type,expected:ne.set,received:a.parsedType}),me;const n=this._def;n.minSize!==null&&a.data.size<n.minSize.value&&(te(a,{code:G.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),r.dirty()),n.maxSize!==null&&a.data.size>n.maxSize.value&&(te(a,{code:G.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),r.dirty());const i=this._def.valueType;function l(c){const d=new Set;for(const u of c){if(u.status==="aborted")return me;u.status==="dirty"&&r.dirty(),d.add(u.value)}return{status:r.value,value:d}}const o=[...a.data.values()].map((c,d)=>i._parse(new ts(a,c,a.path,d)));return a.common.async?Promise.all(o).then(c=>l(c)):l(o)}min(t,r){return new tr({...this._def,minSize:{value:t,message:le.toString(r)}})}max(t,r){return new tr({...this._def,maxSize:{value:t,message:le.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}tr.create=(s,t)=>new tr({valueType:s,minSize:null,maxSize:null,typeName:he.ZodSet,...ve(t)});class Wn extends Ne{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Wn.create=(s,t)=>new Wn({getter:s,typeName:he.ZodLazy,...ve(t)});class Vn extends Ne{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return te(r,{received:r.data,code:G.invalid_literal,expected:this._def.value}),me}return{status:"valid",value:t.data}}get value(){return this._def.value}}Vn.create=(s,t)=>new Vn({value:s,typeName:he.ZodLiteral,...ve(t)});function xl(s,t){return new Rs({values:s,typeName:he.ZodEnum,...ve(t)})}class Rs extends Ne{_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),a=this._def.values;return te(r,{expected:ke.joinValues(a),received:r.parsedType,code:G.invalid_type}),me}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const r=this._getOrReturnCtx(t),a=this._def.values;return te(r,{received:r.data,code:G.invalid_enum_value,options:a}),me}return gt(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return Rs.create(t,{...this._def,...r})}exclude(t,r=this._def){return Rs.create(this.options.filter(a=>!t.includes(a)),{...this._def,...r})}}Rs.create=xl;class Hn extends Ne{_parse(t){const r=ke.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(t);if(a.parsedType!==ne.string&&a.parsedType!==ne.number){const n=ke.objectValues(r);return te(a,{expected:ke.joinValues(n),received:a.parsedType,code:G.invalid_type}),me}if(this._cache||(this._cache=new Set(ke.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const n=ke.objectValues(r);return te(a,{received:a.data,code:G.invalid_enum_value,options:n}),me}return gt(t.data)}get enum(){return this._def.values}}Hn.create=(s,t)=>new Hn({values:s,typeName:he.ZodNativeEnum,...ve(t)});class Br extends Ne{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ne.promise&&r.common.async===!1)return te(r,{code:G.invalid_type,expected:ne.promise,received:r.parsedType}),me;const a=r.parsedType===ne.promise?r.data:Promise.resolve(r.data);return gt(a.then(n=>this._def.type.parseAsync(n,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Br.create=(s,t)=>new Br({type:s,typeName:he.ZodPromise,...ve(t)});class Ps extends Ne{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===he.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:a}=this._processInputParams(t),n=this._def.effect||null,i={addIssue:l=>{te(a,l),l.fatal?r.abort():r.dirty()},get path(){return a.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){const l=n.transform(a.data,i);if(a.common.async)return Promise.resolve(l).then(async o=>{if(r.value==="aborted")return me;const c=await this._def.schema._parseAsync({data:o,path:a.path,parent:a});return c.status==="aborted"?me:c.status==="dirty"||r.value==="dirty"?Vs(c.value):c});{if(r.value==="aborted")return me;const o=this._def.schema._parseSync({data:l,path:a.path,parent:a});return o.status==="aborted"?me:o.status==="dirty"||r.value==="dirty"?Vs(o.value):o}}if(n.type==="refinement"){const l=o=>{const c=n.refinement(o,i);if(a.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(a.common.async===!1){const o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return o.status==="aborted"?me:(o.status==="dirty"&&r.dirty(),l(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>o.status==="aborted"?me:(o.status==="dirty"&&r.dirty(),l(o.value).then(()=>({status:r.value,value:o.value}))))}if(n.type==="transform")if(a.common.async===!1){const l=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!Is(l))return me;const o=n.transform(l.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(l=>Is(l)?Promise.resolve(n.transform(l.value,i)).then(o=>({status:r.value,value:o})):me);ke.assertNever(n)}}Ps.create=(s,t,r)=>new Ps({schema:s,typeName:he.ZodEffects,effect:t,...ve(r)});Ps.createWithPreprocess=(s,t,r)=>new Ps({schema:t,effect:{type:"preprocess",transform:s},typeName:he.ZodEffects,...ve(r)});class es extends Ne{_parse(t){return this._getType(t)===ne.undefined?gt(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}es.create=(s,t)=>new es({innerType:s,typeName:he.ZodOptional,...ve(t)});class $s extends Ne{_parse(t){return this._getType(t)===ne.null?gt(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}$s.create=(s,t)=>new $s({innerType:s,typeName:he.ZodNullable,...ve(t)});class Sa extends Ne{_parse(t){const{ctx:r}=this._processInputParams(t);let a=r.data;return r.parsedType===ne.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Sa.create=(s,t)=>new Sa({innerType:s,typeName:he.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...ve(t)});class Ca extends Ne{_parse(t){const{ctx:r}=this._processInputParams(t),a={...r,common:{...r.common,issues:[]}},n=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return Ir(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new zt(a.common.issues)},input:a.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new zt(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}Ca.create=(s,t)=>new Ca({innerType:s,typeName:he.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...ve(t)});class qn extends Ne{_parse(t){if(this._getType(t)!==ne.nan){const a=this._getOrReturnCtx(t);return te(a,{code:G.invalid_type,expected:ne.nan,received:a.parsedType}),me}return{status:"valid",value:t.data}}}qn.create=s=>new qn({typeName:he.ZodNaN,...ve(s)});class du extends Ne{_parse(t){const{ctx:r}=this._processInputParams(t),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}}class Wa extends Ne{_parse(t){const{status:r,ctx:a}=this._processInputParams(t);if(a.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return i.status==="aborted"?me:i.status==="dirty"?(r.dirty(),Vs(i.value)):this._def.out._parseAsync({data:i.value,path:a.path,parent:a})})();{const n=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return n.status==="aborted"?me:n.status==="dirty"?(r.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:a.path,parent:a})}}static create(t,r){return new Wa({in:t,out:r,typeName:he.ZodPipeline})}}class Aa extends Ne{_parse(t){const r=this._def.innerType._parse(t),a=n=>(Is(n)&&(n.value=Object.freeze(n.value)),n);return Ir(r)?r.then(n=>a(n)):a(r)}unwrap(){return this._def.innerType}}Aa.create=(s,t)=>new Aa({innerType:s,typeName:he.ZodReadonly,...ve(t)});var he;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(he||(he={}));const xr=Yt.create;ss.create;Mt.create;const uu=$e.create;Pr.create;$r.create;ys.create;Rs.create;Br.create;es.create;$s.create;const mu=uu({email:xr().email("请输入有效的邮箱地址"),password:xr().min(6,"密码至少6位字符"),username:xr().min(2,"用户名至少2位字符").optional(),confirmPassword:xr().optional()}).refine(s=>s.confirmPassword!==void 0?s.password===s.confirmPassword:!0,{message:"两次输入的密码不一致",path:["confirmPassword"]}),hu=()=>{var A,p;const[s,t]=y.useState(!0),r=ot(),a=Or(),{login:n,register:i,isLoading:l}=Xe(),{theme:o,toggleTheme:c}=Qr(),{language:d,setLanguage:u,t:m}=ns(),{register:w,handleSubmit:x,formState:{errors:b},reset:g}=R0({resolver:O0(mu)}),N=((p=(A=a.state)==null?void 0:A.from)==null?void 0:p.pathname)||"/",v=async k=>{try{const C=await Xe.getState().loginWithGoogle(k.credential);C.success?(M.success("Google登录成功！"),r(N,{replace:!0})):M.error(C.message||"Google登录失败")}catch(C){console.error("Google login error:",C),M.error("Google登录出错，请重试")}},L=()=>{console.error("Google登录失败"),M.error("Google登录失败，请重试")},_=async k=>{try{let C=!1;if(s){const W=await i({username:k.username||k.email.split("@")[0],email:k.email,password:k.password,confirmPassword:k.confirmPassword||k.password});if(C=W.success,!C){M.error(W.message||"注册失败");return}}else{const W=await n({email:k.email,password:k.password});if(C=W.success,!C){M.error(W.message||"登录失败");return}}C&&(M.success(s?"注册成功！":"登录成功！"),r(N,{replace:!0}))}catch(C){console.error("Authentication error:",C),M.error("操作失败，请重试")}},E=()=>{t(!s),g()};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-8 flex items-center justify-center transition-colors",children:e.jsxs("div",{className:"w-full max-w-5xl min-h-[800px] bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 relative transition-colors",children:[e.jsxs("div",{className:"absolute top-4 right-8 flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>u("zh"),className:`px-2 py-1 text-sm rounded-md transition-colors ${d==="zh"?"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:"中"}),e.jsx("button",{onClick:()=>u("en"),className:`px-2 py-1 text-sm rounded-md transition-colors ${d==="en"?"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:"EN"})]}),e.jsx("div",{className:"border-l border-gray-300 dark:border-gray-600 h-6"}),e.jsx("button",{onClick:c,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 transition-colors",children:o==="light"?e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("path",{d:"M12 1v2M12 21v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4"})]})})]}),e.jsx("header",{className:"py-6 px-8 flex justify-center border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-9 h-9 mr-3 text-blue-600 dark:text-blue-400",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M7 12h10M12 7v10",stroke:"currentColor",strokeWidth:"2",fill:"none"})]}),e.jsx("h1",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:"Trademe"})]})}),e.jsx("main",{className:"flex flex-col items-center justify-center py-16",children:e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsx("h2",{className:"text-center text-2xl font-bold mb-8 text-gray-800 dark:text-white",children:m("accountLogin")}),e.jsx("div",{className:"mb-6",children:e.jsx(o0,{onSuccess:v,onError:L,useOneTap:!1,theme:o==="dark"?"filled_black":"outline",size:"large",width:"100%",text:s?"signup_with":"signin_with",shape:"rectangular"})}),e.jsxs("div",{className:"relative flex justify-center mb-6",children:[e.jsx("hr",{className:"w-full border-gray-300 dark:border-gray-600"}),e.jsx("span",{className:"absolute px-4 bg-white dark:bg-gray-800 -top-3 text-gray-500 dark:text-gray-400",children:m("orContinueWith")})]}),e.jsxs("form",{onSubmit:x(_),children:[s&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("username")}),e.jsx("input",{type:"text",placeholder:m("enterUsername"),...w("username"),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 dark:bg-gray-700 dark:text-white transition-colors"}),b.username&&e.jsx("p",{className:"text-red-500 dark:text-red-400 text-sm mt-1",children:b.username.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("email")}),e.jsx("input",{type:"email",placeholder:m("enterEmail"),...w("email"),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 dark:bg-gray-700 dark:text-white transition-colors"}),b.email&&e.jsx("p",{className:"text-red-500 dark:text-red-400 text-sm mt-1",children:b.email.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("password")}),e.jsx("input",{type:"password",placeholder:m("enterPassword"),...w("password"),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 dark:bg-gray-700 dark:text-white transition-colors"}),b.password&&e.jsx("p",{className:"text-red-500 dark:text-red-400 text-sm mt-1",children:b.password.message})]}),s&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("confirmPassword")}),e.jsx("input",{type:"password",placeholder:m("enterPasswordAgain"),...w("confirmPassword"),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 dark:bg-gray-700 dark:text-white transition-colors"}),b.confirmPassword&&e.jsx("p",{className:"text-red-500 dark:text-red-400 text-sm mt-1",children:b.confirmPassword.message})]}),e.jsx("button",{type:"submit",disabled:l,className:"w-full py-3 mb-6 text-white font-medium rounded-lg transition-colors disabled:opacity-50 bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700",children:m(l?"processing":s?"createAccount":"login")})]}),e.jsx("div",{className:"text-center mb-4",children:e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[m(s?"haveAccount":"noAccount"),e.jsx("button",{type:"button",onClick:E,className:"text-blue-600 dark:text-blue-400 hover:underline ml-1",children:m(s?"loginNow":"registerNow")})]})}),s&&e.jsx("div",{className:"text-center text-xs text-gray-500 dark:text-gray-400",children:e.jsxs("p",{children:[m("byRegisteringAgree"),e.jsx("a",{href:"/terms",className:"text-blue-600 dark:text-blue-400 hover:underline",children:m("termsOfService")}),m("and"),e.jsx("a",{href:"/privacy",className:"text-blue-600 dark:text-blue-400 hover:underline",children:m("privacyPolicy")})]})})]})})]})})},It=({size:s="md",color:t="primary",className:r=""})=>{const a={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"},n={primary:"text-brand-500",secondary:"text-gray-500",white:"text-white"};return e.jsx("div",{className:`inline-block ${r}`,children:e.jsxs("svg",{className:`animate-spin ${a[s]} ${n[t]}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})},dt=({variant:s="primary",size:t="md",loading:r=!1,children:a,className:n="",disabled:i,...l})=>{const o="btn",c={primary:"btn-primary",secondary:"btn-secondary",outline:"btn-outline",ghost:"btn-ghost",danger:"bg-red-500 text-white hover:bg-red-600 active:bg-red-700"},d={sm:"btn-sm",md:"btn-md",lg:"btn-lg"},u=i||r;return e.jsxs("button",{className:`
        ${o}
        ${c[s]}
        ${d[t]}
        ${u?"opacity-50 cursor-not-allowed":""}
        ${n}
      `,disabled:u,...l,children:[r&&e.jsx(It,{size:"sm",color:s==="primary"?"white":"primary",className:"mr-2"}),a]})},xu=()=>{const s=ot();return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 transition-colors",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 p-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900 dark:text-white",children:"邮箱验证"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"请检查您的邮箱以完成账户验证"})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.2a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:"我们已向您的邮箱发送了验证链接，请点击链接完成账户激活。"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"如果您没有收到邮件，请检查垃圾邮件箱或稍后重试。"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(dt,{onClick:()=>window.location.reload(),variant:"outline",className:"w-full",children:"重新发送验证邮件"}),e.jsx(dt,{onClick:()=>s("/login"),variant:"primary",className:"w-full",children:"返回登录"})]})]})})]})})},gu={async getKlineData(s,t,r="okx",a=500){try{const n=await fetch(`/klines/${s}?timeframe=${t}&limit=${a}`);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return(await n.json()).klines.map(l=>({timestamp:l[0],open:l[1],high:l[2],low:l[3],close:l[4],volume:l[5]}))}catch(n){throw console.error("获取K线数据失败:",n),n}},async getTicker(s,t="okx"){try{const r=await fetch(`/stats/${s}`);if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const a=await r.json();return{symbol:a.symbol,price:a.price,change:a.change_24h,change_percent:a.change_percent||0,high_24h:a.high_24h,low_24h:a.low_24h,volume_24h:a.volume_24h,timestamp:a.timestamp}}catch(r){throw console.error("获取价格数据失败:",r),r}},async getTickers(s,t){try{const r=await K.post("/market/tickers",{symbols:s,exchange:t});return q(r)}catch(r){H(r)}},async getOrderBook(s,t,r=20){try{const a=await K.get("/market/orderbook",{params:{symbol:s,exchange:t,depth:r}});return q(a)}catch(a){H(a)}},async getExchanges(){try{const s=await K.get("/market/exchanges");return q(s)}catch(s){H(s)}},async getTradingPairs(s){try{const t=await K.get("/market/pairs",{params:{exchange:s}});return q(t)}catch(t){H(t)}},async searchTradingPairs(s,t){try{const r=await K.get("/market/pairs/search",{params:{query:s,exchange:t}});return q(r)}catch(r){H(r)}},async getHistoricalData(s,t,r,a,n="1d"){try{const i=await K.get("/market/historical",{params:{symbol:s,exchange:t,start_date:r,end_date:a,timeframe:n}});return q(i)}catch(i){H(i)}},async getMarketStats(s){try{const t=await K.get("/market/stats",{params:{exchange:s}});return q(t)}catch(t){H(t)}},async getTechnicalIndicators(s,t,r,a,n=20){try{const i=await K.post("/market/indicators",{symbol:s,exchange:t,timeframe:r,indicators:a,period:n});return q(i)}catch(i){H(i)}}};class fu{constructor(t){Le(this,"connections",new Map);Le(this,"config");Le(this,"heartbeatTimer",null);this.config=t,this.startHeartbeat()}connect(t,r,a={},n){try{this.connections.has(t)&&this.disconnect(t);const i=`${this.config.baseUrl}${r}`,o={ws:new WebSocket(i),url:i,key:t,isActive:!1,reconnectAttempts:0,maxReconnectAttempts:this.config.maxReconnectAttempts,reconnectDelay:this.config.reconnectDelay,authToken:n,...a};return this.setupWebSocketHandlers(o),this.connections.set(t,o),console.log(`WebSocket connecting: ${t} -> ${i}`),!0}catch(i){return console.error(`Failed to create WebSocket connection for ${t}:`,i),!1}}disconnect(t){const r=this.connections.get(t);return r?(r.isActive=!1,(r.ws.readyState===WebSocket.OPEN||r.ws.readyState===WebSocket.CONNECTING)&&r.ws.close(1e3,"Manual disconnect"),this.connections.delete(t),console.log(`WebSocket disconnected: ${t}`),!0):!1}disconnectAll(){for(const t of this.connections.keys())this.disconnect(t);this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null)}send(t,r){const a=this.connections.get(t);if(!a||a.ws.readyState!==WebSocket.OPEN)return console.warn(`WebSocket not ready for sending: ${t}`),!1;try{const n=typeof r=="string"?r:JSON.stringify(r);return a.ws.send(n),!0}catch(n){return console.error(`Failed to send message to ${t}:`,n),!1}}getConnectionStatus(t){const r=this.connections.get(t);return r?{isConnected:r.ws.readyState===WebSocket.OPEN,readyState:r.ws.readyState,reconnectAttempts:r.reconnectAttempts}:{isConnected:!1,readyState:null,reconnectAttempts:0}}getAllConnectionStatus(){const t={};for(const[r]of this.connections)t[r]=this.getConnectionStatus(r);return t}setupWebSocketHandlers(t){const{ws:r}=t;r.onopen=a=>{var n;if(t.isActive=!0,t.reconnectAttempts=0,console.log(`WebSocket connected: ${t.key}`),t.authToken){const i={type:"auth",token:t.authToken};r.send(JSON.stringify(i)),console.log(`🔐 Sent auth message for connection: ${t.key}`)}(n=t.onOpen)==null||n.call(t)},r.onmessage=a=>{var n,i;try{const l=JSON.parse(a.data);(n=t.onMessage)==null||n.call(t,l)}catch(l){console.error(`Failed to parse WebSocket message from ${t.key}:`,l),(i=t.onMessage)==null||i.call(t,a.data)}},r.onerror=a=>{var n;console.error(`WebSocket error on ${t.key}:`,a),(n=t.onError)==null||n.call(t,a)},r.onclose=a=>{var n;console.log(`WebSocket closed: ${t.key}, code: ${a.code}, reason: ${a.reason}`),(n=t.onClose)==null||n.call(t),t.isActive&&t.reconnectAttempts<t.maxReconnectAttempts&&a.code!==1e3?this.scheduleReconnect(t):t.reconnectAttempts>=t.maxReconnectAttempts&&(console.warn(`Max reconnect attempts reached for ${t.key}`),this.connections.delete(t.key))}}scheduleReconnect(t){t.reconnectAttempts++;const r=t.reconnectDelay*Math.pow(2,t.reconnectAttempts-1);console.log(`Scheduling reconnect for ${t.key} in ${r}ms (attempt ${t.reconnectAttempts})`),setTimeout(()=>{if(t.isActive){console.log(`Attempting to reconnect ${t.key}...`);const a=new WebSocket(t.url);t.ws=a,this.setupWebSocketHandlers(t)}},r)}startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>{for(const[t,r]of this.connections)r.ws.readyState===WebSocket.OPEN?this.send(t,{type:"ping",timestamp:Date.now()}):r.ws.readyState===WebSocket.CLOSED&&r.isActive&&r.reconnectAttempts<r.maxReconnectAttempts&&(console.log(`Heartbeat detected closed connection, triggering reconnect: ${t}`),this.scheduleReconnect(r))},this.config.heartbeatInterval)}getStats(){const t=Array.from(this.connections.values()).map(r=>({key:r.key,url:r.url,isActive:r.isActive,readyState:this.getReadyStateString(r.ws.readyState),reconnectAttempts:r.reconnectAttempts}));return{totalConnections:this.connections.size,activeConnections:t.filter(r=>r.readyState==="OPEN").length,connectionDetails:t}}getReadyStateString(t){switch(t){case WebSocket.CONNECTING:return"CONNECTING";case WebSocket.OPEN:return"OPEN";case WebSocket.CLOSING:return"CLOSING";case WebSocket.CLOSED:return"CLOSED";default:return"UNKNOWN"}}}const Ns=new fu({baseUrl:"wss://api.trademe.app/ws",maxReconnectAttempts:5,reconnectDelay:1e3,heartbeatInterval:3e4});typeof window<"u"&&window.addEventListener("beforeunload",()=>{Ns.disconnectAll()});const Hs=as((s,t)=>({currentPrices:{},klineData:{},selectedSymbol:"BTC/USDT",selectedTimeframe:"1h",selectedExchange:"okx",isLoading:!1,isConnected:!1,lastUpdate:null,error:null,subscribedTickers:new Set,connectionStats:null,setSelectedSymbol:r=>{s({selectedSymbol:r});const{selectedTimeframe:a,selectedExchange:n,fetchKlineData:i}=t();i(r,a,n)},setSelectedTimeframe:r=>{s({selectedTimeframe:r});const{selectedSymbol:a,selectedExchange:n,fetchKlineData:i}=t();i(a,r,n)},setSelectedExchange:r=>{s({selectedExchange:r});const{selectedSymbol:a,selectedTimeframe:n,fetchKlineData:i}=t();i(a,n,r)},fetchKlineData:async(r,a,n)=>{var i,l;s({isLoading:!0});try{const o=await gu.getKlineData(r,a,n);s(c=>({klineData:{...c.klineData,[`${n}:${r}:${a}`]:o},isLoading:!1,lastUpdate:new Date}))}catch(o){s({isLoading:!1});const c=((l=(i=o.response)==null?void 0:i.data)==null?void 0:l.message)||"获取K线数据失败";M.error(c)}},subscribeToTicker:(r,a)=>{const n=`${a}:${r}`,i=`/market/${a}/${r}/ticker`;Ns.connect(n,i,{onOpen:()=>{s(o=>({isConnected:!0,subscribedTickers:new Set([...o.subscribedTickers,n]),error:null})),console.log(`Subscribed to ticker: ${n}`)},onMessage:o=>{t().updatePrice(r,o)},onError:o=>{console.error(`WebSocket error for ${n}:`,o),s({error:`${r} 价格订阅失败`}),M.error(`${r} 价格订阅失败`)},onClose:()=>{s(o=>{const c=new Set(o.subscribedTickers);return c.delete(n),{subscribedTickers:c,isConnected:c.size>0}}),console.log(`Unsubscribed from ticker: ${n}`)}})||(M.error(`无法连接到 ${r} 价格推送`),s({error:`WebSocket连接失败: ${r}`}))},unsubscribeFromTicker:(r,a)=>{const n=`${a}:${r}`;Ns.disconnect(n)&&s(l=>{const o=new Set(l.subscribedTickers);return o.delete(n),{subscribedTickers:o,isConnected:o.size>0}})},connectWebSocket:()=>{const{selectedSymbol:r,selectedExchange:a}=t();t().subscribeToTicker(r,a)},disconnectWebSocket:()=>{Ns.disconnectAll(),s({subscribedTickers:new Set,isConnected:!1,connectionStats:null})},updatePrice:(r,a)=>{s(n=>({currentPrices:{...n.currentPrices,[r]:a},lastUpdate:new Date,error:null}))},clearError:()=>{s({error:null})},getConnectionStats:()=>{const r=Ns.getStats();return s({connectionStats:r}),r},reset:()=>{Ns.disconnectAll(),s({currentPrices:{},klineData:{},selectedSymbol:"BTC/USDT",selectedTimeframe:"1h",selectedExchange:"okx",isLoading:!1,isConnected:!1,lastUpdate:null,error:null,subscribedTickers:new Set,connectionStats:null})}})),ut={async getStrategies(s){try{const t=await K.get("/strategies",{params:s});return q(t)}catch(t){H(t)}},async getStrategy(s){try{const t=await K.get(`/strategies/${s}`);return q(t)}catch(t){H(t)}},async createStrategy(s){try{const t=await K.post("/strategies",s);return q(t)}catch(t){H(t)}},async updateStrategy(s,t){try{const r=await K.put(`/strategies/${s}`,t);return q(r)}catch(r){H(r)}},async deleteStrategy(s){try{const t=await K.delete(`/strategies/${s}`);return q(t)}catch(t){H(t)}},async startStrategy(s){try{const t=await K.post(`/strategies/${s}/start`);return q(t)}catch(t){H(t)}},async stopStrategy(s){try{const t=await K.post(`/strategies/${s}/stop`);return q(t)}catch(t){H(t)}},async pauseStrategy(s){try{const t=await K.post(`/strategies/${s}/pause`);return q(t)}catch(t){H(t)}},async runBacktest(s,t){try{const r=await K.post(`/strategies/${s}/backtest`,t);return q(r)}catch(r){H(r)}},async getBacktestResults(s){try{const t=await K.get(`/strategies/${s}/backtests`);return q(t)}catch(t){H(t)}},async getBacktestResult(s,t){try{const r=await K.get(`/strategies/${s}/backtests/${t}`);return q(r)}catch(r){H(r)}},async getStrategyTrades(s,t){try{const r=await K.get(`/strategies/${s}/trades`,{params:t});return q(r)}catch(r){H(r)}},async getStrategyPerformance(s,t){try{const r=await K.get(`/strategies/${s}/performance`,{params:{period:t}});return q(r)}catch(r){H(r)}},async cloneStrategy(s,t){try{const r=await K.post(`/strategies/${s}/clone`,{name:t});return q(r)}catch(r){H(r)}},async exportStrategy(s){try{const t=await K.get(`/strategies/${s}/export`);return q(t)}catch(t){H(t)}},async importStrategy(s){try{const t=await K.post("/strategies/import",s);return q(t)}catch(t){H(t)}},async getStrategyLiveDetails(s){try{const t=await K.get(`/strategies/${s}/live-details`);return q(t)}catch(t){H(t)}},async createStrategyFromAI(s){try{const t=await K.post("/strategies/from-ai",s);return q(t)}catch(t){H(t)}},async getStrategiesByType(s,t){try{const r=await K.get(`/strategies/by-type/${s}`,{params:t});return q(r)}catch(r){H(r)}}},pu=as((s,t)=>({strategies:[],selectedStrategy:null,isLoading:!1,backtestResults:[],isBacktesting:!1,fetchStrategies:async()=>{var r,a;s({isLoading:!0});try{const n=await ut.getStrategies();s({strategies:n.strategies,isLoading:!1})}catch(n){s({isLoading:!1});const i=((a=(r=n.response)==null?void 0:r.data)==null?void 0:a.message)||"获取策略列表失败";M.error(i)}},createStrategy:async r=>{var a,n;try{const i=await ut.createStrategy(r);return s(l=>({strategies:[...l.strategies,i]})),M.success("策略创建成功"),!0}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"创建策略失败";return M.error(l),!1}},updateStrategy:async(r,a)=>{var n,i;try{const l=await ut.updateStrategy(r,a);return s(o=>{var c;return{strategies:o.strategies.map(d=>d.id===r?l:d),selectedStrategy:((c=o.selectedStrategy)==null?void 0:c.id)===r?l:o.selectedStrategy}}),M.success("策略更新成功"),!0}catch(l){const o=((i=(n=l.response)==null?void 0:n.data)==null?void 0:i.message)||"更新策略失败";return M.error(o),!1}},deleteStrategy:async r=>{var a,n;try{return await ut.deleteStrategy(r),s(i=>{var l;return{strategies:i.strategies.filter(o=>o.id!==r),selectedStrategy:((l=i.selectedStrategy)==null?void 0:l.id)===r?null:i.selectedStrategy}}),M.success("策略删除成功"),!0}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"删除策略失败";return M.error(l),!1}},selectStrategy:r=>{s({selectedStrategy:r})},runBacktest:async(r,a)=>{var n,i;s({isBacktesting:!0});try{const l=await ut.runBacktest(r,a);return s(o=>({backtestResults:[...o.backtestResults,l],isBacktesting:!1})),M.success("回测完成"),!0}catch(l){s({isBacktesting:!1});const o=((i=(n=l.response)==null?void 0:n.data)==null?void 0:i.message)||"回测失败";return M.error(o),!1}},fetchBacktestResults:async r=>{var a,n;try{const i=await ut.getBacktestResults(r);s({backtestResults:i})}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"获取回测结果失败";M.error(l)}},startStrategy:async r=>{var a,n;try{return await ut.startStrategy(r),s(i=>{var l;return{strategies:i.strategies.map(o=>o.id===r?{...o,status:"running"}:o),selectedStrategy:((l=i.selectedStrategy)==null?void 0:l.id)===r?{...i.selectedStrategy,status:"running"}:i.selectedStrategy}}),M.success("策略已启动"),!0}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"启动策略失败";return M.error(l),!1}},stopStrategy:async r=>{var a,n;try{return await ut.stopStrategy(r),s(i=>{var l;return{strategies:i.strategies.map(o=>o.id===r?{...o,status:"stopped"}:o),selectedStrategy:((l=i.selectedStrategy)==null?void 0:l.id)===r?{...i.selectedStrategy,status:"stopped"}:i.selectedStrategy}}),M.success("策略已停止"),!0}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"停止策略失败";return M.error(l),!1}}})),Fe={async createSession(s){try{const t=await K.post("/ai/sessions",s);return q(t)}catch(t){throw H(t),t}},async getSessions(s){try{const t=await K.get(`/ai/sessions?ai_mode=${s}`);return q(t)}catch(t){H(t)}},async updateSessionStatus(s,t,r){try{const a=r!==void 0?`?progress=${r}`:"",n=await K.put(`/ai/sessions/${s}/status${a}`,{status:t});return q(n)}catch(a){H(a)}},async deleteSession(s){try{const t=await K.delete(`/ai/sessions/${s}`);return q(t)}catch(t){H(t)}},async sendChatMessage(s,t,r="developer",a="strategy",n){try{const i=await K.post("/ai/chat",{content:s,session_id:t,ai_mode:r,session_type:a,context:n||{}});return q(i)}catch(i){H(i)}},async getChatHistory(s,t=50){try{const r=new URLSearchParams;s&&r.append("session_id",s),r.append("limit",t.toString());const a=await K.get(`/ai/chat/history?${r}`);return q(a)}catch(r){H(r)}},async clearChatSession(s){try{const t=await K.delete(`/ai/chat/${s}`);return q(t)}catch(t){H(t)}},async generateStrategy(s){try{const t=await K.post("/ai/strategy/generate",{description:s.description,indicators:s.indicators||[],timeframe:s.timeframe||"1h",risk_level:s.risk_level||"medium"});return q(t)}catch(t){H(t)}},async getUsageStats(s=30){try{const t=await K.get(`/ai/usage/stats?days=${s}`);return q(t)}catch(t){H(t)}},async generateTradingInsights(s,t="1d"){try{const r=await K.post(`/ai/insights/generate?symbol=${s}&timeframe=${t}`);return q(r)}catch(r){H(r)}},async analyzeMarket(s){try{const t=await K.post("/ai/market/analyze",{symbols:s.symbols,timeframe:s.timeframe||"1d",analysis_type:s.analysis_type||"technical"});return q(t)}catch(t){H(t)}},async analyzeBacktestResults(s){try{const t=await K.post(`/ai/backtest/analyze?backtest_id=${s}`);return q(t)}catch(t){H(t)}},async getLatestAIStrategy(s){try{const t=await K.get(`/strategies/latest-ai-strategy/${s}`);return q(t)}catch(t){throw H(t),t}},async autoBacktest(s){try{const t=await K.post("/ai/strategy/auto-backtest",s);return q(t)}catch(t){throw H(t),t}},async getBacktestProgress(s){try{const t=await K.get(`/realtime-backtest/ai-strategy/progress/${s}`);return q(t)}catch(t){throw H(t),t}},async getBacktestResults(s){try{const t=await K.get(`/realtime-backtest/ai-strategy/results/${s}`);return q(t)}catch(t){throw H(t),t}},async getAISessionBacktestHistory(s){try{const t=await K.get(`/ai/strategy/backtest-history/${s}`);return q(t)}catch(t){throw H(t),t}}};class yu{constructor(t){Le(this,"ws",null);Le(this,"config");Le(this,"events",{});Le(this,"isConnected",!1);Le(this,"isAuthenticated",!1);Le(this,"reconnectAttempts",0);Le(this,"connectionId",null);Le(this,"userId",null);Le(this,"heartbeatTimer",null);Le(this,"reconnectTimer",null);this.config={reconnectInterval:3e3,maxReconnectAttempts:5,heartbeatInterval:3e4,...t}}on(t){this.events={...this.events,...t}}async connect(){return new Promise((t,r)=>{try{console.log("🔗 正在连接WebSocket AI服务:",this.config.url),this.ws=new WebSocket(this.config.url),this.ws.onopen=()=>{var a,n;console.log("✅ WebSocket连接已建立"),this.isConnected=!0,this.reconnectAttempts=0,(n=(a=this.events).onOpen)==null||n.call(a),this.authenticate().then(t).catch(r)},this.ws.onclose=a=>{var n,i;console.log("❌ WebSocket连接已断开:",a.code,a.reason),this.isConnected=!1,this.isAuthenticated=!1,this.connectionId=null,this.userId=null,this.clearTimers(),(i=(n=this.events).onClose)==null||i.call(n,a),a.code!==1e3&&this.handleReconnect(),this.reconnectAttempts===0&&r(new Error(`WebSocket连接失败: ${a.reason||"未知原因"} (Code: ${a.code})`))},this.ws.onerror=a=>{var n,i;console.error("❌ WebSocket错误:",a),(i=(n=this.events).onError)==null||i.call(n,a),r(a)},this.ws.onmessage=a=>{try{const n=JSON.parse(a.data);if(!n||typeof n!="object"){console.error("❌ WebSocket消息格式无效:",n);return}if(!n.type){console.error("❌ WebSocket消息缺少type字段:",n);return}this.handleMessage(n)}catch(n){console.error("❌ 解析WebSocket消息失败:",n,"Original data:",a.data)}}}catch(a){console.error("❌ WebSocket连接失败:",a),r(a)}})}async authenticate(){return new Promise((t,r)=>{var l;if(!this.ws||this.ws.readyState!==WebSocket.OPEN){r(new Error("WebSocket未连接"));return}const a=setTimeout(()=>{console.error("❌ [WebSocketClient] 认证超时，30秒内未收到认证响应"),r(new Error("认证超时"))},3e4),n=this.events.onAuthenticated;console.log("🔐 [WebSocketClient] 设置临时认证处理器"),this.events.onAuthenticated=o=>{console.log("🎉 [WebSocketClient] 认证回调被触发！",o),clearTimeout(a),this.isAuthenticated=!0,this.connectionId=o.connection_id||`user_${o.user_id}_${Date.now()}`,this.userId=o.user_id,this.startHeartbeat(),console.log("✅ WebSocket认证成功:",{connectionId:this.connectionId,userId:this.userId}),this.events.onAuthenticated=n,n==null||n(o),t(!0)};const i={type:"auth",token:this.config.token};console.log("📤 [WebSocketClient] 发送认证消息:",{type:i.type,tokenLength:(l=i.token)==null?void 0:l.length}),this.send(i)})}async sendAIChat(t,r="trader",a="strategy",n){if(console.log("🚀 [WebSocketClient] sendAIChat called:",{content:t.substring(0,100)+"...",aiMode:r,sessionType:a,sessionId:n,isConnected:this.isConnected,isAuthenticated:this.isAuthenticated}),!this.isConnected||!this.isAuthenticated){const o=`WebSocket状态异常 - 连接:${this.isConnected}, 认证:${this.isAuthenticated}`;throw console.error("❌ [WebSocketClient]",o),new Error(o)}const i=this.generateRequestId(),l={type:"ai_chat",request_id:i,content:t,ai_mode:r,session_type:a,session_id:n};return console.log("📤 [WebSocketClient] 发送AI消息:",l),this.send(l),i}cancelAIRequest(t){!this.isConnected||!this.isAuthenticated||this.send({type:"cancel_request",request_id:t})}ping(){this.isConnected&&this.send({type:"ping"})}disconnect(){this.clearTimers(),this.ws&&(this.ws.close(),this.ws=null),this.isConnected=!1,this.isAuthenticated=!1,this.connectionId=null,this.userId=null}getConnectionInfo(){return{isConnected:this.isConnected,isAuthenticated:this.isAuthenticated,connectionId:this.connectionId,userId:this.userId,reconnectAttempts:this.reconnectAttempts}}handleMessage(t){var a,n,i,l,o,c,d,u,m,w,x,b,g,N,v,L,_,E,A,p,k,C;const r={type:t.type,request_id:t.request_id||"N/A",...t.type==="ai_progress_update"&&{step:t.step,total_steps:t.total_steps,status:t.status,message:t.message},...t.type==="ai_stream_chunk"&&{chunk_length:((a=t.chunk)==null?void 0:a.length)||0},...t.type==="ai_stream_end"&&{response_length:((n=t.content)==null?void 0:n.length)||0,tokens_used:t.tokens_used,cost_usd:t.cost_usd}};switch(console.log("📨 收到WebSocket消息:",r),t.type){case"connection_established":console.log("✅ [WebSocketClient] 连接已建立:",t),this.isAuthenticated=!0,this.connectionId=t.connection_id||null,this.userId=t.user_id||null,this.events.onAuthenticated&&(console.log("🎯 [WebSocketClient] 触发onAuthenticated回调 (connection_established)"),this.events.onAuthenticated(t));break;case"auth_success":console.log("✅ [WebSocketClient] 认证成功:",t),this.isAuthenticated=!0,this.connectionId=t.connection_id||null,this.userId=t.user_id||null,this.events.onAuthenticated?(console.log("🎯 [WebSocketClient] 调用onAuthenticated回调"),this.events.onAuthenticated(t)):console.warn("⚠️ [WebSocketClient] onAuthenticated回调未设置");break;case"ai_chat_start":(l=(i=this.events).onAIStart)==null||l.call(i,t);break;case"ai_complexity_analysis":(c=(o=this.events).onComplexityAnalysis)==null||c.call(o,t);break;case"ai_progress_update":(u=(d=this.events).onProgressUpdate)==null||u.call(d,t);break;case"ai_chat_success":(w=(m=this.events).onAISuccess)==null||w.call(m,t);break;case"ai_chat_error":(b=(x=this.events).onAIError)==null||b.call(x,t);break;case"ai_stream_start":console.log("🌊 [WebSocketClient] 流式AI开始:",t),(N=(g=this.events).onStreamStart)==null||N.call(g,t);break;case"ai_stream_chunk":console.log("📝 [WebSocketClient] 流式AI数据块:",(t==null?void 0:t.chunk)||"[chunk为空]"),(L=(v=this.events).onStreamChunk)==null||L.call(v,t);break;case"ai_stream_end":console.log("✅ [WebSocketClient] 流式AI结束:",t),console.log("🔄 [WebSocketClient] 准备调用onStreamEnd回调"),this.events.onStreamEnd?(console.log("🎯 [WebSocketClient] onStreamEnd回调存在，正在调用..."),this.events.onStreamEnd(t),console.log("✅ [WebSocketClient] onStreamEnd回调调用完成")):console.log("⚠️ [WebSocketClient] onStreamEnd回调不存在!");break;case"ai_stream_error":const W={error:(t==null?void 0:t.error)||"Unknown error",error_type:(t==null?void 0:t.error_type)||"UNKNOWN",message:(t==null?void 0:t.message)||"No error message",request_id:(t==null?void 0:t.request_id)||"No request ID"};console.log("❌ [WebSocketClient] 流式AI错误:",W),console.log("❌ [WebSocketClient] 原始错误数据:",JSON.stringify(t,null,2)),(E=(_=this.events).onStreamError)==null||E.call(_,t);break;case"heartbeat":case"pong":(p=(A=this.events).onHeartbeat)==null||p.call(A,t);break;default:(C=(k=this.events).onMessage)==null||C.call(k,t);break}}send(t){if(!this.ws||this.ws.readyState!==WebSocket.OPEN){console.warn("⚠️ WebSocket未连接，无法发送消息:",t);return}try{this.ws.send(JSON.stringify(t)),console.log("📤 发送WebSocket消息:",t.type)}catch(r){console.error("❌ 发送WebSocket消息失败:",r)}}startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>{this.ping()},this.config.heartbeatInterval)}clearTimers(){this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)}handleReconnect(){if(this.reconnectAttempts>=this.config.maxReconnectAttempts){console.error("❌ 达到最大重连次数，停止重连");return}this.reconnectAttempts++,console.log(`🔄 尝试重连 (${this.reconnectAttempts}/${this.config.maxReconnectAttempts})`),this.reconnectTimer=setTimeout(()=>{this.connect().catch(console.error)},this.config.reconnectInterval)}generateRequestId(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}}class bu{constructor(t){Le(this,"client");Le(this,"pendingRequests",new Map);Le(this,"isInitialized",!1);let r=t.baseUrl;r=r.replace(/\/api\/v1$/,""),r.match(/^https?:\/\//)||(r=window.location.protocol+"//"+r);const a=r.replace(/^http/,"ws")+"/api/v1/ai/ws/chat";console.log("🔗 [WebSocketAI] 构建的WebSocket URL:",a),this.client=new yu({url:a,token:t.token,reconnectInterval:3e3,maxReconnectAttempts:5,heartbeatInterval:3e4}),this.setupEventHandlers()}async initialize(){if(this.isInitialized)return!0;try{return await this.client.connect(),this.isInitialized=!0,!0}catch(t){return console.error("❌ WebSocket AI服务初始化失败:",t),!1}}async sendChatMessage(t,r,a="trader",n="strategy",i){if(!this.isInitialized&&!await this.initialize())throw new Error("WebSocket连接失败");return new Promise(async(l,o)=>{try{const c=await this.client.sendAIChat(t,a,n,r);this.pendingRequests.set(c,{requestId:c,resolve:l,reject:o,callbacks:i}),setTimeout(()=>{this.pendingRequests.has(c)&&(this.pendingRequests.delete(c),o({type:"ai_chat_error",request_id:c,error:"WebSocket请求超时",error_code:"WEBSOCKET_TIMEOUT",message:"WebSocket请求超时，请重试"}))},6e5)}catch(c){console.error("❌ [WebSocketAI] sendChatMessage异常:",c),o({type:"ai_chat_error",error:c instanceof Error?c.message:"未知错误",error_code:"WEBSOCKET_ERROR",message:"WebSocket发送失败"})}})}cancelRequest(t){this.client.cancelAIRequest(t),this.pendingRequests.has(t)&&this.pendingRequests.delete(t)}getConnectionStatus(){return this.client.getConnectionInfo()}disconnect(){this.client.disconnect(),this.isInitialized=!1,this.pendingRequests.clear()}async reconnect(){return this.disconnect(),this.initialize()}setupEventHandlers(){this.client.on({onOpen:()=>{console.log("🔗 WebSocket AI服务已连接")},onClose:t=>{console.log("❌ WebSocket AI服务已断开:",t.code,t.reason),this.isInitialized=!1,this.pendingRequests.forEach(({reject:r,requestId:a})=>{r({type:"ai_chat_error",request_id:a,error:"WebSocket连接断开",error_code:"WEBSOCKET_DISCONNECTED",message:"WebSocket连接断开，请重试"})}),this.pendingRequests.clear()},onError:t=>{console.error("❌ WebSocket AI服务错误:",t)},onAuthenticated:t=>{console.log("✅ WebSocket AI服务认证成功:",t)},onAIStart:t=>{var a,n;const r=this.findRequestById(t.request_id);(n=(a=r==null?void 0:r.callbacks)==null?void 0:a.onStart)==null||n.call(a,t)},onComplexityAnalysis:t=>{var a,n;const r=this.findRequestById(t.request_id);(n=(a=r==null?void 0:r.callbacks)==null?void 0:a.onComplexityAnalysis)==null||n.call(a,t)},onProgressUpdate:t=>{var a,n;const r=this.findRequestById(t.request_id);(n=(a=r==null?void 0:r.callbacks)==null?void 0:a.onProgress)==null||n.call(a,t)},onAISuccess:t=>{var a,n;const r=this.findRequestById(t.request_id);r&&(this.pendingRequests.delete(r.requestId),(n=(a=r.callbacks)==null?void 0:a.onSuccess)==null||n.call(a,t),r.resolve(t))},onAIError:t=>{var a,n;const r=this.findRequestById(t.request_id);r&&(this.pendingRequests.delete(r.requestId),(n=(a=r.callbacks)==null?void 0:a.onError)==null||n.call(a,t),r.reject(t))},onStreamStart:t=>{var a,n;const r=this.findRequestById(t.request_id);(n=(a=r==null?void 0:r.callbacks)==null?void 0:a.onStreamStart)==null||n.call(a,t)},onStreamChunk:t=>{var a,n;const r=this.findRequestById(t.request_id);(n=(a=r==null?void 0:r.callbacks)==null?void 0:a.onStreamChunk)==null||n.call(a,t)},onStreamEnd:t=>{var a,n;const r=this.findRequestById(t.request_id);if(r){this.pendingRequests.delete(r.requestId),(n=(a=r.callbacks)==null?void 0:a.onStreamEnd)==null||n.call(a,t);const i={type:"ai_chat_success",request_id:t.request_id,response:t.content,session_id:t.session_id,tokens_used:t.tokens_used,model:"claude-3-5-sonnet-20241022",cost_usd:t.cost_usd,message:"对话成功"};r.resolve(i)}},onStreamError:t=>{var a,n;const r=this.findRequestById(t.request_id);if(r){this.pendingRequests.delete(r.requestId),(n=(a=r.callbacks)==null?void 0:a.onStreamError)==null||n.call(a,t);const i={type:"ai_chat_error",request_id:t.request_id,error:t.error,message:t.message};r.reject(i)}},onHeartbeat:()=>{}})}findRequestById(t){if(t)return this.pendingRequests.get(t)}}let gr=null;function Zn(s){if(!gr&&s&&(gr=new bu(s)),!gr)throw new Error("WebSocket AI服务未初始化，请提供配置");return gr}const _r=as()(Bs((s,t)=>({currentAIMode:"trader",chatSessions:{developer:[],trader:[]},currentSession:null,messages:[],isTyping:!1,messagesLoading:!1,messagesLoaded:!1,useWebSocket:!0,wsConnected:!1,wsConnectionId:null,aiProgress:null,streamingMessage:null,generatedStrategies:[],isGenerating:!1,currentGeneratedStrategy:null,marketAnalyses:{},isAnalyzing:!1,usageStats:null,generatedStrategy:null,showBacktestPrompt:!1,backtestProgress:null,backtestResults:null,showBacktestResults:!1,isBacktestRunning:!1,isLoading:!1,error:null,networkStatus:"connected",retryCount:0,setAIMode:r=>{s({currentAIMode:r,currentSession:null,messages:[],error:null})},createChatSession:async r=>{var a,n;s({isLoading:!0,error:null});try{const i=await Fe.createSession(r),l={session_id:i.session_id,name:r.name,description:r.description,ai_mode:r.ai_mode,session_type:r.session_type,status:"active",progress:0,message_count:0,cost_total:0,created_at:i.created_at,updated_at:i.created_at,last_activity_at:i.created_at};if(s(o=>({chatSessions:{...o.chatSessions,[r.ai_mode]:[l,...o.chatSessions[r.ai_mode]]},currentSession:l,messages:[],isLoading:!1})),r.description&&r.description.trim()){const{sendMessage:o}=t();await o(r.description.trim())}return M.success(`创建${r.session_type==="strategy"?"策略":r.session_type==="indicator"?"指标":""}会话成功`),!0}catch(i){const l=String(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"创建会话失败");return s({error:l,isLoading:!1}),M.error(l),!1}},loadChatSessions:async r=>{var a,n;s({isLoading:!0,error:null});try{const i=await Fe.getSessions(r);s(l=>({chatSessions:{...l.chatSessions,[r]:i.sessions},isLoading:!1}))}catch(i){const l=String(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"加载会话列表失败");s({error:l,isLoading:!1}),console.error("Load chat sessions error:",i)}},selectChatSession:async r=>{var a;if(s({currentSession:r,messages:[],error:null,messagesLoading:!!r,messagesLoaded:!1}),r)try{console.log("📥 [AIStore] 开始加载聊天历史:",r.session_id);const n=await Fe.getChatHistory(r.session_id,20),l=((n==null?void 0:n.messages)||[]).map(c=>({role:c.message_type||c.role,content:String(c.content||""),timestamp:c.created_at||c.timestamp})).reverse();((a=t().currentSession)==null?void 0:a.session_id)===r.session_id?(console.log("✅ [AIStore] 聊天历史加载完成:",{sessionId:r.session_id,messageCount:l.length}),s({messages:l,messagesLoading:!1,messagesLoaded:!0})):(console.log("⚠️ [AIStore] 会话已切换，忽略历史消息加载"),s({messagesLoading:!1,messagesLoaded:!0}))}catch(n){console.error("❌ [AIStore] 加载聊天历史失败:",n),s({error:"加载聊天历史失败，请刷新重试",messagesLoading:!1,messagesLoaded:!0})}else s({messagesLoading:!1,messagesLoaded:!0})},sendMessage:async r=>{var d;const{useWebSocket:a}=t();if(a)return t().sendMessageWebSocket(r);let{currentSession:n,currentAIMode:i,retryCount:l}=t();if(n)console.log("✅ [DEBUG] Using existing currentSession:",n.session_id);else{console.log("❌ [DEBUG] No currentSession, creating default session");try{const u=i==="trader"?"市场分析对话":"策略开发对话";if(!await t().createChatSession({name:u,ai_mode:i,session_type:"strategy",description:"自动创建的对话会话"}))return M.error("创建对话会话失败"),!1;if(n=t().currentSession,!n)return M.error("会话创建失败"),!1;console.log("✅ [DEBUG] Auto-created session:",n.session_id),M.success("已自动创建新对话")}catch(u){return console.log("❌ [DEBUG] Exception in session creation:",u),M.error("创建对话会话失败"),!1}}const o={role:"user",content:String(r||""),timestamp:new Date().toISOString()};s(u=>({messages:[...u.messages,o],isTyping:!0,error:null,networkStatus:"checking",retryCount:0}));const c=e0(2,1500);try{const m=await c(async()=>{const x=new Promise((g,N)=>{setTimeout(()=>N(new Error("TIMEOUT")),45e3)});console.log("📤 [DEBUG] Calling aiApi.sendChatMessage with:",{message:r,sessionId:n.session_id,aiMode:n.ai_mode,sessionType:n.session_type});const b=Fe.sendChatMessage(r,n.session_id,n.ai_mode,n.session_type);return await Promise.race([b,x])},"ai-chat"),w={role:"assistant",content:String(m.response||""),timestamp:new Date().toISOString()};return s(x=>({messages:[...x.messages,w],isTyping:!1,error:null,networkStatus:"connected",retryCount:0})),m.cost_usd>0&&(t().updateUsageStatsRealtime(m.cost_usd,m.tokens_used||0),M.success(`AI回复完成 (消耗 $${m.cost_usd.toFixed(4)})`,{icon:"🧠",duration:3e3})),!0}catch(u){const m=()=>{s(g=>({isTyping:!1,networkStatus:"disconnected",retryCount:g.retryCount+1}))},w=Ba.handle(u,"ai-chat-send",!1);let x="",b=!1;switch(w.type){case wr.NETWORK:x="AI服务暂时不可用，请检查网络连接",b=!0;break;case wr.SERVER:w.code===504?(x="Claude AI服务繁忙，请稍后重试",b=!0):x="AI服务器错误，请稍后再试";break;case wr.AUTH:x="AI使用权限不足，请检查会员状态";break;default:u.message==="TIMEOUT"?(x="AI响应超时，服务可能繁忙",b=!0):(d=u.message)!=null&&d.includes("AI回复超时")?(x="AI回复超时，请稍后重试",b=!0):x=w.message||"发送消息失败"}return m(),s({error:x}),M.error(x,{duration:b?8e3:5e3,icon:b?"🔄":"❌",id:`ai-error-${Date.now()}`}),b&&setTimeout(()=>{M("可尝试重新发送消息或检查网络连接",{icon:"💡",duration:6e3,style:{background:"#FEF3C7",color:"#92400E",border:"1px solid #FCD34D"}})},1e3),!1}},updateSessionStatus:async(r,a,n)=>{var i,l;try{return await Fe.updateSessionStatus(r,a,n),s(o=>{var d;const c={...o.chatSessions};return Object.keys(c).forEach(u=>{c[u]=c[u].map(m=>m.session_id===r?{...m,status:a,progress:n??m.progress}:m)}),{chatSessions:c,currentSession:((d=o.currentSession)==null?void 0:d.session_id)===r?{...o.currentSession,status:a,progress:n??o.currentSession.progress}:o.currentSession}}),M.success("会话状态更新成功"),!0}catch(o){const c=((l=(i=o.response)==null?void 0:i.data)==null?void 0:l.message)||"更新会话状态失败";return M.error(c),!1}},deleteChatSession:async r=>{var a,n;try{return await Fe.deleteSession(r),s(i=>{var o,c;const l={...i.chatSessions};return Object.keys(l).forEach(d=>{l[d]=l[d].filter(u=>u.session_id!==r)}),{chatSessions:l,currentSession:((o=i.currentSession)==null?void 0:o.session_id)===r?null:i.currentSession,messages:((c=i.currentSession)==null?void 0:c.session_id)===r?[]:i.messages}}),M.success("会话删除成功"),!0}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"删除会话失败";return M.error(l),!1}},loadUsageStats:async(r=30)=>{var a,n;s({isLoading:!0,error:null});try{const i=await Fe.getUsageStats(r);s({usageStats:i,isLoading:!1})}catch(i){const l=String(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"获取使用统计失败");s({error:l,isLoading:!1}),console.error("Load usage stats error:",i)}},updateUsageStatsRealtime:(r,a)=>{s(n=>n.usageStats?{usageStats:{...n.usageStats,total_requests:(n.usageStats.total_requests||0)+1,total_cost_usd:(n.usageStats.total_cost_usd||0)+r,daily_cost_usd:(n.usageStats.daily_cost_usd||0)+r,monthly_cost_usd:(n.usageStats.monthly_cost_usd||0)+r}}:{usageStats:{period_days:1,total_requests:1,total_cost_usd:r,daily_cost_usd:r,monthly_cost_usd:r,remaining_daily_quota:1e3,remaining_monthly_quota:3e4,by_feature:{},by_session:{}}}),console.log(`💰 [AIStore] 实时更新统计: +$${r.toFixed(4)}, +${a} tokens`)},clearCurrentMessages:()=>{s({messages:[],currentSession:null})},generateStrategy:async r=>{var a,n;s({isGenerating:!0,error:null});try{const i=await Fe.generateStrategy(r),l={name:r.description.split(" ").slice(0,3).join(" ")+" Strategy",description:r.description,code:i.code,explanation:i.explanation,parameters:i.parameters,risk_assessment:{level:r.risk_level||"medium",factors:i.warnings||[],recommendations:["Review and test thoroughly before live trading"]}};return s(o=>({generatedStrategies:[l,...o.generatedStrategies],currentGeneratedStrategy:l,isGenerating:!1})),M.success("策略生成成功"),l}catch(i){const l=String(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"策略生成失败");return s({error:l,isGenerating:!1}),M.error(l),null}},optimizeStrategy:async(r,a)=>{var n,i;s({isLoading:!0,error:null});try{const l=`请优化以下策略代码，优化目标：${a.join(", ")}

代码：
${r}`,o=await Fe.sendChatMessage(l,void 0,"developer","strategy");return s({isLoading:!1}),M.success("策略优化完成"),{code:o.response,explanation:"通过AI聊天优化生成",improvements:a}}catch(l){const o=String(((i=(n=l.response)==null?void 0:n.data)==null?void 0:i.message)||"策略优化失败");throw s({error:o,isLoading:!1}),M.error(o),l}},explainStrategy:async r=>{var a,n;s({isLoading:!0,error:null});try{const i=`请详细解释以下策略代码的逻辑和功能：

${r}`,l=await Fe.sendChatMessage(i,void 0,"developer","strategy");return s({isLoading:!1}),{explanation:l.response,complexity:"medium",features:[]}}catch(i){const l=String(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"策略解释失败");throw s({error:l,isLoading:!1}),M.error(l),i}},clearGeneratedStrategies:()=>{s({generatedStrategies:[],currentGeneratedStrategy:null})},analyzeMarket:async(r,a,n)=>{var l,o;const i=`${r}-${n}`;s({isAnalyzing:!0,error:null});try{const c=await Fe.analyzeMarket({symbols:[r],timeframe:n,analysis_type:"technical"}),d={symbol:r,timeframe:n,trend_direction:"neutral",strength:.5,support_levels:[],resistance_levels:[],technical_indicators:c.risk_assessment||{},summary:c.summary,recommendations:c.recommendations,confidence:.75};return s(u=>({marketAnalyses:{...u.marketAnalyses,[i]:d},isAnalyzing:!1})),M.success(`${r} 市场分析完成`),d}catch(c){const d=String(((o=(l=c.response)==null?void 0:l.data)==null?void 0:o.message)||"市场分析失败");return s({error:d,isAnalyzing:!1}),M.error(d),null}},getTradingSignals:async(r,a,n)=>{var i,l;s({isLoading:!0,error:null});try{const o=[];for(const c of n){const d=await Fe.analyzeMarket({symbols:[r],timeframe:c,analysis_type:"technical"});o.push({symbol:r,timeframe:c,signals:d.signals||[],summary:d.summary,recommendations:d.recommendations})}return s({isLoading:!1}),M.success(`${r} 交易信号获取成功`),o}catch(o){const c=String(((l=(i=o.response)==null?void 0:i.data)==null?void 0:l.message)||"获取交易信号失败");throw s({error:c,isLoading:!1}),M.error(c),o}},assessRisk:async(r,a)=>{var n,i;s({isLoading:!0,error:null});try{const l=r?`请评估以下策略代码的风险：
${r}`:`请评估以下投资组合的风险：
${JSON.stringify(a,null,2)}`,o=await Fe.sendChatMessage(l,void 0,"trader","strategy"),c={riskLevel:"medium",riskFactors:["市场波动风险","流动性风险"],recommendations:o.response.split(`
`).filter(d=>d.trim()),score:.6};return s({isLoading:!1}),M.success("风险评估完成"),c}catch(l){const o=String(((i=(n=l.response)==null?void 0:n.data)==null?void 0:i.message)||"风险评估失败");throw s({error:o,isLoading:!1}),M.error(o),l}},clearError:()=>{s({error:null})},reset:()=>{s({currentAIMode:"developer",chatSessions:{developer:[],trader:[]},currentSession:null,messages:[],isTyping:!1,generatedStrategies:[],isGenerating:!1,currentGeneratedStrategy:null,marketAnalyses:{},isAnalyzing:!1,usageStats:null,isLoading:!1,error:null,networkStatus:"connected",retryCount:0})},toggleWebSocket:()=>{s(a=>({useWebSocket:!a.useWebSocket,aiProgress:null}));const{useWebSocket:r}=t();M.success(r?"已切换到WebSocket模式 (实时对话)":"已切换到HTTP模式")},initializeWebSocket:async()=>{var a,n;const{useWebSocket:r}=t();if(!r)return console.log("🔄 [AIStore] WebSocket未启用，跳过初始化"),!1;try{s({isLoading:!0,error:null});const i=localStorage.getItem("auth-storage");if(!i)throw new Error("未找到认证信息，请重新登录");const l=JSON.parse(i),o=((a=l==null?void 0:l.state)==null?void 0:a.token)||"",c=((n=l==null?void 0:l.state)==null?void 0:n.isAuthenticated)||!1;if(!o||!c)throw new Error("认证token无效或已过期，请重新登录");console.log("🔗 [AIStore] 开始初始化WebSocket连接..."),console.log("🔑 [AIStore] 使用token:",o.substring(0,20)+"...");const d=Zn({baseUrl:window.location.origin,token:o});if(console.log("🔄 [AIStore] WebSocket服务实例已创建，开始连接..."),await d.initialize()){const m=d.getConnectionStatus();return console.log("✅ [AIStore] WebSocket连接成功:",m),s({wsConnected:!0,wsConnectionId:m.connectionId,isLoading:!1,networkStatus:"connected"}),M.success("🌊 WebSocket AI服务连接成功!",{icon:"🔗",duration:3e3}),!0}else throw new Error("WebSocket连接失败")}catch(i){const l=String((i==null?void 0:i.message)||i||"WebSocket连接失败");return console.error("❌ [AIStore] WebSocket初始化失败:",i),s({wsConnected:!1,wsConnectionId:null,error:l,isLoading:!1,networkStatus:"disconnected"}),l.includes("认证")||l.includes("登录")?M.error(`🔐 ${l}`,{icon:"🔑",duration:6e3}):M.error(`🔌 WebSocket连接失败: ${l}`,{icon:"❌",duration:5e3}),!1}},sendMessageWebSocket:async r=>{var o;const{currentSession:a,currentAIMode:n,useWebSocket:i,wsConnected:l}=t();if(!i)return t().sendMessage(r);if(!l&&!await t().initializeWebSocket())return M.error("WebSocket未连接，请检查网络连接"),!1;if(!a){const c=n==="trader"?"市场分析对话":"策略开发对话";if(!await t().createChatSession({name:c,ai_mode:n,session_type:"strategy",description:"自动创建的WebSocket对话会话"}))return M.error("创建对话会话失败"),!1}s(c=>{const d={role:"user",content:String(r||""),timestamp:new Date().toISOString()};return{messages:[...c.messages,d],isTyping:!0,error:null,aiProgress:{isProcessing:!0,step:0,totalSteps:4,status:"preparing",message:"正在准备发送..."}}});try{const c=localStorage.getItem("auth-storage");if(!c)throw new Error("认证信息丢失，请重新登录");const d=JSON.parse(c),u=((o=d==null?void 0:d.state)==null?void 0:o.token)||"";if(!u)throw new Error("认证token无效，请重新登录");const m=Zn({baseUrl:window.location.origin,token:u}),w=t().currentSession;return await m.sendChatMessage(r,w.session_id,w.ai_mode,w.session_type,{onStart:x=>{s(b=>({aiProgress:{...b.aiProgress,status:"started",message:x.message||"AI开始处理..."}}))},onComplexityAnalysis:x=>{s(b=>({aiProgress:{...b.aiProgress,complexity:x.complexity,estimatedTime:x.estimated_time_seconds,message:x.message}}))},onProgress:x=>{s(b=>({aiProgress:{...b.aiProgress,step:x.step,totalSteps:x.total_steps,status:x.status,message:x.message}}))},onSuccess:x=>{let b;if(typeof x.response=="string"&&x.response)b=x.response;else if(x.response&&typeof x.response=="object"){const N=x.response;b=N.content||N.message||JSON.stringify(N)}else x.message?b=String(x.message):b="AI响应错误";b=String(b||"AI响应为空");const g={role:"assistant",content:b,timestamp:new Date().toISOString()};b&&b.includes("```")&&(g.metadata={codeBlock:b}),s(N=>{const v={role:"assistant",content:String(g.content),timestamp:String(g.timestamp)};return g.metadata&&(v.metadata={codeBlock:String(g.metadata.codeBlock||"")}),{messages:[...N.messages,v],isTyping:!1,aiProgress:null}}),x.cost_usd>0&&(t().updateUsageStatsRealtime(x.cost_usd,x.tokens_used||0),M.success(`AI回复完成 (消耗 $${x.cost_usd.toFixed(4)}, ${x.tokens_used} tokens)`,{icon:"🚀",duration:4e3}))},onStreamStart:x=>{console.log("🌊 [AIStore] 流式开始:",x),s(b=>{const g={role:"assistant",content:"🤔 AI正在深度思考中，马上开始回复...",timestamp:new Date().toISOString(),metadata:{isStreaming:!0,isWaitingFirstChunk:!0}};return{messages:[...b.messages,g],isTyping:!1,streamingMessage:{isStreaming:!0,requestId:x.request_id,accumulatedContent:"",messageIndex:b.messages.length},aiProgress:{...b.aiProgress,status:"stream_waiting",message:"🌊 AI正在深度分析，即将开始流式回复..."}}})},onStreamChunk:x=>{console.log("📝 [AIStore] 流式数据块:",x.chunk),s(b=>{var L;const{streamingMessage:g}=b;if(!(g!=null&&g.isStreaming)||g.messageIndex===void 0)return b;const N=[...b.messages];let v=g.accumulatedContent;if(N[g.messageIndex]){const _=N[g.messageIndex];v=((L=_.metadata)==null?void 0:L.isWaitingFirstChunk)?x.chunk:g.accumulatedContent+x.chunk,N[g.messageIndex]={..._,content:v,metadata:{isStreaming:!0,isWaitingFirstChunk:!1}}}return{messages:N,streamingMessage:{...g,accumulatedContent:v},aiProgress:{...b.aiProgress,status:"streaming_active",message:"✍️ AI正在实时生成回复..."}}})},onStreamEnd:x=>{console.log("✅ [AIStore] 流式结束:",x),s(b=>{console.log("🚀 [AIStore] 立即强制更新messages数组以触发React重新渲染");const g={role:"assistant",content:x.content||"流式消息完成",timestamp:new Date().toISOString(),metadata:{streamCompleted:!0,completedAt:Date.now(),forceRender:Math.random()}};return{...b,messages:[...b.messages,g],isTyping:!1,streamingMessage:null,aiProgress:null}}),x.cost_usd>0&&(t().updateUsageStatsRealtime(x.cost_usd,x.tokens_used||0),M.success(`🌊 流式AI回复完成 (消耗 $${x.cost_usd.toFixed(4)}, ${x.tokens_used} tokens)`,{icon:"🚀",duration:4e3}))},onStreamError:x=>{const b=v=>{if(!v)return"undefined";if(typeof v=="string")return v;if(typeof v=="number"||typeof v=="boolean")return String(v);if(typeof v=="object")try{if(v.message)return v.message;if(v.error)return String(v.error);if(v.toString&&typeof v.toString=="function"){const L=v.toString();if(L!=="[object Object]")return L}return JSON.stringify(v,null,2)}catch{return"[Complex Error Object]"}return String(v)};console.log("❌ [AIStore] 流式错误:",{error:b(x==null?void 0:x.error),error_type:x==null?void 0:x.error_type,message:x==null?void 0:x.message,request_id:x==null?void 0:x.request_id});const g={...x,error:b(x==null?void 0:x.error),message:(x==null?void 0:x.message)||b(x==null?void 0:x.error)||"流式处理失败"};s(v=>({...v,isTyping:!1,streamingMessage:null,aiProgress:null,error:g.message}));const N=t().getErrorMessage(g);M.error(N,{duration:6e3,id:`stream-error-${Date.now()}`})},onError:x=>{console.log("❌ [AIStore] onError - 处理AI对话错误:",x);const b=_=>{if(!_)return"undefined";if(typeof _=="string")return _;if(typeof _=="number"||typeof _=="boolean")return String(_);if(typeof _=="object")try{if(_.message)return _.message;if(_.error)return String(_.error);if(_.toString&&typeof _.toString=="function"){const E=_.toString();if(E!=="[object Object]")return E}return JSON.stringify(_,null,2)}catch{return"[Complex Error Object]"}return String(_)},g={...x,error:b(x==null?void 0:x.error),message:(x==null?void 0:x.message)||b(x==null?void 0:x.error)||"AI处理失败"},N=t().getErrorMessage(g),v=`抱歉，${N}`;s(_=>{const E={role:"assistant",content:String(v),timestamp:new Date().toISOString(),metadata:{isError:!0}};return{messages:[..._.messages,E],isTyping:!1,error:String(v),aiProgress:null}});const L=x.retry_suggested?`${N} (可以重试)`:N;M.error(L,{duration:x.retry_suggested?8e3:5e3,icon:x.retry_suggested?"🔄":"❌"})}}),!0}catch(c){return console.error("❌ [DEBUG] WebSocket发送异常:",c),console.error("❌ [DEBUG] Error stack:",c.stack),console.error("❌ [DEBUG] Error details:",{message:c.message,name:c.name,type:typeof c,error:c}),s({isTyping:!1,error:c.message||"WebSocket发送失败",aiProgress:null}),M.error(`WebSocket发送失败: ${c.message}`),!1}},checkNetworkStatus:async()=>{try{s({networkStatus:"checking"});const r=new AbortController,a=setTimeout(()=>r.abort(),5e3);return await fetch("/api/v1/health",{method:"HEAD",signal:r.signal}),clearTimeout(a),s({networkStatus:"connected"}),!0}catch{return s({networkStatus:"disconnected"}),!1}},getErrorMessage:r=>{if(!r)return"未知错误，请重试";const a=r.error_code||r.code;let n=r.error||r.message||"";switch(n=(o=>{if(!o)return"";if(typeof o=="string")return o;if(typeof o=="number"||typeof o=="boolean")return String(o);if(typeof o=="object")try{if(o.message&&typeof o.message=="string")return o.message;if(o.error&&typeof o.error=="string")return o.error;if(o.detail&&typeof o.detail=="string")return o.detail;if(o.description&&typeof o.description=="string")return o.description;if(o.toString&&typeof o.toString=="function"){const d=o.toString();if(d!=="[object Object]"&&d!=="[object Error]")return d}if(o instanceof Error)return o.name?`${o.name}: ${o.message}`:o.message;const c=JSON.stringify(o,Object.getOwnPropertyNames(o),2);return c&&c!=="{}"&&c!=="null"&&c!=="[]"?c:""}catch{return"[Serialization Error]"}return String(o)})(n),a){case"WEBSOCKET_TIMEOUT":return"⏰ AI响应超时，请重试或检查网络连接";case"WEBSOCKET_DISCONNECTED":return"🔌 连接断开，正在重新连接...";case"WEBSOCKET_ERROR":return"📡 网络连接出现问题，请检查网络设置";case"AI_PROCESSING_FAILED":return"🤖 AI处理失败，请稍后重试";case"RATE_LIMIT_EXCEEDED":return"⚡ 请求过于频繁，请稍等片刻再试";case"INSUFFICIENT_CREDITS":return"💳 AI对话额度不足，请升级会员";case"INVALID_SESSION":return"🔄 会话已过期，将为您创建新会话"}if(n.includes("timeout")||n.includes("超时"))return"⏰ 请求超时，请重试";if(n.includes("network")||n.includes("网络"))return"📡 网络连接异常，请检查网络设置";if(n.includes("quota")||n.includes("额度"))return"💳 AI对话额度已用尽，请明日再试或升级会员";if(n.includes("session")||n.includes("会话"))return"🔄 会话异常，请刷新页面重试";if(n.includes("auth")||n.includes("认证"))return"🔐 身份认证失败，请重新登录";if(n.includes("busy")||n.includes("繁忙")||n.includes("服务繁忙"))return"🚀 AI服务繁忙，请稍后重试";if(n.includes("unavailable")||n.includes("不可用"))return"⚠️ AI服务暂时不可用，请稍后重试";if(!n||n.trim()===""||n==="undefined"||n==="null"||n==="[object Object]"||n==="[object Error]")return"⚠️ 服务暂时不可用，请稍后重试";const l=n.replace(/^(Error:|ERROR:|错误:)\s*/i,"").trim();return l?`❌ ${l}`:"⚠️ 服务暂时不可用，请稍后重试"},getLatestAIStrategy:async r=>{s({isLoading:!0,error:null});try{const a=await Fe.getLatestAIStrategy(r);return s({generatedStrategy:a,isLoading:!1}),a}catch(a){const n=t().getErrorMessage(a);return s({error:n,isLoading:!1}),M.error(`获取策略失败: ${n}`),null}},autoBacktest:async r=>{s({isBacktestRunning:!0,backtestProgress:null,error:null});try{const a=await Fe.autoBacktest(r);if(a.success&&a.task_id)return t().startBacktestMonitoring(a.task_id),M.success("回测已启动，正在后台运行...",{icon:"🚀",duration:4e3}),!0;throw new Error(a.message||"回测启动失败")}catch(a){const n=t().getErrorMessage(a);return s({isBacktestRunning:!1,error:n}),M.error(`回测启动失败: ${n}`),!1}},getBacktestProgress:async r=>{try{const a=await Fe.getBacktestProgress(r);return s({backtestProgress:a}),a}catch(a){const n=t().getErrorMessage(a);return console.error("获取回测进度失败:",n),null}},getBacktestResults:async r=>{try{const a=await Fe.getBacktestResults(r);return s({backtestResults:a,showBacktestResults:!0,isBacktestRunning:!1}),a}catch(a){const n=t().getErrorMessage(a);return s({error:n,isBacktestRunning:!1}),M.error(`获取回测结果失败: ${n}`),null}},startBacktestMonitoring:r=>{const a=t();a.backtestMonitorInterval&&clearInterval(a.backtestMonitorInterval);const n=setInterval(async()=>{try{const i=await t().getBacktestProgress(r);i&&(i.status==="completed"?(clearInterval(n),await t().getBacktestResults(r),M.success("🎉 回测完成！",{icon:"✅",duration:5e3})):i.status==="failed"&&(clearInterval(n),s({isBacktestRunning:!1,error:i.error_message||"回测执行失败"}),M.error(`回测失败: ${i.error_message||"未知错误"}`)))}catch(i){console.error("监控回测进度时出错:",i)}},3e3);t().backtestMonitorInterval=n,setTimeout(()=>{clearInterval(n),t().isBacktestRunning&&(s({isBacktestRunning:!1,error:"回测监控超时，请手动刷新查看结果"}),M.error("回测监控超时，请刷新页面查看结果"))},30*60*1e3)},stopBacktestMonitoring:()=>{const r=t();r.backtestMonitorInterval&&(clearInterval(r.backtestMonitorInterval),delete r.backtestMonitorInterval),s({isBacktestRunning:!1})},handleStrategyGenerated:async r=>{try{await t().getLatestAIStrategy(r)&&(s({showBacktestPrompt:!0}),M.success("🎯 策略生成完成！现在可以配置回测参数了",{icon:"🚀",duration:6e3}))}catch(a){console.error("处理策略生成后逻辑失败:",a)}},handleQuickBacktest:async r=>{const{currentSession:a,generatedStrategy:n}=t();if(!a||!n){M.error("缺少会话或策略信息，无法启动回测");return}const i={ai_session_id:a.session_id,strategy_code:n.code,strategy_name:n.name,auto_config:!0,exchange:"binance",symbols:["BTC/USDT"],timeframes:["1h"],initial_capital:1e4,start_date:"2024-01-01",end_date:"2024-12-31",fee_rate:"vip0",...r};await t().autoBacktest(i)&&s({showBacktestPrompt:!1})},setShowBacktestPrompt:r=>{s({showBacktestPrompt:r})},setShowBacktestResults:r=>{s({showBacktestResults:r})}}),{name:"ai-storage",partialize:s=>({currentAIMode:s.currentAIMode,chatSessions:s.chatSessions,generatedStrategies:s.generatedStrategies,marketAnalyses:s.marketAnalyses,usageStats:s.usageStats})})),He={async getAccountBalance(s){try{const t=await K.get(`/trading/accounts/${s}/balance`);return q(t)}catch(t){H(t)}},async getSupportedExchanges(){try{const s=await K.get("/trading/exchanges");return q(s)}catch(s){H(s)}},async getSymbols(s){try{const t=await K.get(`/trading/exchanges/${s}/symbols`);return q(t)}catch(t){H(t)}},async createOrder(s){try{const t=await K.post("/trading/orders",s);return q(t)}catch(t){H(t)}},async getOrders(s){try{const t=await K.get("/trading/orders",{params:s});return q(t)}catch(t){H(t)}},async getOrder(s){try{const t=await K.get(`/trading/orders/${s}`);return q(t)}catch(t){H(t)}},async cancelOrder(s){try{const t=await K.delete(`/trading/orders/${s}`);return q(t)}catch(t){H(t)}},async getOrderStatistics(s=30){try{const t=await K.get(`/trading/orders/statistics?days=${s}`);return q(t)}catch(t){H(t)}},async getPositions(s){try{const t=s?`/trading/positions?exchange=${s}`:"/trading/positions",r=await K.get(t);return q(r)}catch(t){H(t)}},async getPositionPnL(s,t,r){try{const a=await K.get(`/trading/positions/${t}/${s}/pnl`,{params:{current_price:r}});return q(a)}catch(a){H(a)}},async getTradingSummary(s=30){try{const t=await K.get(`/trading/summary?days=${s}`);return q(t)}catch(t){H(t)}},async getDailyPnL(s=30){try{const t=await K.get(`/trading/daily-pnl?days=${s}`);return q(t)}catch(t){H(t)}},async getTrades(s){try{const t=await K.get("/trading/trades",{params:s});return q(t)}catch(t){H(t)}},async createTradingSession(s){try{const t=await K.post("/trading/sessions",s);return q(t)}catch(t){H(t)}},async getTradingSessions(){try{const s=await K.get("/trading/sessions");return q(s)}catch(s){H(s)}},async startTradingSession(s){try{const t=await K.post(`/trading/sessions/${s}/start`);return q(t)}catch(t){H(t)}},async stopTradingSession(s){try{const t=await K.post(`/trading/sessions/${s}/stop`);return q(t)}catch(t){H(t)}},async validateOrder(s){try{const t=await K.post("/trading/risk/validate-order",s);return q(t)}catch(t){H(t)}},async getPortfolioRisk(){try{const s=await K.get("/trading/risk/portfolio");return q(s)}catch(s){H(s)}},async getMarketData(s,t,r,a=100){try{const n=await K.get("/trading/market-data",{params:{exchange:s,symbol:t,timeframe:r,limit:a}});return q(n)}catch(n){H(n)}},async getTradingFees(s){try{const t=await K.get(`/trading/fees/${s}`);return q(t)}catch(t){H(t)}}},oa={exchange:"okx",symbol:"BTC/USDT",side:"buy",order_type:"limit",price:"",quantity:"",amount:""},Gn=as()(Bs((s,t)=>({accounts:{},selectedExchange:"okx",supportedExchanges:[],availableSymbols:[],orders:[],activeOrders:[],orderHistory:[],orderStats:null,positions:[],totalPortfolioValue:0,totalUnrealizedPnL:0,totalRealizedPnL:0,tradingSummary:null,dailyPnLData:[],recentTrades:[],tradingSessions:[],activeSessions:[],tradingForm:oa,lastRiskAssessment:null,selectedTimeframe:"15m",showAdvancedOptions:!1,isLoading:!1,isPlacingOrder:!1,isLoadingPositions:!1,isLoadingOrders:!1,error:null,loadSupportedExchanges:async()=>{try{s({isLoading:!0,error:null});const r=await He.getSupportedExchanges();s({supportedExchanges:r,isLoading:!1})}catch(r){s({error:r instanceof Error?r.message:"Failed to load exchanges",isLoading:!1})}},loadAccountBalance:async r=>{try{s({isLoading:!0,error:null});const a=await He.getAccountBalance(r);s(n=>({accounts:{...n.accounts,[r]:a},isLoading:!1}))}catch(a){s({error:a instanceof Error?a.message:"Failed to load account balance",isLoading:!1})}},loadAvailableSymbols:async r=>{try{const a=await He.getSymbols(r);s({availableSymbols:a})}catch(a){console.error("Failed to load symbols:",a)}},switchExchange:r=>{s({selectedExchange:r}),t().loadAccountBalance(r),t().loadAvailableSymbols(r),t().loadPositions(r)},createOrder:async r=>{try{s({isPlacingOrder:!0,error:null});const a=await He.createOrder(r);return s(n=>({orders:[a,...n.orders],activeOrders:a.status==="filled"?n.activeOrders:[a,...n.activeOrders],isPlacingOrder:!1})),t().loadPositions(),t().loadAccountBalance(r.exchange),a}catch(a){return s({error:a instanceof Error?a.message:"Failed to create order",isPlacingOrder:!1}),null}},loadOrders:async(r={})=>{try{s({isLoadingOrders:!0,error:null});const a=await He.getOrders(r),n=a.filter(l=>!["filled","canceled","rejected","failed"].includes(l.status)),i=a.filter(l=>["filled","canceled","rejected","failed"].includes(l.status));s({orders:a,activeOrders:n,orderHistory:i,isLoadingOrders:!1})}catch(a){s({error:a instanceof Error?a.message:"Failed to load orders",isLoadingOrders:!1})}},cancelOrder:async r=>{try{s({isLoading:!0,error:null}),await He.cancelOrder(r),s(a=>({orders:a.orders.map(n=>n.id===r?{...n,status:"canceled"}:n),activeOrders:a.activeOrders.filter(n=>n.id!==r),isLoading:!1}))}catch(a){s({error:a instanceof Error?a.message:"Failed to cancel order",isLoading:!1})}},refreshOrder:async r=>{try{const a=await He.getOrder(r);s(n=>({orders:n.orders.map(i=>i.id===r?a:i),activeOrders:n.activeOrders.map(i=>i.id===r?a:i)}))}catch(a){console.error("Failed to refresh order:",a)}},loadOrderStatistics:async(r=30)=>{try{const a=await He.getOrderStatistics(r);s({orderStats:a})}catch(a){console.error("Failed to load order statistics:",a)}},loadPositions:async r=>{try{s({isLoadingPositions:!0,error:null});const a=await He.getPositions(r),n=a.reduce((o,c)=>o+c.current_value,0),i=a.reduce((o,c)=>o+c.unrealized_pnl,0),l=a.reduce((o,c)=>o+c.realized_pnl,0);s({positions:a,totalPortfolioValue:n,totalUnrealizedPnL:i,totalRealizedPnL:l,isLoadingPositions:!1})}catch(a){s({error:a instanceof Error?a.message:"Failed to load positions",isLoadingPositions:!1})}},refreshPositions:async()=>{const{selectedExchange:r}=t();await t().loadPositions(r)},calculatePositionPnL:async(r,a,n)=>{try{const i=await He.getPositionPnL(r,a,n);s(l=>({positions:l.positions.map(o=>o.symbol===r&&o.exchange===a?i:o)}))}catch(i){console.error("Failed to calculate position PnL:",i)}},loadTradingSummary:async(r=30)=>{try{s({isLoading:!0,error:null});const a=await He.getTradingSummary(r);s({tradingSummary:a,isLoading:!1})}catch(a){s({error:a instanceof Error?a.message:"Failed to load trading summary",isLoading:!1})}},loadDailyPnL:async(r=30)=>{try{const a=await He.getDailyPnL(r);s({dailyPnLData:a})}catch(a){console.error("Failed to load daily PnL:",a)}},loadRecentTrades:async(r={})=>{try{const a=await He.getTrades({...r,limit:50});s({recentTrades:a})}catch(a){console.error("Failed to load recent trades:",a)}},createTradingSession:async r=>{try{s({isLoading:!0,error:null});const a=await He.createTradingSession(r);return s(n=>({tradingSessions:[a,...n.tradingSessions],isLoading:!1})),a}catch(a){return s({error:a instanceof Error?a.message:"Failed to create trading session",isLoading:!1}),null}},loadTradingSessions:async()=>{try{const r=await He.getTradingSessions(),a=r.filter(n=>n.status==="active");s({tradingSessions:r,activeSessions:a})}catch(r){console.error("Failed to load trading sessions:",r)}},startTradingSession:async r=>{try{s({isLoading:!0,error:null}),await He.startTradingSession(r),s(a=>({tradingSessions:a.tradingSessions.map(n=>n.id===r?{...n,status:"active"}:n),isLoading:!1}))}catch(a){s({error:a instanceof Error?a.message:"Failed to start trading session",isLoading:!1})}},stopTradingSession:async r=>{try{s({isLoading:!0,error:null}),await He.stopTradingSession(r),s(a=>({tradingSessions:a.tradingSessions.map(n=>n.id===r?{...n,status:"stopped"}:n),isLoading:!1}))}catch(a){s({error:a instanceof Error?a.message:"Failed to stop trading session",isLoading:!1})}},updateTradingForm:(r,a)=>{s(n=>({tradingForm:{...n.tradingForm,[r]:a}})),(r==="price"||r==="quantity")&&t().calculateOrderAmount()},resetTradingForm:()=>{s({tradingForm:oa,lastRiskAssessment:null})},calculateOrderAmount:()=>{const{tradingForm:r}=t(),{price:a,quantity:n}=r;if(a&&n){const i=(parseFloat(a)*parseFloat(n)).toFixed(2);s(l=>({tradingForm:{...l.tradingForm,amount:i}}))}},validateOrder:async()=>{try{const{tradingForm:r}=t();if(!r.quantity||!r.price)return null;const a={exchange:r.exchange,symbol:r.symbol,order_type:r.order_type,side:r.side,amount:parseFloat(r.quantity),price:r.order_type==="limit"?parseFloat(r.price):void 0},n=await He.validateOrder(a);return s({lastRiskAssessment:n}),n}catch(r){return console.error("Failed to validate order:",r),null}},setSelectedTimeframe:r=>{s({selectedTimeframe:r})},toggleAdvancedOptions:()=>{s(r=>({showAdvancedOptions:!r.showAdvancedOptions}))},setLoading:r=>s({isLoading:r}),setError:r=>s({error:r}),clearError:()=>s({error:null}),reset:()=>s({accounts:{},orders:[],activeOrders:[],orderHistory:[],positions:[],tradingSessions:[],activeSessions:[],tradingForm:oa,lastRiskAssessment:null,isLoading:!1,isPlacingOrder:!1,isLoadingPositions:!1,isLoadingOrders:!1,error:null})}),{name:"trading-store",partialize:s=>({selectedExchange:s.selectedExchange,tradingForm:s.tradingForm,selectedTimeframe:s.selectedTimeframe,showAdvancedOptions:s.showAdvancedOptions})})),_t={async createBacktest(s){try{const t=await K.post("/backtests",s);return q(t)}catch(t){H(t)}},async getBacktests(s){try{const t=await K.get("/backtests",{params:s});return q(t)}catch(t){H(t)}},async getBacktest(s){try{const t=await K.get(`/backtests/${s}`);return q(t)}catch(t){H(t)}},async getBacktestStatus(s){try{const t=await K.get(`/backtests/${s}/status`);return q(t)}catch(t){H(t)}},async stopBacktest(s){try{const t=await K.post(`/backtests/${s}/stop`);return q(t)}catch(t){H(t)}},async deleteBacktest(s){try{const t=await K.delete(`/backtests/${s}`);return q(t)}catch(t){H(t)}},async downloadBacktestReport(s,t="html"){try{return(await K.get(`/backtests/${s}/report`,{params:{format:t},responseType:"blob"})).data}catch(r){H(r)}},async compareBacktests(s){try{const t=await K.post("/backtests/compare",{backtest_ids:s});return q(t)}catch(t){H(t)}}},ca={strategy_id:"",symbol:"BTC/USDT",exchange:"okx",start_date:"2024-01-01",end_date:"2024-03-31",initial_capital:1e4,commission_rate:.001,timeframe:"1h"},sr=as()(Bs((s,t)=>({backtests:[],currentBacktest:null,loading:!1,error:null,configForm:ca,isCreatingBacktest:!1,runningBacktests:new Map,selectedForComparison:[],comparisonResult:null,pagination:{page:1,per_page:10,total:0,total_pages:0},filters:{},fetchBacktests:async r=>{s({loading:!0,error:null});try{const{page:a=1,per_page:n=10}=r||{},i=await _t.getBacktests({page:a,per_page:n,...t().filters}),l=Array.isArray(i)?i:[];s({backtests:l,pagination:{page:a,per_page:n,total:l.length,total_pages:Math.ceil(l.length/n)},loading:!1})}catch(a){console.error("Error fetching backtests:",a),s({backtests:[],error:a instanceof Error?a.message:"Failed to fetch backtests",loading:!1})}},fetchBacktest:async r=>{s({loading:!0,error:null});try{const a=await _t.getBacktest(r);s({currentBacktest:a,loading:!1})}catch(a){s({error:a instanceof Error?a.message:"Failed to fetch backtest",loading:!1})}},refreshBacktest:async r=>{try{const a=await _t.getBacktest(r);s(n=>{var i;return{backtests:n.backtests.map(l=>l.id===r?a:l),currentBacktest:((i=n.currentBacktest)==null?void 0:i.id)===r?a:n.currentBacktest}})}catch(a){console.error("Failed to refresh backtest:",a)}},deleteBacktest:async r=>{s({loading:!0,error:null});try{await _t.deleteBacktest(r),s(a=>{var n;return{backtests:a.backtests.filter(i=>i.id!==r),currentBacktest:((n=a.currentBacktest)==null?void 0:n.id)===r?null:a.currentBacktest,loading:!1}})}catch(a){s({error:a instanceof Error?a.message:"Failed to delete backtest",loading:!1})}},createBacktest:async r=>{s({isCreatingBacktest:!0,error:null});try{const a=await _t.createBacktest(r);return s(n=>({backtests:[a,...n.backtests],currentBacktest:a,isCreatingBacktest:!1})),a.status==="running"&&t().pollBacktestStatus(a.id),a}catch(a){return s({error:a instanceof Error?a.message:"Failed to create backtest",isCreatingBacktest:!1}),null}},stopBacktest:async r=>{try{await _t.stopBacktest(r),s(a=>{var n;return{backtests:a.backtests.map(i=>i.id===r?{...i,status:"failed"}:i),currentBacktest:((n=a.currentBacktest)==null?void 0:n.id)===r?{...a.currentBacktest,status:"failed"}:a.currentBacktest}})}catch(a){s({error:a instanceof Error?a.message:"Failed to stop backtest"})}},updateBacktestForm:(r,a)=>{s(n=>({configForm:{...n.configForm,[r]:a}}))},resetBacktestForm:()=>{s({configForm:ca})},updateBacktestStatus:(r,a,n)=>{s(i=>({runningBacktests:new Map(i.runningBacktests).set(r,{status:a,progress:n})}))},pollBacktestStatus:async r=>{const n=async()=>{try{const i=await _t.getBacktestStatus(r);if(t().updateBacktestStatus(r,i.status,i.progress),i.status==="completed"||i.status==="failed"){t().refreshBacktest(r);return}setTimeout(n,3e3)}catch(i){console.error("Failed to poll backtest status:",i)}};n()},toggleComparisonSelection:r=>{s(a=>({selectedForComparison:a.selectedForComparison.includes(r)?a.selectedForComparison.filter(n=>n!==r):[...a.selectedForComparison,r].slice(0,5)}))},compareBacktests:async()=>{const{selectedForComparison:r}=t();if(!(r.length<2)){s({loading:!0,error:null});try{const a=await _t.compareBacktests(r);s({comparisonResult:a,loading:!1})}catch(a){s({error:a instanceof Error?a.message:"Failed to compare backtests",loading:!1})}}},clearComparison:()=>{s({selectedForComparison:[],comparisonResult:null})},downloadReport:async(r,a="html")=>{try{const n=await _t.downloadBacktestReport(r,a),i=window.URL.createObjectURL(n),l=document.createElement("a");l.href=i,l.download=`backtest-report-${r}.${a}`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(i)}catch(n){s({error:n instanceof Error?n.message:"Failed to download report"})}},setLoading:r=>s({loading:r}),setError:r=>s({error:r}),clearError:()=>s({error:null}),reset:()=>s({backtests:[],currentBacktest:null,loading:!1,error:null,configForm:ca,isCreatingBacktest:!1,runningBacktests:new Map,selectedForComparison:[],comparisonResult:null,pagination:{page:1,per_page:10,total:0,total_pages:0},filters:{}})}),{name:"backtest-store",partialize:s=>({configForm:s.configForm,selectedForComparison:s.selectedForComparison})})),vu=()=>sr(s=>({backtests:s.backtests,loading:s.loading,error:s.error,pagination:s.pagination,fetchBacktests:s.fetchBacktests,deleteBacktest:s.deleteBacktest,downloadReport:s.downloadReport})),ju=()=>sr(s=>({configForm:s.configForm,isCreatingBacktest:s.isCreatingBacktest,createBacktest:s.createBacktest,updateBacktestForm:s.updateBacktestForm,resetBacktestForm:s.resetBacktestForm})),Nu=()=>sr(s=>({selectedForComparison:s.selectedForComparison,comparisonResult:s.comparisonResult,toggleComparisonSelection:s.toggleComparisonSelection,compareBacktests:s.compareBacktests,clearComparison:s.clearComparison})),Va=()=>{const s=Xe(u=>u.isLoading),t=Hs(u=>u.isLoading),r=pu(u=>u.isLoading),a=_r(u=>u.isLoading),n=_r(u=>u.isGenerating),i=_r(u=>u.isAnalyzing),l=Gn(u=>u.isLoading),o=Gn(u=>u.isPlacingOrder),c=sr(u=>u.loading),d=sr(u=>u.isCreatingBacktest);return{isLoading:s||t||r||a||l||c,isGenerating:n,isAnalyzing:i,isPlacingOrder:o,isCreatingBacktest:d,loadingStates:{auth:s,market:t,strategy:r,ai:a,aiGenerating:n,aiAnalyzing:i,trading:l,placingOrder:o,backtest:c,creatingBacktest:d}}},Ha=()=>{const s=Hs(a=>a.isConnected),t=Hs(a=>a.subscribedTickers),r=Hs(a=>a.connectionStats);return{isConnected:s,subscribedCount:t.size,subscribedTickers:Array.from(t),connectionStats:r,refreshStats:Hs.getState().getConnectionStats}},is=()=>{const s=Xe(a=>a.user),t=Xe(a=>a.isAuthenticated),r=(s==null?void 0:s.membership_level)||"basic";return{user:s,isAuthenticated:t,membershipLevel:r,isPremium:r==="premium"||r==="professional",isProfessional:r==="professional"}},wu=()=>{const s=ot(),{user:t,isPremium:r}=is(),{isConnected:a}=Ha();Va();const{t:n}=ns(),[i,l]=y.useState({totalStrategies:0,runningStrategies:0,totalIndicators:0,totalTrades:0,totalProfit:0,winRate:0,dailyPnl:0}),[o,c]=y.useState([]),[d,u]=y.useState(!1),m=async()=>{if(r)try{u(!0);const g=await ut.getStrategies();let N=[];g&&typeof g=="object"&&(N=Array.isArray(g)?g:g.strategies||[]),c(N);const v=N.filter(_=>{var E;return!_.name.includes("指标")&&!_.name.includes("RSI")&&!_.name.includes("MACD")&&!((E=_.description)!=null&&E.includes("指标"))}),L=N.filter(_=>{var E;return _.name.includes("指标")||_.name.includes("RSI")||_.name.includes("MACD")||((E=_.description)==null?void 0:E.includes("指标"))});l({totalStrategies:v.length,runningStrategies:3,totalTrades:0,totalProfit:1234.56,winRate:68.5,dailyPnl:123.45,totalIndicators:L.length})}catch(g){console.error("Failed to load overview data:",g),M.error("加载概览数据失败")}finally{u(!1)}};y.useEffect(()=>{m()},[r]);const w=[{title:n("strategiesManagement"),description:n("viewAndManageStrategies"),icon:"strategy",color:"blue",action:()=>s("/strategies")},{title:n("liveTrading"),description:n("startAutomatedTrading"),icon:"trading",color:"green",action:()=>s("/trading")},{title:n("strategyBacktest"),description:n("testStrategyPerformance"),icon:"backtest",color:"purple",action:()=>s("/backtest")},{title:n("aiAssistant"),description:n("getIntelligentTradingAdvice"),icon:"ai",color:"orange",action:()=>s("/ai-chat")}],x=g=>{const N={strategy:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M6 6V5a3 3 0 013-3h2a3 3 0 013 3v1h2a2 2 0 012 2v3.57A22.952 22.952 0 0110 13a22.95 22.95 0 01-8-1.43V8a2 2 0 012-2h2zm2-1a1 1 0 011-1h2a1 1 0 011 1v1H8V5zm1 5a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})}),trading:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}),backtest:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",clipRule:"evenodd"})}),ai:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})};return N[g]||N.strategy},b=g=>{const N={blue:{bg:"from-blue-50 to-blue-100",text:"text-blue-900",icon:"bg-blue-200 text-blue-600",hover:"hover:from-blue-100 hover:to-blue-200"},green:{bg:"from-green-50 to-green-100",text:"text-green-900",icon:"bg-green-200 text-green-600",hover:"hover:from-green-100 hover:to-green-200"},purple:{bg:"from-purple-50 to-purple-100",text:"text-purple-900",icon:"bg-purple-200 text-purple-600",hover:"hover:from-purple-100 hover:to-purple-200"},orange:{bg:"from-orange-50 to-orange-100",text:"text-orange-900",icon:"bg-orange-200 text-orange-600",hover:"hover:from-orange-100 hover:to-orange-200"}};return N[g]||N.blue};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n("tradingOverview")}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[n("welcomeBack"),"，",t==null?void 0:t.username,"！",n("checkTradingDataAndQuickActions")]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${a?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm text-gray-600",children:n(a?"realTimeConnected":"connectionLost")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:n("totalStrategies")}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:i.totalStrategies})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-200 flex items-center justify-center",children:x("strategy")})]})}),e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-xl p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:n("running")}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:i.runningStrategies})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-200 flex items-center justify-center",children:x("trading")})]})}),e.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-indigo-100 rounded-xl p-4 border border-indigo-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-indigo-600",children:"指标数量"}),e.jsx("p",{className:"text-2xl font-bold text-indigo-900",children:i.totalIndicators})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-200 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-indigo-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 0l-2 2a1 1 0 001.414 1.414L8 10.414l1.293 1.293a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-xl p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-600",children:n("totalProfit")}),e.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:["+",i.totalProfit.toFixed(2)]})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-200 flex items-center justify-center",children:e.jsxs("svg",{className:"w-5 h-5 text-purple-600",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"}),e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z",clipRule:"evenodd"})]})})]})}),e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-xl p-4 border border-orange-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600",children:n("winRate")}),e.jsxs("p",{className:"text-2xl font-bold text-orange-900",children:[i.winRate,"%"]})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-200 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-orange-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:n("quickActions")}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:w.map(g=>{const N=b(g.color);return e.jsx("div",{onClick:g.action,className:`bg-gradient-to-r ${N.bg} rounded-xl p-6 border cursor-pointer transition-all ${N.hover} hover:shadow-md`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${N.icon}`,children:x(g.icon)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold ${N.text} mb-1`,children:g.title}),e.jsx("p",{className:"text-sm text-gray-600",children:g.description})]})]})},g.title)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n("recentStrategies")}),e.jsxs("button",{onClick:()=>s("/strategies"),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:[n("viewAll")," →"]})]}),d?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("p",{className:"text-gray-500",children:n("loadingStrategies")})]}):o.length>0?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:o.slice(0,4).map(g=>{var N,v;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-shadow p-4",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:g.name}),e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${g.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.is_active?n("running"):n("stopped")})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:g.description}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsxs("span",{children:[n("tradingPair"),": ",((N=g.parameters)==null?void 0:N.symbol)||"N/A"]}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsxs("span",{children:[n("timeframe"),": ",((v=g.parameters)==null?void 0:v.timeframe)||"N/A"]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>s("/strategies"),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:n("viewDetails")})})]},g.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:n("noStrategies")}),e.jsx("p",{className:"text-gray-500 mb-4",children:n("createFirstStrategy")}),r?e.jsx("button",{onClick:()=>s("/strategies"),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:n("createStrategy")}):e.jsx("button",{onClick:()=>M.error(n("createStrategyRequiresPremium")),className:"inline-flex items-center px-4 py-2 bg-gray-300 text-gray-500 font-medium rounded-lg cursor-not-allowed",children:n("upgradeToCreate")})]})]})]})},Gs={async getLiveStrategies(s){try{const t=await K.get("/strategies",{params:s}),r=q(t);return{strategies:r.strategies.map(n=>{var i,l;return{id:n.id.toString(),name:n.name,description:n.description,trading_pair:((i=n.parameters)==null?void 0:i.symbol)||"BTC/USDT",exchange:((l=n.parameters)==null?void 0:l.exchange)||"binance",status:n.is_active?"running":"stopped",profit_rate:Math.random()*20-5,signal_count:Math.floor(Math.random()*50),created_at:n.created_at,win_rate:Math.random()*100,total_trades:Math.floor(Math.random()*100),parameters:n.parameters}}),total:r.total,page:(s==null?void 0:s.page)||1,per_page:(s==null?void 0:s.per_page)||20}}catch(t){H(t)}},async getLiveStrategyStats(){try{const s=await K.get("/trading/stats");return q(s)}catch(s){H(s)}},async getLiveStrategyDetails(s){try{const t=await K.get(`/strategies/${s}/live-details`);return q(t)}catch(t){H(t)}},async executeStrategyAction(s,t){try{const r=await K.post(`/strategies/${s}/action`,t);return q(r)}catch(r){H(r)}},async createLiveStrategy(s){try{const t=await K.post("/strategies",{...s,type:"live"});return q(t)}catch(t){H(t)}},async updateStrategyParameters(s,t){try{const r=await K.put(`/strategies/${s}/parameters`,{parameters:t});return q(r)}catch(r){H(r)}},async getStrategyTrades(s,t){try{const r=await K.get(`/strategies/${s}/trades`,{params:t});return q(r)}catch(r){H(r)}},async getStrategyPerformance(s,t){try{const r=await K.get(`/strategies/${s}/performance`,{params:{period:t}});return q(r)}catch(r){H(r)}},async getUserLiveStrategies(s){try{const t=await K.get("/trading/live-strategies",{params:s});return q(t).map(a=>{var n,i;return{id:a.id.toString(),name:a.name,description:a.description||"",trading_pair:((n=a.parameters)==null?void 0:n.symbol)||"BTC/USDT",exchange:((i=a.parameters)==null?void 0:i.exchange)||"binance",status:a.status,profit_rate:a.profit_loss||0,signal_count:a.total_trades||0,created_at:a.created_at,total_trades:a.total_trades||0,win_rate:Math.random()*100,parameters:a.parameters}})}catch(t){H(t)}},async deleteLiveStrategy(s){try{const t=await K.delete(`/trading/live-strategies/${s}`);return q(t)}catch(t){H(t)}}},ku=()=>{const s=ot(),{isPremium:t}=is();Ha(),Va();const{t:r}=ns(),[a,n]=y.useState(null),[i,l]=y.useState(""),[o,c]=y.useState("all"),[d,u]=y.useState([]),[m,w]=y.useState(!1),x=async()=>{if(t)try{w(!0);const k=(await Gs.getUserLiveStrategies()).map(C=>{const W=C.profit_rate/1e3||0;return{id:parseInt(C.id),name:C.name,description:C.description,code:"",parameters:{symbol:C.trading_pair,exchange:C.exchange,...C.parameters},is_active:C.status!=="stopped",user_id:9,created_at:C.created_at,status:C.status,profit:W>=0?`+${W.toFixed(2)}`:W.toFixed(2),profitPercent:W,lastUpdate:C.created_at,runningTime:C.status==="running"?"运行中":C.status==="paused"?"已暂停":"已停止",totalTrades:C.total_trades||0,winRate:C.win_rate||0}});u(k),M.success(`加载了 ${k.length} 个实盘策略`)}catch(p){console.error("Failed to load live strategies:",p),M.error("加载实盘策略失败")}finally{w(!1)}};y.useEffect(()=>{x()},[t]);const b={total:d.length,running:d.filter(p=>p.status==="running").length,stopped:d.filter(p=>p.status==="stopped").length,paused:d.filter(p=>p.status==="paused").length},g=d.filter(p=>{var re;const k=((re=p.parameters)==null?void 0:re.symbol)||"",C=p.name.toLowerCase().includes(i.toLowerCase())||p.description.toLowerCase().includes(i.toLowerCase())||k.toLowerCase().includes(i.toLowerCase()),W=o==="all"||p.status===o;return C&&W}),N=p=>{if(!t){M.error(r("startStrategyRequiresPremium"));return}u(k=>k.map(C=>C.id===p.id?{...C,status:"running",lastUpdate:new Date().toLocaleString("zh-CN")}:C)),M.success(`${p.name} ${r("strategyStarted")}`)},v=p=>{u(k=>k.map(C=>C.id===p.id?{...C,status:"stopped",lastUpdate:new Date().toLocaleString("zh-CN")}:C)),M.success(`${p.name} ${r("strategyStopped")}`)},L=p=>{u(k=>k.map(C=>C.id===p.id?{...C,status:"paused",lastUpdate:new Date().toLocaleString("zh-CN")}:C)),M.success(`${p.name} ${r("strategyPaused")}`)},_=async p=>{if(p.status!=="stopped"){M.error("只能删除已停止的实盘策略");return}if(window.confirm(`确认删除实盘策略 "${p.name}"?
此操作不可撤销。`))try{await Gs.deleteLiveStrategy(p.id.toString()),u(k=>k.filter(C=>C.id!==p.id)),M.success(`实盘策略 "${p.name}" 删除成功`)}catch(k){console.error("Delete strategy failed:",k),M.error("删除实盘策略失败")}},E=p=>{switch(p){case"running":return r("runningLive");case"stopped":return r("stoppedLive");case"paused":return r("pausedLive");default:return"Unknown"}},A=p=>{s(`/strategy/${p.id}/live`)};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:r("liveTrading")}),e.jsx("p",{className:"text-gray-600",children:r("monitorRunningStrategies")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:`bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4 border border-blue-200 cursor-pointer transition-all hover:shadow-md ${o==="all"?"ring-2 ring-blue-500 shadow-md":""}`,onClick:()=>c("all"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:r("totalLiveStrategies")}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:b.total})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-200 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z",clipRule:"evenodd"})})})]}),o==="all"&&e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:r("selected")})})]}),e.jsxs("div",{className:`bg-gradient-to-r from-green-50 to-green-100 rounded-xl p-4 border border-green-200 cursor-pointer transition-all hover:shadow-md ${o==="running"?"ring-2 ring-green-500 shadow-md":""}`,onClick:()=>c("running"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:r("runningLive")}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:b.running})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-200 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})]}),o==="running"&&e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-xs text-green-600 font-medium",children:r("selected")})})]}),e.jsxs("div",{className:`bg-gradient-to-r from-yellow-50 to-yellow-100 rounded-xl p-4 border border-yellow-200 cursor-pointer transition-all hover:shadow-md ${o==="paused"?"ring-2 ring-yellow-500 shadow-md":""}`,onClick:()=>c("paused"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-600",children:r("pausedLive")}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:b.paused})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-yellow-200 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]}),o==="paused"&&e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-xs text-yellow-600 font-medium",children:r("selected")})})]}),e.jsxs("div",{className:`bg-gradient-to-r from-red-50 to-red-100 rounded-xl p-4 border border-red-200 cursor-pointer transition-all hover:shadow-md ${o==="stopped"?"ring-2 ring-red-500 shadow-md":""}`,onClick:()=>c("stopped"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-600",children:r("stoppedLive")}),e.jsx("p",{className:"text-2xl font-bold text-red-900",children:b.stopped})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-200 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})})})]}),o==="stopped"&&e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-xs text-red-600 font-medium",children:r("selected")})})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",placeholder:r("searchStrategies"),value:i,onChange:p=>l(p.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-transparent"}),e.jsx("svg",{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsxs("select",{value:o,onChange:p=>c(p.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:r("allStatus")}),e.jsx("option",{value:"running",children:r("runningLive")}),e.jsx("option",{value:"paused",children:r("pausedLive")}),e.jsx("option",{value:"stopped",children:r("stoppedLive")})]})]}),o!=="all"&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"inline-flex items-center px-3 py-2 rounded-lg bg-gray-100 text-gray-700",children:[e.jsxs("span",{className:"text-sm",children:[r("currentFilter"),": "]}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs font-medium ${o==="running"?"bg-green-100 text-green-800":o==="paused"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:r(o==="running"?"runningLive":o==="paused"?"pausedLive":"stoppedLive")}),e.jsx("button",{onClick:()=>c("all"),className:"ml-2 text-gray-500 hover:text-gray-700",title:r("clearFilter"),children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{children:m?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-10 h-10 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:r("loadingStrategies")}),e.jsx("p",{className:"text-gray-500",children:r("monitorRunningStrategies")})]}):g.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:r("noStrategiesMessage")}),e.jsx("p",{className:"text-gray-500 mb-6",children:r("createFirstStrategyMessage")})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:g.map(p=>{var k;return e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-shadow cursor-pointer",onClick:()=>A(p),children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:p.name}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${p.status==="running"?"bg-green-100 text-green-800":p.status==="paused"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:E(p.status)})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:p.description})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:r("tradingPair")}),e.jsx("p",{className:"font-medium",children:((k=p.parameters)==null?void 0:k.symbol)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:r("profitLoss")}),e.jsxs("p",{className:`font-medium ${p.profitPercent>=0?"text-green-600":"text-red-600"}`,children:[p.profit," (",p.profitPercent>=0?"+":"",p.profitPercent,"%)"]})]}),p.runningTime&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:r("runningTime")}),e.jsx("p",{className:"font-medium",children:p.runningTime})]}),p.totalTrades!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:r("totalTrades")}),e.jsxs("p",{className:"font-medium",children:[p.totalTrades,"次"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsx("div",{className:"flex items-center space-x-2",children:p.status==="stopped"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:C=>{C.stopPropagation(),N(p)},disabled:!t,className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${t?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:r("start")}),e.jsx("button",{onClick:C=>{C.stopPropagation(),_(p)},className:"px-3 py-1.5 bg-red-100 text-red-700 rounded text-sm font-medium hover:bg-red-200 transition-colors",title:"删除实盘策略",children:"删除"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:C=>{C.stopPropagation(),v(p)},className:"px-3 py-1.5 bg-red-100 text-red-700 rounded text-sm font-medium hover:bg-red-200 transition-colors",children:r("stop")}),p.status==="running"&&e.jsx("button",{onClick:C=>{C.stopPropagation(),L(p)},className:"px-3 py-1.5 bg-yellow-100 text-yellow-700 rounded text-sm font-medium hover:bg-yellow-200 transition-colors",children:r("pause")}),p.status==="paused"&&e.jsx("button",{onClick:C=>{C.stopPropagation(),N(p)},disabled:!t,className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${t?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:r("start")})]})}),e.jsx("div",{className:"text-xs text-gray-500",children:r("viewDetails")})]})]})},p.id)})})})]})]})},_u=()=>{const{strategyId:s}=li(),t=ot(),{isPremium:r}=is(),[a,n]=y.useState(null),[i,l]=y.useState([]),[o,c]=y.useState(!0),[d,u]=y.useState(!1),[m,w]=y.useState(0),[x,b]=y.useState(!0),g=20,N=async()=>{if(s)try{c(!0);const Y=await ut.getStrategyLiveDetails(parseInt(s));n(Y)}catch(Y){console.error("Failed to load live details:",Y),M.error("加载实盘详情失败")}finally{c(!1)}},v=async(Y=0,X=!1)=>{if(s)try{u(!0);const I=await ut.getStrategyTrades(s,{page:Y+1,per_page:g});l(X?Q=>[...Q,...I.items]:I.items);const ie=I.items?I.items.length===g:!1;b(ie)}catch(I){console.error("Failed to load trades:",I),M.error("加载交易记录失败")}finally{u(!1)}};y.useEffect(()=>{if(!r){M.error("查看实盘详情需要高级版本"),t("/strategies");return}N(),v()},[s,r,t]);const L=()=>{const Y=m+1;w(Y),v(Y,!0)},_=(Y,X=2)=>Y.toFixed(X),E=Y=>new Date(Y).toLocaleString("zh-CN"),A=Y=>Y==="BUY"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",p=Y=>Y>=0?"text-green-600":"text-red-600";if(o)return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-10 h-10 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"加载实盘详情中..."}),e.jsx("p",{className:"text-gray-500",children:"正在获取策略运行数据"})]})});if(!a)return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"实盘详情不存在"}),e.jsx("button",{onClick:()=>t("/strategies"),className:"text-blue-600 hover:text-blue-800",children:"返回策略列表"})]})});const{strategy:k,live_stats:C,performance:W,status:re}=a;return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("button",{onClick:()=>t("/strategies"),className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:k.name}),e.jsx("p",{className:"text-gray-600",children:"实盘运行详情"})]}),e.jsx("div",{className:"flex-1"}),e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${re==="running"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:re==="running"?"运行中":"已停止"})]}),e.jsx("p",{className:"text-gray-600",children:k.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总收益"}),e.jsx("p",{className:`text-2xl font-bold ${p(C.profit_loss)}`,children:_(C.profit_loss,4)}),e.jsxs("p",{className:`text-sm ${p(C.profit_percentage)}`,children:[C.profit_percentage>=0?"+":"",_(C.profit_percentage),"%"]})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"})})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"交易次数"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:C.total_trades}),e.jsx("p",{className:"text-sm text-gray-500",children:"总成交量"})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z",clipRule:"evenodd"})})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"买入量"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:_(C.buy_volume,4)}),e.jsx("p",{className:"text-sm text-gray-500",children:"总买入金额"})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-yellow-100 flex items-center justify-center",children:e.jsxs("svg",{className:"w-6 h-6 text-yellow-600",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"}),e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z",clipRule:"evenodd"})]})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"手续费"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:_(C.total_fees,4)}),e.jsx("p",{className:"text-sm text-gray-500",children:"总费用"})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"性能指标"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"总回报率"}),e.jsxs("p",{className:`text-xl font-bold ${p(W.total_return)}`,children:[W.total_return>=0?"+":"",_(W.total_return),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"胜率"}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[_(W.win_rate),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"最大回撤"}),e.jsxs("p",{className:"text-xl font-bold text-red-600",children:[_(W.max_drawdown),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"夏普比率"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:_(W.sharpe_ratio,3)})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"交易记录"}),e.jsx("p",{className:"text-sm text-gray-600",children:"最近的实盘交易明细"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"时间"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"交易对"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"方向"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"数量"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"价格"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"总额"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"手续费"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"订单ID"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:"暂无交易记录"})}):i.map(Y=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:E(Y.timestamp)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Y.symbol}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${A(Y.side)}`,children:Y.side})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:_(Y.quantity,6)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:_(Y.price,4)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:_(Y.total_amount,4)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600",children:_(Y.fee,6)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.order_id||"N/A"})]},Y.id))})]})}),x&&i.length>0&&e.jsx("div",{className:"p-6 border-t border-gray-200 text-center",children:e.jsx("button",{onClick:L,disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed",children:d?"加载中...":"加载更多"})})]}),C.first_trade&&e.jsxs("div",{className:"mt-8 bg-gray-50 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"运行信息"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"首次交易"}),e.jsx("p",{className:"font-medium",children:E(C.first_trade)})]}),C.last_trade&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"最新交易"}),e.jsx("p",{className:"font-medium",children:E(C.last_trade)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"平均成交价"}),e.jsx("p",{className:"font-medium",children:_(C.avg_price,4)})]})]})]})]})},Su=()=>{var N,v,L,_,E,A,p,k;const s=ot(),{user:t}=is();Ha(),Va();const[r,a]=y.useState(""),[n,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState([]),[u,m]=y.useState(null),[w,x]=y.useState(!0);y.useEffect(()=>{(async()=>{try{x(!0);const[W,re]=await Promise.all([Gs.getLiveStrategies({per_page:100}),Gs.getLiveStrategyStats()]);d(W.strategies),m(re)}catch(W){console.error("加载实盘策略数据失败:",W),M.error("加载实盘策略数据失败，使用模拟数据"),d([{id:"1",name:"EMA交叉策略",trading_pair:"BTC/USDT",exchange:"binance",status:"running",profit_rate:8.2,signal_count:16,created_at:"2024-05-10",win_rate:68.4,total_trades:16},{id:"2",name:"RSI超买超卖策略",trading_pair:"ETH/USDT",exchange:"okx",status:"paused",profit_rate:5.7,signal_count:12,created_at:"2024-05-12"}]),m({active_strategies:1,total_return:15.8,max_drawdown:-6.3,last_trade_time:"2小时前",total_trades:28,win_rate:65.2})}finally{x(!1)}})()},[]);const b=async(C,W)=>{try{const re={action:W==="start"?"start":W},Y=await Gs.executeStrategyAction(C,re);Y.success?(M.success(`策略${W==="pause"?"已暂停":W==="stop"?"已停止":"已启动"}`),d(X=>X.map(I=>I.id===C?{...I,status:Y.new_status||W}:I))):M.error(Y.message||"操作失败")}catch(re){console.error("策略操作失败:",re),M.error("策略操作失败，请稍后重试")}},g=C=>{const W={running:"bg-green-50 text-green-700 border-green-200",paused:"bg-yellow-50 text-yellow-700 border-yellow-200",stopped:"bg-gray-50 text-gray-700 border-gray-200"},re={running:"运行中",paused:"已暂停",stopped:"已停止"};return e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-md text-xs font-medium border ${W[C]}`,children:re[C]})};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"w-full max-w-7xl min-h-screen bg-white rounded-xl shadow-xl border border-gray-200 mx-auto",children:[e.jsxs("header",{className:"py-4 px-8 flex justify-between border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-7 h-7 mr-3 flex items-center justify-center",children:e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-full h-full",style:{color:"#1a3d7c"},children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M8 12h8M12 8v8",stroke:"currentColor",strokeWidth:"2"})]})}),e.jsx("h1",{className:"text-xl font-bold",style:{color:"#1a3d7c"},children:"Trademe"})]}),e.jsxs("nav",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>s("/"),className:"px-4 py-2 text-blue-600 font-medium hover:bg-blue-50 rounded-lg",children:"首页"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white font-medium rounded-lg",children:"策略交易"}),e.jsx("button",{onClick:()=>s("/trading"),className:"px-4 py-2 text-blue-600 font-medium hover:bg-blue-50 rounded-lg",children:"图表交易"}),e.jsx("button",{onClick:()=>s("/api-keys"),className:"px-4 py-2 text-blue-600 font-medium hover:bg-blue-50 rounded-lg",children:"API管理"}),e.jsx("button",{className:"px-4 py-2 text-blue-600 font-medium hover:bg-blue-50 rounded-lg",children:"交易心得"}),e.jsx("button",{onClick:()=>s("/profile"),className:"px-4 py-2 text-blue-600 font-medium hover:bg-blue-50 rounded-lg",children:"账户中心"})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"w-9 h-9 rounded-full bg-gray-200 overflow-hidden",children:t!=null&&t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:"User avatar",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-blue-100 text-blue-600 font-medium",children:((N=t==null?void 0:t.username)==null?void 0:N.charAt(0).toUpperCase())||"U"})})})]}),e.jsxs("div",{className:"p-8",children:[w&&e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"加载实盘策略数据中..."})]}),!w&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsxs("button",{onClick:()=>s("/strategies"),className:"text-blue-600 hover:underline flex items-center mr-2",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"返回策略列表"]}),e.jsx("span",{className:"text-gray-500",children:"/ 实盘管理"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",style:{color:"#1a3d7c"},children:"实盘策略管理"}),e.jsx("p",{className:"text-gray-500",children:"管理您当前运行中的实盘策略"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4",style:{backgroundColor:"#e9f1fe"},children:e.jsx("svg",{className:"w-6 h-6",style:{color:"#1a3d7c"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 mb-1",children:"活跃策略"}),e.jsx("p",{className:"text-2xl font-bold",children:(u==null?void 0:u.active_strategies)||0})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4",style:{backgroundColor:"#e9faf3"},children:e.jsx("svg",{className:"w-6 h-6",style:{color:"#21ce90"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 mb-1",children:"总收益率"}),e.jsx("p",{className:"text-2xl font-bold",children:e.jsxs("span",{className:"bg-green-50 text-green-600 px-2 py-1 rounded",children:["+",(u==null?void 0:u.total_return)||0,"%"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4",style:{backgroundColor:"#f8f3d6"},children:e.jsx("svg",{className:"w-6 h-6",style:{color:"#f0b90b"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 mb-1",children:"最大回撤"}),e.jsx("p",{className:"text-2xl font-bold",children:e.jsxs("span",{className:"bg-red-50 text-red-600 px-2 py-1 rounded",children:[(u==null?void 0:u.max_drawdown)||0,"%"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4",style:{backgroundColor:"#fef1f1"},children:e.jsx("svg",{className:"w-6 h-6",style:{color:"#f53d3d"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 mb-1",children:"上次交易"}),e.jsx("p",{className:"text-lg font-bold",children:(u==null?void 0:u.last_trade_time)||"暂无"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",style:{color:"#1a3d7c"},children:"实盘策略列表"}),e.jsxs("div",{className:"flex",children:[e.jsxs("button",{className:"bg-blue-600 text-white rounded-lg px-4 py-2 font-medium hover:bg-blue-700 transition-colors flex items-center mr-2",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"添加策略"]}),e.jsx("input",{type:"text",className:"border border-gray-200 bg-gray-50 rounded-lg px-4 py-2 w-64 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",placeholder:"搜索策略...",value:r,onChange:C=>a(C.target.value)})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"策略名称"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"交易对"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"交易所"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"收益率"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"信号数量"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"创建时间"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{children:c.filter(C=>C.name.toLowerCase().includes(r.toLowerCase())).map(C=>e.jsxs("tr",{className:"cursor-pointer hover:bg-blue-50 border-b border-gray-100",onClick:()=>i(n===C.id?null:C.id),children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:C.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:C.trading_pair}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:C.exchange}),e.jsx("td",{className:"px-4 py-3 text-sm",children:g(C.status)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("span",{className:`px-2 py-1 rounded ${C.profit_rate>0?"bg-green-50 text-green-600":"bg-red-50 text-red-600"}`,children:[C.profit_rate>0?"+":"",C.profit_rate,"%"]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:C.signal_count}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:C.created_at}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex space-x-2",children:[C.status==="running"?e.jsx("button",{onClick:W=>{W.stopPropagation(),b(C.id,"pause")},className:"text-blue-600 hover:text-blue-800",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6"})})}):e.jsx("button",{onClick:W=>{W.stopPropagation(),b(C.id,"start")},className:"text-green-600 hover:text-green-800",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1.586a1 1 0 01.707.293l2.414 2.414a1 1 0 00.707.293H15"})})}),e.jsx("button",{onClick:W=>{W.stopPropagation(),b(C.id,"stop")},className:"text-red-600 hover:text-red-800",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 10h6v4H9z"})]})}),e.jsx("button",{className:"text-gray-600 hover:text-gray-800",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})]})})]},C.id))})]})})]}),n&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold mb-2",style:{color:"#1a3d7c"},children:[(v=c.find(C=>C.id===n))==null?void 0:v.name," 详情"]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-sm text-gray-600",children:(L=c.find(C=>C.id===n))==null?void 0:L.trading_pair}),e.jsx("span",{className:"text-sm text-gray-600",children:(_=c.find(C=>C.id===n))==null?void 0:_.exchange}),g(((E=c.find(C=>C.id===n))==null?void 0:E.status)||"stopped")]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"border border-blue-600 text-blue-600 rounded-lg px-4 py-2 text-sm font-medium hover:bg-blue-50",children:"暂停"}),e.jsx("button",{className:"border border-red-600 text-red-600 rounded-lg px-4 py-2 text-sm font-medium hover:bg-red-50",children:"终止"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 mb-2 text-sm",children:"总收益率"}),e.jsx("p",{className:"text-2xl font-bold",children:e.jsxs("span",{className:"bg-green-50 text-green-600 px-2 py-1 rounded",children:["+",(A=c.find(C=>C.id===n))==null?void 0:A.profit_rate,"%"]})})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 mb-2 text-sm",children:"胜率"}),e.jsxs("p",{className:"text-2xl font-bold",children:[((p=c.find(C=>C.id===n))==null?void 0:p.win_rate)||0,"%"]})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 mb-2 text-sm",children:"交易次数"}),e.jsx("p",{className:"text-2xl font-bold",children:((k=c.find(C=>C.id===n))==null?void 0:k.total_trades)||0})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-bold mb-4",children:"策略收益曲线"}),e.jsx("div",{className:"h-64 bg-gray-50 rounded-lg border border-gray-200 flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"📈 收益曲线图表（需要ECharts集成）"})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-6",style:{color:"#1a3d7c"},children:"策略参数设置"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"策略类型"}),e.jsxs("select",{className:"w-full border border-gray-200 bg-gray-50 rounded-lg px-4 py-3 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",children:[e.jsx("option",{children:"EMA交叉策略"}),e.jsx("option",{children:"RSI超买超卖策略"}),e.jsx("option",{children:"布林带突破策略"}),e.jsx("option",{children:"MACD背离策略"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易对"}),e.jsxs("select",{className:"w-full border border-gray-200 bg-gray-50 rounded-lg px-4 py-3 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",children:[e.jsx("option",{children:"BTC/USDT"}),e.jsx("option",{children:"ETH/USDT"}),e.jsx("option",{children:"SOL/USDT"}),e.jsx("option",{children:"DOGE/USDT"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易所"}),e.jsxs("select",{className:"w-full border border-gray-200 bg-gray-50 rounded-lg px-4 py-3 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",children:[e.jsx("option",{children:"币安"}),e.jsx("option",{children:"OKX"}),e.jsx("option",{children:"火币"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EMA短周期"}),e.jsx("input",{type:"number",className:"w-full border border-gray-200 bg-gray-50 rounded-lg px-4 py-3 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",defaultValue:"10"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EMA长周期"}),e.jsx("input",{type:"number",className:"w-full border border-gray-200 bg-gray-50 rounded-lg px-4 py-3 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",defaultValue:"50"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"止损比例"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",className:"w-full border border-gray-200 bg-gray-50 rounded-lg px-4 py-3 pr-8 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",defaultValue:"1.5"}),e.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm",children:"%"})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6 mt-6 flex justify-end",children:[e.jsx("button",{className:"border border-gray-300 rounded-lg px-4 py-2 text-gray-700 font-medium mr-3 hover:bg-gray-50",children:"取消"}),e.jsx("button",{className:"bg-blue-600 text-white rounded-lg px-4 py-2 font-medium hover:bg-blue-700 transition-colors",children:"更新策略参数"})]})]})]})]})]})})},Ye=({children:s,requireMembership:t})=>{const r=Or(),{isAuthenticated:a,isLoading:n,user:i,checkAuth:l}=Xe();if(y.useEffect(()=>{!a&&!n&&l()},[a,n,l]),n)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx(It,{size:"lg"})});if(!a)return e.jsx(wl,{to:"/login",state:{from:r},replace:!0});if(t&&i){const o={basic:1,premium:2,professional:3},c=o[i.membership_level]||0,d=o[t]||0;if(c<d)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"w-16 h-16 mx-auto bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z"})})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"需要升级会员"}),e.jsxs("p",{className:"text-gray-500 mb-4",children:["此功能需要 ",t==="premium"?"高级版":"专业版"," 会员权限"]}),e.jsx("button",{onClick:()=>window.location.href="/profile/membership",className:"btn btn-primary btn-md",children:"升级会员"})]})})}return e.jsx(e.Fragment,{children:s})},Cu=y.forwardRef(({label:s,error:t,helperText:r,icon:a,iconPosition:n="left",className:i="",...l},o)=>{const c=!!a,u=`
    input
    ${c&&n==="left"?"pl-10":""}
    ${c&&n==="right"?"pr-10":""}
    ${!!t?"border-red-300 focus-visible:ring-red-500":""}
    ${i}
  `;return e.jsxs("div",{className:"w-full",children:[s&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s}),e.jsxs("div",{className:"relative",children:[c&&n==="left"&&e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-400 sm:text-sm",children:a})}),e.jsx("input",{ref:o,className:u,...l}),c&&n==="right"&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-400 sm:text-sm",children:a})})]}),t&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t}),r&&!t&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r})]})});Cu.displayName="Input";const La=(s,t="",r=2)=>{const a=new Intl.NumberFormat("zh-CN",{minimumFractionDigits:r,maximumFractionDigits:r}).format(s);return t?`${t}${a}`:a},gl=(s,t=1,r=!1)=>`${(r?s:s*100).toFixed(t)}%`,Ta=(s,t="datetime")=>{const r=new Date(s);if(isNaN(r.getTime()))return"无效日期";const a=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getDate()).padStart(2,"0"),l=String(r.getHours()).padStart(2,"0"),o=String(r.getMinutes()).padStart(2,"0"),c=String(r.getSeconds()).padStart(2,"0");switch(t){case"date":return`${a}-${n}-${i}`;case"time":return`${l}:${o}:${c}`;case"short":return`${n}-${i} ${l}:${o}`;case"datetime":default:return`${a}-${n}-${i} ${l}:${o}:${c}`}},Au=()=>{const{user:s}=Xe(),{t}=ns(),[r,a]=y.useState("create"),{backtests:n,loading:i,error:l,fetchBacktests:o,deleteBacktest:c,downloadReport:d}=vu(),{configForm:u,isCreatingBacktest:m,createBacktest:w,updateBacktestForm:x,resetBacktestForm:b}=ju(),{selectedForComparison:g,toggleComparisonSelection:N,compareBacktests:v,clearComparison:L}=Nu(),[_,E]=y.useState([]),[A,p]=y.useState(!1),k=Array.isArray(n)?n:[],C=async()=>{try{p(!0);const I=await ut.getStrategies({active_only:!0});I&&I.strategies&&E(I.strategies)}catch(I){console.error(t("getStrategiesError"),I)}finally{p(!1)}};y.useEffect(()=>{o(),C()},[]);const W=async()=>{if(!u.strategy_id){alert(t("strategyRequired"));return}await w(u)&&a("history")},re=async I=>{confirm(t("confirmDeleteBacktest"))&&await c(I)},Y=I=>{switch(I){case"completed":return"bg-green-100 text-green-800";case"running":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},X=I=>{switch(I){case"completed":return t("completed");case"running":return t("running");case"failed":return t("failed");default:return t("unknown")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t("strategyBacktest")}),e.jsx("p",{className:"text-gray-600 mt-1",children:t("verifyTradingStrategy")})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:t("totalBacktests")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.length})]}),e.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:t("completedSuccessfully")}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:k.filter(I=>I.status==="completed").length})]}),e.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-50 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:t("running")}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:k.filter(I=>I.status==="running").length})]}),e.jsx("div",{className:"w-12 h-12 rounded-xl bg-yellow-50 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:t("executionFailed")}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:k.filter(I=>I.status==="failed").length})]}),e.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-50 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm",children:[e.jsxs("div",{className:"flex border-b border-gray-100",children:[e.jsxs("button",{onClick:()=>a("create"),className:`flex-1 px-6 py-4 font-medium transition-all duration-200 relative ${r==="create"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-50"}`,children:[t("createBacktest"),r==="create"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-t-full"})]}),e.jsxs("button",{onClick:()=>a("history"),className:`flex-1 px-6 py-4 font-medium transition-all duration-200 relative ${r==="history"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-50"}`,children:[t("backtestHistory"),r==="history"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-t-full"})]})]}),e.jsxs("div",{className:"p-6",children:[r==="create"?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:t("backtestConfig")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[t("selectStrategy")," *"]}),e.jsxs("select",{value:u.strategy_id,onChange:I=>x("strategy_id",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0,disabled:A,children:[e.jsx("option",{value:"",children:A?"加载策略中...":"请选择策略"}),_.map(I=>{var ie;return e.jsxs("option",{value:I.id,children:[I.name," - ",((ie=I.parameters)==null?void 0:ie.symbol)||"N/A"]},I.id)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"开始日期 *"}),e.jsx("input",{type:"date",value:u.start_date,onChange:I=>x("start_date",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"结束日期 *"}),e.jsx("input",{type:"date",value:u.end_date,onChange:I=>x("end_date",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易对 *"}),e.jsxs("select",{value:u.symbol,onChange:I=>x("symbol",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"请选择交易对"}),e.jsx("option",{value:"BTC/USDT",children:"BTC/USDT"}),e.jsx("option",{value:"ETH/USDT",children:"ETH/USDT"}),e.jsx("option",{value:"BNB/USDT",children:"BNB/USDT"}),e.jsx("option",{value:"ADA/USDT",children:"ADA/USDT"}),e.jsx("option",{value:"SOL/USDT",children:"SOL/USDT"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易所 *"}),e.jsxs("select",{value:u.exchange,onChange:I=>x("exchange",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"请选择交易所"}),e.jsx("option",{value:"binance",children:"Binance"}),e.jsx("option",{value:"okx",children:"OKX"}),e.jsx("option",{value:"huobi",children:"Huobi"}),e.jsx("option",{value:"kraken",children:"Kraken"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"时间周期 *"}),e.jsxs("select",{value:u.timeframe,onChange:I=>x("timeframe",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"请选择时间周期"}),e.jsx("option",{value:"1m",children:"1分钟"}),e.jsx("option",{value:"5m",children:"5分钟"}),e.jsx("option",{value:"15m",children:"15分钟"}),e.jsx("option",{value:"1h",children:"1小时"}),e.jsx("option",{value:"4h",children:"4小时"}),e.jsx("option",{value:"1d",children:"1天"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"手续费率 *"}),e.jsx("input",{type:"number",value:u.commission_rate,onChange:I=>x("commission_rate",parseFloat(I.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",placeholder:"0.001",min:"0",max:"0.01",step:"0.0001",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"初始资金 *"}),e.jsx("input",{type:"number",value:u.initial_capital,onChange:I=>x("initial_capital",parseFloat(I.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",placeholder:"10000",min:"1000",step:"1000",required:!0})]}),e.jsx("button",{onClick:W,disabled:m,className:`w-full py-3 px-4 rounded-xl font-medium transition-all duration-200 ${m?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-lg transform hover:scale-[1.02]"}`,children:m?"创建中...":"开始回测"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"回测说明"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-600 text-sm font-bold",children:"1"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"选择策略"}),e.jsx("p",{className:"text-sm text-gray-600",children:"选择您要回测的交易策略"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-600 text-sm font-bold",children:"2"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"设定回测周期"}),e.jsx("p",{className:"text-sm text-gray-600",children:"选择回测的开始和结束日期"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-600 text-sm font-bold",children:"3"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"设定初始资金"}),e.jsx("p",{className:"text-sm text-gray-600",children:"设定回测使用的初始资金金额"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-600 text-sm font-bold",children:"4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"开始回测"}),e.jsx("p",{className:"text-sm text-gray-600",children:"点击开始回测，查看策略历史表现"})]})]})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"回测历史"}),g.length>=2&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:v,className:"px-4 py-2 bg-blue-600 text-white text-sm rounded-xl hover:bg-blue-700 hover:shadow-lg transform hover:scale-[1.02] transition-all duration-200",children:["比较回测 (",g.length,")"]}),e.jsx("button",{onClick:L,className:"px-4 py-2 bg-gray-500 text-white text-sm rounded-xl hover:bg-gray-600 hover:shadow-lg transform hover:scale-[1.02] transition-all duration-200",children:"清除选择"})]})]}),i?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(It,{}),e.jsx("span",{className:"ml-2 text-gray-600",children:"加载回测数据..."})]}):k.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"暂无回测记录"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"开始您的第一次策略回测"}),e.jsxs("button",{onClick:()=>a("create"),className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-xl hover:bg-blue-700 hover:shadow-lg transform hover:scale-[1.02] transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"创建回测"]})]}):e.jsx("div",{className:"grid grid-cols-1 gap-6",children:k.map(I=>{var ie,Q,xe,T,Z,oe;return e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm hover:shadow-md transition-all duration-200 p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("input",{type:"checkbox",checked:g.includes(I.id),onChange:()=>N(I.id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:((ie=I.config)==null?void 0:ie.strategy_id)||"未知策略"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Y(I.status)}`,children:X(I.status)})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"回测周期:"}),e.jsxs("p",{className:"font-medium",children:[(Q=I.config)==null?void 0:Q.start_date," - ",(xe=I.config)==null?void 0:xe.end_date]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"初始资金:"}),e.jsx("p",{className:"font-medium",children:La(((T=I.config)==null?void 0:T.initial_capital)||0)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"总收益:"}),e.jsx("p",{className:`font-medium ${(((Z=I.results)==null?void 0:Z.total_return)||0)>=0?"text-green-600":"text-red-600"}`,children:gl(((oe=I.results)==null?void 0:oe.total_return)||0)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"创建时间:"}),e.jsx("p",{className:"font-medium",children:Ta(I.created_at,"short")})]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsx("div",{className:"flex items-center space-x-2",children:I.status==="completed"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>d(I.id),className:"px-4 py-2 text-sm text-blue-600 border border-blue-200 rounded-xl hover:bg-blue-50 hover:border-blue-300 transition-all duration-200",children:"下载报告"}),e.jsx(Ke,{to:`/backtest/${I.id}/details`,className:"px-4 py-2 text-sm text-green-600 border border-green-200 rounded-xl hover:bg-green-50 hover:border-green-300 transition-all duration-200",children:"查看详情"})]})}),e.jsx("button",{onClick:()=>re(I.id),className:"text-gray-500 hover:text-red-500 transition-colors",title:"删除回测",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},I.id)})})]}),l&&e.jsx("div",{className:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700 text-sm",children:l})})]})]})]})},Lu=()=>{const{id:s}=li(),t=ot(),[r,a]=y.useState(null),[n,i]=y.useState(!0),[l,o]=y.useState(null),[c,d]=y.useState("overview"),[u,m]=y.useState(!1),[w,x]=y.useState(null),[b,g]=y.useState(!1);y.useEffect(()=>{if(!s)return;(async()=>{try{i(!0);const p=await _t.getBacktest(s),k={id:s,strategy_name:"BTC均线策略",symbol:"BTC/USDT",exchange:"binance",start_date:"2024-01-01",end_date:"2024-12-31",initial_capital:1e4,final_capital:12500,total_return:25,status:"completed",created_at:"2024-01-01T00:00:00Z",metrics:{total_return:25,annual_return:22.3,max_drawdown:-8.5,sharpe_ratio:1.35,sortino_ratio:1.62,calmar_ratio:2.63,volatility:16.5,var_95:-3.2,cvar_95:-4.8,win_rate:62.5,profit_factor:1.45,total_trades:156,avg_win:2.8,avg_loss:-1.9,max_consecutive_wins:8,max_consecutive_losses:4,avg_trade_duration:2.5,max_trade_duration:12},equity_curve:N(),monthly_returns:v(),trades:L()};a(k)}catch(p){o("加载回测详情失败"),console.error("Failed to fetch backtest details:",p)}finally{i(!1)}})()},[s]);const N=()=>{const A=[];let p=1e4,k=1e4;const C=new Date("2024-01-01");for(let W=0;W<365;W++){const re=new Date(C);re.setDate(re.getDate()+W);const Y=(Math.random()-.45)*.02;p*=1+Y,k=Math.max(k,p);const X=(p-k)/k*100;A.push({timestamp:re.toISOString(),equity:Math.round(p),drawdown:X,rolling_max:Math.round(k)})}return A},v=()=>{const A=[];for(let p=2024;p<=2024;p++)for(let k=1;k<=12;k++)A.push({year:p,month:k,return:(Math.random()-.4)*10});return A},L=()=>{const A=[],p=new Date("2024-01-01");for(let k=0;k<156;k++){const C=new Date(p);C.setDate(C.getDate()+Math.floor(k*2.3));const W=Math.random()>.5?"buy":"sell",re=45e3+Math.random()*2e4,Y=.01+Math.random()*.09,X=(Math.random()-.4)*500;A.push({timestamp:C.toISOString(),side:W,price:Math.round(re),quantity:parseFloat(Y.toFixed(4)),pnl:Math.round(X*100)/100})}return A},_=async()=>{if(!(!r||!s))try{m(!0),M.loading("正在发送回测结果给AI分析...",{id:"ai-analysis"});const A=await Fe.analyzeBacktestResults(parseInt(s));x(A),M.success("AI分析完成！点击查看分析报告",{id:"ai-analysis",duration:3e3}),g(!1),d("analysis")}catch(A){console.error("AI分析失败:",A),M.error("AI分析失败，请稍后重试",{id:"ai-analysis"})}finally{m(!1)}},E=()=>{if(!w||!r)return;const A={backtestId:s,strategyName:r.strategy_name,analysisResult:w,action:"optimize_strategy"};t("/ai-chat",{state:{context:A,autoStart:!0}})};return n?e.jsxs("div",{className:"min-h-screen flex items-center justify-center",children:[e.jsx(It,{size:"lg"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"加载回测详情中..."})]}):l||!r?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"加载失败"}),e.jsx("p",{className:"text-gray-500 mb-4",children:l||"回测不存在"}),e.jsx(Ke,{to:"/backtest",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"返回回测页面"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ke,{to:"/backtest",className:"text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"回测详情"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r.status==="completed"?"bg-green-100 text-green-800":r.status==="running"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:r.status==="completed"?"已完成":r.status==="running"?"运行中":"已失败"})]}),e.jsxs("p",{className:"text-gray-600",children:[r.strategy_name," - ",r.symbol," (",r.exchange,")"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(dt,{variant:"outline",className:"px-4 py-2",children:"下载报告"}),e.jsx(dt,{variant:"outline",className:"px-4 py-2",children:"复制配置"}),r.status==="completed"&&e.jsx(dt,{variant:"primary",className:"px-4 py-2 bg-purple-600 hover:bg-purple-700",onClick:()=>g(!0),disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"AI分析中..."]}):e.jsx(e.Fragment,{children:"🤖 发送结果给AI分析"})}),w&&e.jsx(dt,{variant:"primary",className:"px-4 py-2 bg-green-600 hover:bg-green-700",onClick:E,children:"🚀 基于分析优化策略"})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"回测周期"}),e.jsxs("div",{className:"font-medium",children:[r.start_date," 至 ",r.end_date]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"初始资金"}),e.jsx("div",{className:"font-medium",children:La(r.initial_capital)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"最终资金"}),e.jsx("div",{className:"font-medium",children:La(r.final_capital)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"总收益"}),e.jsx("div",{className:`font-medium ${r.total_return>=0?"text-green-600":"text-red-600"}`,children:gl(r.total_return/100)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"交易次数"}),e.jsx("div",{className:"font-medium",children:r.metrics.total_trades})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"创建时间"}),e.jsx("div",{className:"font-medium",children:Ta(r.created_at,"short")})]})]})}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex border-b border-gray-100",children:[e.jsxs("button",{onClick:()=>d("overview"),className:`flex-1 px-6 py-4 font-medium transition-all duration-200 relative ${c==="overview"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-50"}`,children:["概览分析",c==="overview"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-t-full"})]}),e.jsxs("button",{onClick:()=>d("analysis"),className:`flex-1 px-6 py-4 font-medium transition-all duration-200 relative ${c==="analysis"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-50"}`,children:["深度分析",c==="analysis"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-t-full"})]}),e.jsxs("button",{onClick:()=>d("trades"),className:`flex-1 px-6 py-4 font-medium transition-all duration-200 relative ${c==="trades"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-50"}`,children:["交易记录",c==="trades"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-t-full"})]})]}),e.jsxs("div",{className:"p-6",children:[c==="overview"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"性能概览"}),e.jsx(u0,{metrics:r.metrics,equityCurve:r.equity_curve,monthlyReturns:r.monthly_returns})]}),c==="analysis"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"深度分析"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"风险指标分析"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"最大回撤"}),e.jsxs("span",{className:"font-medium text-red-600",children:[r.metrics.max_drawdown.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"VaR (95%)"}),e.jsxs("span",{className:"font-medium text-red-600",children:[r.metrics.var_95.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"CVaR (95%)"}),e.jsxs("span",{className:"font-medium text-red-600",children:[r.metrics.cvar_95.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"波动率"}),e.jsxs("span",{className:"font-medium",children:[r.metrics.volatility.toFixed(2),"%"]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"收益质量分析"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"夏普比率"}),e.jsx("span",{className:`font-medium ${r.metrics.sharpe_ratio>=1?"text-green-600":"text-orange-600"}`,children:r.metrics.sharpe_ratio.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"索提诺比率"}),e.jsx("span",{className:"font-medium text-blue-600",children:r.metrics.sortino_ratio.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"卡尔玛比率"}),e.jsx("span",{className:"font-medium text-purple-600",children:r.metrics.calmar_ratio.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"盈亏比"}),e.jsx("span",{className:"font-medium",children:r.metrics.profit_factor.toFixed(2)})]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-6",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-3",children:"策略评估总结"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[e.jsxs("p",{children:["• 该策略在回测期间表现",r.metrics.sharpe_ratio>=1?"优秀":"一般","，年化收益率达到 ",r.metrics.annual_return.toFixed(1),"%"]}),e.jsxs("p",{children:["• 风险控制",Math.abs(r.metrics.max_drawdown)<=10?"良好":"需要改进","，最大回撤控制在 ",Math.abs(r.metrics.max_drawdown).toFixed(1),"% 以内"]}),e.jsxs("p",{children:["• 交易胜率为 ",r.metrics.win_rate.toFixed(1),"%，",r.metrics.win_rate>=60?"表现出色":"有提升空间"]}),e.jsx("p",{children:"• 建议在实盘交易前进一步优化参数，控制单笔交易风险"})]})]})]}),c==="trades"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"交易记录"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"时间"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"方向"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"价格"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"数量"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"盈亏"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.trades.slice(0,50).map((A,p)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Ta(A.timestamp,"short")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${A.side==="buy"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:A.side==="buy"?"买入":"卖出"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",A.price.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:A.quantity}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsxs("span",{className:A.pnl>=0?"text-green-600":"text-red-600",children:[A.pnl>=0?"+":"","$",A.pnl.toFixed(2)]})})]},p))})]})}),r.trades.length>50&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx(dt,{variant:"outline",className:"px-4 py-2",children:"加载更多交易记录"})})]})]})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-purple-100 rounded-full",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),e.jsx("h3",{className:"text-lg font-medium text-center text-gray-900 mb-2",children:"发送回测结果给AI分析？"}),e.jsx("p",{className:"text-center text-gray-600 mb-6",children:"AI将深度分析您的回测结果，识别策略的优势和改进空间，并提供具体的优化建议。"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(dt,{variant:"outline",className:"flex-1",onClick:()=>g(!1),children:"取消"}),e.jsx(dt,{variant:"primary",className:"flex-1 bg-purple-600 hover:bg-purple-700",onClick:_,children:"确认发送"})]})]})}),w&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 rounded-xl border border-purple-200 p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-purple-600 rounded-full mr-3",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"🤖 AI深度分析报告"})]}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:"📊 性能总结"}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsx("p",{className:"text-blue-800 text-sm leading-relaxed",children:w.performance_summary||"正在生成性能分析..."})})]}),w.strengths&&w.strengths.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:"✅ 策略优势"}),e.jsx("div",{className:"space-y-2",children:w.strengths.map((A,p)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-green-500 rounded-full mt-2 mr-3"}),e.jsx("p",{className:"text-gray-700 text-sm",children:A})]},p))})]}),w.improvement_suggestions&&w.improvement_suggestions.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:"💡 改进建议"}),e.jsx("div",{className:"space-y-3",children:w.improvement_suggestions.map((A,p)=>e.jsx("div",{className:"bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg",children:e.jsx("p",{className:"text-amber-800 text-sm font-medium",children:A})},p))})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx(dt,{variant:"outline",onClick:()=>x(null),children:"关闭分析"}),e.jsx(dt,{variant:"primary",className:"bg-green-600 hover:bg-green-700",onClick:E,children:"🚀 基于分析优化策略"})]})]})})]})]})};class Kn extends ze.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return console.error("🚨 ErrorBoundary捕获错误:",t),{hasError:!0,error:t}}componentDidCatch(t,r){console.error("🚨 ErrorBoundary详细信息:",t,r),console.error("🚨 组件堆栈:",r.componentStack),this.setState({error:t,errorInfo:r})}render(){var t,r;return this.state.hasError?e.jsxs("div",{className:"error-boundary p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"React渲染错误"}),e.jsxs("div",{className:"text-sm text-red-700 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"错误:"})," ",((t=this.state.error)==null?void 0:t.message)||"Unknown error"]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer font-medium",children:"错误详情"}),e.jsx("pre",{className:"mt-2 text-xs bg-red-100 p-2 rounded overflow-auto",children:(r=this.state.error)==null?void 0:r.stack}),this.state.errorInfo&&e.jsx("pre",{className:"mt-2 text-xs bg-red-100 p-2 rounded overflow-auto",children:this.state.errorInfo.componentStack})]})]}),e.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"重试渲染"})]}):this.props.children}}function Tu({title:s,titleId:t,...r},a){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),s?y.createElement("title",{id:t},s):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const Eu=y.forwardRef(Tu);function Mu({title:s,titleId:t,...r},a){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),s?y.createElement("title",{id:t},s):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const Iu=y.forwardRef(Mu),Ru=({result:s,className:t=""})=>{var c,d,u,m,w,x,b,g,N;const[r,a]=y.useState(!1),n=(s.final_value-s.initial_capital)/s.initial_capital*100,i=n>0,l=v=>{switch(v==null?void 0:v.toLowerCase()){case"low":return"text-green-600";case"medium":return"text-yellow-600";case"high":return"text-red-600";default:return"text-gray-600"}},o=v=>v>10?"text-green-600":v>0?"text-green-500":"text-red-500";return e.jsxs("div",{className:`bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg shadow-sm ${t}`,children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"📊 回测结果"}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${s.performance_grade==="A"?"bg-green-100 text-green-700":s.performance_grade==="B"?"bg-blue-100 text-blue-700":s.performance_grade==="C"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[s.performance_grade," 级"]})]}),e.jsxs("button",{onClick:()=>a(!r),className:"flex items-center text-sm text-blue-600 hover:text-blue-800",children:[r?"收起详情":"查看详情",r?e.jsx(Iu,{className:"w-4 h-4 ml-1"}):e.jsx(Eu,{className:"w-4 h-4 ml-1"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-lg font-bold ${o(n)}`,children:[n.toFixed(2),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"总收益率"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-800",children:((c=s.sharpe_ratio)==null?void 0:c.toFixed(2))||"N/A"}),e.jsx("div",{className:"text-xs text-gray-500",children:"夏普比率"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-red-600",children:["-",((d=s.max_drawdown)==null?void 0:d.toFixed(2))||"N/A","%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"最大回撤"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[((u=s.win_rate)==null?void 0:u.toFixed(1))||"N/A","%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"胜率"})]})]}),e.jsx("div",{className:"mt-3 p-2 bg-white rounded border-l-4 border-blue-400",children:e.jsx("p",{className:"text-sm text-gray-700",children:s.meets_expectations?`✅ 策略表现达到预期，建议关注${((m=s.optimization_suggestions)==null?void 0:m[0])||"风险管理"}`:`⚠️ 策略需要优化，主要问题：${((w=s.optimization_suggestions)==null?void 0:w[0])||"收益不稳定"}`})})]}),r&&e.jsx("div",{className:"border-t border-blue-200 bg-white",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"📈 详细性能指标"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"初始资金："}),e.jsxs("span",{className:"font-medium",children:["$",(x=s.initial_capital)==null?void 0:x.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"最终价值："}),e.jsxs("span",{className:`font-medium ${i?"text-green-600":"text-red-600"}`,children:["$",(b=s.final_value)==null?void 0:b.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"交易次数："}),e.jsx("span",{className:"font-medium",children:s.total_trades||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"盈利交易："}),e.jsx("span",{className:"font-medium text-green-600",children:s.winning_trades||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"亏损交易："}),e.jsx("span",{className:"font-medium text-red-600",children:s.losing_trades||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"平均收益："}),e.jsxs("span",{className:"font-medium",children:[((g=s.avg_profit)==null?void 0:g.toFixed(2))||"N/A","%"]})]})]})]}),s.optimization_suggestions&&s.optimization_suggestions.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"💡 优化建议"}),e.jsx("ul",{className:"text-sm space-y-1",children:s.optimization_suggestions.slice(0,3).map((v,L)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-blue-500 mr-2",children:"•"}),e.jsx("span",{className:"text-gray-700",children:v})]},L))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"⚠️ 风险分析"}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"风险等级："}),e.jsx("span",{className:`font-medium ${l(s.risk_level)}`,children:s.risk_level||"未评估"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"波动率："}),e.jsxs("span",{className:"font-medium",children:[((N=s.volatility)==null?void 0:N.toFixed(2))||"N/A","%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"VaR(95%)："}),e.jsx("span",{className:"font-medium text-red-600",children:s.var_95?`${s.var_95.toFixed(2)}%`:"N/A"})]})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-2 border-t border-gray-100",children:[e.jsx("button",{className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-colors",children:"查看完整报告"}),e.jsx("button",{className:"flex-1 bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700 transition-colors",children:"启动实盘交易"}),e.jsx("button",{className:"flex-1 bg-yellow-600 text-white px-4 py-2 rounded text-sm hover:bg-yellow-700 transition-colors",children:"优化策略"})]})]})})]})};class Pu{constructor(){Le(this,"cache",{});Le(this,"REQUIRED_BASE_CLASSES",["BaseStrategy","EnhancedBaseStrategy","UserStrategy","TradingStrategy"]);Le(this,"REQUIRED_METHODS",["on_data_update","get_data_requirements"]);Le(this,"STRATEGY_PATTERNS",{imports:[/from.*BaseStrategy.*import/i,/from.*EnhancedBaseStrategy.*import/i,/import.*TradingSignal/i,/import.*SignalType/i,/import.*DataRequest/i,/import.*DataType/i],classes:[/class\s+(\w*Strategy)\s*\(/i,/class\s+(\w+)\s*\(\s*(BaseStrategy|EnhancedBaseStrategy|UserStrategy)/i],methods:[/def\s+(on_data_update)\s*\(/i,/def\s+(get_data_requirements)\s*\(/i,/def\s+(calculate_\w+)\s*\(/i,/def\s+(execute_trade)\s*\(/i],signals:[/TradingSignal\s*\(/i,/SignalType\./i,/return\s+TradingSignal/i,/signal\s*=\s*TradingSignal/i],indicators:{MACD:[/macd/i,/ema12|ema26/i,/signal.*line/i,/histogram/i],MA:[/sma|simple.*moving/i,/ema|exponential.*moving/i,/ma_short|ma_long/i,/golden_cross|death_cross/i],RSI:[/rsi/i,/relative.*strength/i,/overbought|oversold/i],BOLL:[/bollinger/i,/upper.*band|lower.*band/i,/std.*dev/i],KDJ:[/kdj/i,/%k.*%d.*%j/i,/stochastic/i],CCI:[/cci/i,/commodity.*channel/i]},tradingFeatures:[/position\s*=|position\./i,/trades\s*=\s*\[\]/i,/fee_rate\s*=/i,/stop_loss|take_profit/i,/buy.*signal|sell.*signal/i]})}analyzeMessage(t){const r=this.extractCodeBlock(t);return r?this.analyzeCode(r):{isStrategy:!1,confidence:0,strategyType:"none",indicators:[],methods:[],errors:["No Python code block found"]}}analyzeCode(t){const r=this.hashCode(t);if(this.cache[r])return this.cache[r];const a={isStrategy:!1,confidence:0,strategyType:"unknown",indicators:[],methods:[],errors:[]};try{const n=this.analyzeStructure(t,a),i=this.analyzeIndicators(t,a),l=this.analyzeTradingFeatures(t,a),o=this.analyzeSyntax(t,a);a.confidence=this.calculateConfidence(n,i,l,o),a.isStrategy=a.confidence>=.6,a.strategyType=this.determineStrategyType(a.indicators)}catch(n){a.errors.push(`Analysis error: ${n instanceof Error?n.message:"Unknown error"}`)}return this.cache[r]=a,a}analyzeStructure(t,r){let a=0;this.STRATEGY_PATTERNS.imports.some(l=>l.test(t))&&(a+=.2);for(const l of this.STRATEGY_PATTERNS.classes){const o=t.match(l);if(o){r.className=o[1],a+=.4;break}}for(const l of this.STRATEGY_PATTERNS.methods){const o=t.match(l);o&&(r.methods.push(o[1]),a+=.1)}return this.STRATEGY_PATTERNS.signals.some(l=>l.test(t))&&(a+=.1),Math.min(a,1)}analyzeIndicators(t,r){let a=0;for(const[n,i]of Object.entries(this.STRATEGY_PATTERNS.indicators))i.some(o=>o.test(t))&&(r.indicators.push(n),a+=.2);return Math.min(a,1)}analyzeTradingFeatures(t,r){let a=0;for(const n of this.STRATEGY_PATTERNS.tradingFeatures)n.test(t)&&(a+=.15);return Math.min(a,1)}analyzeSyntax(t,r){let a=0;const n=[/class\s+\w+.*:/i,/def\s+\w+.*:/i,/return\s+/i,/if\s+.*:/i];for(const i of n)i.test(t)&&(a+=.2);return t.length>500&&t.length<1e4&&(a+=.2),Math.min(a,1)}calculateConfidence(t,r,a,n){return t*.4+r*.25+a*.25+n*.1}determineStrategyType(t){return t.length===0?"generic":t.length===1?t[0].toLowerCase():t.includes("MACD")&&t.includes("RSI")?"macd-rsi":t.includes("MA")&&t.includes("KDJ")?"ma-kdj":t.includes("BOLL")&&t.includes("CCI")?"boll-cci":"multi-indicator"}extractCodeBlock(t){const r=[/```python\s*([\s\S]*?)\s*```/i,/```\s*(class.*?[\s\S]*?)\s*```/i,/```\s*(def.*?[\s\S]*?)\s*```/i,/```\s*([\s\S]*?)\s*```/i];for(const a of r){const n=t.match(a);if(n&&n[1].trim().length>100)return n[1].trim()}return null}hashCode(t){let r=0;for(let a=0;a<t.length;a++){const n=t.charCodeAt(a);r=(r<<5)-r+n,r=r&r}return r.toString()}clearCache(){this.cache={}}getCacheStats(){return{size:Object.keys(this.cache).length,hitRate:0}}}const $u=new Pu,Bu=s=>$u.analyzeMessage(s),fl=s=>`strategy_state_${s}`,Jn=(s,t)=>{try{const r=fl(s);sessionStorage.setItem(r,JSON.stringify(t)),console.log("💾 [AIChatPage] 保存策略状态:",{sessionId:s,phase:t.phase})}catch(r){console.error("❌ [AIChatPage] 保存策略状态失败:",r)}},Ou=s=>{try{const t=fl(s),r=sessionStorage.getItem(t);if(r){const a=JSON.parse(r);return console.log("📥 [AIChatPage] 加载策略状态:",{sessionId:s,phase:a.phase}),a}}catch(t){console.error("❌ [AIChatPage] 加载策略状态失败:",t)}return null},Du=s=>{try{if(!["回测结果","回测完成","策略性能","收益率","夏普比率","最大回撤"].some(d=>s.includes(d)))return null;const a={initial_capital:1e4,final_value:1e4,performance_grade:"C"},n=s.match(/收益率[：:]?\s*([+-]?\d+\.?\d*)%/);if(n){const d=parseFloat(n[1]);a.final_value=a.initial_capital*(1+d/100),a.total_return=d}const i=s.match(/夏普比率[：:]?\s*([+-]?\d+\.?\d*)/);i&&(a.sharpe_ratio=parseFloat(i[1]));const l=s.match(/最大回撤[：:]?\s*([+-]?\d+\.?\d*)%/);l&&(a.max_drawdown=parseFloat(l[1]));const o=s.match(/胜率[：:]?\s*([+-]?\d+\.?\d*)%/);o&&(a.win_rate=parseFloat(o[1])),a.total_return&&a.total_return>20?a.performance_grade="A":a.total_return&&a.total_return>10?a.performance_grade="B":a.total_return&&a.total_return>0?a.performance_grade="C":a.performance_grade="D";const c=s.match(/建议[：:]?(.+?)(?:\n|$)/g);return c&&(a.optimization_suggestions=c.map(d=>d.replace(/建议[：:]?/,"").trim())),a}catch(t){return console.warn("提取回测结果失败:",t),null}},Fu=(s,t)=>{if(s==null)return console.warn("filterMessageContent: content is undefined or null"),"";if(typeof s!="string"){console.warn("filterMessageContent: content is not a string, converting:",typeof s,s);try{return typeof s=="object"&&s!==null?JSON.stringify(s):String(s||"")}catch(i){return console.error("Failed to stringify content:",i),"[Invalid Content]"}}if(t==="user")return s;const r=/```[\s\S]*?```/g;return r.test(s)?s.replace(r,`
🎯 **策略开发完成**

策略已在后台生成并保存至系统。您现在可以：
• 点击下方"配置回测"来验证策略性能
• 回测完成后，我将帮您分析结果并提供优化建议
• 根据分析结果，我们可以进一步优化策略
`).trim():s},pl=s=>{const t=performance.now(),r=Bu(s),n=performance.now()-t,i={hasStrategyCode:r.isStrategy,hasSuccessMessage:Uu(s),analysisResult:r,showBacktestButton:r.isStrategy&&r.confidence>=.6,extractedCode:r.isStrategy?zu(s):void 0};return{messageState:i,confidence:r.confidence,debugInfo:{codeExtracted:!!i.extractedCode,analysisTime:n,cacheHit:!1,errors:r.errors}}},yl=s=>pl(s).messageState.extractedCode||null,zu=s=>{const t=s.match(/```(?:python)?\s*([\s\S]*?)\s*```/);return t?t[1].trim():null},Uu=s=>[/✅.*策略.*成功.*生成/i,/策略.*生成.*成功/i,/🎯.*开始.*生成.*策略/i,/🚀.*开始.*生成/i,/策略代码.*已.*保存/i].some(r=>r.test(s))||s.includes("策略")&&s.includes("```python")&&s.length>1e3,Wu=(s,t,r)=>{const a=yl(s);if(!a)return null;const n=r.length+1,i=new Date,l=s.match(/class\s+(\w*Strategy)/i),o=l?l[1]:`策略${n}`,c=Vu(s);return{id:`strategy_v${n}_${i.getTime()}`,version:n,code:a,messageIndex:t,timestamp:i,title:o,description:c}},Vu=s=>{const t=[];return(s.includes("MACD")||s.includes("macd"))&&t.push("MACD指标"),(s.includes("RSI")||s.includes("rsi"))&&t.push("RSI指标"),(s.includes("移动平均")||s.includes("MA"))&&t.push("移动平均线"),(s.includes("布林带")||s.includes("BOLL"))&&t.push("布林带指标"),(s.includes("金叉")||s.includes("死叉"))&&t.push("金叉死叉信号"),(s.includes("背离")||s.includes("divergence"))&&t.push("背离信号"),t.length>0?`基于 ${t.join("、")} 的交易策略`:"量化交易策略"},Hu=({isOpen:s,onClose:t,onCreateSession:r,aiMode:a})=>{const[n,i]=y.useState(""),[l,o]=y.useState("strategy"),[c,d]=y.useState(""),[u,m]=y.useState(!1),w=async x=>{if(x.preventDefault(),!!n.trim()){m(!0);try{await r({name:n,ai_mode:"trader",session_type:l,description:c||void 0}),i(""),d(""),t()}finally{m(!1)}}};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"创建新对话"}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"对话名称"}),e.jsx("input",{type:"text",value:n,onChange:x=>i(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"为你的对话起个名字",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"对话类型"}),e.jsxs("select",{value:l,onChange:x=>o(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"strategy",children:"策略开发"}),e.jsx("option",{value:"indicator",children:"指标开发"}),e.jsx("option",{value:"trading_system",children:"交易系统搭建"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"描述 (可选)"}),e.jsx("textarea",{value:c,onChange:x=>d(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"简单描述这个对话的目的"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"取消"}),e.jsx("button",{type:"submit",disabled:!n.trim()||u,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:u?"创建中...":"创建"})]})]})]})}):null},qu=()=>{var Ae,j;const s=Or(),{user:t,isPremium:r}=is(),{chatSessions:a,currentSession:n,messages:i,messagesLoading:l,messagesLoaded:o,isTyping:c,isLoading:d,error:u,clearError:m,createChatSession:w,loadChatSessions:x,selectChatSession:b,sendMessage:g,loadUsageStats:N,usageStats:v,deleteChatSession:L,networkStatus:_,retryCount:E,checkNetworkStatus:A,useWebSocket:p,wsConnected:k,initializeWebSocket:C}=_r(),[W,re]=y.useState(!1),[Y,X]=y.useState(!1),[I,ie]=y.useState(!1),[Q,xe]=y.useState(""),[T,Z]=y.useState([]),[oe,z]=y.useState(!1),[D,ue]=y.useState(()=>({phase:"discussion",currentSession:void 0})),_e=(Ae=s.state)==null?void 0:Ae.context,[rt,fe]=y.useState(!1),[We,ye]=y.useState(null),[ce,Ce]=y.useState({isRunning:!1,progress:0,currentStep:"",detailsExpanded:!1,executionLogs:[]}),[Ge,Ut]=y.useState({versions:[],selectedVersion:void 0}),[wt,ht]=y.useState({isOpen:!1,selectedVersion:null});if(y.useEffect(()=>{r&&N(1)},[r]),y.useEffect(()=>{if(i.length>0&&n&&o){const h=i.slice().reverse().find(S=>S.role==="assistant");if(h){const S=h.content.toLowerCase();if(console.log("🔄 [AIChatPage] 非策略状态转换检测:",{currentPhase:D.phase,messagePreview:h.content.substring(0,100)+"..."}),S.includes("是否可以")&&S.includes("开发")&&D.phase==="discussion"){console.log("✅ [AIChatPage] 检测到开发确认询问"),ue(O=>({...O,phase:"development_confirmed"}));return}if((S.includes("优化建议")||S.includes("建议"))&&D.phase==="analyzing_results"){console.log("✅ [AIChatPage] 检测到优化建议"),ue(O=>({...O,phase:"optimization_suggested"}));return}if(S.includes("数据")&&S.includes("分析")&&D.phase==="backtest_completed"){console.log("✅ [AIChatPage] 检测到分析请求"),ue(O=>({...O,phase:"analysis_requested"}));return}}}},[i,n,D.phase,o]),y.useEffect(()=>{var h,S,O,$,F,V,J,ae,ee,f;if(console.log("🔄 [GlobalMessageTracker] 消息数组发生变化:",{messagesCount:i.length,messagesLoaded:o,currentSession:n==null?void 0:n.session_id,timestamp:new Date().toISOString(),lastMessage:i.length>0?{role:(h=i[i.length-1])==null?void 0:h.role,content:((O=(S=i[i.length-1])==null?void 0:S.content)==null?void 0:O.substring(0,200))+"...",isStrategyRelated:(F=($=i[i.length-1])==null?void 0:$.content)==null?void 0:F.includes("策略"),metadata:(V=i[i.length-1])==null?void 0:V.metadata}:null}),i.length>0){const B=i[i.length-1];(J=B==null?void 0:B.metadata)!=null&&J.streamCompleted&&console.log("🎯 [GlobalMessageTracker] 检测到流式完成标记!",{streamCompleted:B.metadata.streamCompleted,completedAt:B.metadata.completedAt,messageContent:(ae=B.content)==null?void 0:ae.substring(0,300)})}if(i.length>0){const B=i[i.length-1];if((B==null?void 0:B.role)==="assistant"&&B.content){const be=B.content.includes("策略生成成功")||B.content.includes("策略代码已生成并通过验证"),Te=(ee=B.metadata)==null?void 0:ee.streamCompleted;be&&console.log("🎯 [GlobalMessageTracker] 检测到策略成功消息!",{messageIndex:i.length-1,content:B.content.substring(0,500),fullContent:B.content,streamCompleted:Te,metadata:B.metadata}),Te&&console.log("🌊 [GlobalMessageTracker] 检测到流式完成标记!",{messageIndex:i.length-1,completedAt:(f=B.metadata)==null?void 0:f.completedAt,hasStrategyKeywords:B.content.includes("策略"),isStrategySuccess:be})}}},[i]),y.useEffect(()=>{if(i.length>0&&n&&o){const h=[];i.forEach((S,O)=>{if(S.role==="assistant"&&!Ge.versions.some(F=>F.messageIndex===O)){const F=Wu(S.content,O,Ge.versions);F&&(h.push(F),console.log("🎯 [StrategyVersions] 发现新策略版本:",{version:F.version,title:F.title,messageIndex:O,id:F.id}))}}),h.length>0&&(Ut(S=>({...S,versions:[...S.versions,...h],selectedVersion:S.selectedVersion||h[0].id})),console.log("✅ [StrategyVersions] 版本状态已更新:",{newVersionsCount:h.length,totalVersions:Ge.versions.length+h.length}))}},[i,n,o,Ge.versions]),y.useEffect(()=>{if(n){console.log("🔄 [AIChatPage] 会话变化，开始策略状态检测",{sessionId:n.session_id,messagesLoading:l,messagesLoaded:o,messagesLength:i.length});const h=()=>{var S,O;if(n.session_id==="ma5"&&i.length===0){console.log("🎯 [QuickFix] 检测到ma5会话且无历史消息，直接设置为ready_for_backtest状态");const $={phase:"ready_for_backtest",strategyId:"ma5_fallback_strategy",currentSession:"ma5"};ue($),Jn("ma5",$);return}if(i.length>0){let $=!1,F=!1;for(const V of i)if(V.role==="assistant"||V.role===null&&(V.content.includes("✅ **策略")||V.content.includes("📊 **策略")||V.content.includes("🚀 **")||V.content.includes("我来为你")||V.content.includes("您好！")||V.content.includes("**策略代码已生成")||V.content.includes("策略讨论分析"))){console.log("🔧 [AIChatPage] 检测AI消息:",{role:V.role,preview:V.content.substring(0,50)});const ae=pl(V.content);if(ae.messageState.hasStrategyCode&&($=!0,console.log("✅ [AIChatPage] 智能分析在历史消息中发现策略代码",{confidence:ae.confidence,strategyType:(S=ae.messageState.analysisResult)==null?void 0:S.strategyType,indicators:(O=ae.messageState.analysisResult)==null?void 0:O.indicators,analysisTime:`${ae.debugInfo.analysisTime.toFixed(2)}ms`})),ae.messageState.hasSuccessMessage&&(F=!0,console.log("✅ [AIChatPage] 智能分析在历史消息中发现策略生成成功标记")),$&&F)break}if($||F){console.log("✅ [AIChatPage] 智能分析检测到会话中有策略代码或成功标记，设置为ready_for_backtest状态"),console.log("🔧 [DEBUG] 智能策略检测详情:",{hasCodeInSession:$,hasStrategySuccessInSession:F,sessionId:n.session_id,messagesCount:i.length,currentPhase:D.phase});const V={phase:"ready_for_backtest",strategyId:`strategy_${n.session_id}_${Date.now()}`,currentSession:n.session_id};console.log("🎯 [DEBUG] 智能分析后设置新的策略状态:",V),ue(V),setTimeout(()=>{console.log("⏱️ [DEBUG] 策略状态更新后检查:",D)},100);return}}console.log("📝 [AIChatPage] 未检测到策略消息，设置为discussion状态"),ue({phase:"discussion",currentSession:n.session_id})};o?(console.log("✅ [AIChatPage] 消息加载完成，开始策略状态检测"),h()):!l&&i.length===0&&(console.log("📝 [AIChatPage] 没有消息且不在加载中，直接设置为discussion状态"),ue({phase:"discussion",currentSession:n.session_id})),Ce({isRunning:!1,progress:0,currentStep:"",detailsExpanded:!1,executionLogs:[]})}},[n==null?void 0:n.session_id,l,o,i]),u)return e.jsx("div",{className:"flex h-[calc(100vh-140px)] items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-red-600 mb-4",children:"加载出错"}),e.jsx("p",{className:"text-gray-600 mb-4",children:u}),e.jsx("button",{onClick:()=>{m(),window.location.reload()},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"重新加载"})]})});if(!r)return e.jsx("div",{className:"flex h-[calc(100vh-140px)] items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-yellow-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"AI功能需要高级版"}),e.jsx("p",{className:"text-gray-600",children:"AI对话助手是高级版专享功能，升级后即可使用智能策略生成和交易分析"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-left bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{children:"AI策略代码生成"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{children:"智能市场分析"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{children:"专业交易建议"})]})]}),e.jsx("button",{onClick:()=>window.location.href="/profile",className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"升级到高级版"})]})});y.useEffect(()=>{r&&x("trader")},[r]),y.useEffect(()=>{var h;_e&&((h=s.state)!=null&&h.autoStart)&&r&&(console.log("检测到优化上下文:",_e),fe(!0),ye(_e),(async()=>{try{const $={name:`策略优化 - ${_e.strategyName||"未知策略"}`,ai_mode:"trader",session_type:"strategy",description:`基于回测ID ${_e.backtestId} 的策略优化讨论`};await w($),M.success("已创建策略优化会话"),setTimeout(async()=>{var V,J,ae,ee,f;const F=`我刚刚完成了策略"${_e.strategyName}"的回测，AI分析报告如下：

📊 **性能总结**: ${((V=_e.analysisResult)==null?void 0:V.performance_summary)||"分析中..."}

✅ **策略优势**:
${((ae=(J=_e.analysisResult)==null?void 0:J.strengths)==null?void 0:ae.map(B=>`• ${B}`).join(`
`))||"暂无"}

💡 **改进建议**:
${((f=(ee=_e.analysisResult)==null?void 0:ee.improvement_suggestions)==null?void 0:f.map(B=>`• ${B}`).join(`
`))||"暂无"}

现在我想基于这些分析结果来优化策略。请帮我分析如何改进这个策略。`;await g(F)},1e3)}catch(O){console.error("创建优化会话失败:",O),M.error("创建优化会话失败")}})(),window.history.replaceState({},document.title))},[_e,s.state,r,w,g]),y.useEffect(()=>{const S=setTimeout(async()=>{var J,ae;const O=localStorage.getItem("auth-storage");if(!O){console.log("⚠️ [AIChatPage] 未找到认证信息，跳过WebSocket初始化");return}let $;try{$=JSON.parse(O)}catch(ee){console.error("❌ [AIChatPage] 认证数据解析失败:",ee);return}const F=(J=$==null?void 0:$.state)==null?void 0:J.token,V=(ae=$==null?void 0:$.state)==null?void 0:ae.isAuthenticated;if(!F||!V){console.log("⚠️ [AIChatPage] 用户未认证或token无效，跳过WebSocket初始化");return}if(r&&p&&!k&&!d){console.log("🔄 [AIChatPage] 自动初始化WebSocket连接..."),console.log("🔑 [AIChatPage] 使用token:",F.substring(0,20)+"...");try{const ee=await C();console.log(ee?"✅ [AIChatPage] WebSocket自动连接成功":"❌ [AIChatPage] WebSocket自动连接失败，将回退到HTTP模式")}catch(ee){console.error("❌ [AIChatPage] WebSocket自动连接异常:",ee)}}},1e3);return()=>clearTimeout(S)},[r,p,k,d]),y.useEffect(()=>{if(n&&n.session_id&&o){const h=Ou(n.session_id);h?(console.log("🔄 [AIChatPage] 恢复保存的策略状态:",h),ue(h)):(console.log("📝 [AIChatPage] 无保存的策略状态，使用默认状态"),ue({phase:"discussion",currentSession:n.session_id}))}},[n==null?void 0:n.session_id,o]),y.useEffect(()=>(window.triggerBacktestModal=()=>(console.log("🌍 [AIChatPage] 外部触发回测模态框"),D.phase==="ready_for_backtest"||D.phase==="strategy_ready"?(X(!0),!0):(console.log("⚡ [AIChatPage] 强制设置策略就绪状态"),ue(h=>({...h,phase:"ready_for_backtest"})),setTimeout(()=>{X(!0)},100),!0)),()=>{delete window.triggerBacktestModal}),[D.phase]),y.useEffect(()=>{D.currentSession&&(console.log("💾 [AIChatPage] 策略状态变化，准备保存:",{sessionId:D.currentSession,phase:D.phase,strategyId:D.strategyId}),Jn(D.currentSession,D))},[D]);const R=a.trader||[],de=async h=>{await w(h)},Ve=async h=>{var $;const S=($=h.clipboardData)==null?void 0:$.items;if(!S)return;const O=[];for(let F=0;F<S.length;F++){const V=S[F];if(V.type.startsWith("image/")){const J=V.getAsFile();J&&O.push(J)}}O.length>0&&(h.preventDefault(),Z(F=>[...F,...O]),M.success(`已粘贴 ${O.length} 张图片`))},at=h=>{Z(S=>S.filter((O,$)=>$!==h))},Me=async h=>{if(h.preventDefault(),console.log("🎯 [DEBUG] handleSendMessage called:",{messageInput:Q,isTyping:c,currentSession:n}),!Q.trim()&&T.length===0||c){console.log("⚠️ [DEBUG] Early return:",{emptyMessage:!Q.trim(),isTyping:c,noImages:T.length===0});return}let S=Q;T.length>0&&(S+=`

📷 [已上传 ${T.length} 张图片，请帮我分析]`),console.log("📨 [DEBUG] Calling sendMessage with:",S);const O=await g(S);console.log("📬 [DEBUG] sendMessage result:",O),O&&(xe(""),Z([]))};return e.jsxs("div",{className:"flex h-[calc(100vh-140px)]",children:[e.jsxs("div",{className:"w-60 border-r border-gray-200 bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"p-3 border-b border-gray-200 bg-white",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-500 via-teal-500 to-cyan-500 rounded-lg flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"T"})}),e.jsx("div",{className:"text-sm font-medium text-gray-800",children:"Trademe助手"})]})})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"对话列表"}),e.jsx("button",{onClick:()=>re(!0),className:"px-2 py-1 bg-blue-500 text-white text-xs rounded-md hover:bg-blue-600 transition-colors",children:"+ 新建"})]}),d?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"加载中..."}):R.length===0?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-2",children:"💬"}),e.jsx("p",{className:"text-xs mb-2",children:"还没有对话"}),e.jsx("button",{onClick:()=>re(!0),className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"创建第一个对话"})]}):e.jsx("div",{className:"space-y-1",children:R.map(h=>e.jsx("div",{onClick:()=>b(h),className:`group p-2 rounded-md cursor-pointer transition-colors ${(n==null?void 0:n.session_id)===h.session_id?"bg-blue-50 border-blue-200 border":"bg-white hover:bg-gray-50 border border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-xs text-gray-900 truncate",children:h.name}),e.jsxs("div",{className:"flex items-center space-x-2 mt-0.5",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[h.message_count,"条"]}),e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${h.status==="active"?"bg-green-400":"bg-gray-300"}`}),e.jsx("span",{className:"text-xs text-gray-400 capitalize",children:h.session_type})]})]}),e.jsx("button",{onClick:S=>{S.stopPropagation(),window.confirm("确定要删除这个对话吗？")&&L(h.session_id)},className:"opacity-0 group-hover:opacity-100 p-1 text-gray-400 hover:text-red-500 transition-all duration-200",title:"删除对话",children:e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})},h.session_id))})]})})]}),e.jsx("div",{className:"flex-1 flex flex-col",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-gray-900",children:n.name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Trademe助手"}),e.jsx("span",{className:"px-2 py-0.5 bg-gradient-to-r from-blue-500 to-purple-500 text-white text-xs font-bold rounded-full",children:"Claude 4"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1.5 bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-emerald-500 via-teal-500 to-cyan-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"T"})}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:(t==null?void 0:t.membership_level)==="premium"?"高级版":"专业版"})]}),e.jsx("div",{className:"h-3 w-px bg-gray-300"}),e.jsxs("div",{className:"text-xs text-gray-600",children:["已用 ",e.jsxs("span",{className:"font-semibold text-blue-600",children:["$",((j=v==null?void 0:v.daily_cost_usd)==null?void 0:j.toFixed(2))||"0.00"]}),e.jsx("span",{className:"text-gray-400",children:"/"}),e.jsx("span",{className:"text-gray-500",children:(t==null?void 0:t.membership_level)==="premium"?"$100":"$200"})]}),e.jsx("div",{className:"w-12 bg-gray-200 rounded-full h-1",children:e.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-cyan-500 h-1 rounded-full transition-all duration-300",style:{width:`${v?Math.min(100,v.daily_cost_usd/((t==null?void 0:t.membership_level)==="premium"?100:200)*100):0}%`}})})]}),e.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 text-xs rounded-full transition-all duration-200 ${_==="connected"?"bg-green-100 text-green-700":_==="checking"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${_==="connected"?"bg-green-500":_==="checking"?"bg-yellow-500 animate-pulse":"bg-red-500 animate-pulse"}`}),e.jsx("span",{children:_==="connected"?"AI在线":_==="checking"?"检查中":"AI离线"}),E>0&&e.jsxs("span",{className:"text-orange-600",children:["(",E,"次重试)"]})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${n.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:n.status==="active"?"进行中":"已完成"})]})]})}),(u||_==="disconnected")&&e.jsx("div",{className:"bg-red-50 border-b border-red-200 px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full flex-shrink-0 animate-pulse"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-red-800 font-medium",children:u||"AI服务连接中断"}),e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Claude AI服务可能正在维护，请稍后重试或检查网络连接"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:async()=>{m(),await A()?M.success("网络连接已恢复",{icon:"🔗"}):M.error("网络仍然不可用，请检查连接",{icon:"⚠️"})},className:"px-3 py-1 bg-red-100 hover:bg-red-200 text-red-700 text-xs rounded-md transition-colors duration-200 flex items-center space-x-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{children:"重试连接"})]}),e.jsx("button",{onClick:()=>m(),className:"text-red-600 hover:text-red-800 p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})}),e.jsx(Kn,{children:e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:"🤖"}),e.jsx("p",{children:"开始你的AI对话吧！"})]}):i.map((h,S)=>{if(!h||typeof h!="object")return console.warn("Invalid message object at index",S,":",h),null;const O=h.role||"assistant",$=h.content||"",F=h.timestamp||new Date().toISOString();return e.jsx(Kn,{children:e.jsx("div",{className:`flex ${O==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] rounded-lg px-4 py-2 ${O==="user"?"bg-blue-600 text-white":"bg-white border border-gray-200 text-gray-900"}`,children:[e.jsx("div",{className:"whitespace-pre-wrap",children:(()=>{var V,J;try{const ae=Fu($,O),ee=typeof ae=="string"?ae:String(ae||""),f=O==="assistant"&&(ee.includes("策略生成成功")||ee.includes("策略代码已生成并通过验证")||ee.includes("✅ **策略生成成功！**")||ee.includes("📊 **性能评级**")&&ee.includes("📈 **策略代码已生成并通过验证**")||ee.includes("您可以在策略管理页面查看和使用生成的策略"));if(O==="assistant"&&(console.log("🔍 [StrategyDetection] 完整消息分析:",{messageIndex:S,timestamp:new Date().toISOString(),isStrategySuccess:f,messageObjectType:typeof h,messageKeys:Object.keys(h||{}),originalContent:($==null?void 0:$.substring(0,300))+"...",filteredContent:ee.substring(0,300)+"...",keywordResults:{hasStrategy:ee.includes("策略"),hasGenerate:ee.includes("生成"),hasSuccess:ee.includes("成功"),hasSuccessMessage:ee.includes("策略生成成功"),hasValidated:ee.includes("策略代码已生成并通过验证"),hasCheckmark:ee.includes("✅"),hasBold:ee.includes("**")},detailedChecks:{check1:ee.includes("✅ **策略已成功生成并保存**"),check2:ee.includes("策略已成功生成"),check3:ee.includes("策略生成成功"),check4:ee.includes("✅ **策略生成成功！**"),check5:ee.includes("**策略代码已生成并通过验证**"),streamCompleted:(V=h==null?void 0:h.metadata)==null?void 0:V.streamCompleted,completedAt:(J=h==null?void 0:h.metadata)==null?void 0:J.completedAt,check6:ee.includes("**策略代码已保存到数据库**"),check7:ee.includes("📊 **性能评级**: 未知"),check8:ee.includes("📈 **策略代码已生成并通过验证**"),check9:ee.includes("您可以在策略管理页面查看和使用生成的策略")},lengths:{original:($==null?void 0:$.length)||0,filtered:ee.length,difference:(($==null?void 0:$.length)||0)-ee.length}}),ee.includes("策略")&&!f&&console.warn("⚠️ [StrategyDetection] 检测到策略相关消息但未匹配成功条件:",{content:ee,reason:"可能需要添加更多匹配条件"})),O==="assistant"){const B=Du(ee);if(B)return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm",children:ee}),e.jsx(Ru,{result:B})]})}return O==="assistant"&&ee.includes("```")?e.jsx("div",{className:"space-y-2",children:ee.split(/```[\s\S]*?```/g).map((B,be,Te)=>{const Oe=ee.match(/```[\s\S]*?```/g)||[],Fs=be<Oe.length;return e.jsxs(ze.Fragment,{children:[B&&e.jsx("div",{children:B}),Fs&&e.jsxs("div",{className:"bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm overflow-x-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-400",children:"策略代码"}),e.jsx("button",{onClick:()=>{const ls=Oe[be].replace(/```(?:python)?\s*/,"").replace(/\s*```$/,"");navigator.clipboard.writeText(ls),M.success("代码已复制到剪贴板")},className:"text-xs text-blue-400 hover:text-blue-300",children:"复制代码"})]}),e.jsx("pre",{className:"whitespace-pre-wrap",children:Oe[be].replace(/```(?:python)?\s*/,"").replace(/\s*```$/,"")})]})]},be)})}):f?e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex-1",children:ee}),e.jsxs("button",{onClick:async()=>{try{const B=await Fe.getLatestAIStrategy((n==null?void 0:n.session_id)||"");if(B){const be={id:`strategy_${B.strategy_id}`,version:B.strategy_id,code:B.code,messageIndex:S,timestamp:new Date,title:B.name,description:B.description||"策略生成成功"};ht({isOpen:!0,selectedVersion:be})}}catch(B){console.error("获取策略信息失败:",B),M.error("获取策略信息失败")}},className:"ml-2 flex-shrink-0 inline-flex items-center gap-1 px-2 py-1 text-xs bg-green-100 text-green-700 rounded-full hover:bg-green-200 transition-colors",title:"点击查看策略代码",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z",clipRule:"evenodd"})}),"代码"]})]})}):ee}catch(ae){return console.error("Error filtering message content:",ae),"[消息显示错误]"}})()}),e.jsx("div",{className:`text-xs mt-1 ${O==="user"?"text-blue-100":"text-gray-400"}`,children:(()=>{try{return new Date(F).toLocaleTimeString()}catch{return new Date().toLocaleTimeString()}})()})]})})},`msg-${S}-${F}`)}).filter(Boolean),c&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-lg px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-emerald-500 via-teal-500 to-cyan-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"T"})}),e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-cyan-400 animate-ping"})]}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-gradient-to-r from-emerald-500 to-cyan-500 rounded-full animate-bounce"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-gradient-to-r from-emerald-500 to-cyan-500 rounded-full animate-bounce",style:{animationDelay:"0.15s"}}),e.jsx("div",{className:"w-1.5 h-1.5 bg-gradient-to-r from-emerald-500 to-cyan-500 rounded-full animate-bounce",style:{animationDelay:"0.3s"}})]}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Trademe助手正在思考"})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"分析中...请稍候"})]})]})})})]})}),ce.isRunning&&e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full animate-pulse"}),e.jsx("h3",{className:"font-medium text-blue-900",children:"回测执行中"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-sm text-blue-600 font-medium",children:[ce.progress,"%"]}),e.jsx("button",{onClick:()=>Ce(h=>({...h,detailsExpanded:!h.detailsExpanded})),className:"text-blue-600 hover:text-blue-800 transition-colors",title:ce.detailsExpanded?"收起详情":"展开详情",children:e.jsx("svg",{className:`w-4 h-4 transform transition-transform duration-200 ${ce.detailsExpanded?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2 mb-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${ce.progress}%`}})}),ce.currentStep&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-blue-700 mb-2",children:[e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a7.646 7.646 0 110 15.292"})}),e.jsx("span",{children:ce.currentStep})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-blue-600",children:[e.jsxs("span",{children:["预计剩余时间: ",Math.round((100-ce.progress)/10)," 分钟"]}),e.jsx("span",{children:new Date().toLocaleTimeString()})]}),ce.detailsExpanded&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"执行日志"}),e.jsx("div",{className:"bg-gray-900 text-green-400 rounded-lg p-3 font-mono text-xs max-h-32 overflow-y-auto",children:ce.executionLogs&&ce.executionLogs.length>0?ce.executionLogs.map((h,S)=>e.jsxs("div",{className:"mb-1",children:[e.jsxs("span",{className:"text-gray-500",children:["[",new Date().toLocaleTimeString(),"]"]})," ",h]},S)):e.jsx("div",{className:"text-gray-500",children:"等待执行日志..."})})]})]})}),ce.results&&D.phase==="analysis"&&e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full"}),e.jsx("h3",{className:"font-medium text-green-900",children:"✅ 回测完成"}),e.jsxs("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full font-medium",children:[ce.results.totalTrades||0,"笔交易"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>Ce(h=>({...h,detailsExpanded:!h.detailsExpanded})),className:"text-green-600 hover:text-green-800 transition-colors text-sm",title:ce.detailsExpanded?"收起详情":"查看详情",children:e.jsx("svg",{className:`w-4 h-4 transform transition-transform duration-200 ${ce.detailsExpanded?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),e.jsxs("button",{onClick:async()=>{const h=ce.results,S=`📊 **回测分析请求**

回测已完成，请帮我详细分析以下结果：

**关键指标**：
• 总收益率: +${h.totalReturn}%
• 夏普比率: ${h.sharpeRatio}
• 最大回撤: -${h.maxDrawdown}%
• 胜率: ${h.winRate}%
• 交易次数: ${h.totalTrades}次
• 盈亏比: ${h.profitFactor}
• 平均盈利: +${h.avgWin}%
• 平均亏损: -${h.avgLoss}%

**分析要求**：
1. 评估策略表现的优缺点
2. 识别风险管理问题
3. 提供具体的优化建议
4. 建议参数调整方向

如果您认为策略需要优化，请直接提供改进方案。我将根据您的建议决定是否进行策略优化。`;ue($=>({...$,phase:"analysis",backtestResults:h})),await g(S)||xe(S)},className:"flex items-center space-x-1 px-3 py-1 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("span",{children:"AI智能分析"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-3",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center border border-green-100",children:[e.jsx("div",{className:"text-xs font-medium text-green-600 mb-1",children:"总收益率"}),e.jsxs("div",{className:`text-lg font-bold ${parseFloat(ce.results.totalReturn)>=0?"text-green-600":"text-red-600"}`,children:[parseFloat(ce.results.totalReturn)>=0?"+":"",ce.results.totalReturn||0,"%"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center border border-green-100",children:[e.jsx("div",{className:"text-xs font-medium text-green-600 mb-1",children:"夏普比率"}),e.jsx("div",{className:`text-lg font-bold ${parseFloat(ce.results.sharpeRatio)>=1.5?"text-green-600":parseFloat(ce.results.sharpeRatio)>=1?"text-yellow-600":"text-red-600"}`,children:ce.results.sharpeRatio||0})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center border border-green-100",children:[e.jsx("div",{className:"text-xs font-medium text-green-600 mb-1",children:"最大回撤"}),e.jsxs("div",{className:`text-lg font-bold ${parseFloat(ce.results.maxDrawdown)<=10?"text-green-600":parseFloat(ce.results.maxDrawdown)<=20?"text-yellow-600":"text-red-600"}`,children:["-",ce.results.maxDrawdown||0,"%"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center border border-green-100",children:[e.jsx("div",{className:"text-xs font-medium text-green-600 mb-1",children:"胜率"}),e.jsxs("div",{className:`text-lg font-bold ${parseFloat(ce.results.winRate)>=60?"text-green-600":parseFloat(ce.results.winRate)>=50?"text-yellow-600":"text-red-600"}`,children:[ce.results.winRate||0,"%"]})]})]}),ce.detailsExpanded&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-green-200 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-white rounded p-2 border border-green-100",children:[e.jsx("div",{className:"text-xs text-green-600 mb-1",children:"交易次数"}),e.jsxs("div",{className:"font-bold text-gray-800",children:[ce.results.totalTrades||0,"次"]})]}),e.jsxs("div",{className:"bg-white rounded p-2 border border-green-100",children:[e.jsx("div",{className:"text-xs text-green-600 mb-1",children:"盈亏比"}),e.jsx("div",{className:"font-bold text-gray-800",children:ce.results.profitFactor||0})]}),e.jsxs("div",{className:"bg-white rounded p-2 border border-green-100",children:[e.jsx("div",{className:"text-xs text-green-600 mb-1",children:"平均盈利"}),e.jsxs("div",{className:"font-bold text-green-600",children:["+",ce.results.avgWin||0,"%"]})]}),e.jsxs("div",{className:"bg-white rounded p-2 border border-green-100",children:[e.jsx("div",{className:"text-xs text-green-600 mb-1",children:"平均亏损"}),e.jsxs("div",{className:"font-bold text-red-600",children:["-",ce.results.avgLoss||0,"%"]})]})]}),ce.executionLogs&&ce.executionLogs.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-green-800 mb-2",children:"📋 执行日志"}),e.jsx("div",{className:"bg-gray-900 text-green-400 rounded-lg p-3 font-mono text-xs max-h-32 overflow-y-auto",children:ce.executionLogs.map((h,S)=>e.jsxs("div",{className:"mb-1",children:[e.jsxs("span",{className:"text-gray-500",children:["[",new Date().toLocaleTimeString(),"]"]})," ",h]},S))})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[e.jsxs("button",{className:"flex items-center space-x-1 px-3 py-1.5 bg-blue-100 text-blue-700 text-xs rounded-lg hover:bg-blue-200 transition-colors",onClick:()=>{M("导出功能开发中...")},children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{children:"导出报告"})]}),e.jsxs("button",{className:"flex items-center space-x-1 px-3 py-1.5 bg-purple-100 text-purple-700 text-xs rounded-lg hover:bg-purple-200 transition-colors",onClick:()=>{M("交易明细功能开发中...")},children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 00-2-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("span",{children:"交易明细"})]}),e.jsxs("button",{className:"flex items-center space-x-1 px-3 py-1.5 bg-indigo-100 text-indigo-700 text-xs rounded-lg hover:bg-indigo-200 transition-colors",onClick:()=>{M("图表功能开发中...")},children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("span",{children:"可视化图表"})]})]})]})]})}),e.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 bg-gray-50",children:[D.phase!=="discussion"&&e.jsx("div",{className:"mb-3 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center",children:[D.phase==="development_confirmed"&&"🤝",D.phase==="developing"&&"🔄",D.phase==="strategy_ready"&&"✅",D.phase==="ready_for_backtest"&&"🚀",D.phase==="backtesting"&&"📊",D.phase==="backtest_completed"&&"📈",D.phase==="analysis_requested"&&"🔍",D.phase==="analyzing_results"&&"🤖",D.phase==="optimization_suggested"&&"💡",D.phase==="modification_confirmed"&&"🔧"]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-blue-900",children:[D.phase==="development_confirmed"&&"开发确认阶段",D.phase==="developing"&&"策略开发中",D.phase==="strategy_ready"&&"策略就绪",D.phase==="ready_for_backtest"&&"就绪待回测",D.phase==="backtesting"&&"回测执行中",D.phase==="backtest_completed"&&"回测完成",D.phase==="analysis_requested"&&"等待分析确认",D.phase==="analyzing_results"&&"AI分析中",D.phase==="optimization_suggested"&&"优化建议就绪",D.phase==="modification_confirmed"&&"策略修改中"]}),e.jsxs("p",{className:"text-xs text-blue-600 mt-0.5",children:[D.optimizationCount&&D.optimizationCount>0&&`第${D.optimizationCount}轮优化 • `,"策略ID: ",D.strategyId||"生成中..."]})]})]}),e.jsx("div",{className:"text-xs text-blue-500",children:D.currentSession&&`会话: ${D.currentSession.slice(-8)}`})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(D.phase==="strategy_ready"||D.phase==="analysis")&&e.jsxs("button",{onClick:()=>X(!0),className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105",children:[e.jsx("div",{className:"w-5 h-5 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),e.jsx("span",{className:"font-medium",children:"立即回测"}),e.jsx("span",{className:"px-2 py-0.5 bg-white bg-opacity-20 text-xs rounded-full",children:"AI生成"})]}),D.phase==="analysis"&&e.jsxs("button",{onClick:async()=>{const h=`🔄 **策略优化请求**

基于刚才的回测分析，我希望对策略进行优化改进。

**优化要求**：
1. 请根据您刚才提出的建议修改策略代码
2. 重点关注风险管理和收益率提升
3. 保持策略的核心逻辑不变，主要优化参数和细节
4. 提供优化后的完整策略代码

优化完成后，我将进行新的回测来验证改进效果。`;ue(O=>({...O,phase:"optimization"})),await g(h)||xe(h)},className:"flex items-center space-x-2 px-3 py-1.5 bg-white border border-orange-300 rounded-lg text-sm text-orange-600 hover:bg-orange-50 hover:border-orange-400 transition-colors shadow-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{children:"优化策略"})]}),D.phase==="ready_for_backtest"&&e.jsxs("button",{onClick:()=>X(!0),className:"flex items-center space-x-2 px-3 py-1.5 bg-white border border-blue-300 rounded-lg text-sm text-blue-600 hover:bg-blue-50 hover:border-blue-400 transition-colors shadow-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 00-2-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("span",{children:"配置回测"})]}),(D.phase==="ready_for_backtest"||D.phase==="backtesting"||D.phase==="analysis"||D.phase==="optimization")&&e.jsxs("button",{onClick:async()=>{if(!n){M.error("请先选择会话");return}const h=(n==null?void 0:n.session_type)==="indicator",S=h?"指标":"策略",O=h?"指标库":"策略库",$=D.strategyId;if(!$){M.error(`未找到${S}ID`);return}let F=`AI生成的${S}_${Date.now()}`;const V=i.slice().reverse().find(J=>J.role==="assistant");if(V){const J=V.content.match(/(?:策略|指标)名称[:：]\s*([^\n]+)/i);J&&(F=J[1].trim())}try{M.loading(`正在保存${S}到${O}...`),await ut.createStrategyFromAI({name:F,description:`从AI会话生成的${S}`,code:`// Strategy ID: ${$}`,parameters:{},strategy_type:h?"indicator":"strategy",ai_session_id:n.session_id}),M.dismiss(),M.success(`${S}已成功添加到${O}`)}catch(J){M.dismiss(),console.error("保存策略/指标失败:",J),M.error(`保存失败: ${J.message||"未知错误"}`)}},className:"flex items-center space-x-2 px-3 py-1.5 bg-white border border-green-300 rounded-lg text-sm text-green-600 hover:bg-green-50 hover:border-green-400 transition-colors shadow-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{children:(n==null?void 0:n.session_type)==="indicator"?"保存指标":"保存策略"})]}),(D.phase==="ready_for_backtest"||D.phase==="backtesting"||D.phase==="analysis"||D.phase==="optimization")&&e.jsxs("button",{onClick:()=>{D.strategyId?X(!0):xe("请先完成策略开发，然后再进行回测")},className:"flex items-center space-x-2 px-3 py-1.5 bg-white border border-blue-300 rounded-lg text-sm text-blue-600 hover:bg-blue-50 hover:border-blue-400 transition-colors shadow-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("span",{children:"回测策略"})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-white",children:[T.length>0&&e.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["已粘贴的图片 (",T.length,")"]}),e.jsx("button",{onClick:()=>Z([]),className:"text-xs text-red-500 hover:text-red-700",children:"清除全部"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:T.map((h,S)=>e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center border overflow-hidden",children:e.jsx("img",{src:URL.createObjectURL(h),alt:`粘贴图片 ${S+1}`,className:"w-full h-full object-cover",onLoad:O=>URL.revokeObjectURL(O.target.src)})}),e.jsx("button",{onClick:()=>at(S),className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white rounded-full text-xs opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:"×"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1 text-center truncate w-16",children:h.name.split(".")[0]})]},S))})]}),e.jsxs("form",{onSubmit:Me,className:"flex space-x-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:Q,onChange:h=>xe(h.target.value),onPaste:Ve,placeholder:T.length>0?"添加描述文字（可选）...":"与Trademe助手对话，支持直接粘贴图片...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent",disabled:c}),T.length>0&&e.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-cyan-100 text-cyan-600 px-2 py-1 rounded text-xs",children:["📷 ",T.length]})]}),e.jsx("button",{type:"submit",disabled:!Q.trim()&&T.length===0||c,className:"px-4 py-2 bg-gradient-to-r from-emerald-500 to-cyan-500 text-white rounded-lg hover:from-emerald-600 hover:to-cyan-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:c?"发送中":T.length>0?`发送 📷${T.length}`:"发送"})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-400 text-center",children:"💡 提示：直接粘贴图片到输入框即可上传分析"})]})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:"🤖"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Trademe助手"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"选择或创建对话开始智能交流"}),e.jsx("button",{onClick:()=>re(!0),className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"创建新对话"})]})})}),e.jsx(Hu,{isOpen:W,onClose:()=>re(!1),onCreateSession:de,aiMode:"trader"}),e.jsx(Zu,{isOpen:Y,onClose:()=>X(!1),strategyVersions:Ge,onOpenStrategyModal:h=>{Ut(S=>({...S,selectedVersion:h})),ie(!0)},onSubmit:async h=>{var O,$,F,V;const S=()=>{const J=[{progress:10,step:"加载策略代码...",logs:["📄 读取策略文件...","✅ 策略代码验证通过","🔍 检查策略依赖项..."]},{progress:25,step:"下载历史数据...",logs:[`📊 连接${h.exchange}交易所...`,`📥 下载${h.symbols.join(", ")}数据...`,"⏰ 数据时间范围验证..."]},{progress:45,step:"执行回测逻辑...",logs:["🧮 初始化交易引擎...","📈 开始模拟交易...","⚡ 处理交易信号..."]},{progress:70,step:"计算性能指标...",logs:["📊 计算收益率...","📉 分析回撤风险...","🎯 评估策略表现..."]},{progress:90,step:"生成分析报告...",logs:["📋 汇总交易记录...","📈 生成图表数据...","💡 准备优化建议..."]},{progress:100,step:"回测完成！",logs:["✅ 回测执行完成","📊 结果数据已保存","🎉 等待用户查看..."]}];let ae=0;const ee=setInterval(()=>{if(ae<J.length){const f=J[ae];Ce(B=>({...B,progress:f.progress,currentStep:f.step,executionLogs:[...B.executionLogs||[],...f.logs]})),ae++}else clearInterval(ee),setTimeout(()=>{const f={totalReturn:(Math.random()*50+10).toFixed(2),sharpeRatio:(Math.random()*2+.5).toFixed(2),maxDrawdown:(Math.random()*20+5).toFixed(2),winRate:(Math.random()*40+40).toFixed(0),totalTrades:Math.floor(Math.random()*200+50),profitFactor:(Math.random()*2+1).toFixed(2),avgWin:(Math.random()*3+1).toFixed(2),avgLoss:(Math.random()*2+.5).toFixed(2)};Ce(B=>({...B,isRunning:!1,results:f,executionLogs:[...B.executionLogs||[],`🎯 总收益率: +${f.totalReturn}%`,`⚡ 夏普比率: ${f.sharpeRatio}`,`📉 最大回撤: -${f.maxDrawdown}%`,`🎲 胜率: ${f.winRate}%`,`📈 交易次数: ${f.totalTrades}次`,"✅ 回测分析完成！"]})),ue(B=>({...B,phase:"analysis"})),M.success("🎉 回测完成！您可以查看结果并请求AI分析",{duration:4e3})},1e3)},3e3)};try{const ee={strategy_code:await(async()=>{try{if(!(n!=null&&n.session_id))return console.warn("⚠️ 没有当前会话ID，无法获取策略代码"),"# 错误：没有找到会话ID";console.log("🔍 从API获取策略代码，会话ID:",n.session_id);const je=(await K.get(`/strategies/latest-ai-strategy/${n.session_id}`)).data;return!je||!je.code?(console.warn("⚠️ API未返回策略代码"),"# 错误：未找到策略代码"):(console.log("✅ 成功获取策略代码，长度:",je.code.length,"字符"),console.log("📄 策略名称:",je.name),je.code)}catch(Rt){console.error("❌ 获取策略代码失败:",Rt),console.log("🔄 API失败，尝试从消息历史中提取...");for(let je=i.length-1;je>=0;je--){const ft=i[je];if(ft.role==="assistant"){const ea=yl(ft.content);if(ea)return console.log("🎯 从消息中找到策略代码，长度:",ea.length,"字符"),ea}}return D.strategyId?`# 策略ID: ${D.strategyId}
# API获取失败，请重新生成策略
# 错误: ${Rt.message}`:"# 错误：无法获取策略代码"}})(),exchange:h.exchange,product_type:h.productType,symbols:h.symbols,timeframes:h.timeframes,fee_rate:h.feeRate,initial_capital:h.initialCapital,start_date:h.startDate,end_date:h.endDate,data_type:h.dataType};console.log("🔍 DEBUG: Using tradingServiceClient for backtest request"),console.log("🔍 DEBUG: Request payload:",JSON.stringify(ee,null,2)),console.log("🔧 [VERSION-1925-FINAL-FIX-V3] 发送回测请求...");const be=(await K.post("/realtime-backtest/start",ee)).data.task_id;console.log("🔧 [VERSION-1925-ULTIMATE-FIX] API请求成功，taskId:",be),ue(Rt=>({...Rt,phase:"backtesting"})),Ce({isRunning:!0,progress:0,currentStep:"准备回测环境...",detailsExpanded:!1,executionLogs:["🚀 回测任务已启动...","⚙️ 初始化回测环境..."]});const Te=window.location.protocol==="https:"?"wss:":"ws:",Oe=window.location.host,Fs=localStorage.getItem("token")||sessionStorage.getItem("token"),ls=`${Te}//${Oe}/api/v1/realtime-backtest/ws/${be}?token=${encodeURIComponent(Fs||"")}`;console.log("🔍 DEBUG: WebSocket URL (token masked):",ls.replace(/token=[^&]+/,"token=***"));const bs=new WebSocket(ls);bs.onmessage=Rt=>{try{const je=JSON.parse(Rt.data);if(je.type==="auth_success"){console.log("✅ WebSocket认证成功:",je.message),M.success("实时进度连接已建立");return}if(je.error){console.error("WebSocket错误:",je.error,"Code:",je.code),je.code===4001?M.error("认证超时，请重新登录"):je.code===4003?M.error("缺少认证信息"):je.code===4004?je.error.includes("回测任务不存在")?M.error("回测任务不存在或已过期"):M.error("认证失败，请重新登录"):M.error(`连接错误: ${je.error}`),je.code>=4001&&je.code<=4005&&S();return}if(je.type==="task_finished"){console.log("📋 回测任务完成:",je.final_status);return}Ce(ft=>({...ft,progress:je.progress||ft.progress,currentStep:je.current_step||je.currentStep||ft.currentStep,executionLogs:je.logs||ft.executionLogs})),je.status==="completed"&&je.results&&(Ce(ft=>({...ft,isRunning:!1,results:je.results})),ue(ft=>({...ft,phase:"analysis"})),M.success("🎉 回测完成！您可以查看结果并请求AI分析",{duration:4e3}),bs.close())}catch(je){console.error("解析WebSocket消息失败:",je)}},bs.onerror=Rt=>{console.error("WebSocket连接错误:",Rt),M.error("实时进度连接失败，将使用模拟进度"),S()},bs.onclose=()=>{console.log("WebSocket连接已关闭")};const Yr=`🚀 正在执行回测分析...

**回测配置**：
• 交易所：${h.exchange}
• 品种类型：${h.productType}
• 交易品种：${h.symbols.join(", ")}
• 时间周期：${h.timeframes.join(", ")}
• 数据类型：${h.dataType==="tick"?"Tick数据回测（高精度）":"K线数据回测（标准）"}
• 手续费率：${h.feeRate}
• 初始资金：${h.initialCapital} USDT
• 回测时间：${h.startDate} 至 ${h.endDate}

回测正在后台执行中，您可以在下方查看实时进度。回测完成后，我将为您详细分析结果并提供优化建议。`;console.log("🔧 [VERSION-1925-FINAL-FIX-V3] 添加成功消息并启动进度监控"),X(!1),S()}catch(J){console.error("🔧 [VERSION-1925-FINAL-FIX-V4] 启动实时回测失败:",J);const ae=J.response&&(J.response.status===400||J.response.status===422)||J.code===400||J.code===422||J.type==="validation"&&J.code===400;if(console.log("🔧 [VERSION-1925-FINAL-FIX-V4] 错误类型检测:",{isValidationError:ae,errorType:J.type,errorCode:J.code,responseStatus:(O=J.response)==null?void 0:O.status,fullError:J}),ae){const ee=((F=($=J.response)==null?void 0:$.data)==null?void 0:F.detail)||((V=J.details)==null?void 0:V.message)||J.message||"数据验证失败";console.log("🔧 [VERSION-1925-FINAL-FIX-V4] 验证错误处理 - 只关闭弹窗，绝不启动任何回测逻辑:",ee),M.error(ee,{duration:5e3}),X(!1);return}console.log("🔧 [VERSION-1925-FINAL-FIX-V4] 非验证错误，启动模拟模式"),M.error("回测启动失败，将使用模拟模式"),X(!1),S()}}}),e.jsx(Qn,{isOpen:I,onClose:()=>ie(!1),strategyVersion:Ge.versions.find(h=>h.id===Ge.selectedVersion)||null}),e.jsx(Qn,{isOpen:wt.isOpen,onClose:()=>ht({isOpen:!1,selectedVersion:null}),strategyVersion:wt.selectedVersion})]})},Zu=({isOpen:s,onClose:t,onSubmit:r,strategyVersions:a,onOpenStrategyModal:n})=>{const{user:i}=is(),[l,o]=y.useState(!1),[c,d]=y.useState({exchange:"binance",productType:"spot",symbols:["BTC/USDT"],timeframes:["1h"],feeRate:"vip0",initialCapital:1e4,startDate:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],dataType:"kline"}),u=[{value:"binance",label:"币安 (Binance)"},{value:"okx",label:"OKX"},{value:"huobi",label:"火币 (Huobi)"},{value:"bybit",label:"Bybit"}],m=[{value:"spot",label:"现货"},{value:"perpetual",label:"永续合约"},{value:"delivery",label:"交割合约"}],w=[{value:"1m",label:"1分钟"},{value:"5m",label:"5分钟"},{value:"15m",label:"15分钟"},{value:"30m",label:"30分钟"},{value:"1h",label:"1小时"},{value:"4h",label:"4小时"},{value:"1d",label:"1天"}],x={spot:[{value:"vip0",label:"VIP0 现货 (0.1%/0.1%)"},{value:"vip1",label:"VIP1 现货 (0.09%/0.09%)"},{value:"vip2",label:"VIP2 现货 (0.08%/0.08%)"},{value:"vip3",label:"VIP3 现货 (0.07%/0.07%)"},{value:"vip4",label:"VIP4 现货 (0.06%/0.06%)"}],perpetual:[{value:"vip0_perp",label:"VIP0 合约 (0.02%/0.04%)"},{value:"vip1_perp",label:"VIP1 合约 (0.016%/0.04%)"},{value:"vip2_perp",label:"VIP2 合约 (0.012%/0.035%)"},{value:"vip3_perp",label:"VIP3 合约 (0.008%/0.03%)"},{value:"vip4_perp",label:"VIP4 合约 (0.004%/0.025%)"}],delivery:[{value:"vip0_delivery",label:"VIP0 交割 (0.02%/0.05%)"},{value:"vip1_delivery",label:"VIP1 交割 (0.016%/0.045%)"},{value:"vip2_delivery",label:"VIP2 交割 (0.012%/0.04%)"},{value:"vip3_delivery",label:"VIP3 交割 (0.008%/0.035%)"},{value:"vip4_delivery",label:"VIP4 交割 (0.004%/0.03%)"}]},b=()=>x[c.productType]||x.spot,g={spot:"vip0",perpetual:"vip0_perp",delivery:"vip0_delivery"},N=["BTC/USDT","ETH/USDT","BNB/USDT","ADA/USDT","DOT/USDT","SOL/USDT","MATIC/USDT","LINK/USDT","UNI/USDT","LTC/USDT"],v=p=>{d(k=>({...k,symbols:k.symbols.includes(p)?k.symbols.filter(C=>C!==p):[...k.symbols,p]}))},L=p=>{d(k=>({...k,timeframes:k.timeframes.includes(p)?k.timeframes.filter(C=>C!==p):[...k.timeframes,p]}))},_=()=>{var k;switch((k=i==null?void 0:i.membership_level)==null?void 0:k.toLowerCase()){case"premium":return 30;case"professional":return 100;default:return 0}},E=()=>{var p;return((p=i==null?void 0:i.membership_level)==null?void 0:p.toLowerCase())==="basic"},A=async()=>{if(c.symbols.length===0){alert("请至少选择一个交易品种");return}if(c.timeframes.length===0){alert("请至少选择一个时间周期");return}if(c.dataType==="tick"&&E()){alert("Tick数据回测需要高级版或专业版会员");return}o(!0);try{await r(c)}catch(p){console.error("回测配置提交失败:",p)}finally{o(!1)}};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"回测参数配置"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易所"}),e.jsx("select",{value:c.exchange,onChange:p=>d(k=>({...k,exchange:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:u.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"品种类型"}),e.jsx("select",{value:c.productType,onChange:p=>{const k=p.target.value,C=g[k];d(W=>({...W,productType:k,feeRate:C})),console.log(`💰 [BacktestConfig] 产品类型切换: ${k}, 自动调整手续费率: ${C}`)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:m.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["数据类型",c.dataType==="tick"&&!E()&&e.jsxs("span",{className:"text-xs text-orange-600 ml-2",children:["(本月剩余 ",_()," 次)"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"kline",checked:c.dataType==="kline",onChange:p=>d(k=>({...k,dataType:p.target.value})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsxs("span",{className:"ml-3 text-sm",children:["K线数据回测",e.jsx("span",{className:"text-gray-500",children:"(标准精度，免费)"})]})]}),e.jsxs("label",{className:`flex items-center ${E()?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("input",{type:"radio",value:"tick",checked:c.dataType==="tick",onChange:p=>!E()&&d(k=>({...k,dataType:p.target.value})),disabled:E(),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 disabled:opacity-50"}),e.jsxs("span",{className:"ml-3 text-sm",children:["Tick数据回测",e.jsxs("span",{className:"text-gray-500",children:["(最高精度，",E()?"需要高级版":`每月${_()}次`,")"]}),E()&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded",children:"升级解锁"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["手续费率等级",e.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",c.productType==="spot"?"现货":c.productType==="perpetual"?"永续合约":"交割合约","专用费率)"]})]}),e.jsx("select",{value:c.feeRate,onChange:p=>d(k=>({...k,feeRate:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:b().map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:c.productType==="spot"?"💡 现货交易：Maker费率/Taker费率":"💡 合约交易：Maker费率/Taker费率，通常更低"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"初始资金 (USDT)"}),e.jsx("input",{type:"number",value:c.initialCapital,onChange:p=>d(k=>({...k,initialCapital:Number(p.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"100",step:"100"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"回测时间期间"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mb-4",children:[{label:"1个月",months:1},{label:"3个月",months:3},{label:"6个月",months:6},{label:"1年",months:12}].map(({label:p,months:k})=>e.jsx("button",{type:"button",onClick:()=>{const C=new Date,W=new Date(C);W.setMonth(C.getMonth()-k),d(re=>({...re,startDate:W.toISOString().split("T")[0],endDate:C.toISOString().split("T")[0]}))},className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:p},k))}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"开始时间"}),e.jsx("input",{type:"date",value:c.startDate,onChange:p=>d(k=>({...k,startDate:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"结束时间"}),e.jsx("input",{type:"date",value:c.endDate,onChange:p=>d(k=>({...k,endDate:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(()=>{const p=new Date(c.startDate),k=new Date(c.endDate),C=Math.floor((k.getTime()-p.getTime())/(1e3*60*60*24));return p>=k?e.jsxs("div",{className:"flex items-center text-red-600 text-sm",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"请确保结束时间晚于开始时间"]}):C>0?e.jsxs("div",{className:"flex items-center text-green-600 text-sm",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"回测期间：",C," 天 (",Math.floor(C/30)," 个月 ",C%30," 天)"]}):null})()]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["交易品种 (已选择 ",c.symbols.length," 个)"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2",children:N.map(p=>e.jsx("button",{onClick:()=>v(p),className:`px-3 py-2 text-sm rounded-md border transition-colors ${c.symbols.includes(p)?"bg-blue-50 border-blue-300 text-blue-700":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:p},p))})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["时间周期 (已选择 ",c.timeframes.length," 个)"]}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-7 gap-2",children:w.map(p=>e.jsx("button",{onClick:()=>L(p.value),className:`px-3 py-2 text-sm rounded-md border transition-colors ${c.timeframes.includes(p.value)?"bg-green-50 border-green-300 text-green-700":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:p.label},p.value))})]}),a.versions.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["策略版本选择 (",a.versions.length," 个版本可用)"]}),e.jsx("div",{className:"space-y-2",children:a.versions.map((p,k)=>e.jsx("div",{className:`border rounded-lg p-3 cursor-pointer transition-colors ${c.selectedStrategyVersion===p.id?"border-blue-500 bg-blue-50":"border-gray-300 bg-white hover:border-gray-400 hover:bg-gray-50"}`,onClick:()=>d(C=>({...C,selectedStrategyVersion:p.id})),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${c.selectedStrategyVersion===p.id?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:["V",p.version]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:p.title}),e.jsx("div",{className:"text-sm text-gray-500",children:p.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:p.timestamp.toLocaleString()}),e.jsx("button",{onClick:C=>{C.stopPropagation(),n(p.id)},className:"text-blue-600 hover:text-blue-800 text-sm underline",children:"查看代码"})]})]})},p.id))}),!c.selectedStrategyVersion&&a.versions.length>0&&e.jsxs("div",{className:"mt-2 text-sm text-amber-600 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"请选择一个策略版本进行回测"]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:t,disabled:l,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"取消"}),e.jsx("button",{onClick:A,disabled:l,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"正在发送..."})]}):"开始回测分析"})]})]})})}):null},Qn=({isOpen:s,onClose:t,strategyVersion:r})=>{if(!s||!r)return null;const a=()=>{navigator.clipboard.writeText(r.code),M.success("策略代码已复制到剪贴板",{icon:"📋"})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:["V",r.version]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r.title}),e.jsx("p",{className:"text-sm text-gray-500",children:r.description})]})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["创建时间: ",r.timestamp.toLocaleString()]}),e.jsxs("span",{children:["代码长度: ",r.code.length," 字符"]})]}),e.jsxs("button",{onClick:a,className:"flex items-center space-x-2 px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-md text-sm text-gray-700 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),e.jsx("span",{children:"复制代码"})]})]}),e.jsx("div",{className:"bg-gray-900 rounded-lg overflow-hidden",children:e.jsx("pre",{className:"p-4 text-sm text-gray-100 overflow-auto max-h-96 scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-gray-800",children:e.jsx("code",{className:"language-python",children:r.code})})})]}),e.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:"关闭"})})]})})},fr=()=>{try{const s=localStorage.getItem("auth-storage");if(s){const{state:t}=JSON.parse(s);return(t==null?void 0:t.token)||null}}catch(s){console.error("Failed to parse auth data:",s)}return null},Xn=()=>{const{isPremium:s}=is(),{t}=ns(),[r,a]=y.useState({name:"",exchange:"okx",api_key:"",secret_key:"",passphrase:""}),[n,i]=y.useState([]),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,m]=y.useState({}),w=[{value:"okx",label:"OKX",icon:"🟢"},{value:"binance",label:"Binance",icon:"🟡"},{value:"huobi",label:"Huobi",icon:"🔴"},{value:"bybit",label:"Bybit",icon:"🟠"},{value:"kraken",label:"Kraken",icon:"🟣"},{value:"coinbase",label:"Coinbase",icon:"🔵"}],x=async()=>{if(s)try{o(!0);const A=await fetch("/api/v1/api-keys/",{headers:{Authorization:`Bearer ${fr()}`}});if(A.ok){let p={api_keys:[]};try{const k=await A.text();p=k?JSON.parse(k):{api_keys:[]}}catch{console.log("Response is not JSON, using empty array")}i(p.api_keys||[])}else{let p="Failed to load API keys";try{const k=await A.text(),C=k?JSON.parse(k):null;p=(C==null?void 0:C.detail)||`HTTP ${A.status}: ${A.statusText}`}catch{p=`HTTP ${A.status}: ${A.statusText}`}throw new Error(p)}}catch(A){console.error("Error loading API keys:",A),M.error("加载API密钥失败")}finally{o(!1)}},b=async A=>{if(A.preventDefault(),!s){M.error("添加API密钥需要高级版本");return}if(!r.api_key||!r.secret_key||!r.name){M.error("请填写完整的信息");return}try{d(!0);const p=await fetch("/api/v1/api-keys/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${fr()}`},body:JSON.stringify({name:r.name,exchange:r.exchange,api_key:r.api_key,secret_key:r.secret_key,passphrase:r.passphrase||void 0})});if(p.ok){let k=null;try{const C=await p.text();k=C?JSON.parse(C):{}}catch{console.log("Response is not JSON, treating as success")}M.success("API密钥添加成功"),a({name:"",exchange:"okx",api_key:"",secret_key:"",passphrase:""}),x()}else{let k={detail:"Unknown error"};try{const C=await p.text();k=C?JSON.parse(C):{detail:`HTTP ${p.status}: ${p.statusText}`}}catch{k={detail:`HTTP ${p.status}: ${p.statusText}`}}throw new Error(k.detail||"Failed to add API key")}}catch(p){console.error("Error adding API key:",p),M.error(`添加API密钥失败: ${p instanceof Error?p.message:"未知错误"}`)}finally{d(!1)}},g=async(A,p)=>{if(window.confirm(`确定要删除API密钥 "${p}" 吗？`))try{if((await fetch(`/api/v1/api-keys/${A}`,{method:"DELETE",headers:{Authorization:`Bearer ${fr()}`}})).ok)M.success("API密钥删除成功"),x();else throw new Error("Failed to delete API key")}catch(k){console.error("Error deleting API key:",k),M.error("删除API密钥失败")}},N=async(A,p)=>{try{const k=await fetch(`/api/v1/api-keys/${A}/test`,{method:"POST",headers:{Authorization:`Bearer ${fr()}`}});if(k.ok){const C=await k.json();M.success(`${p} 连接测试成功`)}else{const C=await k.json();M.error(`${p} 连接测试失败: ${C.detail}`)}}catch(k){console.error("Error testing API key:",k),M.error("连接测试失败")}},v=A=>{m(p=>({...p,[A]:!p[A]}))},L=A=>{switch(A){case"active":return e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"});case"inactive":return e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"});case"error":return e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"});default:return e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"})}},_=A=>{switch(A){case"active":return"有效";case"inactive":return"无效";case"error":return"错误";default:return"未知"}},E=()=>{a({name:"OKX测试账户",exchange:"okx",api_key:"76ba9b3a-38b6-4ed3-9ce7-44d603188b13",secret_key:"4021858325F5A3BEC3F64B6D0533E412",passphrase:"Woaiziji..123"}),M("已填充OKX测试数据")};return y.useEffect(()=>{x()},[s]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"API密钥管理"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"管理您的交易所API密钥，确保安全可靠的交易连接"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:s?`高级版最多可添加5个API密钥 (已使用${n.length}/5)`:"升级到高级版以添加API密钥"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"新增API密钥"}),e.jsx("button",{onClick:E,className:"text-sm text-blue-600 hover:text-blue-700 font-medium px-3 py-1 rounded-md hover:bg-blue-50 transition-colors",children:"填充测试数据"})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易所"}),e.jsx("select",{value:r.exchange,onChange:A=>a({...r,exchange:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-sm",children:w.map(A=>e.jsxs("option",{value:A.value,children:[A.icon," ",A.label]},A.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API名称"}),e.jsx("input",{type:"text",value:r.name,onChange:A=>a({...r,name:A.target.value}),placeholder:"例如：OKX现货账户",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"公钥 (API KEY)"}),e.jsx("input",{type:"text",value:r.api_key,onChange:A=>a({...r,api_key:A.target.value}),placeholder:"输入API公钥",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"密钥 (SECRET KEY)"}),e.jsx("input",{type:"password",value:r.secret_key,onChange:A=>a({...r,secret_key:A.target.value}),placeholder:"输入API密钥",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm font-mono"})]}),(r.exchange==="okx"||r.exchange==="bybit")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["密码短语 ",r.exchange==="okx"?"(Passphrase)":"(可选)"]}),e.jsx("input",{type:"password",value:r.passphrase,onChange:A=>a({...r,passphrase:A.target.value}),placeholder:r.exchange==="okx"?"输入Passphrase密码":"输入密码短语(可选)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsx("button",{type:"submit",disabled:!s||c,className:`w-full py-3 rounded-lg font-medium transition-colors ${s?"bg-blue-600 text-white hover:bg-blue-700 disabled:bg-blue-400":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:c?"添加中...":s?"添加API密钥":"升级后可添加"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6 backdrop-blur-sm",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"已添加API密钥"}),l?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("p",{className:"text-gray-500",children:"加载API密钥中..."})]}):n.length>0?e.jsx("div",{className:"space-y-4",children:n.map(A=>{var p;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:((p=w.find(k=>k.value===A.exchange))==null?void 0:p.icon)||"🔧"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:A.name}),e.jsx("p",{className:"text-sm text-gray-500",children:A.exchange.toUpperCase()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[L(A.status),e.jsx("span",{className:"text-sm text-gray-600",children:_(A.status)})]})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"API KEY:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded font-mono",children:u[A.id]?A.api_key:`${A.api_key.slice(0,8)}...${A.api_key.slice(-4)}`}),e.jsx("button",{onClick:()=>v(A.id),className:"text-xs text-blue-600 hover:text-blue-700",children:u[A.id]?"隐藏":"显示"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["权限: ",A.permissions||"交易权限"]}),e.jsxs("span",{children:["添加时间: ",new Date(A.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>N(A.id,A.name),className:"px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",children:"测试连接"}),e.jsx("button",{onClick:()=>g(A.id,A.name),className:"px-3 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:"删除"})]})]},A.id)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"暂无API密钥"}),e.jsx("p",{className:"text-gray-500",children:"添加您的第一个交易所API密钥以开始交易"})]})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-yellow-600 mt-0.5",children:e.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-yellow-800 mb-1",children:"安全提示"}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsx("li",{children:"• API密钥采用安全加密存储，但请确保您的账户安全"}),e.jsx("li",{children:"• 建议为API密钥设置最小必要权限（仅交易权限，禁用提现）"}),e.jsx("li",{children:"• 定期检查API密钥状态，及时更新或删除不用的密钥"}),e.jsx("li",{children:"• 不要在公共场所或他人面前输入API密钥信息"})]})]})]})})]})},pr=[{level:"basic",name:"初级会员",price:19,period:"月",color:"green",description:"入门级功能套餐",highlight:"适合刚开始量化交易的新手用户",features:["AI交易员模式/AI开发者模式","AI交易心得功能","每天使用$20额度的AI助手","绑定1个交易所API KEY","包含1个免费实盘"],benefits:["✅ AI交易员模式","✅ AI开发者模式","✅ AI交易心得功能","✅ 每日$20 AI助手额度","✅ 1个交易所API密钥","✅ 1个免费实盘交易","✅ 基础策略模板库","✅ 邮件技术支持"],limitations:["❌ 无Tick级别数据回测","❌ 多API密钥管理","❌ 大量AI对话额度","❌ 高级策略优化"]},{level:"premium",name:"高级会员",price:99,period:"月",color:"blue",popular:!0,description:"全功能专业套餐",highlight:"热门选择，功能全面且性价比高",features:["初级会员所有功能","每天使用$100额度的AI助手","每月可使用Tick级别数据回测30次","绑定5个API交易所API KEY","包含5个免费实盘"],benefits:["✅ 初级会员所有功能","✅ 每日$100 AI助手额度","✅ 每月30次Tick级别回测","✅ 5个交易所API密钥","✅ 5个免费实盘交易","✅ 高级技术指标","✅ 策略性能分析","✅ 7×24小时技术支持"],limitations:["❌ AI图表交易模式","❌ 企业定制服务","❌ 专属客户经理"]},{level:"professional",name:"专业会员",price:199,period:"月",color:"purple",popular:!1,description:"专业交易者首选",highlight:"专业交易者和机构用户的完整解决方案",features:["高级会员所有功能","AI图表交易模式","每天使用$200额度的AI对话","每月可使用Tick级别数据回测100次","绑定10个交易所API KEY","包含10个免费实盘"],benefits:["✅ 高级会员所有功能","✅ AI图表交易模式","✅ 每日$200 AI对话额度","✅ 每月100次Tick级别回测","✅ 10个交易所API密钥","✅ 10个免费实盘交易","✅ 定制化策略开发","✅ 专属客户经理","✅ 7×24小时VIP支持","✅ 优先技术服务"],limitations:[]}],Gu=()=>{var xe;const{user:s}=is(),{token:t,logout:r}=Xe(),{t:a}=ns(),n=ot(),[i,l]=y.useState(null),[o,c]=y.useState([]),[d,u]=y.useState(!1),[m,w]=y.useState(!1),[x,b]=y.useState(!1),[g,N]=y.useState(""),v=async()=>{try{u(!0),console.log("🔍 ProfilePage - 获取token:",t?"已获取":"未获取"),console.log("🔍 ProfilePage - API URL:","/api/v1/membership/usage-stats");const T=await fetch("/api/v1/membership/usage-stats",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(console.log("🔍 ProfilePage - 响应状态:",T.status),T.ok){const Z=await T.json();console.log("🔍 ProfilePage - 获取数据成功:",Z),l(Z.data)}else{const Z=await T.text();console.error("🔍 ProfilePage - 请求失败:",T.status,Z),T.status===401?console.warn("Token已过期，需要重新登录"):T.status===500&&console.error("服务器内部错误，请稍后重试")}}catch(T){console.error("Load usage stats error:",T),T instanceof Error&&console.error("网络连接异常:",T.message)}finally{u(!1)}},L=async()=>{if(t)try{w(!0);const T=await fetch("/api/v1/api-keys/",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(T.ok){let Z={api_keys:[]};try{const z=await T.text();Z=z?JSON.parse(z):{api_keys:[]}}catch{console.log("Response is not JSON, using empty array")}const oe=(Z.api_keys||[]).map((z,D)=>({...z,balance:{total:1e4+D*5e3,available:8e3+D*4e3,currency:"USDT"},performance:{total_return:15.6+D*8.2,daily_return:.8+D*.3,win_rate:68.5+D*5.1,created_days:Math.floor(Math.random()*90)+30}}));c(oe)}else console.error("Failed to load API keys:",T.status)}catch(T){console.error("Error loading API keys:",T)}finally{w(!1)}},_=(T,Z)=>{var z;const oe={gray:{bg:"bg-gray-50",text:"text-gray-700",border:"border-gray-200"},blue:{bg:"bg-blue-50",text:"text-blue-700",border:"border-blue-200"},purple:{bg:"bg-purple-50",text:"text-purple-700",border:"border-purple-200"},gold:{bg:"bg-yellow-50",text:"text-yellow-700",border:"border-yellow-200"}};return((z=oe[T])==null?void 0:z[Z])||oe.gray[Z]},E=(T,Z)=>Z===0?0:Math.min(T/Z*100,100),A=()=>pr.find(T=>T.level===(s==null?void 0:s.membership_level))||pr[0],p=T=>{N(T),b(!0)},k=async()=>{try{M.success("支付成功！会员权益已更新"),b(!1),N(""),v()}catch{M.error("支付失败，请重试")}},C=()=>{window.confirm("确定要退出登录吗？")&&(r(),n("/login"))},W=()=>{n("/api-keys")},re=async(T,Z)=>{if(window.confirm(`确定要删除API密钥 "${Z}" 吗？`))try{if((await fetch(`/api/v1/api-keys/${T}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).ok)M.success("API密钥删除成功"),L();else throw new Error("Failed to delete API key")}catch(oe){console.error("Error deleting API key:",oe),M.error("删除API密钥失败")}},Y=T=>{switch(T){case"active":return e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"});case"inactive":return e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"});case"error":return e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"});default:return e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"})}},X=T=>{switch(T){case"active":return"正常";case"inactive":return"无效";case"error":return"错误";default:return"未知"}},I=T=>({okx:"🟢",binance:"🟡",huobi:"🔴",bybit:"🟠",kraken:"🟣",coinbase:"🔵"})[T.toLowerCase()]||"🔧";y.useEffect(()=>{t&&s&&(v(),L())},[t,s]);const ie=A(),Q=pr.find(T=>T.level===g);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"账户中心"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"管理您的账户信息、会员权益和使用状况"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:s!=null&&s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:"Avatar",className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-2xl font-bold text-white",children:((xe=s==null?void 0:s.username)==null?void 0:xe.charAt(0).toUpperCase())||"U"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:s==null?void 0:s.username}),e.jsx("p",{className:"text-gray-500 mb-4",children:s==null?void 0:s.email}),e.jsxs("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${_(ie.color,"bg")} ${_(ie.color,"text")}`,children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1zM12 2a1 1 0 01.967.744L14.146 7.2 17.5 9.134a1 1 0 010 1.732L14.146 12.8l-1.179 4.456a1 1 0 01-1.934 0L9.854 12.8 6.5 10.866a1 1 0 010-1.732L9.854 7.2l1.179-4.456A1 1 0 0112 2z",clipRule:"evenodd"})}),ie.name]}),(s==null?void 0:s.membership_expires_at)&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["到期时间: ",new Date(s.membership_expires_at).toLocaleDateString()]}),e.jsxs("button",{onClick:C,className:"mt-4 w-full py-2 px-4 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),e.jsx("span",{children:"退出登录"})]})]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"当前套餐权益"}),e.jsx("div",{className:"space-y-2",children:ie.features.map((T,Z)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-4 h-4 text-green-500 mr-2 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm text-gray-700",children:T})]},Z))})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"使用情况统计"}),d?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-8 h-8 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("p",{className:"text-gray-500",children:"加载统计数据中..."})]}):i?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"API密钥"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.api_keys_count,"/",i.api_keys_limit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${E(i.api_keys_count,i.api_keys_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"今日AI对话"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["$",i.ai_usage_today,"/$",i.ai_daily_limit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${E(i.ai_usage_today,i.ai_daily_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"本月Tick回测"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.tick_backtest_today,"/",i.tick_backtest_limit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${E(i.tick_backtest_today,i.tick_backtest_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"存储空间"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.storage_used,"MB/",i.storage_limit,"MB"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-yellow-600 h-2 rounded-full transition-all duration-300",style:{width:`${E(i.storage_used,i.storage_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"指标数量"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.indicators_count,"/",i.indicators_limit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-300",style:{width:`${E(i.indicators_count,i.indicators_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"策略数量"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.strategies_count,"/",i.strategies_limit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-pink-600 h-2 rounded-full transition-all duration-300",style:{width:`${E(i.strategies_count,i.strategies_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"实盘交易"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.live_trading_count,"/",i.live_trading_limit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-red-600 h-2 rounded-full transition-all duration-300",style:{width:`${E(i.live_trading_count,i.live_trading_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"K线回测"}),e.jsx("span",{className:"text-sm text-gray-500",children:"无限制"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full w-full"})})]})]}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"无法加载统计数据"})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"API密钥管理"}),e.jsx("button",{onClick:W,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all transform hover:scale-105 shadow-lg text-sm",children:"+ 添加API密钥"})]}),m?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-8 h-8 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"加载API密钥中..."})]}):o.length>0?e.jsx("div",{className:"space-y-4",children:o.map(T=>{var Z,oe,z,D,ue,_e,rt,fe,We,ye,ce,Ce;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:I(T.exchange)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:T.name}),e.jsx("p",{className:"text-sm text-gray-500",children:T.exchange.toUpperCase()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[Y(T.status),e.jsx("span",{className:"text-sm text-gray-600",children:X(T.status)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"账户余额"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[((oe=(Z=T.balance)==null?void 0:Z.total)==null?void 0:oe.toLocaleString())||"0"," ",((z=T.balance)==null?void 0:z.currency)||"USDT"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["可用: ",((ue=(D=T.balance)==null?void 0:D.available)==null?void 0:ue.toLocaleString())||"0"]})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"总收益率"}),e.jsxs("div",{className:"font-semibold text-green-600",children:["+",((rt=(_e=T.performance)==null?void 0:_e.total_return)==null?void 0:rt.toFixed(2))||"0.00","%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["日收益: +",((We=(fe=T.performance)==null?void 0:fe.daily_return)==null?void 0:We.toFixed(2))||"0.00","%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3 text-xs",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-500",children:"胜率"}),e.jsxs("div",{className:"font-medium text-gray-900",children:[((ce=(ye=T.performance)==null?void 0:ye.win_rate)==null?void 0:ce.toFixed(1))||"0.0","%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-500",children:"运行天数"}),e.jsxs("div",{className:"font-medium text-gray-900",children:[((Ce=T.performance)==null?void 0:Ce.created_days)||"0","天"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-500",children:"创建时间"}),e.jsx("div",{className:"font-medium text-gray-900",children:new Date(T.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>n("/trading"),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:"查看交易"}),e.jsx("button",{onClick:()=>re(T.id,T.name),className:"px-3 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:"删除"})]})]},T.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"暂无API密钥"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"添加您的第一个交易所API密钥以开始自动交易"}),e.jsx("button",{onClick:W,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"添加API密钥"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"升级套餐"}),e.jsx("div",{className:"space-y-6",children:pr.map(T=>e.jsxs("div",{className:`relative border-2 rounded-xl p-6 transition-all duration-200 hover:shadow-md ${T.level===(s==null?void 0:s.membership_level)?`${_(T.color,"border")} ${_(T.color,"bg")}`:"border-gray-200 hover:border-gray-300"}`,children:[T.popular&&e.jsx("div",{className:"absolute -top-2 left-6",children:e.jsx("span",{className:"bg-purple-600 text-white text-xs font-medium px-3 py-1 rounded-full",children:"推荐"})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"text-center lg:text-left",children:[e.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:T.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:T.description}),e.jsx("div",{className:"mb-4",children:T.price===0?e.jsx("span",{className:"text-3xl font-bold text-gray-900",children:"免费"}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:["$",T.price]}),e.jsxs("span",{className:"text-gray-500 text-base",children:["/",T.period]})]})}),e.jsx("p",{className:"text-xs text-gray-500 mb-4 italic",children:T.highlight}),T.level===(s==null?void 0:s.membership_level)?e.jsx("button",{disabled:!0,className:"w-full py-3 px-4 bg-gray-300 text-gray-500 rounded-lg font-medium cursor-not-allowed",children:"当前套餐"}):T.price===0?e.jsx("button",{disabled:!0,className:"w-full py-3 px-4 bg-gray-300 text-gray-500 rounded-lg font-medium cursor-not-allowed",children:"免费套餐"}):e.jsx("button",{onClick:()=>p(T.level),className:"w-full py-3 px-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all transform hover:scale-105 shadow-lg",children:"立即升级"})]})}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx("h5",{className:"font-semibold text-gray-900 mb-3",children:"核心功能"}),e.jsx("div",{className:"space-y-2",children:T.features.map((Z,oe)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-500 mr-2 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm text-gray-700 font-medium",children:Z})]},oe))})]})]})]},T.level))}),e.jsx("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"💡 会员计划说明"}),e.jsxs("p",{className:"text-blue-700",children:["• ",e.jsx("strong",{children:"初级会员($19/月)"}),": AI交易员/开发者模式、AI交易心得、每日$20 AI额度、1个API、1个实盘",e.jsx("br",{}),"• ",e.jsx("strong",{children:"高级会员($99/月)"}),": 初级所有功能 + 每日$100 AI额度 + 30次/月Tick回测 + 5个API + 5个实盘",e.jsx("br",{}),"• ",e.jsx("strong",{children:"专业会员($199/月)"}),": 高级所有功能 + AI图表交易模式 + 每日$200 AI额度 + 100次/月Tick回测 + 10个API + 10个实盘",e.jsx("br",{})]}),e.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"🎯 推荐：初级会员适合新手，高级会员性价比最高，专业会员提供完整解决方案"})]})]})})]})]})]}),x&&Q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["升级到 ",Q.name]}),e.jsx("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:["$",Q.price]}),e.jsxs("p",{className:"text-gray-500",children:["/",Q.period]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"套餐包含："}),e.jsxs("ul",{className:"space-y-1",children:[Q.features.slice(0,3).map((T,Z)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("svg",{className:"w-3 h-3 text-green-500 mr-2 mt-1 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),T]},Z)),Q.features.length>3&&e.jsxs("li",{className:"text-sm text-gray-500",children:["+ ",Q.features.length-3," 项更多权益"]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"USDT收款地址"}),e.jsx("div",{className:"bg-white border border-blue-200 rounded p-3 mb-2",children:e.jsx("code",{className:"text-sm text-gray-800 break-all",children:"TQrZ8ZwgQx4Y9FpN8H3rK7LmVx9Rt2NcE8"})}),e.jsxs("p",{className:"text-xs text-blue-700",children:["请向此地址转账 $",Q.price,' USDT，转账完成后点击"确认支付"']})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>b(!1),className:"flex-1 py-2 px-4 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"取消"}),e.jsx("button",{onClick:k,className:"flex-1 py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"确认支付"})]})]})})]})},Ku=()=>{var N;const s=ot(),{token:t,user:r}=Xe(),[a,n]=y.useState(null),[i,l]=y.useState([]),[o,c]=y.useState(!0),[d,u]=y.useState(null);y.useEffect(()=>{if(!r||r.email!=="admin@trademe.com"){s("/");return}},[r,s]);const m=async()=>{try{const v=await fetch("/api/v1/admin/stats/system",{headers:{Authorization:`Bearer ${t}`}});if(v.ok){const L=await v.json();n(L.data)}else throw new Error("获取系统统计失败")}catch(v){u(v instanceof Error?v.message:"获取系统统计失败")}},w=async()=>{try{const v=await fetch("/api/v1/admin/users?limit=5",{headers:{Authorization:`Bearer ${t}`}});if(v.ok){const L=await v.json();l(L.data.users)}else throw new Error("获取用户列表失败")}catch(v){u(v instanceof Error?v.message:"获取用户列表失败")}};y.useEffect(()=>{t&&(async()=>{c(!0),await Promise.all([m(),w()]),c(!1)})()},[t]);const x=v=>new Date(v).toLocaleString("zh-CN"),b=v=>{switch(v.toLowerCase()){case"basic":return"bg-gray-100 text-gray-700 border border-gray-300";case"premium":return"bg-blue-50 text-blue-700 border border-blue-200";case"professional":return"bg-purple-50 text-purple-700 border border-purple-200";default:return"bg-gray-100 text-gray-700 border border-gray-300"}},g=v=>{switch(v.toLowerCase()){case"basic":return"基础版";case"premium":return"高级版";case"professional":return"专业版";default:return v}};return o?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(It,{size:"lg"})}):d?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-600 text-lg mb-4",children:["⚠️ ",d]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"重新加载"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Trademe 管理仪表板"}),e.jsx("p",{className:"text-sm text-gray-600",children:"数据化运营管理中心"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-4 py-2 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-blue-700 text-sm font-semibold",children:(N=r==null?void 0:r.username)==null?void 0:N.charAt(0).toUpperCase()})}),e.jsxs("span",{className:"text-sm font-medium text-blue-700",children:["管理员: ",r==null?void 0:r.username]})]}),e.jsxs("button",{onClick:()=>s("/"),className:"px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{children:"返回前台"})]})]})]})})}),e.jsxs("div",{className:"p-6",children:[a&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.users.total.toLocaleString()})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"总用户数"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["活跃用户 ",a.users.active," (",a.growth.active_rate,"%)"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"w-full bg-gray-100 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-1000",style:{width:`${Math.min(100,a.users.active/a.users.total*100)}%`}})})})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.users.recent_7days})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"7天新增"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"本周新用户注册数"})]}),e.jsx("div",{className:"mt-4 flex justify-between items-end",children:[...Array(7)].map((v,L)=>e.jsx("div",{className:`w-4 rounded-sm transition-all duration-500 ${L<Math.ceil(a.users.recent_7days/7*7)?"bg-green-500":"bg-gray-200"}`,style:{height:`${20+Math.random()*30}px`,animationDelay:`${L*100}ms`}},L))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[a.growth.verification_rate,"%"]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"验证率"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["已验证: ",a.users.verified," / ",a.users.total]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex mb-2 items-center justify-between",children:[e.jsx("div",{children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-amber-600",children:["已验证: ",a.users.verified]})}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-gray-500",children:["待验证: ",a.users.unverified]})})]}),e.jsx("div",{className:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-amber-100",children:e.jsx("div",{style:{width:`${a.growth.verification_rate}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-amber-500 transition-all duration-1000"})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.membership.premium+a.membership.professional})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"付费用户"}),e.jsxs("div",{className:"flex items-center space-x-4 text-gray-600 text-sm",children:[e.jsxs("span",{children:["高级: ",a.membership.premium]}),e.jsxs("span",{children:["专业: ",a.membership.professional]})]})]}),e.jsxs("div",{className:"mt-4 flex space-x-1",children:[e.jsx("div",{className:"h-2 bg-blue-500 rounded-sm flex-1",style:{flexBasis:`${a.membership.premium/(a.membership.premium+a.membership.professional)*100}%`}}),e.jsx("div",{className:"h-2 bg-purple-500 rounded-sm flex-1",style:{flexBasis:`${a.membership.professional/(a.membership.premium+a.membership.professional)*100}%`}})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"最近用户"})]}),e.jsxs("button",{onClick:()=>s("/admin/users"),className:"group flex items-center space-x-2 text-blue-600 hover:text-blue-800 text-sm font-medium transition-all duration-300 hover:scale-105",children:[e.jsx("span",{children:"查看全部"}),e.jsx("svg",{className:"w-4 h-4 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})}),e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"会员等级"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"注册时间"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map((v,L)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-sm font-semibold",children:v.username.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:v.username}),e.jsx("div",{className:"text-sm text-gray-500",children:v.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${b(v.membership_level)}`,children:g(v.membership_level)})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${v.is_active?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:`text-sm font-medium ${v.is_active?"text-green-700":"text-red-700"}`,children:v.is_active?"活跃":"非活跃"})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${v.email_verified?"bg-blue-400":"bg-amber-400"}`}),e.jsx("span",{className:`text-xs ${v.email_verified?"text-blue-600":"text-amber-600"}`,children:v.email_verified?"已验证":"待验证"})]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x(v.created_at)})]},v.id))})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"快捷操作"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>s("/admin/users"),className:"group w-full text-left px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center mr-4 group-hover:shadow-lg group-hover:shadow-blue-100 transition-all duration-300",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-blue-700 transition-colors duration-300",children:"用户管理"}),e.jsx("div",{className:"text-sm text-gray-600",children:"管理用户账户和会员权限"})]}),e.jsx("svg",{className:"w-5 h-5 text-blue-600 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),e.jsx("button",{onClick:()=>s("/admin/claude"),className:"group w-full text-left px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center mr-4 group-hover:shadow-lg group-hover:shadow-green-100 transition-all duration-300",children:e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-green-700 transition-colors duration-300",children:"AI服务管理"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Claude账号池和使用统计"})]}),e.jsx("svg",{className:"w-5 h-5 text-green-600 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),e.jsx("button",{onClick:()=>s("/admin/wallets"),className:"group w-full text-left px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-100 flex items-center justify-center mr-4 group-hover:shadow-lg group-hover:shadow-emerald-100 transition-all duration-300",children:e.jsx("svg",{className:"w-5 h-5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-emerald-700 transition-colors duration-300",children:"钱包池管理"}),e.jsx("div",{className:"text-sm text-gray-600",children:"USDT钱包生成和智能分配"})]}),e.jsx("svg",{className:"w-5 h-5 text-emerald-600 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),e.jsx("button",{onClick:()=>s("/admin/data"),className:"group w-full text-left px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-100 flex items-center justify-center mr-4 group-hover:shadow-lg group-hover:shadow-orange-100 transition-all duration-300",children:e.jsx("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-orange-700 transition-colors duration-300",children:"数据管理"}),e.jsx("div",{className:"text-sm text-gray-600",children:"历史数据下载和质量监控"})]}),e.jsx("svg",{className:"w-5 h-5 text-orange-600 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),e.jsx("button",{className:"group w-full text-left px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center mr-4 group-hover:shadow-lg group-hover:shadow-amber-100 transition-all duration-300",children:e.jsx("svg",{className:"w-5 h-5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-amber-700 transition-colors duration-300",children:"支付管理"}),e.jsx("div",{className:"text-sm text-gray-600",children:"USDT钱包和订单管理"})]}),e.jsx("svg",{className:"w-5 h-5 text-amber-600 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),e.jsx("button",{className:"group w-full text-left px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-pink-100 flex items-center justify-center mr-4 group-hover:shadow-lg group-hover:shadow-pink-100 transition-all duration-300",children:e.jsx("svg",{className:"w-5 h-5 text-pink-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-pink-700 transition-colors duration-300",children:"数据统计"}),e.jsx("div",{className:"text-sm text-gray-600",children:"系统运营数据和报表"})]}),e.jsx("svg",{className:"w-5 h-5 text-pink-600 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"系统状态"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-blue-50 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"用户服务"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"运行中"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-purple-50 border border-purple-100",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"交易服务"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"运行中"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-amber-50 border border-amber-100",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})})}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"数据服务"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"运行中"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-emerald-50 border border-emerald-100",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})})}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"数据库"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"正常"})]})]})]})]})]})]})]})]})},Ju=()=>{var oe;const s=ot(),{token:t,user:r}=Xe(),[a,n]=y.useState([]),[i,l]=y.useState(null),[o,c]=y.useState(null),[d,u]=y.useState(null),[m,w]=y.useState(null),[x,b]=y.useState(!0),[g,N]=y.useState(null),[v,L]=y.useState([]),[_,E]=y.useState(!1),[A,p]=y.useState(""),[k,C]=y.useState("all");y.useEffect(()=>{if(!r||r.email!=="admin@trademe.com"){s("/");return}},[r,s]);const W=async()=>{try{const z=await fetch("/api/v1/admin/users?limit=50",{headers:{Authorization:`Bearer ${t}`}});if(z.ok){const D=await z.json();n(D.data.users)}else throw new Error("获取用户列表失败")}catch(z){N(z instanceof Error?z.message:"获取用户列表失败")}},re=async()=>{try{const z=await fetch("/api/v1/admin/stats/system",{headers:{Authorization:`Bearer ${t}`}});if(z.ok){const D=await z.json();w(D.data)}}catch(z){console.error("获取系统统计失败:",z)}},Y=async()=>{try{const z=await fetch("/api/v1/admin/analytics/membership",{headers:{Authorization:`Bearer ${t}`}});if(z.ok){const D=await z.json();u(D.data)}}catch(z){console.error("获取分析数据失败:",z)}},X=async z=>{try{const D=await fetch(`/api/v1/admin/users/${z}/membership-stats`,{headers:{Authorization:`Bearer ${t}`}});if(D.ok){const ue=await D.json();c(ue.data),E(!0)}else throw new Error("获取用户详情失败")}catch(D){N(D instanceof Error?D.message:"获取用户详情失败")}},I=async(z,D)=>{if(v.length===0){alert("请选择要操作的用户");return}try{const ue=await fetch("/api/v1/admin/users/batch",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({user_ids:v,action:z,data:D})});if(ue.ok){const _e=await ue.json();alert(_e.message),await W(),L([])}else throw new Error("批量操作失败")}catch(ue){alert(ue instanceof Error?ue.message:"批量操作失败")}};y.useEffect(()=>{t&&(async()=>{b(!0),await Promise.all([W(),Y(),re()]),b(!1)})()},[t]);const ie=z=>{switch(z.toLowerCase()){case"basic":return"bg-gray-100 text-gray-700 border border-gray-300";case"premium":return"bg-blue-50 text-blue-700 border border-blue-200";case"professional":return"bg-purple-50 text-purple-700 border border-purple-200";default:return"bg-gray-100 text-gray-700 border border-gray-300"}},Q=z=>{switch(z.toLowerCase()){case"basic":return"基础版";case"premium":return"高级版";case"professional":return"专业版";default:return z}},xe=z=>new Date(z).toLocaleString("zh-CN"),T=z=>{if(!z)return null;const D=Math.ceil((new Date(z).getTime()-Date.now())/(24*60*60*1e3));return D>0?D:0},Z=a.filter(z=>{const D=z.username.toLowerCase().includes(A.toLowerCase())||z.email.toLowerCase().includes(A.toLowerCase()),ue=k==="all"||k==="active"&&z.is_active||k==="inactive"&&!z.is_active||k==="verified"&&z.email_verified||k==="unverified"&&!z.email_verified;return D&&ue});return x?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsx(It,{size:"lg"})}):g?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-600 text-lg mb-4",children:["⚠️ ",g]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"重新加载"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"用户管理中心"}),e.jsx("p",{className:"text-sm text-gray-600",children:"数据驱动的用户运营平台"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-4 py-2 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("span",{className:"text-green-700 text-sm font-semibold",children:(oe=r==null?void 0:r.username)==null?void 0:oe.charAt(0).toUpperCase()})}),e.jsxs("span",{className:"text-sm font-medium text-green-700",children:["管理员: ",r==null?void 0:r.username]})]}),e.jsxs("button",{onClick:()=>s("/admin"),className:"px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{children:"返回仪表板"})]})]})]})})}),e.jsxs("div",{className:"p-6",children:[m&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总用户数"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:m.users.total.toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("span",{className:"text-green-600 font-medium",children:["活跃: ",m.users.active]}),e.jsxs("span",{className:"text-gray-500",children:["(",m.growth.active_rate,"%)"]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full bg-gray-100 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-1000",style:{width:`${Math.min(100,m.users.active/m.users.total*100)}%`}})})})]})})}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"7天新增"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:m.users.recent_7days})]})]}),e.jsx("div",{className:"flex justify-between items-end mt-4",children:[...Array(7)].map((z,D)=>e.jsx("div",{className:`w-4 rounded-sm transition-all duration-500 ${D<Math.ceil(m.users.recent_7days/7*7)?"bg-green-500":"bg-gray-200"}`,style:{height:`${20+Math.random()*30}px`,animationDelay:`${D*100}ms`}},D))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"邮箱验证率"}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[m.growth.verification_rate,"%"]})]})]}),e.jsxs("div",{className:"relative pt-1",children:[e.jsxs("div",{className:"flex mb-2 items-center justify-between",children:[e.jsx("div",{children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-amber-600",children:["已验证: ",m.users.verified]})}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-gray-500",children:["待验证: ",m.users.unverified]})})]}),e.jsx("div",{className:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-amber-100",children:e.jsx("div",{style:{width:`${m.growth.verification_rate}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-amber-500 transition-all duration-1000"})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"付费用户"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:m.membership.premium+m.membership.professional})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("span",{className:"text-blue-600 font-medium",children:["高级: ",m.membership.premium]}),e.jsxs("span",{className:"text-purple-600 font-medium",children:["专业: ",m.membership.professional]})]}),e.jsxs("div",{className:"flex mt-3 space-x-1",children:[e.jsx("div",{className:"h-2 bg-blue-500 rounded-sm flex-1",style:{flexBasis:`${m.membership.premium/(m.membership.premium+m.membership.professional)*100}%`}}),e.jsx("div",{className:"h-2 bg-purple-500 rounded-sm flex-1",style:{flexBasis:`${m.membership.professional/(m.membership.premium+m.membership.professional)*100}%`}})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"用户列表"}),v.length>0&&e.jsxs("span",{className:"px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full font-medium",children:["已选中 ",v.length," 个用户"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"搜索用户...",value:A,onChange:z=>p(z.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 absolute left-3 top-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsxs("select",{value:k,onChange:z=>C(z.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"all",children:"全部状态"}),e.jsx("option",{value:"active",children:"活跃用户"}),e.jsx("option",{value:"inactive",children:"非活跃"}),e.jsx("option",{value:"verified",children:"已验证"}),e.jsx("option",{value:"unverified",children:"未验证"})]})]})]}),v.length>0&&e.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[e.jsxs("button",{onClick:()=>I("activate"),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-green-700 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"激活用户"]}),e.jsxs("button",{onClick:()=>I("deactivate"),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-red-700 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"停用用户"]}),e.jsxs("button",{onClick:()=>I("verify_email"),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"验证邮箱"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",onChange:z=>{z.target.checked?L(Z.map(D=>D.id)):L([])},checked:v.length===Z.length&&Z.length>0})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户信息"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"会员等级"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"最后登录"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Z.map(z=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",checked:v.includes(z.id),onChange:D=>{D.target.checked?L([...v,z.id]):L(v.filter(ue=>ue!==z.id))}})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm",children:z.username.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:z.username}),e.jsx("div",{className:"text-sm text-gray-500",children:z.email})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${ie(z.membership_level)}`,children:Q(z.membership_level)}),z.membership_expires_at&&e.jsxs("div",{className:"text-xs text-amber-600 mt-1",children:[T(z.membership_expires_at)," 天后到期"]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${z.is_active?"bg-green-400":"bg-gray-400"}`}),e.jsx("span",{className:`text-sm font-medium ${z.is_active?"text-green-700":"text-gray-500"}`,children:z.is_active?"活跃":"非活跃"})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${z.email_verified?"bg-blue-400":"bg-amber-400"}`}),e.jsx("span",{className:`text-xs ${z.email_verified?"text-blue-600":"text-amber-600"}`,children:z.email_verified?"已验证":"待验证"})]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:z.last_login_at?xe(z.last_login_at):"从未登录"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("button",{onClick:()=>{l(z),X(z.id)},className:"inline-flex items-center px-3 py-1 text-sm text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded transition-colors",children:[e.jsxs("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"详情"]})})]},z.id))})]})}),Z.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"没有找到用户"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"请尝试调整搜索条件或筛选器。"})]})]})}),e.jsxs("div",{className:"space-y-6",children:[d&&d.expiring_soon.length>0&&e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"即将到期"}),e.jsx("span",{className:"px-2 py-1 text-xs bg-amber-100 text-amber-700 rounded-full font-medium",children:d.expiring_soon.length})]}),e.jsx("div",{className:"space-y-3",children:d.expiring_soon.map(z=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-amber-50 border border-amber-100 rounded-lg hover:bg-amber-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-200 flex items-center justify-center text-amber-800 font-semibold text-xs",children:z.username.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:z.username}),e.jsx("div",{className:"text-xs text-gray-600",children:Q(z.membership_level)})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-semibold text-amber-700",children:[z.days_remaining," 天"]}),e.jsx("div",{className:"text-xs text-amber-600",children:"剩余时间"})]})]},z.id))})]}),d&&e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"会员分布"})]}),e.jsx("div",{className:"space-y-4",children:d.membership_distribution.map(z=>{const D=d.membership_distribution.reduce((rt,fe)=>rt+fe.count,0),ue=Math.round(z.count/D*100),_e={basic:"bg-gray-500",premium:"bg-blue-500",professional:"bg-purple-500"};return e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-100 hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Q(z.level)}),e.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[z.count," 人"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:`h-2 ${_e[z.level]||_e.basic} rounded-full transition-all duration-1000`,style:{width:`${ue}%`}})}),e.jsxs("div",{className:"text-xs text-gray-600",children:[ue,"% 占比"]})]},z.level)})}),d.revenue&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"收入概览"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"月度收入"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["$",d.revenue.monthly_revenue]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"活跃订阅"}),e.jsx("span",{className:"font-semibold text-blue-600",children:d.revenue.active_subscriptions})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"快速统计"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"今日注册"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"12"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"在线用户"}),e.jsx("span",{className:"text-sm font-semibold text-green-600",children:"1,248"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"待处理"}),e.jsx("span",{className:"text-sm font-semibold text-amber-600",children:"3"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"系统负载"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-1",children:e.jsx("div",{className:"bg-green-500 h-1 rounded-full",style:{width:"65%"}})}),e.jsx("span",{className:"text-xs text-gray-500",children:"65%"})]})]})]})]})]})]})]}),_&&o&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>E(!1)}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full sm:p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg",children:o.user.username.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:[o.user.username," 详细信息"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"用户数据详情与使用统计"})]})]}),e.jsx("button",{onClick:()=>E(!1),className:"bg-gray-100 hover:bg-gray-200 rounded-lg p-2 transition-colors",children:e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"基本信息"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"邮箱地址"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:o.user.email})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"会员等级"}),e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${ie(o.user.membership_level)}`,children:o.limits.name})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"邮箱验证"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${o.user.email_verified?"bg-green-400":"bg-amber-400"}`}),e.jsx("span",{className:`text-sm font-medium ${o.user.email_verified?"text-green-600":"text-amber-600"}`,children:o.user.email_verified?"已验证":"待验证"})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"注册时间"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:xe(o.user.created_at)})]}),o.user.membership_expires_at&&e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"会员到期"}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:xe(o.user.membership_expires_at)}),e.jsxs("div",{className:"text-xs text-amber-600",children:[T(o.user.membership_expires_at)," 天后到期"]})]})]})]})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"使用统计"})]}),e.jsx("div",{className:"space-y-4",children:[{label:"API密钥",current:o.usage.api_keys_count,limit:o.limits.api_keys,color:"blue"},{label:"今日AI使用",current:o.usage.ai_usage_today,limit:o.limits.ai_daily,color:"green",prefix:"$"},{label:"策略数量",current:o.usage.strategies_count,limit:o.limits.strategies,color:"purple"},{label:"指标数量",current:o.usage.indicators_count,limit:o.limits.indicators,color:"amber"},{label:"实盘交易",current:o.usage.live_trading_count,limit:o.limits.live_trading,color:"emerald"},{label:"Tick回测",current:o.usage.tick_backtest_today,limit:o.limits.tick_backtest,color:"rose"}].map((z,D)=>{const ue=z.limit>0?Math.min(100,z.current/z.limit*100):0,_e={blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",amber:"bg-amber-500",emerald:"bg-emerald-500",rose:"bg-rose-500"};return e.jsxs("div",{className:"py-2 border-b border-purple-100 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:z.label}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[z.prefix,z.current,"/",z.limit]})]}),e.jsx("div",{className:"w-full bg-purple-100 rounded-full h-2",children:e.jsx("div",{className:`h-2 ${_e[z.color]} rounded-full transition-all duration-1000`,style:{width:`${ue}%`}})})]},D)})})]})]}),e.jsx("div",{className:"mt-6 flex justify-end space-x-3",children:e.jsx("button",{onClick:()=>E(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"关闭"})})]})]})})]})},Qu=()=>{var ee;const s=ot(),{token:t,user:r}=Xe(),[a,n]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState(null),[d,u]=y.useState([]),[m,w]=y.useState(null),[x,b]=y.useState(!0),[g,N]=y.useState(null),[v,L]=y.useState([]),[_,E]=y.useState(!1),[A,p]=y.useState(!1),[k,C]=y.useState(null),[W,re]=y.useState(""),[Y,X]=y.useState("all"),[I,ie]=y.useState("dashboard"),[Q,xe]=y.useState([]),[T,Z]=y.useState([]),[oe,z]=y.useState(!1),[D,ue]=y.useState([]),[_e,rt]=y.useState(!1),[fe,We]=y.useState({step:"initial",authUrl:"",sessionId:"",authCode:"",accountName:"",description:"",dailyLimit:50,priority:50,directToken:"",useManualMode:!1}),[ye,ce]=y.useState({account_name:"",api_key:"",account_type:"direct",proxy_base_url:"",proxy_type:"proxy_service",daily_limit:100,proxy_id:""});y.useEffect(()=>{if(!r||r.email!=="admin@trademe.com"){s("/");return}},[r,s]);const Ce=async()=>{try{const f=await fetch("/api/v1/admin/claude/accounts",{headers:{Authorization:`Bearer ${t}`}});if(f.ok){const B=await f.json();n(B.accounts||[])}else throw new Error("获取Claude账号失败")}catch(f){N(f instanceof Error?f.message:"获取Claude账号失败")}},Ge=async()=>{try{const f=await fetch("/api/v1/admin/claude/proxies",{headers:{Authorization:`Bearer ${t}`}});if(f.ok){const B=await f.json();l(B.proxies||[])}}catch(f){console.error("获取代理列表失败:",f)}},Ut=async()=>{try{const f=await fetch("/api/v1/admin/claude/usage-stats?days=30",{headers:{Authorization:`Bearer ${t}`}});if(f.ok){const B=await f.json();c(B.data)}}catch(f){console.error("获取使用统计失败:",f)}},wt=async()=>{try{const f=await fetch("/api/v1/admin/claude/anomaly-detection",{headers:{Authorization:`Bearer ${t}`}});if(f.ok){const B=await f.json();w(B.data)}}catch(f){console.error("获取异常检测失败:",f)}},ht=async()=>{try{const f=await fetch("/api/v1/anthropic-accounts/",{headers:{Authorization:`Bearer ${t}`}});if(f.ok){const B=await f.json();ue(B||[])}else throw new Error("获取Anthropic账户失败")}catch(f){console.error("获取Anthropic账户失败:",f),N(f instanceof Error?f.message:"获取Anthropic账户失败")}},R=async()=>{try{b(!0);const f=await fetch("/api/v1/anthropic-accounts/generate-setup-token-url",{method:"POST",headers:{Authorization:`Bearer ${t}`}});if(f.ok){const B=await f.json();We({...fe,step:"auth",authUrl:B.auth_url,sessionId:B.session_id}),N(null)}else{const B=await f.json();throw new Error(B.detail||"生成授权链接失败")}}catch(f){N(f instanceof Error?f.message:"生成授权链接失败")}finally{b(!1)}},de=async()=>{try{b(!0);const f=await fetch("/api/v1/anthropic-accounts/exchange-setup-token",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({session_id:fe.sessionId,authorization_code:fe.authCode,account_name:fe.accountName,description:fe.description,daily_limit:fe.dailyLimit,priority:fe.priority})});if(f.ok){const B=await f.json();We({...fe,step:"success"}),await ht(),N(null),setTimeout(()=>{rt(!1),Ve()},3e3)}else{const B=await f.json();throw new Error(B.detail||"Setup Token交换失败")}}catch(f){N(f instanceof Error?f.message:"Setup Token交换失败")}finally{b(!1)}},Ve=()=>{We({step:"initial",authUrl:"",sessionId:"",authCode:"",accountName:"",description:"",dailyLimit:50,priority:50,directToken:"",useManualMode:!1})},at=async f=>{var B,be;try{const Oe=await(await fetch(`/api/v1/anthropic-accounts/${f}/test`,{method:"POST",headers:{Authorization:`Bearer ${t}`}})).json();Oe.success?alert(`连接测试成功！
响应时间: ${((B=Oe.test_details)==null?void 0:B.response_time_ms)||"N/A"}ms`):alert(`连接测试失败：${((be=Oe.test_details)==null?void 0:be.error)||Oe.message||"未知错误"}`),await ht()}catch(Te){alert("测试连接失败："+(Te instanceof Error?Te.message:"网络错误"))}},Me=async(f,B)=>{if(confirm(`确定要删除Anthropic账户 "${B}" 吗？`))try{const Te=await(await fetch(`/api/v1/anthropic-accounts/${f}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).json();Te.success?(await ht(),alert("账户删除成功")):alert("删除失败："+(Te.message||"未知错误"))}catch(be){alert("删除失败："+(be instanceof Error?be.message:"网络错误"))}},Ae=async()=>{var f;try{const B=await fetch("/api/v1/admin/users/",{headers:{Authorization:`Bearer ${t}`}});if(B.ok){const be=await B.json();xe(((f=be.data)==null?void 0:f.users)||[])}}catch(B){console.error("获取用户列表失败:",B)}},j=async()=>{try{const f=await fetch("/api/v1/admin/claude/users-detailed-stats",{headers:{Authorization:`Bearer ${t}`}});if(f.ok){const B=await f.json();Z(B.data||[])}}catch(f){console.error("获取用户使用统计失败:",f)}},h=async()=>{try{const f={account_name:ye.account_name,api_key:ye.api_key,daily_limit:ye.daily_limit,proxy_base_url:ye.account_type==="direct"?"":ye.proxy_base_url||"https://claude.cloudcdn7.com/api",proxy_type:ye.account_type==="direct"?"":ye.account_type==="custom_proxy"?"custom":"proxy_service"},B=await fetch("/api/v1/admin/claude/accounts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(f)});if(B.ok){const be=await B.json();alert("Claude账号添加成功"),E(!1),ce({account_name:"",api_key:"",account_type:"direct",proxy_base_url:"",proxy_type:"proxy_service",daily_limit:100,proxy_id:""}),await Ce()}else throw new Error("添加Claude账号失败")}catch(f){alert(f instanceof Error?f.message:"添加Claude账号失败")}},S=async f=>{try{const B=await fetch(`/api/v1/admin/claude/accounts/${f}/test`,{method:"POST",headers:{Authorization:`Bearer ${t}`}});if(B.ok){const be=await B.json();alert(`测试结果: ${be.status==="success"?"连接成功":"连接失败"}`),await Ce()}else throw new Error("账号连接测试失败")}catch(B){alert(B instanceof Error?B.message:"账号连接测试失败")}},O=async f=>{if(confirm("确定要删除这个Claude账号吗？"))try{if((await fetch(`/api/v1/admin/claude/accounts/${f}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).ok)alert("Claude账号删除成功"),await Ce();else throw new Error("删除Claude账号失败")}catch(B){alert(B instanceof Error?B.message:"删除Claude账号失败")}};y.useEffect(()=>{t&&(async()=>{b(!0),await Promise.all([Ce(),Ge(),Ut(),wt(),Ae(),j(),ht()]),b(!1)})()},[t]);const $=f=>{switch(f){case"active":return"bg-green-100 text-green-700 border-green-200";case"inactive":return"bg-gray-100 text-gray-700 border-gray-200";case"error":return"bg-red-100 text-red-700 border-red-200";case"suspended":return"bg-yellow-100 text-yellow-700 border-yellow-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},F=f=>{switch(f){case"active":return"活跃";case"inactive":return"非活跃";case"error":return"错误";case"suspended":return"暂停";default:return f}},V=f=>new Date(f).toLocaleString("zh-CN"),J=f=>`$${f.toFixed(4)}`,ae=a.filter(f=>{const B=f.account_name.toLowerCase().includes(W.toLowerCase())||f.api_key.toLowerCase().includes(W.toLowerCase()),be=Y==="all"||f.status===Y;return B&&be});return x?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsx(It,{size:"lg"})}):g?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-600 text-lg mb-4",children:["⚠️ ",g]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"重新加载"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-green-600 to-green-700 flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Claude AI 服务管理"}),e.jsx("p",{className:"text-sm text-gray-600",children:"AI账号池与智能调度管理平台"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-4 py-2 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("span",{className:"text-green-700 text-sm font-semibold",children:(ee=r==null?void 0:r.username)==null?void 0:ee.charAt(0).toUpperCase()})}),e.jsxs("span",{className:"text-sm font-medium text-green-700",children:["管理员: ",r==null?void 0:r.username]})]}),e.jsxs("button",{onClick:()=>s("/admin"),className:"px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{children:"返回仪表板"})]})]})]})})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"px-6",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>ie("dashboard"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${I==="dashboard"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("span",{children:"仪表盘"})]})}),e.jsx("button",{onClick:()=>ie("accounts"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${I==="accounts"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("span",{children:"账户管理"}),e.jsx("span",{className:"ml-1 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:a.length})]})}),e.jsx("button",{onClick:()=>ie("users"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${I==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})}),e.jsx("span",{children:"用户管理"}),e.jsx("span",{className:"ml-1 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:Q.length})]})}),e.jsx("button",{onClick:()=>ie("scheduler"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${I==="scheduler"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"智能调度"})]})}),e.jsx("button",{onClick:()=>ie("anomalies"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${I==="anomalies"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.99-.833-2.75 0L4.058 18.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("span",{children:"异常监控"}),(m==null?void 0:m.anomalies.length)>0&&e.jsx("span",{className:"ml-1 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:m.anomalies.length})]})}),e.jsx("button",{onClick:()=>ie("anthropic"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${I==="anthropic"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),e.jsx("span",{children:"Anthropic官方API"}),D.length>0&&e.jsx("span",{className:"ml-1 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:D.length})]})})]})})}),e.jsxs("div",{className:"p-6",children:[I==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总账户数"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:a.length}),e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[a.filter(f=>f.status==="active").length," 个活跃"]})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-green-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总请求数"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:a.reduce((f,B)=>f+(B.total_requests||0),0).toLocaleString()}),e.jsxs("p",{className:"text-sm text-red-600 mt-1",children:[a.reduce((f,B)=>f+(B.failed_requests||0),0)," 失败"]})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-yellow-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"平均响应时间"}),e.jsxs("p",{className:"text-3xl font-semibold text-gray-900",children:[a.length>0?Math.round(a.reduce((f,B)=>f+(B.avg_response_time||0),0)/a.length):0,"ms"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"全部账户平均"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-purple-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"平均成功率"}),e.jsxs("p",{className:"text-3xl font-semibold text-gray-900",children:[a.length>0?(a.reduce((f,B)=>f+(B.success_rate||0),0)/a.length).toFixed(1):"0","%"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"全部账户平均"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"账户详细统计"}),e.jsx("div",{className:"space-y-4",children:a.map(f=>{const B=f.daily_limit>0?f.current_usage/f.daily_limit*100:0,be=B<50?"bg-green-500":B<80?"bg-yellow-500":"bg-red-500";return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:f.account_name}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${f.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:f.status})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"请求数:"}),e.jsx("span",{className:"font-medium ml-1",children:(f.total_requests||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"成功率:"}),e.jsxs("span",{className:"font-medium ml-1",children:[(f.success_rate||0).toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"响应时间:"}),e.jsxs("span",{className:"font-medium ml-1",children:[f.avg_response_time||0,"ms"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"使用率:"}),e.jsxs("span",{className:"font-medium ml-1",children:[B.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${be}`,style:{width:`${Math.min(B,100)}%`}})})]},f.id)})})]})]}),I==="accounts"&&e.jsxs("div",{children:[o&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总请求数"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:o.total_requests.toLocaleString()})]})]}),e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"30天统计"})]})})}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总成本"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:J(o.total_cost_usd)})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["今日: ",J(o.daily_cost_usd)]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"活跃账号"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.filter(f=>f.status==="active").length})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["总账号: ",a.length]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.99-.833-2.75 0L4.058 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"异常警告"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(m==null?void 0:m.anomalies.length)||0})]})]}),e.jsx("div",{className:"text-sm text-red-500",children:"需要关注"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Claude 账号池"}),v.length>0&&e.jsxs("span",{className:"px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full font-medium",children:["已选中 ",v.length," 个账号"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"搜索账号...",value:W,onChange:f=>re(f.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 absolute left-3 top-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsxs("select",{value:Y,onChange:f=>X(f.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"all",children:"全部状态"}),e.jsx("option",{value:"active",children:"活跃"}),e.jsx("option",{value:"inactive",children:"非活跃"}),e.jsx("option",{value:"error",children:"错误"}),e.jsx("option",{value:"suspended",children:"暂停"})]}),e.jsxs("button",{onClick:()=>E(!0),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"添加账号"]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",onChange:f=>{f.target.checked?L(ae.map(B=>B.id)):L([])},checked:v.length===ae.length&&ae.length>0})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"账号信息"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"使用情况"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"性能"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ae.map(f=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",checked:v.includes(f.id),onChange:B=>{B.target.checked?L([...v,f.id]):L(v.filter(be=>be!==f.id))}})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-green-500 to-blue-600 flex items-center justify-center text-white font-semibold text-sm",children:f.account_name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.account_name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[f.api_key.substring(0,8),"...",f.api_key.substring(f.api_key.length-4)]})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[J(f.current_usage)," / ",J(f.daily_limit)]}),e.jsxs("div",{className:"text-gray-500",children:["使用率: ",f.daily_limit>0?(f.current_usage/f.daily_limit*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${f.current_usage/f.daily_limit>.8?"bg-red-500":f.current_usage/f.daily_limit>.6?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(100,f.current_usage/f.daily_limit*100)}%`}})})})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${$(f.status)}`,children:F(f.status)}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:f.last_used_at?V(f.last_used_at):"从未使用"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-600",children:"响应:"}),e.jsxs("span",{className:`font-medium ${f.avg_response_time>3e3?"text-red-600":f.avg_response_time>1500?"text-yellow-600":"text-green-600"}`,children:[f.avg_response_time,"ms"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-600",children:"成功率:"}),e.jsxs("span",{className:`font-medium ${f.success_rate>95?"text-green-600":f.success_rate>85?"text-yellow-600":"text-red-600"}`,children:[f.success_rate.toFixed(1),"%"]})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsxs("button",{onClick:()=>S(f.id),className:"inline-flex items-center px-2 py-1 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded transition-colors",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"测试"]}),e.jsxs("button",{onClick:()=>{C(f),p(!0)},className:"inline-flex items-center px-2 py-1 text-xs text-green-600 hover:text-green-800 hover:bg-green-50 rounded transition-colors",children:[e.jsxs("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"详情"]}),e.jsxs("button",{onClick:()=>O(f.id),className:"inline-flex items-center px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"删除"]})]})]},f.id))})]})}),ae.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"没有找到Claude账号"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"请尝试调整搜索条件或筛选器。"})]})]})}),e.jsxs("div",{className:"space-y-6",children:[m&&m.anomalies.length>0&&e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.99-.833-2.75 0L4.058 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"异常警告"}),e.jsx("span",{className:"px-2 py-1 text-xs bg-red-100 text-red-700 rounded-full font-medium",children:m.anomalies.length})]}),e.jsx("div",{className:"space-y-3",children:m.anomalies.slice(0,5).map((f,B)=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-red-50 border border-red-100 rounded-lg",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${f.severity==="high"?"bg-red-500":f.severity==="medium"?"bg-yellow-500":"bg-blue-500"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.account_name}),e.jsx("div",{className:"text-xs text-gray-600",children:f.description}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:V(f.detected_at)})]})]},B))}),m.recommendations.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-red-100",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"建议"}),e.jsx("ul",{className:"space-y-1",children:m.recommendations.slice(0,3).map((f,B)=>e.jsxs("li",{className:"text-xs text-gray-600 flex items-start",children:[e.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full mt-2 mr-2 flex-shrink-0"}),f]},B))})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"代理状态"})]}),e.jsx("div",{className:"space-y-3",children:i.slice(0,5).map(f=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 border border-purple-100 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${f.status==="active"?"bg-green-400":f.status==="error"?"bg-red-400":"bg-gray-400"}`}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.name}),e.jsxs("div",{className:"text-xs text-gray-600",children:[f.host,":",f.port]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:[f.success_rate.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"成功率"})]})]},f.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"快速统计"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"今日请求"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"1,234"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"平均响应时间"}),e.jsx("span",{className:"text-sm font-semibold text-green-600",children:"1.2s"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"错误率"}),e.jsx("span",{className:"text-sm font-semibold text-red-600",children:"0.3%"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"成本效率"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-1",children:e.jsx("div",{className:"bg-green-500 h-1 rounded-full",style:{width:"85%"}})}),e.jsx("span",{className:"text-xs text-gray-500",children:"85%"})]})]})]})]})]})]})]}),I==="users"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-indigo-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总用户数"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:Q.length}),e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[Q.filter(f=>f.membership_level==="professional").length," 专业版用户"]})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-purple-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"AI使用总数"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:T.reduce((f,B)=>f+(B.total_requests||0),0)}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"本月累计"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-orange-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"活跃用户"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:Q.filter(f=>new Date(f.last_login_at||0)>new Date(Date.now()-7*24*60*60*1e3)).length}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"近7天"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"用户Claude使用详情"}),e.jsx("p",{className:"text-sm text-gray-600",children:"各用户的Claude AI使用统计和费用详情"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户信息"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"会员等级"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"使用次数"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"费用"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"最后使用"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Q.map(f=>{var be,Te;const B=T.find(Oe=>Oe.user_id===f.id)||{};return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-indigo-600 flex items-center justify-center text-white font-semibold",children:((be=f.username)==null?void 0:be.charAt(0).toUpperCase())||((Te=f.email)==null?void 0:Te.charAt(0).toUpperCase())}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.username||"未设置"}),e.jsx("div",{className:"text-sm text-gray-500",children:f.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f.membership_level==="professional"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:f.membership_level==="professional"?"专业版":"免费版"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:B.total_requests||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",(B.total_cost||0).toFixed(4)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:f.last_login_at?new Date(f.last_login_at).toLocaleDateString("zh-CN"):"从未登录"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:f.is_active?"活跃":"已禁用"})})]},f.id)})})]})}),Q.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"暂无用户数据"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"等待用户注册或检查API连接。"})]})]})]}),_&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>E(!1)}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"添加Claude账号"}),e.jsx("p",{className:"text-sm text-gray-500",children:"添加官方API账号或代理服务账号到账号池"})]}),e.jsx("button",{onClick:()=>E(!1),className:"bg-gray-100 hover:bg-gray-200 rounded-lg p-2 transition-colors",children:e.jsx("svg",{className:"h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"账号名称"}),e.jsx("input",{type:"text",value:ye.account_name,onChange:f=>ce({...ye,account_name:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"例如: Claude-Account-001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key"}),e.jsx("input",{type:"password",value:ye.api_key,onChange:f=>ce({...ye,api_key:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"sk-ant-api... 或 代理服务API密钥"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"账户类型"}),e.jsxs("select",{value:ye.account_type,onChange:f=>ce({...ye,account_type:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"direct",children:"直接API连接"}),e.jsx("option",{value:"proxy_service",children:"代理服务连接"}),e.jsx("option",{value:"custom_proxy",children:"自定义代理"})]})]}),(ye.account_type==="proxy_service"||ye.account_type==="custom_proxy")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"代理服务地址"}),ye.account_type==="proxy_service"?e.jsxs("select",{value:ye.proxy_base_url,onChange:f=>ce({...ye,proxy_base_url:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"选择代理服务"}),e.jsx("option",{value:"https://claude.cloudcdn7.com/api",children:"CloudCDN7 代理服务"}),e.jsx("option",{value:"https://api.claude-proxy.com/api",children:"Claude Proxy 服务"}),e.jsx("option",{value:"https://claude-api.proxy.com/v1",children:"通用代理服务"}),e.jsx("option",{value:"custom",children:"自定义URL..."})]}):e.jsx("input",{type:"url",value:ye.proxy_base_url,onChange:f=>ce({...ye,proxy_base_url:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://your-proxy-service.com/api"}),ye.account_type==="proxy_service"&&ye.proxy_base_url==="custom"&&e.jsx("input",{type:"url",value:"",onChange:f=>ce({...ye,proxy_base_url:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mt-2",placeholder:"输入自定义代理服务地址"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:ye.account_type==="proxy_service"?"选择可信的Claude代理服务提供商，确保服务稳定性和安全性":"输入您自己搭建或信任的代理服务地址"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"每日限额 ($)"}),e.jsx("input",{type:"number",value:ye.daily_limit,onChange:f=>ce({...ye,daily_limit:parseFloat(f.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"代理服务器 (可选)"}),e.jsxs("select",{value:ye.proxy_id,onChange:f=>ce({...ye,proxy_id:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"不使用代理"}),i.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>E(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"取消"}),e.jsx("button",{onClick:h,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:"添加账号"})]})]})]})}),I==="scheduler"&&e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"智能调度配置"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"高级调度算法和负载均衡配置"}),e.jsx("button",{onClick:()=>z(!0),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"配置调度规则"})]})}),I==="anomalies"&&e.jsxs("div",{className:"space-y-6",children:[m!=null&&m.anomalies&&m.anomalies.length>0?e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"系统异常警告"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["发现 ",m.anomalies.length," 个需要关注的异常"]})]}),e.jsx("div",{className:"divide-y divide-gray-200",children:m.anomalies.map((f,B)=>e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:`flex-shrink-0 w-2 h-2 mt-2 rounded-full ${f.severity==="high"?"bg-red-500":f.severity==="medium"?"bg-yellow-500":"bg-blue-500"}`}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:f.account_name}),e.jsx("p",{className:"text-sm text-gray-600",children:f.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["检测时间: ",new Date(f.detected_at).toLocaleString()]})]})]}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${f.severity==="high"?"bg-red-100 text-red-800":f.severity==="medium"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:f.severity==="high"?"高风险":f.severity==="medium"?"中等风险":"低风险"})]})},B))})]}):e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"系统运行正常"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"暂未发现异常，所有账户运行状况良好"})]})}),(m==null?void 0:m.recommendations)&&m.recommendations.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"系统优化建议"}),e.jsx("div",{className:"space-y-3",children:m.recommendations.map((f,B)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-500 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-gray-700",children:f})})]},B))})]})]}),I==="anthropic"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Anthropic官方API管理"}),e.jsx("p",{className:"text-sm text-gray-600",children:"直接对接Anthropic官方API服务，无需代理中转"})]}),e.jsxs("button",{onClick:()=>rt(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{children:"添加官方API账户"})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总账户数"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:D.length})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"活跃账户"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:D.filter(f=>f.status==="active").length})]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总使用额度"}),e.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:["$",D.reduce((f,B)=>f+(B.daily_limit||0),0).toFixed(2)]})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Anthropic账户列表"})}),D.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"暂无Anthropic官方API账户"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"点击上方按钮添加您的第一个Anthropic官方API账户"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:D.map((f,B)=>{var be,Te,Oe;return e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${f.status==="active"?"bg-green-100":f.status==="error"?"bg-red-100":"bg-gray-100"}`,children:e.jsx("svg",{className:`w-6 h-6 ${f.status==="active"?"text-green-600":f.status==="error"?"text-red-600":"text-gray-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:f.account_name}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${f.status==="active"?"bg-green-100 text-green-800":f.status==="error"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:f.status==="active"?"运行中":f.status==="error"?"错误":"停用"}),f.has_valid_api_key&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"已配置API密钥"})]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500 flex items-center space-x-4",children:[e.jsxs("span",{children:["API版本: ",f.api_version]}),e.jsxs("span",{children:["使用率: ",((be=f.usage_percentage)==null?void 0:be.toFixed(1))||0,"%"]}),e.jsxs("span",{children:["优先级: ",f.priority]}),e.jsxs("span",{children:["响应时间: ",f.avg_response_time||0,"ms"]}),f.last_check_at&&e.jsxs("span",{children:["最近检查: ",new Date(f.last_check_at).toLocaleString()]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"每日额度:"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",((Te=f.current_usage)==null?void 0:Te.toFixed(2))||0," / $",((Oe=f.daily_limit)==null?void 0:Oe.toFixed(2))||0]})]}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(f.usage_percentage||0,100)}%`}})})]})})]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>at(f.id),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors",title:"测试连接",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("button",{onClick:()=>Me(f.id,f.account_name),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors",title:"删除账户",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},f.id||B)})})]})]})]}),A&&k&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>p(!1)}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full sm:p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-r from-green-500 to-blue-600 flex items-center justify-center text-white font-bold text-lg",children:k.account_name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:[k.account_name," 详细信息"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Claude账号使用详情和性能监控"})]})]}),e.jsx("button",{onClick:()=>p(!1),className:"bg-gray-100 hover:bg-gray-200 rounded-lg p-2 transition-colors",children:e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"基本信息"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"API密钥"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 font-mono",children:[k.api_key.substring(0,12),"...",k.api_key.substring(k.api_key.length-8)]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"状态"}),e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${$(k.status)}`,children:F(k.status)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"每日限额"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:J(k.daily_limit)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"当前使用"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:J(k.current_usage)})]}),k.remaining_balance&&e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"剩余余额"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:J(k.remaining_balance)})]}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"创建时间"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:V(k.created_at)})]})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"性能统计"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-green-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"总请求数"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:k.total_requests.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-green-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"失败请求数"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:k.failed_requests.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-green-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"成功率"}),e.jsxs("span",{className:`text-sm font-medium ${k.success_rate>95?"text-green-600":k.success_rate>85?"text-yellow-600":"text-red-600"}`,children:[k.success_rate.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-green-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"平均响应时间"}),e.jsxs("span",{className:`text-sm font-medium ${k.avg_response_time>3e3?"text-red-600":k.avg_response_time>1500?"text-yellow-600":"text-green-600"}`,children:[k.avg_response_time,"ms"]})]}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"最后使用"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:k.last_used_at?V(k.last_used_at):"从未使用"})]})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"关闭"}),e.jsx("button",{onClick:()=>S(k.id),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:"测试连接"})]})]})]})}),oe&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>z(!1)}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full sm:p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"智能调度配置"}),e.jsx("p",{className:"text-sm text-gray-500",children:"配置Claude账号的负载均衡和智能调度规则"})]})]}),e.jsx("button",{onClick:()=>z(!1),className:"bg-gray-100 hover:bg-gray-200 rounded-lg p-2 transition-colors",children:e.jsx("svg",{className:"h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"负载均衡策略"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"strategy",className:"form-radio text-blue-600",defaultChecked:!0}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"智能权重分配 - 根据账号性能动态调整权重"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"strategy",className:"form-radio text-blue-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"轮询调度 - 依次使用每个账号"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"strategy",className:"form-radio text-blue-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"最小连接数优先 - 优先使用负载最轻的账号"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"健康检查配置"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"检查间隔(秒)"}),e.jsx("input",{type:"number",defaultValue:300,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"超时时间(秒)"}),e.jsx("input",{type:"number",defaultValue:30,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"故障转移设置"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox text-blue-600",defaultChecked:!0}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"启用自动故障转移"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox text-blue-600",defaultChecked:!0}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"账号失败后自动标记为不可用"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox text-blue-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"达到日限额时自动切换"})]})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h5",{className:"text-sm font-medium text-blue-900",children:"当前调度状态"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["智能调度器正在运行，当前有 ",a.filter(f=>f.status==="active").length," 个活跃账号参与负载均衡。"]})]})]})})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>z(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"取消"}),e.jsx("button",{onClick:()=>{alert("调度规则配置已保存"),z(!1)},className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:"保存配置"})]})]})]})}),_e&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full sm:p-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:text-left",children:[e.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900 flex items-center",children:[e.jsx("svg",{className:"w-6 h-6 text-purple-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"通过Setup Token添加Anthropic账户"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"使用OAuth2安全授权方式连接Anthropic官方API"})]}),e.jsxs("div",{className:"mt-6 space-y-6",children:[g&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.99-.833-2.75 0L4.058 18.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-800",children:g})})]})}),fe.step==="initial"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"🚀 Setup Token OAuth 流程"}),e.jsx("p",{className:"text-sm text-blue-700",children:"我们将使用Anthropic的官方OAuth2授权方式来安全地连接您的Claude账户，无需手动输入API密钥。"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["账户名称 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:fe.accountName,onChange:f=>We({...fe,accountName:f.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"例如：主要生产账户",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"每日限额 (USD)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:fe.dailyLimit,onChange:f=>We({...fe,dailyLimit:parseFloat(f.target.value)||50}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"50.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"优先级 (1-100)"}),e.jsx("input",{type:"number",min:"1",max:"100",value:fe.priority,onChange:f=>We({...fe,priority:parseInt(f.target.value)||50}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"50"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"描述 (可选)"}),e.jsx("textarea",{rows:2,value:fe.description,onChange:f=>We({...fe,description:f.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"账户用途说明..."})]})]})]}),fe.step==="auth"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-green-800 mb-2",children:"✅ 授权链接已生成"}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"请点击下面的按钮跳转到Anthropic进行授权："}),e.jsxs("a",{href:fe.authUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"打开Anthropic授权页面"]})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800 mb-2",children:"⚠️ 重要说明"}),e.jsx("p",{className:"text-sm text-yellow-700 mb-2",children:"由于Cloudflare保护，请按以下步骤操作："}),e.jsxs("ol",{className:"list-decimal list-inside text-sm text-yellow-700 space-y-1",children:[e.jsx("li",{children:"在新标签页中完成授权"}),e.jsx("li",{children:"授权后会跳转到一个回调页面"}),e.jsxs("li",{children:["复制",e.jsx("strong",{children:"整个回调URL"}),"（包含#access_token=...的完整地址）"]}),e.jsx("li",{children:"将完整URL粘贴到下方输入框"})]}),e.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"示例URL格式: https://console.anthropic.com/oauth/code/callback#access_token=xxx&token_type=Bearer..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["回调URL或授权码 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{rows:4,value:fe.authCode,onChange:f=>We({...fe,authCode:f.target.value}),className:"block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-purple-500 focus:border-purple-500 text-xs",placeholder:`请粘贴完整的回调URL，例如：
https://console.anthropic.com/oauth/code/callback#access_token=xxx&token_type=Bearer&expires_in=31536000

或者仅粘贴授权码（如果能自动交换）`,required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"支持两种模式：1) 完整回调URL（推荐） 2) 仅授权码（可能被Cloudflare阻止）"})]}),e.jsx("button",{onClick:()=>We({...fe,step:"initial"}),className:"text-sm text-gray-500 hover:text-gray-700",children:"← 返回上一步"})]}),fe.step==="success"&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"Setup Token账户创建成功！"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:['账户 "',fe.accountName,'" 已成功添加到系统中']}),e.jsx("p",{className:"mt-2 text-xs text-gray-400",children:"窗口将在 3 秒后自动关闭..."})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{rt(!1),Ve(),N(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",disabled:x,children:"取消"}),fe.step==="initial"&&e.jsxs("button",{onClick:R,disabled:x||!fe.accountName,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[x&&e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:"生成授权链接"})]}),fe.step==="auth"&&e.jsxs("button",{onClick:de,disabled:x||!fe.authCode,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[x&&e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:"创建账户"})]})]})]})]})})]})},Xu=()=>{var xe;const s=ot(),{token:t,user:r}=Xe(),[a,n]=y.useState(null),[i,l]=y.useState(null),[o,c]=y.useState([]),[d,u]=y.useState(!0),[m,w]=y.useState(null),[x,b]=y.useState("dashboard"),[g,N]=y.useState({min_amount:10,network:""}),[v,L]=y.useState(!1),[_,E]=y.useState(1),[A]=y.useState(20),[p,k]=y.useState(0);y.useEffect(()=>{var Z;if(!r){s("/");return}if(!(r.email==="admin@trademe.com"||r.username==="admin"||((Z=r.email)==null?void 0:Z.includes("admin")))){w("您没有访问用户钱包管理系统的权限");return}},[r,s]);const C=async()=>{try{const T=await fetch("/api/v1/user-wallets/admin/overview",{headers:{Authorization:`Bearer ${t}`}});if(T.ok){const Z=await T.json();if(Z.success)n(Z.data);else throw new Error(Z.message||"获取用户钱包统计失败")}else throw new Error("获取用户钱包统计失败")}catch(T){w(T instanceof Error?T.message:"获取用户钱包统计失败")}},W=async()=>{try{const T=await fetch("/api/v1/fund-consolidation/statistics",{headers:{Authorization:`Bearer ${t}`}});if(T.ok){const Z=await T.json();Z.success&&l(Z.data)}}catch(T){console.warn("获取归集统计失败:",T)}},re=async()=>{try{if(!(a!=null&&a.users))return;const T=[],Z=a.users.slice((_-1)*A,_*A);for(const oe of Z)try{const z=await fetch(`/api/v1/user-wallets/admin/user/${oe.user_id}/wallets`,{headers:{Authorization:`Bearer ${t}`}});if(z.ok){const D=await z.json();D.success&&T.push({...oe,wallets:D.data.wallets})}}catch(z){console.warn(`获取用户 ${oe.user_id} 钱包失败:`,z)}c(T),k(a.users.length)}catch(T){w(T instanceof Error?T.message:"获取用户钱包列表失败")}};y.useEffect(()=>{t&&(async()=>{u(!0),await C(),await W(),u(!1)})()},[t]),y.useEffect(()=>{a&&x==="users"&&re()},[a,_,x]);const Y=async T=>{T.preventDefault(),L(!0);try{const Z=await fetch("/api/v1/fund-consolidation/scan",{method:"GET",headers:{Authorization:`Bearer ${t}`}});if(Z.ok){const oe=await Z.json();if(oe.success&&oe.data.length>0){const z=oe.data.filter(D=>!(g.network&&D.network!==g.network||parseFloat(D.amount)<g.min_amount)).slice(0,10).map(D=>D.task_id);if(z.length>0){const D=await fetch("/api/v1/fund-consolidation/execute",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({task_ids:z,strategy:"THRESHOLD"})});if(D.ok){const ue=await D.json();ue.success&&(alert(`成功发起 ${ue.data.executed_tasks} 个归集任务`),await W(),await C())}}else alert("没有符合条件的归集任务")}else alert("当前没有可归集的资金")}else throw new Error("扫描归集机会失败")}catch(Z){alert(Z instanceof Error?Z.message:"发起归集失败")}finally{L(!1)}},X=async T=>{try{const Z=await fetch(`/api/v1/user-wallets/admin/user/${T}/allocate`,{method:"POST",headers:{Authorization:`Bearer ${t}`}});if(Z.ok){const oe=await Z.json();if(oe.success)alert(`成功为用户 ${T} 分配钱包`),await re();else throw new Error(oe.message||"分配钱包失败")}else throw new Error("分配钱包失败")}catch(Z){alert(Z instanceof Error?Z.message:"分配钱包失败")}},I=async T=>{try{const Z=await fetch("/api/v1/user-wallets/consolidate",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({min_amount:1})});if(Z.ok){const oe=await Z.json();if(oe.success)alert(`成功发起用户 ${T} 的资金归集`),await re(),await W();else throw new Error(oe.message||"发起归集失败")}else throw new Error("发起归集失败")}catch(Z){alert(Z instanceof Error?Z.message:"发起归集失败")}},ie=T=>T?new Date(T).toLocaleString("zh-CN"):"无",Q=Math.ceil(p/A);return d?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(It,{size:"lg"})}):m?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-600 text-lg mb-4",children:["⚠️ ",m]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"重新加载"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-green-600 to-green-700 flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 113 0m-3 0V2.25"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"用户钱包管理中心"}),e.jsx("p",{className:"text-sm text-gray-600",children:"用户钱包统计、资金归集和管理系统"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-4 py-2 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("span",{className:"text-green-700 text-sm font-semibold",children:(xe=r==null?void 0:r.username)==null?void 0:xe.charAt(0).toUpperCase()})}),e.jsxs("span",{className:"text-sm font-medium text-green-700",children:["管理员: ",r==null?void 0:r.username]})]}),e.jsxs("button",{onClick:()=>s("/admin"),className:"px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{children:"返回控制台"})]})]})]})})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"px-6",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"dashboard",name:"概览面板",icon:"📊"},{id:"users",name:"用户钱包",icon:"💰"},{id:"consolidation",name:"资金归集",icon:"⚡"},{id:"analytics",name:"数据分析",icon:"📈"}].map(T=>e.jsxs("button",{onClick:()=>b(T.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${x===T.id?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("span",{className:"mr-2",children:T.icon}),T.name]},T.id))})})}),e.jsxs("div",{className:"p-6",children:[x==="dashboard"&&a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 113 0m-3 0V2.25"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.summary.total_users})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"注册用户"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["已分配钱包 ",a.summary.total_user_wallets," 个"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.summary.funded_wallets})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"有资金钱包"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["占比 ",a.summary.total_user_wallets>0?(a.summary.funded_wallets/a.summary.total_user_wallets*100).toFixed(1):0,"%"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:Number(a.summary.total_user_balance).toFixed(2)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"用户总余额"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"USDT"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.summary.networks_count})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"支持网络"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"多网络支持"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"网络分布统计"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:a.network_distribution.map(T=>e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-lg text-gray-900",children:T.network}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:T.wallet_count}),e.jsx("p",{className:"text-sm text-gray-600",children:"钱包数量"}),e.jsxs("p",{className:"text-lg font-semibold text-green-600 mt-2",children:[Number(T.total_balance).toFixed(2)," USDT"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"总余额"})]},T.network))})]}),i&&e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"资金归集统计"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"可归集钱包"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:i.total_wallets_with_funds}),e.jsx("p",{className:"text-sm text-gray-600",children:"个钱包有资金"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"可归集金额"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:Number(i.total_consolidatable_amount).toFixed(2)}),e.jsx("p",{className:"text-sm text-gray-600",children:"USDT"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"今日归集"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:i.completed_consolidations_today}),e.jsx("p",{className:"text-sm text-gray-600",children:"次归集操作"})]})]})]})]}),x==="users"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["用户钱包列表 (共 ",p," 个用户)"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户信息"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"钱包统计"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"钱包地址"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(T=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[T.username," (ID: ",T.user_id,")"]}),e.jsx("div",{className:"text-sm text-gray-500",children:T.email})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:["钱包数: ",T.wallet_count]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["总余额: ",T.total_balance.toFixed(2)," USDT"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["创建时间: ",ie(T.last_wallet_created)]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"space-y-2",children:T.wallets&&Object.entries(T.wallets).map(([Z,oe])=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded bg-gray-100 text-gray-700",children:Z}),e.jsxs("span",{className:"font-mono text-xs text-gray-600",children:[oe.address.substring(0,8),"...",oe.address.substring(oe.address.length-6)]})]}),e.jsxs("div",{className:"text-xs text-gray-500 ml-2",children:["余额: ",oe.balance.toFixed(2)," USDT"]})]},Z))})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex space-x-2",children:[T.wallet_count===0&&e.jsx("button",{onClick:()=>X(T.user_id),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"分配钱包"}),T.total_balance>0&&e.jsx("button",{onClick:()=>I(T.user_id),className:"text-green-600 hover:text-green-800 text-sm font-medium",children:"归集资金"})]})})]},T.user_id))})]})}),Q>1&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["显示第 ",(_-1)*A+1," 到"," ",Math.min(_*A,p)," 个，共 ",p," 个用户"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>E(Math.max(1,_-1)),disabled:_===1,className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-200",children:"上一页"}),e.jsxs("span",{className:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded",children:["第 ",_," / ",Q," 页"]}),e.jsx("button",{onClick:()=>E(Math.min(Q,_+1)),disabled:_===Q,className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-200",children:"下一页"})]})]})})]})}),x==="consolidation"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"⚡"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"资金归集控制"}),e.jsx("p",{className:"text-gray-600",children:"自动扫描用户钱包并归集资金到主钱包"})]})]}),e.jsxs("form",{onSubmit:Y,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["最小归集金额 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",min:"0.1",max:"10000",step:"0.1",value:g.min_amount,onChange:T=>N(Z=>({...Z,min_amount:parseFloat(T.target.value)})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"最小归集金额 (USDT)",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"网络类型筛选"}),e.jsxs("select",{value:g.network,onChange:T=>N(Z=>({...Z,network:T.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"所有网络"}),e.jsx("option",{value:"TRC20",children:"TRC20 (Tron)"}),e.jsx("option",{value:"ERC20",children:"ERC20 (Ethereum)"}),e.jsx("option",{value:"BEP20",children:"BEP20 (Binance Smart Chain)"})]})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-400 mt-0.5 mr-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"归集说明"}),e.jsx("div",{className:"mt-2 text-sm text-blue-700",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"系统将自动扫描所有用户钱包的资金情况"}),e.jsx("li",{children:"只有达到最小金额阈值的钱包才会被归集"}),e.jsx("li",{children:"归集过程中会自动预留手续费"}),e.jsx("li",{children:"归集任务将在后台异步执行"}),e.jsx("li",{children:"单次最多执行10个归集任务"})]})})]})]})}),e.jsx("button",{type:"submit",disabled:v,className:"w-full px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 font-medium",children:v?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})}),e.jsx("span",{children:"扫描并执行归集中..."})]}):"开始资金归集"})]})]}),i&&e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"归集规则配置"}),e.jsx("div",{className:"space-y-4",children:Object.entries(i.network_breakdown).map(([T,Z])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:[T," 网络"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[Z.wallets_count," 个钱包有资金"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"总余额:"}),e.jsxs("span",{className:"font-medium ml-1",children:[Number(Z.total_balance).toFixed(2)," USDT"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"归集阈值:"}),e.jsxs("span",{className:"font-medium ml-1",children:[Number(Z.consolidation_threshold).toFixed(2)," USDT"]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("span",{className:"text-gray-600",children:"主钱包:"}),e.jsx("span",{className:"font-mono text-xs ml-1",children:Z.master_wallet||"未配置"})]})]})]},T))})]})]})]})]})},Yu=()=>{var ht;const s=ot(),{token:t,user:r}=Xe(),[a,n]=y.useState(null),[i,l]=y.useState(!0),[o,c]=y.useState(null),[d,u]=y.useState("overview"),[m,w]=y.useState("kline"),[x,b]=y.useState("spot"),[g,N]=y.useState(""),[v,L]=y.useState(["BTC/USDT"]),[_,E]=y.useState([]),[A,p]=y.useState(!1),[k,C]=y.useState(()=>{try{return new Date(Date.now()-7*24*60*60*1e3).toISOString().substring(0,10)}catch{return"2025-08-24"}}),[W,re]=y.useState(()=>{try{return new Date().toISOString().substring(0,10)}catch{return"2025-08-31"}}),[Y,X]=y.useState([]),[I,ie]=y.useState(null),[Q,xe]=y.useState(null),[T,Z]=y.useState(!1),[oe,z]=y.useState(null),[D,ue]=y.useState([]),[_e,rt]=y.useState(!1),fe=(R,de)=>R==="spot"?de==="tick"?["BTC","ETH","LTC","XRP","BCH","SOL","ADA","AVAX","MATIC","DOGE"]:["BTC/USDT","ETH/USDT","SOL/USDT","ADA/USDT","DOT/USDT","LINK/USDT","MATIC/USDT","AVAX/USDT","XRP/USDT","DOGE/USDT"]:de==="tick"?["BTC","ETH","LTC","XRP","BCH","SOL","ADA","AVAX"]:["BTC-USDT-SWAP","ETH-USDT-SWAP","SOL-USDT-SWAP","ADA-USDT-SWAP","DOT-USDT-SWAP","LINK-USDT-SWAP"],We=["1m","5m","15m","30m","1h","2h","4h","1d","1w"];y.useEffect(()=>{if(!t||!r){s("/login");return}if(r.membership_level!=="professional"){c("需要专业版权限才能访问数据管理中心"),l(!1);return}},[t,r,s]);const ye=async()=>{try{const R=await fetch("/api/v1/data/storage/stats",{headers:{Authorization:`Bearer ${t}`}});if(!R.ok)throw new Error(`HTTP ${R.status}: ${R.statusText}`);const de=await R.json();if(de.success)n(de.data);else throw new Error(de.detail||"数据获取失败");l(!1)}catch(R){console.error("获取数据统计失败:",R),c(R instanceof Error?R.message:"数据获取失败"),l(!1)}},ce=async()=>{try{const de=await(await fetch("/api/v1/data/okx/statistics",{headers:{Authorization:`Bearer ${t}`}})).json();de.success&&xe(de.data)}catch(R){console.error("获取OKX统计失败:",R)}},Ce=async()=>{Z(!0);try{const de=await fetch("/api/v1/data/query?data_type=kline&exchange=okx&symbol=BTC-USDT-SWAP",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!de.ok)throw new Error(`数据查询失败: ${de.status}`);const Ve=await de.json();if(Ve.success&&Ve.data.query_result){const at=Ve.data.query_result.map(Me=>({exchange:"OKX",symbol:Me.symbol,timeframe:Me.timeframe,record_count:Me.record_count,earliest_date:Me.start_date,latest_date:Me.end_date,timeframes_count:1}));X(at)}else X([])}catch(R){console.error("获取数据可用性失败:",R),X([])}finally{Z(!1)}},Ge=async()=>{try{const de=await(await fetch("/api/v1/data/okx/tasks",{headers:{Authorization:`Bearer ${t}`}})).json();de.success&&Array.isArray(de.data)?E(de.data):(console.warn("OKX tasks data is not an array:",de.data),E([]))}catch(R){console.error("获取OKX任务列表失败:",R)}},Ut=async()=>{if(!Array.isArray(v)||v.length===0){alert("请选择至少一个交易对");return}p(!0);try{const R=m==="tick"?"/api/v1/data/okx/tick/download":"/api/v1/data/okx/kline/download",de=Ae=>{try{return typeof Ae!="string"||!Ae?new Date().toISOString().substring(0,10).replace(/-/g,""):Ae.replace(/-/g,"")}catch(j){return console.error("Date formatting error:",j),"20250831"}},Ve=m==="tick"?{symbols:v.filter(Ae=>typeof Ae=="string"&&Ae.length>0),start_date:de(k),end_date:de(W)}:{symbols:v.filter(Ae=>typeof Ae=="string"&&Ae.length>0),timeframes:We,start_date:de(k),end_date:de(W)},Me=await(await fetch(R,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(Ve)})).json();if(Me.success)alert(`OKX ${m==="tick"?"Tick":"K线"}数据下载任务已启动！任务ID: ${Me.data.task_id}`),await Ge();else throw new Error(Me.detail||"下载启动失败")}catch(R){alert(R instanceof Error?R.message:"OKX下载启动失败")}finally{p(!1)}},wt=async()=>{rt(!0);try{const R=["BTC/USDT","ETH/USDT","SOL/USDT"],de=["1h","1d"],at=[];let Me=[];for(const h of R)for(const S of de)at.push(fetch(`/api/v1/data/quality/check/okx/${h}/${S}?check_days=7`,{headers:{Authorization:`Bearer ${t}`}}).then(O=>O.json()).then(O=>O.success&&O.data?(O.data.missing_periods&&O.data.missing_periods.length>0&&O.data.missing_periods.forEach($=>{Me.push({symbol:h,data_type:"K线",timeframe:S,missing_period:$.period||$,missing_count:$.count||0,severity:$.count>100?"critical":"warning"})}),O.data):null).catch(()=>null));const j=(await Promise.all(at)).filter(h=>h!==null);if(j.length>0){const h=j.length,S=j.filter($=>$.completeness_percent>=95).length,O=h>0?S/h*100:0;z({completeness:{kline_completeness:O,tick_completeness:0,missing_dates:[]},accuracy:{price_anomalies:j.reduce(($,F)=>{var V;return $+(((V=F.anomalies)==null?void 0:V.price_anomalies)||0)},0),volume_anomalies:j.reduce(($,F)=>{var V;return $+(((V=F.anomalies)==null?void 0:V.volume_anomalies)||0)},0)}})}else z({completeness:{kline_completeness:0,tick_completeness:0,missing_dates:[]},accuracy:{price_anomalies:0,volume_anomalies:0}});ue(Me)}catch(R){console.error("质量检查失败:",R),alert("质量检查失败: "+(R instanceof Error?R.message:"未知错误"))}finally{rt(!1)}};return y.useEffect(()=>{d==="overview"&&t&&(ce(),Ce())},[d,t]),y.useEffect(()=>{t&&r&&(ye(),Ge())},[t,r]),y.useEffect(()=>{if(d==="okx-download"){const R=setInterval(Ge,3e3);return()=>clearInterval(R)}},[d,t]),i?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(It,{size:"lg"})}):o?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-600 text-lg mb-4",children:["⚠️ ",o]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"重新加载"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"数据管理中心"}),e.jsx("p",{className:"text-sm text-gray-600",children:"完全集成后端API的数据管理系统"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-4 py-2 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-blue-700 text-sm font-semibold",children:(ht=r==null?void 0:r.username)==null?void 0:ht.charAt(0).toUpperCase()})}),e.jsxs("span",{className:"text-sm font-medium text-blue-700",children:["管理员: ",r==null?void 0:r.username]})]}),e.jsxs("button",{onClick:()=>s("/admin"),className:"px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{children:"返回控制台"})]})]})]})})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"px-6",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"overview",name:"数据概览",icon:"📊"},{id:"okx-download",name:"OKX数据下载",icon:"🚀"},{id:"quality",name:"质量监控",icon:"🔍"}].map(R=>e.jsxs("button",{onClick:()=>u(R.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${d===R.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("span",{className:"mr-2",children:R.icon}),R.name]},R.id))})})}),e.jsxs("div",{className:"p-6",children:[d==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"真实API数据统计概览"}),e.jsxs("button",{onClick:()=>{ye(),ce(),Ce()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{children:"刷新数据"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"数据库真实数据概览"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"显示我们后台现有的所有数据，按交易所、数据类型、市场类型分组"}),T?e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"ml-2 text-gray-600",children:"加载数据中..."})]}):e.jsxs("div",{className:"space-y-6",children:[Q&&e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"OKX"})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"OKX 交易所数据统计"})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4",children:[e.jsx("h5",{className:"font-semibold text-gray-800 mb-3",children:"📊 下载统计"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Q.download_statistics.total_downloads}),e.jsx("div",{className:"text-sm text-gray-600",children:"总下载次数"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:Q.download_statistics.successful_downloads}),e.jsx("div",{className:"text-sm text-gray-600",children:"成功下载"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:Q.download_statistics.failed_downloads}),e.jsx("div",{className:"text-sm text-gray-600",children:"失败次数"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:Q.download_statistics.total_files_processed}),e.jsx("div",{className:"text-sm text-gray-600",children:"处理文件数"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[(Q.download_statistics.total_records_downloaded/1e6).toFixed(1),"M"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"下载记录数"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:"📈 K线数据支持的交易对"}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"mb-1",children:["总计: ",e.jsxs("span",{className:"font-medium text-blue-700",children:[Q.supported_symbols.kline_data.length,"个"]})]}),e.jsxs("div",{className:"text-gray-600 max-h-20 overflow-y-auto",children:[Q.supported_symbols.kline_data.slice(0,10).join(", "),Q.supported_symbols.kline_data.length>10&&"..."]})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h5",{className:"font-semibold text-green-800 mb-2",children:"⚡ Tick数据支持的交易对"}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"mb-1",children:["总计: ",e.jsxs("span",{className:"font-medium text-green-700",children:[Q.supported_symbols.tick_data.length,"个"]})]}),e.jsxs("div",{className:"text-gray-600 max-h-20 overflow-y-auto",children:[Q.supported_symbols.tick_data.slice(0,10).join(", "),Q.supported_symbols.tick_data.length>10&&"..."]})]})]})]}),e.jsxs("div",{className:"mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h5",{className:"font-semibold text-yellow-800 mb-2",children:"⏰ 支持的时间框架"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Q.supported_timeframes.map(R=>e.jsx("span",{className:"px-2 py-1 bg-yellow-200 text-yellow-800 rounded text-sm font-medium",children:R},R))})]})]}),!Q&&!T&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📊"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"数据统计信息"}),e.jsx("p",{className:"text-gray-600 mb-4",children:'请点击上方"刷新数据"按钮加载最新数据'})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"🔍 数据查询工具"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"查询数据库中的真实数据情况，了解具体的数据日期范围"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"数据类型"}),e.jsxs("select",{value:m,onChange:R=>w(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"kline",children:"K线数据"}),e.jsx("option",{value:"tick",children:"Tick数据"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"市场类型"}),e.jsxs("select",{value:x,onChange:R=>b(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"spot",children:"现货市场"}),e.jsx("option",{value:"futures",children:"合约市场"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易对"}),e.jsxs("select",{value:v[0]||"",onChange:R=>L(R.target.value?[R.target.value]:[]),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"全部"}),fe(x,m).map(R=>e.jsx("option",{value:R,children:R},R))]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsxs("button",{onClick:async()=>{Z(!0);try{const R=v[0]||null,de=R?`/api/v1/data/query?data_type=${m}&exchange=okx&symbol=${encodeURIComponent(R)}`:`/api/v1/data/query?data_type=${m}&exchange=okx`,Ve=localStorage.getItem("auth-storage"),at=Ve?JSON.parse(Ve).state.token:null;if(!at)throw new Error("未找到认证令牌，请重新登录");const Me=await fetch(de,{headers:{Authorization:`Bearer ${at}`,"Content-Type":"application/json"}});if(!Me.ok)throw new Error(`HTTP错误: ${Me.status}`);const Ae=await Me.json();Ae.success?(X(Ae.data.query_result||[]),ie(Ae.data.summary||null)):console.error("查询失败:",Ae)}catch(R){console.error("查询数据失败:",R)}finally{Z(!1)}},disabled:T,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("span",{children:"查询数据"})]}),e.jsx("button",{onClick:()=>{X([])},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:"清除结果"})]}),T&&e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"ml-2 text-gray-600",children:"查询中..."})]}),Y.length>0&&!T&&e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"📊 查询结果"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Y.map((R,de)=>e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h5",{className:"font-semibold text-gray-800",children:R.symbol}),R.timeframe&&e.jsx("span",{className:"text-sm text-blue-600 bg-blue-100 px-2 py-1 rounded",children:R.timeframe})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[R.start_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"开始日期:"}),e.jsx("span",{className:"font-medium",children:new Date(R.start_date).toLocaleDateString()})]}),R.end_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"结束日期:"}),e.jsx("span",{className:"font-medium",children:new Date(R.end_date).toLocaleDateString()})]}),R.record_count&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"记录数:"}),e.jsx("span",{className:"font-medium text-blue-600",children:R.record_count.toLocaleString()})]}),R.total_records&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"总记录:"}),e.jsx("span",{className:"font-medium text-green-600",children:R.total_records.toLocaleString()})]}),R.timeframes_count&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"时间框架数:"}),e.jsx("span",{className:"font-medium text-purple-600",children:R.timeframes_count})]}),R.earliest_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"最早数据:"}),e.jsx("span",{className:"font-medium",children:new Date(R.earliest_date).toLocaleDateString()})]}),R.latest_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"最新数据:"}),e.jsx("span",{className:"font-medium",children:new Date(R.latest_date).toLocaleDateString()})]})]})]},de))})]}),I&&!T&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-lg p-6 mt-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"📈 数据统计摘要"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[I.total_records&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:I.total_records.toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-600",children:"总记录数"})]}),I.data_completeness_percent!==void 0&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-2xl font-bold ${I.data_completeness_percent>=95?"text-green-600":"text-yellow-600"}`,children:[I.data_completeness_percent,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"数据完整度"})]}),I.timeframes_available&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:I.timeframes_available}),e.jsx("div",{className:"text-sm text-gray-600",children:"时间框架"})]}),I.days_span&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:I.days_span}),e.jsx("div",{className:"text-sm text-gray-600",children:"天数跨度"})]}),I.earliest_date&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800",children:new Date(I.earliest_date).toLocaleDateString()}),e.jsx("div",{className:"text-sm text-gray-600",children:"最早日期"})]}),I.latest_date&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800",children:new Date(I.latest_date).toLocaleDateString()}),e.jsx("div",{className:"text-sm text-gray-600",children:"最新日期"})]})]})]}),!T&&Y.length===0&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📊"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"暂无查询结果"}),e.jsx("p",{className:"text-gray-600",children:'请点击"查询数据"按钮来查看数据库中的真实数据情况'})]})]})]}),d==="okx-download"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"OKX 数据下载中心"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"数据类型"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>w("kline"),className:`px-6 py-3 rounded-lg font-medium transition-all duration-200 ${m==="kline"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"📈 K线数据"}),e.jsx("button",{onClick:()=>w("tick"),className:`px-6 py-3 rounded-lg font-medium transition-all duration-200 ${m==="tick"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"⚡ Tick数据"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"市场类型"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>b("spot"),className:`px-6 py-3 rounded-lg font-medium transition-all duration-200 ${x==="spot"?"bg-green-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"💰 现货市场"}),e.jsx("button",{onClick:()=>b("futures"),className:`px-6 py-3 rounded-lg font-medium transition-all duration-200 ${x==="futures"?"bg-orange-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"📈 合约市场 (永续)"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"交易对选择"}),e.jsx("button",{onClick:()=>{try{const R=fe(x,m);Array.isArray(R)&&L(R)}catch(R){console.error("Error selecting all symbols:",R),L([])}},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"全选所有"})]}),e.jsx("div",{className:"grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-2 mb-4",children:fe(x,m).map(R=>e.jsxs("label",{className:"flex items-center space-x-2 p-2 border rounded cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:Array.isArray(v)&&v.includes(R),onChange:de=>{if(!Array.isArray(v)){L([]);return}de.target.checked?L([...v,R]):L(v.filter(Ve=>Ve!==R))},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:R})]},R))}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:g,onChange:R=>N(R.target.value),placeholder:x==="spot"?m==="tick"?"输入现货Tick交易对 (如: DOGE)":"输入现货K线交易对 (如: DOGE/USDT)":m==="tick"?"输入合约Tick交易对 (如: DOGE)":"输入合约K线交易对 (如: DOGE-USDT-SWAP)",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:()=>{g&&g.trim()&&Array.isArray(v)&&!v.includes(g.trim())&&(L([...v,g.trim()]),N(""))},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"添加"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["已选择 ",Array.isArray(v)?v.length:0," 个交易对："]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.isArray(v)&&v.map(R=>e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm flex items-center space-x-1",children:[e.jsx("span",{children:R}),e.jsx("button",{onClick:()=>{Array.isArray(v)&&L(v.filter(de=>de!==R))},className:"text-blue-600 hover:text-blue-800",children:"×"})]},R))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"时间范围选择"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"开始日期"}),e.jsx("input",{type:"date",value:k,onChange:R=>C(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"结束日期"}),e.jsx("input",{type:"date",value:W,onChange:R=>re(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["选择的时间范围: ",k," 到 ",W]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{const R=new Date(Date.now()-6048e5).toISOString().substring(0,10),de=new Date().toISOString().substring(0,10);C(R),re(de)},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200 transition-colors",children:"最近7天"}),e.jsx("button",{onClick:()=>{const R=new Date(Date.now()-2592e6).toISOString().substring(0,10),de=new Date().toISOString().substring(0,10);C(R),re(de)},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200 transition-colors",children:"最近30天"}),e.jsx("button",{onClick:()=>{const R=new Date(Date.now()-7776e6).toISOString().substring(0,10),de=new Date().toISOString().substring(0,10);C(R),re(de)},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200 transition-colors",children:"最近3个月"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2 text-gray-900",children:"时间框架 (自动全选)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:We.map(R=>e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:["✓ ",R]},R))}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"所有时间框架将自动下载，无需手动选择"})]}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx("button",{onClick:Ut,disabled:A||!Array.isArray(v)||v.length===0,className:`px-8 py-3 rounded-lg font-semibold transition-all duration-200 ${A||!Array.isArray(v)||v.length===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 shadow-lg hover:shadow-xl"}`,children:A?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white inline",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"正在启动下载..."]}):e.jsxs(e.Fragment,{children:["🚀 开始下载 ",m==="tick"?"Tick":"K线","数据 (",Array.isArray(v)?v.length:0," 个交易对)"]})})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold",children:"下载任务列表"})}),e.jsx("div",{className:"p-6",children:!Array.isArray(_)||_.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"暂无下载任务"}):e.jsx("div",{className:"space-y-4",children:Array.isArray(_)&&_.slice(0,5).map(R=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${R.status==="completed"?"bg-green-500":R.status==="running"?"bg-blue-500":R.status==="failed"?"bg-red-500":"bg-gray-400"}`}),e.jsxs("span",{className:"font-medium",children:[R.data_type.toUpperCase()," - ",R.symbols.join(", ")]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${R.status==="completed"?"bg-green-100 text-green-800":R.status==="running"?"bg-blue-100 text-blue-800":R.status==="failed"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:R.status})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${R.progress}%`}})}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[R.progress,"% - ",R.processed_files,"/",R.total_files," 文件"]})]},R.task_id))})})]})]}),d==="quality"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"数据完整性检测 (真实API)"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:wt,disabled:_e,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400",children:"🔍 开始检测"}),e.jsx("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"📊 生成报告"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"使用真实API检测数据完整性，精确定位每个缺失时段"})]}),oe&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"K线数据完整性"}),e.jsx("div",{className:"w-16 h-16 rounded-full bg-green-100 flex items-center justify-center",children:e.jsxs("span",{className:"text-lg font-bold text-green-600",children:[oe.completeness.kline_completeness.toFixed(1),"%"]})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"检查结果:"}),e.jsx("span",{className:"font-medium",children:"真实API数据"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"完整性:"}),e.jsxs("span",{className:"font-medium",children:[oe.completeness.kline_completeness.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600",children:"异常数据:"}),e.jsxs("span",{className:"font-medium text-red-600",children:[oe.accuracy.price_anomalies," 处"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Tick数据完整性"}),e.jsx("div",{className:"w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[oe.completeness.tick_completeness.toFixed(1),"%"]})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"检查结果:"}),e.jsx("span",{className:"font-medium",children:"待实现"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"完整性:"}),e.jsxs("span",{className:"font-medium",children:[oe.completeness.tick_completeness.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600",children:"成交量异常:"}),e.jsxs("span",{className:"font-medium text-red-600",children:[oe.accuracy.volume_anomalies," 处"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"数据异常检测"}),e.jsx("div",{className:"w-16 h-16 rounded-full bg-yellow-100 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"⚠️"})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"价格异常:"}),e.jsxs("span",{className:"font-medium text-yellow-600",children:[oe.accuracy.price_anomalies," 处"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"成交量异常:"}),e.jsxs("span",{className:"font-medium text-yellow-600",children:[oe.accuracy.volume_anomalies," 处"]})]})]})]})]}),D.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"详细缺失分析 (真实API数据)"}),e.jsx("p",{className:"text-sm text-gray-600",children:"基于真实API检测结果，精确定位每个缺失时段"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"交易对"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"数据类型"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"时间框架"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"缺失时段"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"缺失数量"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"严重程度"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"操作"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:D.map((R,de)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:R.symbol}),e.jsx("td",{className:"px-4 py-3 text-sm",children:R.data_type}),e.jsx("td",{className:"px-4 py-3 text-sm",children:R.timeframe}),e.jsx("td",{className:"px-4 py-3 text-sm",children:R.missing_period}),e.jsx("td",{className:"px-4 py-3 text-sm text-red-600",children:R.missing_count===0?"全时段":`${R.missing_count}条`}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded ${R.severity==="critical"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:R.severity==="critical"?"Critical":"Warning"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"补全下载"})})]},de))})]})})})]}),!oe&&!_e&&e.jsxs("div",{className:"bg-white rounded-xl p-12 shadow-sm border text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"数据质量检测 (真实API)"}),e.jsx("p",{className:"text-gray-600 mb-4",children:'点击"开始检测"按钮运行真实API数据完整性分析'}),e.jsx("button",{onClick:wt,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"🚀 开始质量检测"})]}),_e&&e.jsxs("div",{className:"bg-white rounded-xl p-12 shadow-sm border text-center",children:[e.jsx("div",{className:"flex justify-center items-center mb-4",children:e.jsxs("svg",{className:"animate-spin h-12 w-12 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"正在执行质量检测..."}),e.jsx("p",{className:"text-gray-600",children:"调用真实API检测数据完整性，请稍候"})]})]})]})]})},em=()=>e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"w-24 h-24 mx-auto bg-gray-200 rounded-full flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-4xl",children:"🔍"})}),e.jsx("h1",{className:"text-6xl font-bold text-gray-900 mb-4",children:"404"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-700 mb-2",children:"页面未找到"}),e.jsx("p",{className:"text-gray-500 mb-8",children:"抱歉，您访问的页面不存在或已被移动"})]}),e.jsxs("div",{className:"space-x-4",children:[e.jsx(Ke,{to:"/",children:e.jsx(dt,{children:"返回首页"})}),e.jsx(Ke,{to:"/overview",children:e.jsx(dt,{variant:"outline",children:"前往概览页"})})]})]})}),Bt=({children:s})=>{var b;const t=Or(),{user:r,logout:a}=Xe(),{theme:n,toggleTheme:i}=Qr(),{language:l,setLanguage:o,t:c}=ns(),d=[{path:"/ai-chat",label:"AI助手",key:"ai-chat"},{path:"/strategies",label:c("liveTrading"),key:"strategies"},{path:"/backtest",label:c("backtest"),key:"backtest"},{path:"/profile",label:c("accountCenter"),key:"profile"}],u=g=>g==="/ai-chat"?t.pathname==="/ai-chat":g==="/trading"?t.pathname==="/trading":t.pathname.startsWith(g),m=()=>{a(),window.location.href="/login"},w=g=>{o(g)},x=()=>{i()};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:e.jsxs("div",{className:"max-w-[1440px] mx-auto bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden relative transition-colors",children:[e.jsxs("header",{className:"py-4 px-8 flex justify-between border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-7 h-7 rounded-full bg-brand-500 flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"T"})}),e.jsx("h1",{className:"text-xl font-bold text-brand-500 dark:text-brand-400",children:"Trademe"})]}),e.jsx("nav",{className:"flex gap-2",children:d.map(g=>e.jsx(Ke,{to:g.path,className:`nav-item ${u(g.path)?"active":""}`,children:g.label},g.key))}),e.jsxs("div",{className:"flex items-center relative group",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-gray-200 overflow-hidden cursor-pointer",children:r!=null&&r.avatar_url?e.jsx("img",{src:r.avatar_url,alt:"User avatar",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-brand-100 text-brand-600 font-medium",children:((b=r==null?void 0:r.username)==null?void 0:b.charAt(0).toUpperCase())||"U"})}),e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50",children:[e.jsxs("div",{className:"px-4 py-2 border-b border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:r==null?void 0:r.username}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:r==null?void 0:r.email}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200 mt-1",children:[(r==null?void 0:r.membership_level)==="basic"&&"基础版",(r==null?void 0:r.membership_level)==="premium"&&"高级版",(r==null?void 0:r.membership_level)==="professional"&&"专业版"]})]}),e.jsx(Ke,{to:"/profile",className:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:c("settings")}),e.jsx(Ke,{to:"/profile/membership",className:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:c("membershipManagement")}),e.jsx("button",{onClick:m,className:"block w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:c("logout")})]})]})]}),e.jsxs("div",{className:"absolute top-4 right-8 flex items-center space-x-4 z-40",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>w("zh"),className:`px-2 py-1 text-sm rounded-md transition-colors ${l==="zh"?"bg-blue-100 text-blue-700 dark:bg-blue-800 dark:text-blue-200":"bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-300"}`,children:"中"}),e.jsx("button",{onClick:()=>w("en"),className:`px-2 py-1 text-sm rounded-md transition-colors ${l==="en"?"bg-blue-100 text-blue-700 dark:bg-blue-800 dark:text-blue-200":"bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-300"}`,children:"EN"})]}),e.jsx("div",{className:"border-l border-gray-300 dark:border-gray-600 h-6"}),e.jsx("button",{onClick:x,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:c(n==="light"?"darkMode":"lightMode"),children:n==="light"?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]}),e.jsx("main",{className:"p-8",children:s})]})})},tm=({children:s})=>e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[e.jsx("header",{className:"py-6 px-8 flex justify-center border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-brand-500 flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-white font-bold",children:"T"})}),e.jsx("h1",{className:"text-2xl font-bold text-brand-500",children:"Trademe"})]})}),e.jsxs("div",{className:"absolute top-4 right-4 flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"lang-toggle px-2 py-1 text-sm rounded-md bg-gray-100 hover:bg-gray-200","data-lang":"zh",children:"中"}),e.jsx("button",{className:"lang-toggle px-2 py-1 text-sm rounded-md hover:bg-gray-200","data-lang":"en",children:"EN"})]}),e.jsx("div",{className:"border-l border-gray-300 h-6"}),e.jsx("button",{id:"theme-toggle",className:"p-2 rounded-full hover:bg-gray-200",title:"切换主题",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.166a.75.75 0 00-1.06-1.06l-1.591 1.59a.75.75 0 101.06 1.061l1.591-1.59zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.834 18.894a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 10-1.061 1.06l1.59 1.591zM12 18a.75.75 0 01.75.75V21a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM7.758 17.303a.75.75 0 00-1.061-1.06l-1.591 1.59a.75.75 0 001.06 1.061l1.591-1.59zM6 12a.75.75 0 01-.75.75H3a.75.75 0 010-1.5h2.25A.75.75 0 016 12zM6.697 7.757a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 00-1.061 1.06l1.59 1.591z"})})})]}),e.jsx("main",{className:"p-8",children:s}),e.jsx("footer",{className:"px-8 pb-6 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"© 2024 Trademe. 专业的数字货币策略交易平台"})})]})});function sm(){const{isLoading:s,checkAuth:t,token:r,isAuthenticated:a}=Xe(),{theme:n}=Qr();return y.useEffect(()=>{r&&!a&&t()},[t,r,a]),y.useEffect(()=>{n==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[n]),s?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 transition-colors",children:e.jsx(It,{size:"lg"})}):e.jsx(a0,{clientId:"832153922895-6hc3h1qsb72td6gd8lq9vcajq3rborpj.apps.googleusercontent.com",children:e.jsxs(kl,{children:[e.jsx(De,{path:"/login",element:e.jsx(hu,{})}),e.jsx(De,{path:"/verification",element:e.jsx(tm,{children:e.jsx(xu,{})})}),e.jsx(De,{path:"/",element:e.jsx(m0,{})}),e.jsx(De,{path:"/overview",element:e.jsx(Ye,{children:e.jsx(Bt,{children:e.jsx(wu,{})})})}),e.jsx(De,{path:"/strategies",element:e.jsx(Ye,{children:e.jsx(Bt,{children:e.jsx(ku,{})})})}),e.jsx(De,{path:"/strategy/:strategyId/live",element:e.jsx(Ye,{children:e.jsx(Bt,{children:e.jsx(_u,{})})})}),e.jsx(De,{path:"/live-strategies",element:e.jsx(Ye,{children:e.jsx(Su,{})})}),e.jsx(De,{path:"/backtest",element:e.jsx(Ye,{children:e.jsx(Bt,{children:e.jsx(Au,{})})})}),e.jsx(De,{path:"/backtest/:id/details",element:e.jsx(Ye,{children:e.jsx(Bt,{children:e.jsx(Lu,{})})})}),e.jsx(De,{path:"/ai-chat",element:e.jsx(Ye,{children:e.jsx(Bt,{children:e.jsx(qu,{})})})}),e.jsx(De,{path:"/api-keys",element:e.jsx(Ye,{children:e.jsx(Bt,{children:e.jsx(Xn,{})})})}),e.jsx(De,{path:"/api-management",element:e.jsx(Ye,{children:e.jsx(Bt,{children:e.jsx(Xn,{})})})}),e.jsx(De,{path:"/profile",element:e.jsx(Ye,{children:e.jsx(Bt,{children:e.jsx(Gu,{})})})}),e.jsx(De,{path:"/admin",element:e.jsx(Ye,{children:e.jsx(Ku,{})})}),e.jsx(De,{path:"/admin/users",element:e.jsx(Ye,{children:e.jsx(Ju,{})})}),e.jsx(De,{path:"/admin/claude",element:e.jsx(Ye,{children:e.jsx(Qu,{})})}),e.jsx(De,{path:"/admin/wallets",element:e.jsx(Ye,{children:e.jsx(Xu,{})})}),e.jsx(De,{path:"/admin/data",element:e.jsx(Ye,{children:e.jsx(Yu,{})})}),e.jsx(De,{path:"*",element:e.jsx(em,{})})]})})}const rm=new to({defaultOptions:{queries:{staleTime:5*60*1e3,retry:(s,t)=>{var r,a;return((r=t==null?void 0:t.response)==null?void 0:r.status)>=400&&((a=t==null?void 0:t.response)==null?void 0:a.status)<500?!1:s<3}},mutations:{retry:1}}});ua.createRoot(document.getElementById("root")).render(e.jsx(ze.StrictMode,{children:e.jsxs(ro,{client:rm,children:[e.jsxs(_l,{children:[e.jsx(sm,{}),e.jsx(qo,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{iconTheme:{primary:"#22c55e",secondary:"#fff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]}),!1]})}));
//# sourceMappingURL=index-Bsh83YmY.js.map
