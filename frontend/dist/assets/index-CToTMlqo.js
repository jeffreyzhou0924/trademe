var Cl=Object.defineProperty;var tn=s=>{throw TypeError(s)};var Al=(s,t,r)=>t in s?Cl(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var Ne=(s,t,r)=>Al(s,typeof t!="symbol"?t+"":t,r),sa=(s,t,r)=>t.has(s)||tn("Cannot "+r);var F=(s,t,r)=>(sa(s,t,"read from private field"),r?r.call(s):t.get(s)),Te=(s,t,r)=>t.has(s)?tn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,r),je=(s,t,r,a)=>(sa(s,t,"write to private field"),a?a.call(s,r):t.set(s,r),r),Xe=(s,t,r)=>(sa(s,t,"access private method"),r);var xr=(s,t,r,a)=>({set _(n){je(s,t,n,r)},get _(){return F(s,t,a)}});import{r as b,a as Ll,g as Tl,R as Ke,u as ot,L as Ge,b as Oa,c as gi,N as Ml,d as El,e as Re,B as Pl}from"./vendor-D-qGpst1.js";import{i as Zs,L as ma,R as $l}from"./charts-BV7FbyVl.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var pi={exports:{}},Fr={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Il=b,Dl=Symbol.for("react.element"),Rl=Symbol.for("react.fragment"),Bl=Object.prototype.hasOwnProperty,Ol=Il.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Fl={key:!0,ref:!0,__self:!0,__source:!0};function fi(s,t,r){var a,n={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(a in t)Bl.call(t,a)&&!Fl.hasOwnProperty(a)&&(n[a]=t[a]);if(s&&s.defaultProps)for(a in t=s.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:Dl,type:s,key:i,ref:l,props:n,_owner:Ol.current}}Fr.Fragment=Rl;Fr.jsx=fi;Fr.jsxs=fi;pi.exports=Fr;var e=pi.exports,xa={},sn=Ll;xa.createRoot=sn.createRoot,xa.hydrateRoot=sn.hydrateRoot;var zr=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(s){return this.listeners.add(s),this.onSubscribe(),()=>{this.listeners.delete(s),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Ur=typeof window>"u"||"Deno"in globalThis;function pt(){}function zl(s,t){return typeof s=="function"?s(t):s}function Ul(s){return typeof s=="number"&&s>=0&&s!==1/0}function Wl(s,t){return Math.max(s+(t||0)-Date.now(),0)}function ga(s,t){return typeof s=="function"?s(t):s}function Vl(s,t){return typeof s=="function"?s(t):s}function rn(s,t){const{type:r="all",exact:a,fetchStatus:n,predicate:i,queryKey:l,stale:o}=s;if(l){if(a){if(t.queryHash!==Fa(l,t.options))return!1}else if(!Ys(t.queryKey,l))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||n&&n!==t.state.fetchStatus||i&&!i(t))}function an(s,t){const{exact:r,status:a,predicate:n,mutationKey:i}=s;if(i){if(!t.options.mutationKey)return!1;if(r){if(Xs(t.options.mutationKey)!==Xs(i))return!1}else if(!Ys(t.options.mutationKey,i))return!1}return!(a&&t.state.status!==a||n&&!n(t))}function Fa(s,t){return((t==null?void 0:t.queryKeyHashFn)||Xs)(s)}function Xs(s){return JSON.stringify(s,(t,r)=>pa(r)?Object.keys(r).sort().reduce((a,n)=>(a[n]=r[n],a),{}):r)}function Ys(s,t){return s===t?!0:typeof s!=typeof t?!1:s&&t&&typeof s=="object"&&typeof t=="object"?Object.keys(t).every(r=>Ys(s[r],t[r])):!1}function yi(s,t){if(s===t)return s;const r=nn(s)&&nn(t);if(r||pa(s)&&pa(t)){const a=r?s:Object.keys(s),n=a.length,i=r?t:Object.keys(t),l=i.length,o=r?[]:{},c=new Set(a);let d=0;for(let h=0;h<l;h++){const u=r?h:i[h];(!r&&c.has(u)||r)&&s[u]===void 0&&t[u]===void 0?(o[u]=void 0,d++):(o[u]=yi(s[u],t[u]),o[u]===s[u]&&s[u]!==void 0&&d++)}return n===l&&d===n?s:o}return t}function nn(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function pa(s){if(!ln(s))return!1;const t=s.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!ln(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(s)!==Object.prototype)}function ln(s){return Object.prototype.toString.call(s)==="[object Object]"}function Hl(s){return new Promise(t=>{setTimeout(t,s)})}function ql(s,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(s,t):r.structuralSharing!==!1?yi(s,t):t}function Kl(s,t,r=0){const a=[...s,t];return r&&a.length>r?a.slice(1):a}function Zl(s,t,r=0){const a=[t,...s];return r&&a.length>r?a.slice(0,-1):a}var za=Symbol();function bi(s,t){return!s.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!s.queryFn||s.queryFn===za?()=>Promise.reject(new Error(`Missing queryFn: '${s.queryHash}'`)):s.queryFn}var hs,Gt,Cs,li,Gl=(li=class extends zr{constructor(){super();Te(this,hs);Te(this,Gt);Te(this,Cs);je(this,Cs,t=>{if(!Ur&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){F(this,Gt)||this.setEventListener(F(this,Cs))}onUnsubscribe(){var t;this.hasListeners()||((t=F(this,Gt))==null||t.call(this),je(this,Gt,void 0))}setEventListener(t){var r;je(this,Cs,t),(r=F(this,Gt))==null||r.call(this),je(this,Gt,t(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(t){F(this,hs)!==t&&(je(this,hs,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof F(this,hs)=="boolean"?F(this,hs):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},hs=new WeakMap,Gt=new WeakMap,Cs=new WeakMap,li),vi=new Gl,As,Jt,Ls,oi,Jl=(oi=class extends zr{constructor(){super();Te(this,As,!0);Te(this,Jt);Te(this,Ls);je(this,Ls,t=>{if(!Ur&&window.addEventListener){const r=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",a)}}})}onSubscribe(){F(this,Jt)||this.setEventListener(F(this,Ls))}onUnsubscribe(){var t;this.hasListeners()||((t=F(this,Jt))==null||t.call(this),je(this,Jt,void 0))}setEventListener(t){var r;je(this,Ls,t),(r=F(this,Jt))==null||r.call(this),je(this,Jt,t(this.setOnline.bind(this)))}setOnline(t){F(this,As)!==t&&(je(this,As,t),this.listeners.forEach(a=>{a(t)}))}isOnline(){return F(this,As)}},As=new WeakMap,Jt=new WeakMap,Ls=new WeakMap,oi),Ar=new Jl;function Ql(){let s,t;const r=new Promise((n,i)=>{s=n,t=i});r.status="pending",r.catch(()=>{});function a(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{a({status:"fulfilled",value:n}),s(n)},r.reject=n=>{a({status:"rejected",reason:n}),t(n)},r}function Xl(s){return Math.min(1e3*2**s,3e4)}function ji(s){return(s??"online")==="online"?Ar.isOnline():!0}var wi=class extends Error{constructor(s){super("CancelledError"),this.revert=s==null?void 0:s.revert,this.silent=s==null?void 0:s.silent}};function Ni(s){let t=!1,r=0,a;const n=Ql(),i=()=>n.status!=="pending",l=x=>{var y;i()||(j(new wi(x)),(y=s.abort)==null||y.call(s))},o=()=>{t=!0},c=()=>{t=!1},d=()=>vi.isFocused()&&(s.networkMode==="always"||Ar.isOnline())&&s.canRun(),h=()=>ji(s.networkMode)&&s.canRun(),u=x=>{i()||(a==null||a(),n.resolve(x))},j=x=>{i()||(a==null||a(),n.reject(x))},p=()=>new Promise(x=>{var y;a=m=>{(i()||d())&&x(m)},(y=s.onPause)==null||y.call(s)}).then(()=>{var x;a=void 0,i()||(x=s.onContinue)==null||x.call(s)}),f=()=>{if(i())return;let x;const y=r===0?s.initialPromise:void 0;try{x=y??s.fn()}catch(m){x=Promise.reject(m)}Promise.resolve(x).then(u).catch(m=>{var A;if(i())return;const g=s.retry??(Ur?0:3),v=s.retryDelay??Xl,P=typeof v=="function"?v(r,m):v,E=g===!0||typeof g=="number"&&r<g||typeof g=="function"&&g(r,m);if(t||!E){j(m);return}r++,(A=s.onFail)==null||A.call(s,r,m),Hl(P).then(()=>d()?void 0:p()).then(()=>{t?j(m):f()})})};return{promise:n,status:()=>n.status,cancel:l,continue:()=>(a==null||a(),n),cancelRetry:o,continueRetry:c,canStart:h,start:()=>(h()?f():p().then(f),n)}}var Yl=s=>setTimeout(s,0);function eo(){let s=[],t=0,r=o=>{o()},a=o=>{o()},n=Yl;const i=o=>{t?s.push(o):n(()=>{r(o)})},l=()=>{const o=s;s=[],o.length&&n(()=>{a(()=>{o.forEach(c=>{r(c)})})})};return{batch:o=>{let c;t++;try{c=o()}finally{t--,t||l()}return c},batchCalls:o=>(...c)=>{i(()=>{o(...c)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{a=o},setScheduler:o=>{n=o}}}var at=eo(),ms,ci,ki=(ci=class{constructor(){Te(this,ms)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Ul(this.gcTime)&&je(this,ms,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(s){this.gcTime=Math.max(this.gcTime||0,s??(Ur?1/0:5*60*1e3))}clearGcTimeout(){F(this,ms)&&(clearTimeout(F(this,ms)),je(this,ms,void 0))}},ms=new WeakMap,ci),Ts,Ms,xt,xs,qe,ir,gs,ft,Rt,di,to=(di=class extends ki{constructor(t){super();Te(this,ft);Te(this,Ts);Te(this,Ms);Te(this,xt);Te(this,xs);Te(this,qe);Te(this,ir);Te(this,gs);je(this,gs,!1),je(this,ir,t.defaultOptions),this.setOptions(t.options),this.observers=[],je(this,xs,t.client),je(this,xt,F(this,xs).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,je(this,Ts,ro(this.options)),this.state=t.state??F(this,Ts),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=F(this,qe))==null?void 0:t.promise}setOptions(t){this.options={...F(this,ir),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&F(this,xt).remove(this)}setData(t,r){const a=ql(this.state.data,t,this.options);return Xe(this,ft,Rt).call(this,{data:a,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),a}setState(t,r){Xe(this,ft,Rt).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var a,n;const r=(a=F(this,qe))==null?void 0:a.promise;return(n=F(this,qe))==null||n.cancel(t),r?r.then(pt).catch(pt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(F(this,Ts))}isActive(){return this.observers.some(t=>Vl(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===za||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ga(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Wl(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(a=>a.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=F(this,qe))==null||r.continue()}onOnline(){var r;const t=this.observers.find(a=>a.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=F(this,qe))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),F(this,xt).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(F(this,qe)&&(F(this,gs)?F(this,qe).cancel({revert:!0}):F(this,qe).cancelRetry()),this.scheduleGc()),F(this,xt).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Xe(this,ft,Rt).call(this,{type:"invalidate"})}async fetch(t,r){var c,d,h,u,j,p,f,x,y,m,g,v;if(this.state.fetchStatus!=="idle"&&((c=F(this,qe))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(F(this,qe))return F(this,qe).continueRetry(),F(this,qe).promise}if(t&&this.setOptions(t),!this.options.queryFn){const P=this.observers.find(E=>E.options.queryFn);P&&this.setOptions(P.options)}const a=new AbortController,n=P=>{Object.defineProperty(P,"signal",{enumerable:!0,get:()=>(je(this,gs,!0),a.signal)})},i=()=>{const P=bi(this.options,r),A=(()=>{const T={client:F(this,xs),queryKey:this.queryKey,meta:this.meta};return n(T),T})();return je(this,gs,!1),this.options.persister?this.options.persister(P,A,this):P(A)},o=(()=>{const P={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:F(this,xs),state:this.state,fetchFn:i};return n(P),P})();(d=this.options.behavior)==null||d.onFetch(o,this),je(this,Ms,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=o.fetchOptions)==null?void 0:h.meta))&&Xe(this,ft,Rt).call(this,{type:"fetch",meta:(u=o.fetchOptions)==null?void 0:u.meta}),je(this,qe,Ni({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,abort:a.abort.bind(a),onFail:(P,E)=>{Xe(this,ft,Rt).call(this,{type:"failed",failureCount:P,error:E})},onPause:()=>{Xe(this,ft,Rt).call(this,{type:"pause"})},onContinue:()=>{Xe(this,ft,Rt).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const P=await F(this,qe).start();if(P===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(P),(p=(j=F(this,xt).config).onSuccess)==null||p.call(j,P,this),(x=(f=F(this,xt).config).onSettled)==null||x.call(f,P,this.state.error,this),P}catch(P){if(P instanceof wi){if(P.silent)return F(this,qe).promise;if(P.revert){if(this.setState({...F(this,Ms),fetchStatus:"idle"}),this.state.data===void 0)throw P;return this.state.data}}throw Xe(this,ft,Rt).call(this,{type:"error",error:P}),(m=(y=F(this,xt).config).onError)==null||m.call(y,P,this),(v=(g=F(this,xt).config).onSettled)==null||v.call(g,this.state.data,P,this),P}finally{this.scheduleGc()}}},Ts=new WeakMap,Ms=new WeakMap,xt=new WeakMap,xs=new WeakMap,qe=new WeakMap,ir=new WeakMap,gs=new WeakMap,ft=new WeakSet,Rt=function(t){const r=a=>{switch(t.type){case"failed":return{...a,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...so(a.data,this.options),fetchMeta:t.meta??null};case"success":const n={...a,data:t.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return je(this,Ms,t.manual?n:void 0),n;case"error":const i=t.error;return{...a,error:i,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...t.state}}};this.state=r(this.state),at.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),F(this,xt).notify({query:this,type:"updated",action:t})})},di);function so(s,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ji(t.networkMode)?"fetching":"paused",...s===void 0&&{error:null,status:"pending"}}}function ro(s){const t=typeof s.initialData=="function"?s.initialData():s.initialData,r=t!==void 0,a=r?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var _t,ui,ao=(ui=class extends zr{constructor(t={}){super();Te(this,_t);this.config=t,je(this,_t,new Map)}build(t,r,a){const n=r.queryKey,i=r.queryHash??Fa(n,r);let l=this.get(i);return l||(l=new to({client:t,queryKey:n,queryHash:i,options:t.defaultQueryOptions(r),state:a,defaultOptions:t.getQueryDefaults(n)}),this.add(l)),l}add(t){F(this,_t).has(t.queryHash)||(F(this,_t).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=F(this,_t).get(t.queryHash);r&&(t.destroy(),r===t&&F(this,_t).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){at.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return F(this,_t).get(t)}getAll(){return[...F(this,_t).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(a=>rn(r,a))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(a=>rn(t,a)):r}notify(t){at.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){at.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){at.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},_t=new WeakMap,ui),Ct,st,ps,At,Ht,hi,no=(hi=class extends ki{constructor(t){super();Te(this,At);Te(this,Ct);Te(this,st);Te(this,ps);this.mutationId=t.mutationId,je(this,st,t.mutationCache),je(this,Ct,[]),this.state=t.state||io(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){F(this,Ct).includes(t)||(F(this,Ct).push(t),this.clearGcTimeout(),F(this,st).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){je(this,Ct,F(this,Ct).filter(r=>r!==t)),this.scheduleGc(),F(this,st).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){F(this,Ct).length||(this.state.status==="pending"?this.scheduleGc():F(this,st).remove(this))}continue(){var t;return((t=F(this,ps))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,l,o,c,d,h,u,j,p,f,x,y,m,g,v,P,E,A,T,k;const r=()=>{Xe(this,At,Ht).call(this,{type:"continue"})};je(this,ps,Ni({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(R,se)=>{Xe(this,At,Ht).call(this,{type:"failed",failureCount:R,error:se})},onPause:()=>{Xe(this,At,Ht).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>F(this,st).canRun(this)}));const a=this.state.status==="pending",n=!F(this,ps).canStart();try{if(a)r();else{Xe(this,At,Ht).call(this,{type:"pending",variables:t,isPaused:n}),await((l=(i=F(this,st).config).onMutate)==null?void 0:l.call(i,t,this));const se=await((c=(o=this.options).onMutate)==null?void 0:c.call(o,t));se!==this.state.context&&Xe(this,At,Ht).call(this,{type:"pending",context:se,variables:t,isPaused:n})}const R=await F(this,ps).start();return await((h=(d=F(this,st).config).onSuccess)==null?void 0:h.call(d,R,t,this.state.context,this)),await((j=(u=this.options).onSuccess)==null?void 0:j.call(u,R,t,this.state.context)),await((f=(p=F(this,st).config).onSettled)==null?void 0:f.call(p,R,null,this.state.variables,this.state.context,this)),await((y=(x=this.options).onSettled)==null?void 0:y.call(x,R,null,t,this.state.context)),Xe(this,At,Ht).call(this,{type:"success",data:R}),R}catch(R){try{throw await((g=(m=F(this,st).config).onError)==null?void 0:g.call(m,R,t,this.state.context,this)),await((P=(v=this.options).onError)==null?void 0:P.call(v,R,t,this.state.context)),await((A=(E=F(this,st).config).onSettled)==null?void 0:A.call(E,void 0,R,this.state.variables,this.state.context,this)),await((k=(T=this.options).onSettled)==null?void 0:k.call(T,void 0,R,t,this.state.context)),R}finally{Xe(this,At,Ht).call(this,{type:"error",error:R})}}finally{F(this,st).runNext(this)}}},Ct=new WeakMap,st=new WeakMap,ps=new WeakMap,At=new WeakSet,Ht=function(t){const r=a=>{switch(t.type){case"failed":return{...a,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...a,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:t.error,failureCount:a.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),at.batch(()=>{F(this,Ct).forEach(a=>{a.onMutationUpdate(t)}),F(this,st).notify({mutation:this,type:"updated",action:t})})},hi);function io(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Bt,yt,lr,mi,lo=(mi=class extends zr{constructor(t={}){super();Te(this,Bt);Te(this,yt);Te(this,lr);this.config=t,je(this,Bt,new Set),je(this,yt,new Map),je(this,lr,0)}build(t,r,a){const n=new no({mutationCache:this,mutationId:++xr(this,lr)._,options:t.defaultMutationOptions(r),state:a});return this.add(n),n}add(t){F(this,Bt).add(t);const r=gr(t);if(typeof r=="string"){const a=F(this,yt).get(r);a?a.push(t):F(this,yt).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(F(this,Bt).delete(t)){const r=gr(t);if(typeof r=="string"){const a=F(this,yt).get(r);if(a)if(a.length>1){const n=a.indexOf(t);n!==-1&&a.splice(n,1)}else a[0]===t&&F(this,yt).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=gr(t);if(typeof r=="string"){const a=F(this,yt).get(r),n=a==null?void 0:a.find(i=>i.state.status==="pending");return!n||n===t}else return!0}runNext(t){var a;const r=gr(t);if(typeof r=="string"){const n=(a=F(this,yt).get(r))==null?void 0:a.find(i=>i!==t&&i.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){at.batch(()=>{F(this,Bt).forEach(t=>{this.notify({type:"removed",mutation:t})}),F(this,Bt).clear(),F(this,yt).clear()})}getAll(){return Array.from(F(this,Bt))}find(t){const r={exact:!0,...t};return this.getAll().find(a=>an(r,a))}findAll(t={}){return this.getAll().filter(r=>an(t,r))}notify(t){at.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return at.batch(()=>Promise.all(t.map(r=>r.continue().catch(pt))))}},Bt=new WeakMap,yt=new WeakMap,lr=new WeakMap,mi);function gr(s){var t;return(t=s.options.scope)==null?void 0:t.id}function on(s){return{onFetch:(t,r)=>{var h,u,j,p,f;const a=t.options,n=(j=(u=(h=t.fetchOptions)==null?void 0:h.meta)==null?void 0:u.fetchMore)==null?void 0:j.direction,i=((p=t.state.data)==null?void 0:p.pages)||[],l=((f=t.state.data)==null?void 0:f.pageParams)||[];let o={pages:[],pageParams:[]},c=0;const d=async()=>{let x=!1;const y=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(t.signal.aborted?x=!0:t.signal.addEventListener("abort",()=>{x=!0}),t.signal)})},m=bi(t.options,t.fetchOptions),g=async(v,P,E)=>{if(x)return Promise.reject();if(P==null&&v.pages.length)return Promise.resolve(v);const T=(()=>{const z={client:t.client,queryKey:t.queryKey,pageParam:P,direction:E?"backward":"forward",meta:t.options.meta};return y(z),z})(),k=await m(T),{maxPages:R}=t.options,se=E?Zl:Kl;return{pages:se(v.pages,k,R),pageParams:se(v.pageParams,P,R)}};if(n&&i.length){const v=n==="backward",P=v?oo:cn,E={pages:i,pageParams:l},A=P(a,E);o=await g(E,A,v)}else{const v=s??i.length;do{const P=c===0?l[0]??a.initialPageParam:cn(a,o);if(c>0&&P==null)break;o=await g(o,P),c++}while(c<v)}return o};t.options.persister?t.fetchFn=()=>{var x,y;return(y=(x=t.options).persister)==null?void 0:y.call(x,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=d}}}function cn(s,{pages:t,pageParams:r}){const a=t.length-1;return t.length>0?s.getNextPageParam(t[a],t,r[a],r):void 0}function oo(s,{pages:t,pageParams:r}){var a;return t.length>0?(a=s.getPreviousPageParam)==null?void 0:a.call(s,t[0],t,r[0],r):void 0}var Ie,Qt,Xt,Es,Ps,Yt,$s,Is,xi,co=(xi=class{constructor(s={}){Te(this,Ie);Te(this,Qt);Te(this,Xt);Te(this,Es);Te(this,Ps);Te(this,Yt);Te(this,$s);Te(this,Is);je(this,Ie,s.queryCache||new ao),je(this,Qt,s.mutationCache||new lo),je(this,Xt,s.defaultOptions||{}),je(this,Es,new Map),je(this,Ps,new Map),je(this,Yt,0)}mount(){xr(this,Yt)._++,F(this,Yt)===1&&(je(this,$s,vi.subscribe(async s=>{s&&(await this.resumePausedMutations(),F(this,Ie).onFocus())})),je(this,Is,Ar.subscribe(async s=>{s&&(await this.resumePausedMutations(),F(this,Ie).onOnline())})))}unmount(){var s,t;xr(this,Yt)._--,F(this,Yt)===0&&((s=F(this,$s))==null||s.call(this),je(this,$s,void 0),(t=F(this,Is))==null||t.call(this),je(this,Is,void 0))}isFetching(s){return F(this,Ie).findAll({...s,fetchStatus:"fetching"}).length}isMutating(s){return F(this,Qt).findAll({...s,status:"pending"}).length}getQueryData(s){var r;const t=this.defaultQueryOptions({queryKey:s});return(r=F(this,Ie).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(s){const t=this.defaultQueryOptions(s),r=F(this,Ie).build(this,t),a=r.state.data;return a===void 0?this.fetchQuery(s):(s.revalidateIfStale&&r.isStaleByTime(ga(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(s){return F(this,Ie).findAll(s).map(({queryKey:t,state:r})=>{const a=r.data;return[t,a]})}setQueryData(s,t,r){const a=this.defaultQueryOptions({queryKey:s}),n=F(this,Ie).get(a.queryHash),i=n==null?void 0:n.state.data,l=zl(t,i);if(l!==void 0)return F(this,Ie).build(this,a).setData(l,{...r,manual:!0})}setQueriesData(s,t,r){return at.batch(()=>F(this,Ie).findAll(s).map(({queryKey:a})=>[a,this.setQueryData(a,t,r)]))}getQueryState(s){var r;const t=this.defaultQueryOptions({queryKey:s});return(r=F(this,Ie).get(t.queryHash))==null?void 0:r.state}removeQueries(s){const t=F(this,Ie);at.batch(()=>{t.findAll(s).forEach(r=>{t.remove(r)})})}resetQueries(s,t){const r=F(this,Ie);return at.batch(()=>(r.findAll(s).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...s},t)))}cancelQueries(s,t={}){const r={revert:!0,...t},a=at.batch(()=>F(this,Ie).findAll(s).map(n=>n.cancel(r)));return Promise.all(a).then(pt).catch(pt)}invalidateQueries(s,t={}){return at.batch(()=>(F(this,Ie).findAll(s).forEach(r=>{r.invalidate()}),(s==null?void 0:s.refetchType)==="none"?Promise.resolve():this.refetchQueries({...s,type:(s==null?void 0:s.refetchType)??(s==null?void 0:s.type)??"active"},t)))}refetchQueries(s,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},a=at.batch(()=>F(this,Ie).findAll(s).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let i=n.fetch(void 0,r);return r.throwOnError||(i=i.catch(pt)),n.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(a).then(pt)}fetchQuery(s){const t=this.defaultQueryOptions(s);t.retry===void 0&&(t.retry=!1);const r=F(this,Ie).build(this,t);return r.isStaleByTime(ga(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(s){return this.fetchQuery(s).then(pt).catch(pt)}fetchInfiniteQuery(s){return s.behavior=on(s.pages),this.fetchQuery(s)}prefetchInfiniteQuery(s){return this.fetchInfiniteQuery(s).then(pt).catch(pt)}ensureInfiniteQueryData(s){return s.behavior=on(s.pages),this.ensureQueryData(s)}resumePausedMutations(){return Ar.isOnline()?F(this,Qt).resumePausedMutations():Promise.resolve()}getQueryCache(){return F(this,Ie)}getMutationCache(){return F(this,Qt)}getDefaultOptions(){return F(this,Xt)}setDefaultOptions(s){je(this,Xt,s)}setQueryDefaults(s,t){F(this,Es).set(Xs(s),{queryKey:s,defaultOptions:t})}getQueryDefaults(s){const t=[...F(this,Es).values()],r={};return t.forEach(a=>{Ys(s,a.queryKey)&&Object.assign(r,a.defaultOptions)}),r}setMutationDefaults(s,t){F(this,Ps).set(Xs(s),{mutationKey:s,defaultOptions:t})}getMutationDefaults(s){const t=[...F(this,Ps).values()],r={};return t.forEach(a=>{Ys(s,a.mutationKey)&&Object.assign(r,a.defaultOptions)}),r}defaultQueryOptions(s){if(s._defaulted)return s;const t={...F(this,Xt).queries,...this.getQueryDefaults(s.queryKey),...s,_defaulted:!0};return t.queryHash||(t.queryHash=Fa(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===za&&(t.enabled=!1),t}defaultMutationOptions(s){return s!=null&&s._defaulted?s:{...F(this,Xt).mutations,...(s==null?void 0:s.mutationKey)&&this.getMutationDefaults(s.mutationKey),...s,_defaulted:!0}}clear(){F(this,Ie).clear(),F(this,Qt).clear()}},Ie=new WeakMap,Qt=new WeakMap,Xt=new WeakMap,Es=new WeakMap,Ps=new WeakMap,Yt=new WeakMap,$s=new WeakMap,Is=new WeakMap,xi),uo=b.createContext(void 0),ho=({client:s,children:t})=>(b.useEffect(()=>(s.mount(),()=>{s.unmount()}),[s]),e.jsx(uo.Provider,{value:s,children:t}));let mo={data:""},xo=s=>typeof window=="object"?((s?s.querySelector("#_goober"):window._goober)||Object.assign((s||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:s||mo,go=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,po=/\/\*[^]*?\*\/|  +/g,dn=/\n+/g,Kt=(s,t)=>{let r="",a="",n="";for(let i in s){let l=s[i];i[0]=="@"?i[1]=="i"?r=i+" "+l+";":a+=i[1]=="f"?Kt(l,i):i+"{"+Kt(l,i[1]=="k"?"":t)+"}":typeof l=="object"?a+=Kt(l,t?t.replace(/([^,])+/g,o=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,o):o?o+" "+c:c)):i):l!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=Kt.p?Kt.p(i,l):i+":"+l+";")}return r+(t&&n?t+"{"+n+"}":n)+a},It={},Si=s=>{if(typeof s=="object"){let t="";for(let r in s)t+=r+Si(s[r]);return t}return s},fo=(s,t,r,a,n)=>{let i=Si(s),l=It[i]||(It[i]=(c=>{let d=0,h=11;for(;d<c.length;)h=101*h+c.charCodeAt(d++)>>>0;return"go"+h})(i));if(!It[l]){let c=i!==s?s:(d=>{let h,u,j=[{}];for(;h=go.exec(d.replace(po,""));)h[4]?j.shift():h[3]?(u=h[3].replace(dn," ").trim(),j.unshift(j[0][u]=j[0][u]||{})):j[0][h[1]]=h[2].replace(dn," ").trim();return j[0]})(s);It[l]=Kt(n?{["@keyframes "+l]:c}:c,r?"":"."+l)}let o=r&&It.g?It.g:null;return r&&(It.g=It[l]),((c,d,h,u)=>{u?d.data=d.data.replace(u,c):d.data.indexOf(c)===-1&&(d.data=h?c+d.data:d.data+c)})(It[l],t,a,o),l},yo=(s,t,r)=>s.reduce((a,n,i)=>{let l=t[i];if(l&&l.call){let o=l(r),c=o&&o.props&&o.props.className||/^go/.test(o)&&o;l=c?"."+c:o&&typeof o=="object"?o.props?"":Kt(o,""):o===!1?"":o}return a+n+(l??"")},"");function Wr(s){let t=this||{},r=s.call?s(t.p):s;return fo(r.unshift?r.raw?yo(r,[].slice.call(arguments,1),t.p):r.reduce((a,n)=>Object.assign(a,n&&n.call?n(t.p):n),{}):r,xo(t.target),t.g,t.o,t.k)}let _i,fa,ya;Wr.bind({g:1});let Ot=Wr.bind({k:1});function bo(s,t,r,a){Kt.p=t,_i=s,fa=r,ya=a}function as(s,t){let r=this||{};return function(){let a=arguments;function n(i,l){let o=Object.assign({},i),c=o.className||n.className;r.p=Object.assign({theme:fa&&fa()},o),r.o=/ *go\d+/.test(c),o.className=Wr.apply(r,a)+(c?" "+c:"");let d=s;return s[0]&&(d=o.as||s,delete o.as),ya&&d[0]&&ya(o),_i(d,o)}return n}}var vo=s=>typeof s=="function",Lr=(s,t)=>vo(s)?s(t):s,jo=(()=>{let s=0;return()=>(++s).toString()})(),Ci=(()=>{let s;return()=>{if(s===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");s=!t||t.matches}return s}})(),wo=20,Ua="default",Ai=(s,t)=>{let{toastLimit:r}=s.settings;switch(t.type){case 0:return{...s,toasts:[t.toast,...s.toasts].slice(0,r)};case 1:return{...s,toasts:s.toasts.map(l=>l.id===t.toast.id?{...l,...t.toast}:l)};case 2:let{toast:a}=t;return Ai(s,{type:s.toasts.find(l=>l.id===a.id)?1:0,toast:a});case 3:let{toastId:n}=t;return{...s,toasts:s.toasts.map(l=>l.id===n||n===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(l=>l.id!==t.toastId)};case 5:return{...s,pausedAt:t.time};case 6:let i=t.time-(s.pausedAt||0);return{...s,pausedAt:void 0,toasts:s.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+i}))}}},jr=[],Li={toasts:[],pausedAt:void 0,settings:{toastLimit:wo}},Tt={},Ti=(s,t=Ua)=>{Tt[t]=Ai(Tt[t]||Li,s),jr.forEach(([r,a])=>{r===t&&a(Tt[t])})},Mi=s=>Object.keys(Tt).forEach(t=>Ti(s,t)),No=s=>Object.keys(Tt).find(t=>Tt[t].toasts.some(r=>r.id===s)),Vr=(s=Ua)=>t=>{Ti(t,s)},ko={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},So=(s={},t=Ua)=>{let[r,a]=b.useState(Tt[t]||Li),n=b.useRef(Tt[t]);b.useEffect(()=>(n.current!==Tt[t]&&a(Tt[t]),jr.push([t,a]),()=>{let l=jr.findIndex(([o])=>o===t);l>-1&&jr.splice(l,1)}),[t]);let i=r.toasts.map(l=>{var o,c,d;return{...s,...s[l.type],...l,removeDelay:l.removeDelay||((o=s[l.type])==null?void 0:o.removeDelay)||(s==null?void 0:s.removeDelay),duration:l.duration||((c=s[l.type])==null?void 0:c.duration)||(s==null?void 0:s.duration)||ko[l.type],style:{...s.style,...(d=s[l.type])==null?void 0:d.style,...l.style}}});return{...r,toasts:i}},_o=(s,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:s,pauseDuration:0,...r,id:(r==null?void 0:r.id)||jo()}),or=s=>(t,r)=>{let a=_o(t,s,r);return Vr(a.toasterId||No(a.id))({type:2,toast:a}),a.id},We=(s,t)=>or("blank")(s,t);We.error=or("error");We.success=or("success");We.loading=or("loading");We.custom=or("custom");We.dismiss=(s,t)=>{let r={type:3,toastId:s};t?Vr(t)(r):Mi(r)};We.dismissAll=s=>We.dismiss(void 0,s);We.remove=(s,t)=>{let r={type:4,toastId:s};t?Vr(t)(r):Mi(r)};We.removeAll=s=>We.remove(void 0,s);We.promise=(s,t,r)=>{let a=We.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof s=="function"&&(s=s()),s.then(n=>{let i=t.success?Lr(t.success,n):void 0;return i?We.success(i,{id:a,...r,...r==null?void 0:r.success}):We.dismiss(a),n}).catch(n=>{let i=t.error?Lr(t.error,n):void 0;i?We.error(i,{id:a,...r,...r==null?void 0:r.error}):We.dismiss(a)}),s};var Co=1e3,Ao=(s,t="default")=>{let{toasts:r,pausedAt:a}=So(s,t),n=b.useRef(new Map).current,i=b.useCallback((u,j=Co)=>{if(n.has(u))return;let p=setTimeout(()=>{n.delete(u),l({type:4,toastId:u})},j);n.set(u,p)},[]);b.useEffect(()=>{if(a)return;let u=Date.now(),j=r.map(p=>{if(p.duration===1/0)return;let f=(p.duration||0)+p.pauseDuration-(u-p.createdAt);if(f<0){p.visible&&We.dismiss(p.id);return}return setTimeout(()=>We.dismiss(p.id,t),f)});return()=>{j.forEach(p=>p&&clearTimeout(p))}},[r,a,t]);let l=b.useCallback(Vr(t),[t]),o=b.useCallback(()=>{l({type:5,time:Date.now()})},[l]),c=b.useCallback((u,j)=>{l({type:1,toast:{id:u,height:j}})},[l]),d=b.useCallback(()=>{a&&l({type:6,time:Date.now()})},[a,l]),h=b.useCallback((u,j)=>{let{reverseOrder:p=!1,gutter:f=8,defaultPosition:x}=j||{},y=r.filter(v=>(v.position||x)===(u.position||x)&&v.height),m=y.findIndex(v=>v.id===u.id),g=y.filter((v,P)=>P<m&&v.visible).length;return y.filter(v=>v.visible).slice(...p?[g+1]:[0,g]).reduce((v,P)=>v+(P.height||0)+f,0)},[r]);return b.useEffect(()=>{r.forEach(u=>{if(u.dismissed)i(u.id,u.removeDelay);else{let j=n.get(u.id);j&&(clearTimeout(j),n.delete(u.id))}})},[r,i]),{toasts:r,handlers:{updateHeight:c,startPause:o,endPause:d,calculateOffset:h}}},Lo=Ot`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,To=Ot`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Mo=Ot`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Eo=as("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Lo} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${To} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${s=>s.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Mo} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Po=Ot`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,$o=as("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${s=>s.secondary||"#e0e0e0"};
  border-right-color: ${s=>s.primary||"#616161"};
  animation: ${Po} 1s linear infinite;
`,Io=Ot`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Do=Ot`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Ro=as("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Io} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Do} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${s=>s.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Bo=as("div")`
  position: absolute;
`,Oo=as("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Fo=Ot`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,zo=as("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Fo} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Uo=({toast:s})=>{let{icon:t,type:r,iconTheme:a}=s;return t!==void 0?typeof t=="string"?b.createElement(zo,null,t):t:r==="blank"?null:b.createElement(Oo,null,b.createElement($o,{...a}),r!=="loading"&&b.createElement(Bo,null,r==="error"?b.createElement(Eo,{...a}):b.createElement(Ro,{...a})))},Wo=s=>`
0% {transform: translate3d(0,${s*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Vo=s=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${s*-150}%,-1px) scale(.6); opacity:0;}
`,Ho="0%{opacity:0;} 100%{opacity:1;}",qo="0%{opacity:1;} 100%{opacity:0;}",Ko=as("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Zo=as("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Go=(s,t)=>{let r=s.includes("top")?1:-1,[a,n]=Ci()?[Ho,qo]:[Wo(r),Vo(r)];return{animation:t?`${Ot(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ot(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Jo=b.memo(({toast:s,position:t,style:r,children:a})=>{let n=s.height?Go(s.position||t||"top-center",s.visible):{opacity:0},i=b.createElement(Uo,{toast:s}),l=b.createElement(Zo,{...s.ariaProps},Lr(s.message,s));return b.createElement(Ko,{className:s.className,style:{...n,...r,...s.style}},typeof a=="function"?a({icon:i,message:l}):b.createElement(b.Fragment,null,i,l))});bo(b.createElement);var Qo=({id:s,className:t,style:r,onHeightUpdate:a,children:n})=>{let i=b.useCallback(l=>{if(l){let o=()=>{let c=l.getBoundingClientRect().height;a(s,c)};o(),new MutationObserver(o).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[s,a]);return b.createElement("div",{ref:i,className:t,style:r},n)},Xo=(s,t)=>{let r=s.includes("top"),a=r?{top:0}:{bottom:0},n=s.includes("center")?{justifyContent:"center"}:s.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Ci()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...a,...n}},Yo=Wr`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,pr=16,ec=({reverseOrder:s,position:t="top-center",toastOptions:r,gutter:a,children:n,toasterId:i,containerStyle:l,containerClassName:o})=>{let{toasts:c,handlers:d}=Ao(r,i);return b.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:pr,left:pr,right:pr,bottom:pr,pointerEvents:"none",...l},className:o,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(h=>{let u=h.position||t,j=d.calculateOffset(h,{reverseOrder:s,gutter:a,defaultPosition:t}),p=Xo(u,j);return b.createElement(Qo,{id:h.id,key:h.id,onHeightUpdate:d.updateHeight,className:h.visible?Yo:"",style:p},h.type==="custom"?Lr(h.message,h):n?n(h):b.createElement(Jo,{toast:h,position:u}))}))},O=We;const tc={},un=s=>{let t;const r=new Set,a=(h,u)=>{const j=typeof h=="function"?h(t):h;if(!Object.is(j,t)){const p=t;t=u??(typeof j!="object"||j===null)?j:Object.assign({},t,j),r.forEach(f=>f(t,p))}},n=()=>t,c={setState:a,getState:n,getInitialState:()=>d,subscribe:h=>(r.add(h),()=>r.delete(h)),destroy:()=>{(tc?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=t=s(a,n,c);return c},sc=s=>s?un(s):un;var Ei={exports:{}},Pi={},$i={exports:{}},Ii={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ds=b;function rc(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var ac=typeof Object.is=="function"?Object.is:rc,nc=Ds.useState,ic=Ds.useEffect,lc=Ds.useLayoutEffect,oc=Ds.useDebugValue;function cc(s,t){var r=t(),a=nc({inst:{value:r,getSnapshot:t}}),n=a[0].inst,i=a[1];return lc(function(){n.value=r,n.getSnapshot=t,ra(n)&&i({inst:n})},[s,r,t]),ic(function(){return ra(n)&&i({inst:n}),s(function(){ra(n)&&i({inst:n})})},[s]),oc(r),r}function ra(s){var t=s.getSnapshot;s=s.value;try{var r=t();return!ac(s,r)}catch{return!0}}function dc(s,t){return t()}var uc=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?dc:cc;Ii.useSyncExternalStore=Ds.useSyncExternalStore!==void 0?Ds.useSyncExternalStore:uc;$i.exports=Ii;var hc=$i.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hr=b,mc=hc;function xc(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var gc=typeof Object.is=="function"?Object.is:xc,pc=mc.useSyncExternalStore,fc=Hr.useRef,yc=Hr.useEffect,bc=Hr.useMemo,vc=Hr.useDebugValue;Pi.useSyncExternalStoreWithSelector=function(s,t,r,a,n){var i=fc(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=bc(function(){function c(p){if(!d){if(d=!0,h=p,p=a(p),n!==void 0&&l.hasValue){var f=l.value;if(n(f,p))return u=f}return u=p}if(f=u,gc(h,p))return f;var x=a(p);return n!==void 0&&n(f,x)?(h=p,f):(h=p,u=x)}var d=!1,h,u,j=r===void 0?null:r;return[function(){return c(t())},j===null?void 0:function(){return c(j())}]},[t,r,a,n]);var o=pc(s,i[0],i[1]);return yc(function(){l.hasValue=!0,l.value=o},[o]),vc(o),o};Ei.exports=Pi;var jc=Ei.exports;const wc=Tl(jc),Di={},{useDebugValue:Nc}=Ke,{useSyncExternalStoreWithSelector:kc}=wc;let hn=!1;const Sc=s=>s;function _c(s,t=Sc,r){(Di?"production":void 0)!=="production"&&r&&!hn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),hn=!0);const a=kc(s.subscribe,s.getState,s.getServerState||s.getInitialState,t,r);return Nc(a),a}const mn=s=>{(Di?"production":void 0)!=="production"&&typeof s!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof s=="function"?sc(s):s,r=(a,n)=>_c(t,a,n);return Object.assign(r,t),r},Ut=s=>s?mn(s):mn,Cc={};function Ac(s,t){let r;try{r=s()}catch{return}return{getItem:n=>{var i;const l=c=>c===null?null:JSON.parse(c,void 0),o=(i=r.getItem(n))!=null?i:null;return o instanceof Promise?o.then(l):l(o)},setItem:(n,i)=>r.setItem(n,JSON.stringify(i,void 0)),removeItem:n=>r.removeItem(n)}}const er=s=>t=>{try{const r=s(t);return r instanceof Promise?r:{then(a){return er(a)(r)},catch(a){return this}}}catch(r){return{then(a){return this},catch(a){return er(a)(r)}}}},Lc=(s,t)=>(r,a,n)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:y=>y,version:0,merge:(y,m)=>({...m,...y}),...t},l=!1;const o=new Set,c=new Set;let d;try{d=i.getStorage()}catch{}if(!d)return s((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...y)},a,n);const h=er(i.serialize),u=()=>{const y=i.partialize({...a()});let m;const g=h({state:y,version:i.version}).then(v=>d.setItem(i.name,v)).catch(v=>{m=v});if(m)throw m;return g},j=n.setState;n.setState=(y,m)=>{j(y,m),u()};const p=s((...y)=>{r(...y),u()},a,n);let f;const x=()=>{var y;if(!d)return;l=!1,o.forEach(g=>g(a()));const m=((y=i.onRehydrateStorage)==null?void 0:y.call(i,a()))||void 0;return er(d.getItem.bind(d))(i.name).then(g=>{if(g)return i.deserialize(g)}).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==i.version){if(i.migrate)return i.migrate(g.state,g.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return g.state}).then(g=>{var v;return f=i.merge(g,(v=a())!=null?v:p),r(f,!0),u()}).then(()=>{m==null||m(f,void 0),l=!0,c.forEach(g=>g(f))}).catch(g=>{m==null||m(void 0,g)})};return n.persist={setOptions:y=>{i={...i,...y},y.getStorage&&(d=y.getStorage())},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>l,onHydrate:y=>(o.add(y),()=>{o.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},x(),f||p},Tc=(s,t)=>(r,a,n)=>{let i={storage:Ac(()=>localStorage),partialize:x=>x,version:0,merge:(x,y)=>({...y,...x}),...t},l=!1;const o=new Set,c=new Set;let d=i.storage;if(!d)return s((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...x)},a,n);const h=()=>{const x=i.partialize({...a()});return d.setItem(i.name,{state:x,version:i.version})},u=n.setState;n.setState=(x,y)=>{u(x,y),h()};const j=s((...x)=>{r(...x),h()},a,n);n.getInitialState=()=>j;let p;const f=()=>{var x,y;if(!d)return;l=!1,o.forEach(g=>{var v;return g((v=a())!=null?v:j)});const m=((y=i.onRehydrateStorage)==null?void 0:y.call(i,(x=a())!=null?x:j))||void 0;return er(d.getItem.bind(d))(i.name).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==i.version){if(i.migrate)return[!0,i.migrate(g.state,g.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,g.state];return[!1,void 0]}).then(g=>{var v;const[P,E]=g;if(p=i.merge(E,(v=a())!=null?v:j),r(p,!0),P)return h()}).then(()=>{m==null||m(p,void 0),p=a(),l=!0,c.forEach(g=>g(p))}).catch(g=>{m==null||m(void 0,g)})};return n.persist={setOptions:x=>{i={...i,...x},x.storage&&(d=x.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>f(),hasHydrated:()=>l,onHydrate:x=>(o.add(x),()=>{o.delete(x)}),onFinishHydration:x=>(c.add(x),()=>{c.delete(x)})},i.skipHydration||f(),p||j},Mc=(s,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((Cc?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Lc(s,t)):Tc(s,t),js=Mc;function Ri(s,t){return function(){return s.apply(t,arguments)}}const{toString:Ec}=Object.prototype,{getPrototypeOf:Wa}=Object,{iterator:qr,toStringTag:Bi}=Symbol,Kr=(s=>t=>{const r=Ec.call(t);return s[r]||(s[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),jt=s=>(s=s.toLowerCase(),t=>Kr(t)===s),Zr=s=>t=>typeof t===s,{isArray:zs}=Array,tr=Zr("undefined");function cr(s){return s!==null&&!tr(s)&&s.constructor!==null&&!tr(s.constructor)&&it(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const Oi=jt("ArrayBuffer");function Pc(s){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(s):t=s&&s.buffer&&Oi(s.buffer),t}const $c=Zr("string"),it=Zr("function"),Fi=Zr("number"),dr=s=>s!==null&&typeof s=="object",Ic=s=>s===!0||s===!1,wr=s=>{if(Kr(s)!=="object")return!1;const t=Wa(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Bi in s)&&!(qr in s)},Dc=s=>{if(!dr(s)||cr(s))return!1;try{return Object.keys(s).length===0&&Object.getPrototypeOf(s)===Object.prototype}catch{return!1}},Rc=jt("Date"),Bc=jt("File"),Oc=jt("Blob"),Fc=jt("FileList"),zc=s=>dr(s)&&it(s.pipe),Uc=s=>{let t;return s&&(typeof FormData=="function"&&s instanceof FormData||it(s.append)&&((t=Kr(s))==="formdata"||t==="object"&&it(s.toString)&&s.toString()==="[object FormData]"))},Wc=jt("URLSearchParams"),[Vc,Hc,qc,Kc]=["ReadableStream","Request","Response","Headers"].map(jt),Zc=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ur(s,t,{allOwnKeys:r=!1}={}){if(s===null||typeof s>"u")return;let a,n;if(typeof s!="object"&&(s=[s]),zs(s))for(a=0,n=s.length;a<n;a++)t.call(null,s[a],a,s);else{if(cr(s))return;const i=r?Object.getOwnPropertyNames(s):Object.keys(s),l=i.length;let o;for(a=0;a<l;a++)o=i[a],t.call(null,s[o],o,s)}}function zi(s,t){if(cr(s))return null;t=t.toLowerCase();const r=Object.keys(s);let a=r.length,n;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const ds=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ui=s=>!tr(s)&&s!==ds;function ba(){const{caseless:s}=Ui(this)&&this||{},t={},r=(a,n)=>{const i=s&&zi(t,n)||n;wr(t[i])&&wr(a)?t[i]=ba(t[i],a):wr(a)?t[i]=ba({},a):zs(a)?t[i]=a.slice():t[i]=a};for(let a=0,n=arguments.length;a<n;a++)arguments[a]&&ur(arguments[a],r);return t}const Gc=(s,t,r,{allOwnKeys:a}={})=>(ur(t,(n,i)=>{r&&it(n)?s[i]=Ri(n,r):s[i]=n},{allOwnKeys:a}),s),Jc=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),Qc=(s,t,r,a)=>{s.prototype=Object.create(t.prototype,a),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:t.prototype}),r&&Object.assign(s.prototype,r)},Xc=(s,t,r,a)=>{let n,i,l;const o={};if(t=t||{},s==null)return t;do{for(n=Object.getOwnPropertyNames(s),i=n.length;i-- >0;)l=n[i],(!a||a(l,s,t))&&!o[l]&&(t[l]=s[l],o[l]=!0);s=r!==!1&&Wa(s)}while(s&&(!r||r(s,t))&&s!==Object.prototype);return t},Yc=(s,t,r)=>{s=String(s),(r===void 0||r>s.length)&&(r=s.length),r-=t.length;const a=s.indexOf(t,r);return a!==-1&&a===r},ed=s=>{if(!s)return null;if(zs(s))return s;let t=s.length;if(!Fi(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=s[t];return r},td=(s=>t=>s&&t instanceof s)(typeof Uint8Array<"u"&&Wa(Uint8Array)),sd=(s,t)=>{const a=(s&&s[qr]).call(s);let n;for(;(n=a.next())&&!n.done;){const i=n.value;t.call(s,i[0],i[1])}},rd=(s,t)=>{let r;const a=[];for(;(r=s.exec(t))!==null;)a.push(r);return a},ad=jt("HTMLFormElement"),nd=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),xn=(({hasOwnProperty:s})=>(t,r)=>s.call(t,r))(Object.prototype),id=jt("RegExp"),Wi=(s,t)=>{const r=Object.getOwnPropertyDescriptors(s),a={};ur(r,(n,i)=>{let l;(l=t(n,i,s))!==!1&&(a[i]=l||n)}),Object.defineProperties(s,a)},ld=s=>{Wi(s,(t,r)=>{if(it(s)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=s[r];if(it(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},od=(s,t)=>{const r={},a=n=>{n.forEach(i=>{r[i]=!0})};return zs(s)?a(s):a(String(s).split(t)),r},cd=()=>{},dd=(s,t)=>s!=null&&Number.isFinite(s=+s)?s:t;function ud(s){return!!(s&&it(s.append)&&s[Bi]==="FormData"&&s[qr])}const hd=s=>{const t=new Array(10),r=(a,n)=>{if(dr(a)){if(t.indexOf(a)>=0)return;if(cr(a))return a;if(!("toJSON"in a)){t[n]=a;const i=zs(a)?[]:{};return ur(a,(l,o)=>{const c=r(l,n+1);!tr(c)&&(i[o]=c)}),t[n]=void 0,i}}return a};return r(s,0)},md=jt("AsyncFunction"),xd=s=>s&&(dr(s)||it(s))&&it(s.then)&&it(s.catch),Vi=((s,t)=>s?setImmediate:t?((r,a)=>(ds.addEventListener("message",({source:n,data:i})=>{n===ds&&i===r&&a.length&&a.shift()()},!1),n=>{a.push(n),ds.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",it(ds.postMessage)),gd=typeof queueMicrotask<"u"?queueMicrotask.bind(ds):typeof process<"u"&&process.nextTick||Vi,pd=s=>s!=null&&it(s[qr]),D={isArray:zs,isArrayBuffer:Oi,isBuffer:cr,isFormData:Uc,isArrayBufferView:Pc,isString:$c,isNumber:Fi,isBoolean:Ic,isObject:dr,isPlainObject:wr,isEmptyObject:Dc,isReadableStream:Vc,isRequest:Hc,isResponse:qc,isHeaders:Kc,isUndefined:tr,isDate:Rc,isFile:Bc,isBlob:Oc,isRegExp:id,isFunction:it,isStream:zc,isURLSearchParams:Wc,isTypedArray:td,isFileList:Fc,forEach:ur,merge:ba,extend:Gc,trim:Zc,stripBOM:Jc,inherits:Qc,toFlatObject:Xc,kindOf:Kr,kindOfTest:jt,endsWith:Yc,toArray:ed,forEachEntry:sd,matchAll:rd,isHTMLForm:ad,hasOwnProperty:xn,hasOwnProp:xn,reduceDescriptors:Wi,freezeMethods:ld,toObjectSet:od,toCamelCase:nd,noop:cd,toFiniteNumber:dd,findKey:zi,global:ds,isContextDefined:Ui,isSpecCompliantForm:ud,toJSONObject:hd,isAsyncFn:md,isThenable:xd,setImmediate:Vi,asap:gd,isIterable:pd};function we(s,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}D.inherits(we,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:D.toJSONObject(this.config),code:this.code,status:this.status}}});const Hi=we.prototype,qi={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{qi[s]={value:s}});Object.defineProperties(we,qi);Object.defineProperty(Hi,"isAxiosError",{value:!0});we.from=(s,t,r,a,n,i)=>{const l=Object.create(Hi);return D.toFlatObject(s,l,function(c){return c!==Error.prototype},o=>o!=="isAxiosError"),we.call(l,s.message,t,r,a,n),l.cause=s,l.name=s.name,i&&Object.assign(l,i),l};const fd=null;function va(s){return D.isPlainObject(s)||D.isArray(s)}function Ki(s){return D.endsWith(s,"[]")?s.slice(0,-2):s}function gn(s,t,r){return s?s.concat(t).map(function(n,i){return n=Ki(n),!r&&i?"["+n+"]":n}).join(r?".":""):t}function yd(s){return D.isArray(s)&&!s.some(va)}const bd=D.toFlatObject(D,{},null,function(t){return/^is[A-Z]/.test(t)});function Gr(s,t,r){if(!D.isObject(s))throw new TypeError("target must be an object");t=t||new FormData,r=D.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,y){return!D.isUndefined(y[x])});const a=r.metaTokens,n=r.visitor||h,i=r.dots,l=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&D.isSpecCompliantForm(t);if(!D.isFunction(n))throw new TypeError("visitor must be a function");function d(f){if(f===null)return"";if(D.isDate(f))return f.toISOString();if(D.isBoolean(f))return f.toString();if(!c&&D.isBlob(f))throw new we("Blob is not supported. Use a Buffer instead.");return D.isArrayBuffer(f)||D.isTypedArray(f)?c&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function h(f,x,y){let m=f;if(f&&!y&&typeof f=="object"){if(D.endsWith(x,"{}"))x=a?x:x.slice(0,-2),f=JSON.stringify(f);else if(D.isArray(f)&&yd(f)||(D.isFileList(f)||D.endsWith(x,"[]"))&&(m=D.toArray(f)))return x=Ki(x),m.forEach(function(v,P){!(D.isUndefined(v)||v===null)&&t.append(l===!0?gn([x],P,i):l===null?x:x+"[]",d(v))}),!1}return va(f)?!0:(t.append(gn(y,x,i),d(f)),!1)}const u=[],j=Object.assign(bd,{defaultVisitor:h,convertValue:d,isVisitable:va});function p(f,x){if(!D.isUndefined(f)){if(u.indexOf(f)!==-1)throw Error("Circular reference detected in "+x.join("."));u.push(f),D.forEach(f,function(m,g){(!(D.isUndefined(m)||m===null)&&n.call(t,m,D.isString(g)?g.trim():g,x,j))===!0&&p(m,x?x.concat(g):[g])}),u.pop()}}if(!D.isObject(s))throw new TypeError("data must be an object");return p(s),t}function pn(s){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function Va(s,t){this._pairs=[],s&&Gr(s,this,t)}const Zi=Va.prototype;Zi.append=function(t,r){this._pairs.push([t,r])};Zi.toString=function(t){const r=t?function(a){return t.call(this,a,pn)}:pn;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function vd(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Gi(s,t,r){if(!t)return s;const a=r&&r.encode||vd;D.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let i;if(n?i=n(t,r):i=D.isURLSearchParams(t)?t.toString():new Va(t,r).toString(a),i){const l=s.indexOf("#");l!==-1&&(s=s.slice(0,l)),s+=(s.indexOf("?")===-1?"?":"&")+i}return s}class fn{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){D.forEach(this.handlers,function(a){a!==null&&t(a)})}}const Ji={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},jd=typeof URLSearchParams<"u"?URLSearchParams:Va,wd=typeof FormData<"u"?FormData:null,Nd=typeof Blob<"u"?Blob:null,kd={isBrowser:!0,classes:{URLSearchParams:jd,FormData:wd,Blob:Nd},protocols:["http","https","file","blob","url","data"]},Ha=typeof window<"u"&&typeof document<"u",ja=typeof navigator=="object"&&navigator||void 0,Sd=Ha&&(!ja||["ReactNative","NativeScript","NS"].indexOf(ja.product)<0),_d=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Cd=Ha&&window.location.href||"http://localhost",Ad=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ha,hasStandardBrowserEnv:Sd,hasStandardBrowserWebWorkerEnv:_d,navigator:ja,origin:Cd},Symbol.toStringTag,{value:"Module"})),Ye={...Ad,...kd};function Ld(s,t){return Gr(s,new Ye.classes.URLSearchParams,{visitor:function(r,a,n,i){return Ye.isNode&&D.isBuffer(r)?(this.append(a,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function Td(s){return D.matchAll(/\w+|\[(\w*)]/g,s).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Md(s){const t={},r=Object.keys(s);let a;const n=r.length;let i;for(a=0;a<n;a++)i=r[a],t[i]=s[i];return t}function Qi(s){function t(r,a,n,i){let l=r[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=i>=r.length;return l=!l&&D.isArray(n)?n.length:l,c?(D.hasOwnProp(n,l)?n[l]=[n[l],a]:n[l]=a,!o):((!n[l]||!D.isObject(n[l]))&&(n[l]=[]),t(r,a,n[l],i)&&D.isArray(n[l])&&(n[l]=Md(n[l])),!o)}if(D.isFormData(s)&&D.isFunction(s.entries)){const r={};return D.forEachEntry(s,(a,n)=>{t(Td(a),n,r,0)}),r}return null}function Ed(s,t,r){if(D.isString(s))try{return(t||JSON.parse)(s),D.trim(s)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(s)}const hr={transitional:Ji,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,i=D.isObject(t);if(i&&D.isHTMLForm(t)&&(t=new FormData(t)),D.isFormData(t))return n?JSON.stringify(Qi(t)):t;if(D.isArrayBuffer(t)||D.isBuffer(t)||D.isStream(t)||D.isFile(t)||D.isBlob(t)||D.isReadableStream(t))return t;if(D.isArrayBufferView(t))return t.buffer;if(D.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return Ld(t,this.formSerializer).toString();if((o=D.isFileList(t))||a.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Gr(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||n?(r.setContentType("application/json",!1),Ed(t)):t}],transformResponse:[function(t){const r=this.transitional||hr.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(D.isResponse(t)||D.isReadableStream(t))return t;if(t&&D.isString(t)&&(a&&!this.responseType||n)){const l=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(o){if(l)throw o.name==="SyntaxError"?we.from(o,we.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ye.classes.FormData,Blob:Ye.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};D.forEach(["delete","get","head","post","put","patch"],s=>{hr.headers[s]={}});const Pd=D.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),$d=s=>{const t={};let r,a,n;return s&&s.split(`
`).forEach(function(l){n=l.indexOf(":"),r=l.substring(0,n).trim().toLowerCase(),a=l.substring(n+1).trim(),!(!r||t[r]&&Pd[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},yn=Symbol("internals");function Ws(s){return s&&String(s).trim().toLowerCase()}function Nr(s){return s===!1||s==null?s:D.isArray(s)?s.map(Nr):String(s)}function Id(s){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(s);)t[a[1]]=a[2];return t}const Dd=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function aa(s,t,r,a,n){if(D.isFunction(a))return a.call(this,t,r);if(n&&(t=r),!!D.isString(t)){if(D.isString(a))return t.indexOf(a)!==-1;if(D.isRegExp(a))return a.test(t)}}function Rd(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function Bd(s,t){const r=D.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(s,a+r,{value:function(n,i,l){return this[a].call(this,t,n,i,l)},configurable:!0})})}let lt=class{constructor(t){t&&this.set(t)}set(t,r,a){const n=this;function i(o,c,d){const h=Ws(c);if(!h)throw new Error("header name must be a non-empty string");const u=D.findKey(n,h);(!u||n[u]===void 0||d===!0||d===void 0&&n[u]!==!1)&&(n[u||c]=Nr(o))}const l=(o,c)=>D.forEach(o,(d,h)=>i(d,h,c));if(D.isPlainObject(t)||t instanceof this.constructor)l(t,r);else if(D.isString(t)&&(t=t.trim())&&!Dd(t))l($d(t),r);else if(D.isObject(t)&&D.isIterable(t)){let o={},c,d;for(const h of t){if(!D.isArray(h))throw TypeError("Object iterator must return a key-value pair");o[d=h[0]]=(c=o[d])?D.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}l(o,r)}else t!=null&&i(r,t,a);return this}get(t,r){if(t=Ws(t),t){const a=D.findKey(this,t);if(a){const n=this[a];if(!r)return n;if(r===!0)return Id(n);if(D.isFunction(r))return r.call(this,n,a);if(D.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Ws(t),t){const a=D.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||aa(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let n=!1;function i(l){if(l=Ws(l),l){const o=D.findKey(a,l);o&&(!r||aa(a,a[o],o,r))&&(delete a[o],n=!0)}}return D.isArray(t)?t.forEach(i):i(t),n}clear(t){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const i=r[a];(!t||aa(this,this[i],i,t,!0))&&(delete this[i],n=!0)}return n}normalize(t){const r=this,a={};return D.forEach(this,(n,i)=>{const l=D.findKey(a,i);if(l){r[l]=Nr(n),delete r[i];return}const o=t?Rd(i):String(i).trim();o!==i&&delete r[i],r[o]=Nr(n),a[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return D.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=t&&D.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[yn]=this[yn]={accessors:{}}).accessors,n=this.prototype;function i(l){const o=Ws(l);a[o]||(Bd(n,l),a[o]=!0)}return D.isArray(t)?t.forEach(i):i(t),this}};lt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);D.reduceDescriptors(lt.prototype,({value:s},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>s,set(a){this[r]=a}}});D.freezeMethods(lt);function na(s,t){const r=this||hr,a=t||r,n=lt.from(a.headers);let i=a.data;return D.forEach(s,function(o){i=o.call(r,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function Xi(s){return!!(s&&s.__CANCEL__)}function Us(s,t,r){we.call(this,s??"canceled",we.ERR_CANCELED,t,r),this.name="CanceledError"}D.inherits(Us,we,{__CANCEL__:!0});function Yi(s,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?s(r):t(new we("Request failed with status code "+r.status,[we.ERR_BAD_REQUEST,we.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Od(s){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return t&&t[1]||""}function Fd(s,t){s=s||10;const r=new Array(s),a=new Array(s);let n=0,i=0,l;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),h=a[i];l||(l=d),r[n]=c,a[n]=d;let u=i,j=0;for(;u!==n;)j+=r[u++],u=u%s;if(n=(n+1)%s,n===i&&(i=(i+1)%s),d-l<t)return;const p=h&&d-h;return p?Math.round(j*1e3/p):void 0}}function zd(s,t){let r=0,a=1e3/t,n,i;const l=(d,h=Date.now())=>{r=h,n=null,i&&(clearTimeout(i),i=null),s(...d)};return[(...d)=>{const h=Date.now(),u=h-r;u>=a?l(d,h):(n=d,i||(i=setTimeout(()=>{i=null,l(n)},a-u)))},()=>n&&l(n)]}const Tr=(s,t,r=3)=>{let a=0;const n=Fd(50,250);return zd(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,c=l-a,d=n(c),h=l<=o;a=l;const u={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:d||void 0,estimated:d&&o&&h?(o-l)/d:void 0,event:i,lengthComputable:o!=null,[t?"download":"upload"]:!0};s(u)},r)},bn=(s,t)=>{const r=s!=null;return[a=>t[0]({lengthComputable:r,total:s,loaded:a}),t[1]]},vn=s=>(...t)=>D.asap(()=>s(...t)),Ud=Ye.hasStandardBrowserEnv?((s,t)=>r=>(r=new URL(r,Ye.origin),s.protocol===r.protocol&&s.host===r.host&&(t||s.port===r.port)))(new URL(Ye.origin),Ye.navigator&&/(msie|trident)/i.test(Ye.navigator.userAgent)):()=>!0,Wd=Ye.hasStandardBrowserEnv?{write(s,t,r,a,n,i){const l=[s+"="+encodeURIComponent(t)];D.isNumber(r)&&l.push("expires="+new Date(r).toGMTString()),D.isString(a)&&l.push("path="+a),D.isString(n)&&l.push("domain="+n),i===!0&&l.push("secure"),document.cookie=l.join("; ")},read(s){const t=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Vd(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function Hd(s,t){return t?s.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):s}function el(s,t,r){let a=!Vd(t);return s&&(a||r==!1)?Hd(s,t):t}const jn=s=>s instanceof lt?{...s}:s;function bs(s,t){t=t||{};const r={};function a(d,h,u,j){return D.isPlainObject(d)&&D.isPlainObject(h)?D.merge.call({caseless:j},d,h):D.isPlainObject(h)?D.merge({},h):D.isArray(h)?h.slice():h}function n(d,h,u,j){if(D.isUndefined(h)){if(!D.isUndefined(d))return a(void 0,d,u,j)}else return a(d,h,u,j)}function i(d,h){if(!D.isUndefined(h))return a(void 0,h)}function l(d,h){if(D.isUndefined(h)){if(!D.isUndefined(d))return a(void 0,d)}else return a(void 0,h)}function o(d,h,u){if(u in t)return a(d,h);if(u in s)return a(void 0,d)}const c={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(d,h,u)=>n(jn(d),jn(h),u,!0)};return D.forEach(Object.keys({...s,...t}),function(h){const u=c[h]||n,j=u(s[h],t[h],h);D.isUndefined(j)&&u!==o||(r[h]=j)}),r}const tl=s=>{const t=bs({},s);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:i,headers:l,auth:o}=t;t.headers=l=lt.from(l),t.url=Gi(el(t.baseURL,t.url,t.allowAbsoluteUrls),s.params,s.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let c;if(D.isFormData(r)){if(Ye.hasStandardBrowserEnv||Ye.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((c=l.getContentType())!==!1){const[d,...h]=c?c.split(";").map(u=>u.trim()).filter(Boolean):[];l.setContentType([d||"multipart/form-data",...h].join("; "))}}if(Ye.hasStandardBrowserEnv&&(a&&D.isFunction(a)&&(a=a(t)),a||a!==!1&&Ud(t.url))){const d=n&&i&&Wd.read(i);d&&l.set(n,d)}return t},qd=typeof XMLHttpRequest<"u",Kd=qd&&function(s){return new Promise(function(r,a){const n=tl(s);let i=n.data;const l=lt.from(n.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:d}=n,h,u,j,p,f;function x(){p&&p(),f&&f(),n.cancelToken&&n.cancelToken.unsubscribe(h),n.signal&&n.signal.removeEventListener("abort",h)}let y=new XMLHttpRequest;y.open(n.method.toUpperCase(),n.url,!0),y.timeout=n.timeout;function m(){if(!y)return;const v=lt.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),E={data:!o||o==="text"||o==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:v,config:s,request:y};Yi(function(T){r(T),x()},function(T){a(T),x()},E),y=null}"onloadend"in y?y.onloadend=m:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(m)},y.onabort=function(){y&&(a(new we("Request aborted",we.ECONNABORTED,s,y)),y=null)},y.onerror=function(){a(new we("Network Error",we.ERR_NETWORK,s,y)),y=null},y.ontimeout=function(){let P=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const E=n.transitional||Ji;n.timeoutErrorMessage&&(P=n.timeoutErrorMessage),a(new we(P,E.clarifyTimeoutError?we.ETIMEDOUT:we.ECONNABORTED,s,y)),y=null},i===void 0&&l.setContentType(null),"setRequestHeader"in y&&D.forEach(l.toJSON(),function(P,E){y.setRequestHeader(E,P)}),D.isUndefined(n.withCredentials)||(y.withCredentials=!!n.withCredentials),o&&o!=="json"&&(y.responseType=n.responseType),d&&([j,f]=Tr(d,!0),y.addEventListener("progress",j)),c&&y.upload&&([u,p]=Tr(c),y.upload.addEventListener("progress",u),y.upload.addEventListener("loadend",p)),(n.cancelToken||n.signal)&&(h=v=>{y&&(a(!v||v.type?new Us(null,s,y):v),y.abort(),y=null)},n.cancelToken&&n.cancelToken.subscribe(h),n.signal&&(n.signal.aborted?h():n.signal.addEventListener("abort",h)));const g=Od(n.url);if(g&&Ye.protocols.indexOf(g)===-1){a(new we("Unsupported protocol "+g+":",we.ERR_BAD_REQUEST,s));return}y.send(i||null)})},Zd=(s,t)=>{const{length:r}=s=s?s.filter(Boolean):[];if(t||r){let a=new AbortController,n;const i=function(d){if(!n){n=!0,o();const h=d instanceof Error?d:this.reason;a.abort(h instanceof we?h:new Us(h instanceof Error?h.message:h))}};let l=t&&setTimeout(()=>{l=null,i(new we(`timeout ${t} of ms exceeded`,we.ETIMEDOUT))},t);const o=()=>{s&&(l&&clearTimeout(l),l=null,s.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),s=null)};s.forEach(d=>d.addEventListener("abort",i));const{signal:c}=a;return c.unsubscribe=()=>D.asap(o),c}},Gd=function*(s,t){let r=s.byteLength;if(r<t){yield s;return}let a=0,n;for(;a<r;)n=a+t,yield s.slice(a,n),a=n},Jd=async function*(s,t){for await(const r of Qd(s))yield*Gd(r,t)},Qd=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const t=s.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},wn=(s,t,r,a)=>{const n=Jd(s,t);let i=0,l,o=c=>{l||(l=!0,a&&a(c))};return new ReadableStream({async pull(c){try{const{done:d,value:h}=await n.next();if(d){o(),c.close();return}let u=h.byteLength;if(r){let j=i+=u;r(j)}c.enqueue(new Uint8Array(h))}catch(d){throw o(d),d}},cancel(c){return o(c),n.return()}},{highWaterMark:2})},Jr=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",sl=Jr&&typeof ReadableStream=="function",Xd=Jr&&(typeof TextEncoder=="function"?(s=>t=>s.encode(t))(new TextEncoder):async s=>new Uint8Array(await new Response(s).arrayBuffer())),rl=(s,...t)=>{try{return!!s(...t)}catch{return!1}},Yd=sl&&rl(()=>{let s=!1;const t=new Request(Ye.origin,{body:new ReadableStream,method:"POST",get duplex(){return s=!0,"half"}}).headers.has("Content-Type");return s&&!t}),Nn=64*1024,wa=sl&&rl(()=>D.isReadableStream(new Response("").body)),Mr={stream:wa&&(s=>s.body)};Jr&&(s=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Mr[t]&&(Mr[t]=D.isFunction(s[t])?r=>r[t]():(r,a)=>{throw new we(`Response type '${t}' is not supported`,we.ERR_NOT_SUPPORT,a)})})})(new Response);const e0=async s=>{if(s==null)return 0;if(D.isBlob(s))return s.size;if(D.isSpecCompliantForm(s))return(await new Request(Ye.origin,{method:"POST",body:s}).arrayBuffer()).byteLength;if(D.isArrayBufferView(s)||D.isArrayBuffer(s))return s.byteLength;if(D.isURLSearchParams(s)&&(s=s+""),D.isString(s))return(await Xd(s)).byteLength},t0=async(s,t)=>{const r=D.toFiniteNumber(s.getContentLength());return r??e0(t)},s0=Jr&&(async s=>{let{url:t,method:r,data:a,signal:n,cancelToken:i,timeout:l,onDownloadProgress:o,onUploadProgress:c,responseType:d,headers:h,withCredentials:u="same-origin",fetchOptions:j}=tl(s);d=d?(d+"").toLowerCase():"text";let p=Zd([n,i&&i.toAbortSignal()],l),f;const x=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let y;try{if(c&&Yd&&r!=="get"&&r!=="head"&&(y=await t0(h,a))!==0){let E=new Request(t,{method:"POST",body:a,duplex:"half"}),A;if(D.isFormData(a)&&(A=E.headers.get("content-type"))&&h.setContentType(A),E.body){const[T,k]=bn(y,Tr(vn(c)));a=wn(E.body,Nn,T,k)}}D.isString(u)||(u=u?"include":"omit");const m="credentials"in Request.prototype;f=new Request(t,{...j,signal:p,method:r.toUpperCase(),headers:h.normalize().toJSON(),body:a,duplex:"half",credentials:m?u:void 0});let g=await fetch(f,j);const v=wa&&(d==="stream"||d==="response");if(wa&&(o||v&&x)){const E={};["status","statusText","headers"].forEach(R=>{E[R]=g[R]});const A=D.toFiniteNumber(g.headers.get("content-length")),[T,k]=o&&bn(A,Tr(vn(o),!0))||[];g=new Response(wn(g.body,Nn,T,()=>{k&&k(),x&&x()}),E)}d=d||"text";let P=await Mr[D.findKey(Mr,d)||"text"](g,s);return!v&&x&&x(),await new Promise((E,A)=>{Yi(E,A,{data:P,headers:lt.from(g.headers),status:g.status,statusText:g.statusText,config:s,request:f})})}catch(m){throw x&&x(),m&&m.name==="TypeError"&&/Load failed|fetch/i.test(m.message)?Object.assign(new we("Network Error",we.ERR_NETWORK,s,f),{cause:m.cause||m}):we.from(m,m&&m.code,s,f)}}),Na={http:fd,xhr:Kd,fetch:s0};D.forEach(Na,(s,t)=>{if(s){try{Object.defineProperty(s,"name",{value:t})}catch{}Object.defineProperty(s,"adapterName",{value:t})}});const kn=s=>`- ${s}`,r0=s=>D.isFunction(s)||s===null||s===!1,al={getAdapter:s=>{s=D.isArray(s)?s:[s];const{length:t}=s;let r,a;const n={};for(let i=0;i<t;i++){r=s[i];let l;if(a=r,!r0(r)&&(a=Na[(l=String(r)).toLowerCase()],a===void 0))throw new we(`Unknown adapter '${l}'`);if(a)break;n[l||"#"+i]=a}if(!a){const i=Object.entries(n).map(([o,c])=>`adapter ${o} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=t?i.length>1?`since :
`+i.map(kn).join(`
`):" "+kn(i[0]):"as no adapter specified";throw new we("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return a},adapters:Na};function ia(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new Us(null,s)}function Sn(s){return ia(s),s.headers=lt.from(s.headers),s.data=na.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),al.getAdapter(s.adapter||hr.adapter)(s).then(function(a){return ia(s),a.data=na.call(s,s.transformResponse,a),a.headers=lt.from(a.headers),a},function(a){return Xi(a)||(ia(s),a&&a.response&&(a.response.data=na.call(s,s.transformResponse,a.response),a.response.headers=lt.from(a.response.headers))),Promise.reject(a)})}const nl="1.11.0",Qr={};["object","boolean","number","function","string","symbol"].forEach((s,t)=>{Qr[s]=function(a){return typeof a===s||"a"+(t<1?"n ":" ")+s}});const _n={};Qr.transitional=function(t,r,a){function n(i,l){return"[Axios v"+nl+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,o)=>{if(t===!1)throw new we(n(l," has been removed"+(r?" in "+r:"")),we.ERR_DEPRECATED);return r&&!_n[l]&&(_n[l]=!0,console.warn(n(l," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,l,o):!0}};Qr.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function a0(s,t,r){if(typeof s!="object")throw new we("options must be an object",we.ERR_BAD_OPTION_VALUE);const a=Object.keys(s);let n=a.length;for(;n-- >0;){const i=a[n],l=t[i];if(l){const o=s[i],c=o===void 0||l(o,i,s);if(c!==!0)throw new we("option "+i+" must be "+c,we.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new we("Unknown option "+i,we.ERR_BAD_OPTION)}}const kr={assertOptions:a0,validators:Qr},wt=kr.validators;let fs=class{constructor(t){this.defaults=t||{},this.interceptors={request:new fn,response:new fn}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=bs(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:i}=r;a!==void 0&&kr.assertOptions(a,{silentJSONParsing:wt.transitional(wt.boolean),forcedJSONParsing:wt.transitional(wt.boolean),clarifyTimeoutError:wt.transitional(wt.boolean)},!1),n!=null&&(D.isFunction(n)?r.paramsSerializer={serialize:n}:kr.assertOptions(n,{encode:wt.function,serialize:wt.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),kr.assertOptions(r,{baseUrl:wt.spelling("baseURL"),withXsrfToken:wt.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=i&&D.merge(i.common,i[r.method]);i&&D.forEach(["delete","get","head","post","put","patch","common"],f=>{delete i[f]}),r.headers=lt.concat(l,i);const o=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(c=c&&x.synchronous,o.unshift(x.fulfilled,x.rejected))});const d=[];this.interceptors.response.forEach(function(x){d.push(x.fulfilled,x.rejected)});let h,u=0,j;if(!c){const f=[Sn.bind(this),void 0];for(f.unshift(...o),f.push(...d),j=f.length,h=Promise.resolve(r);u<j;)h=h.then(f[u++],f[u++]);return h}j=o.length;let p=r;for(u=0;u<j;){const f=o[u++],x=o[u++];try{p=f(p)}catch(y){x.call(this,y);break}}try{h=Sn.call(this,p)}catch(f){return Promise.reject(f)}for(u=0,j=d.length;u<j;)h=h.then(d[u++],d[u++]);return h}getUri(t){t=bs(this.defaults,t);const r=el(t.baseURL,t.url,t.allowAbsoluteUrls);return Gi(r,t.params,t.paramsSerializer)}};D.forEach(["delete","get","head","options"],function(t){fs.prototype[t]=function(r,a){return this.request(bs(a||{},{method:t,url:r,data:(a||{}).data}))}});D.forEach(["post","put","patch"],function(t){function r(a){return function(i,l,o){return this.request(bs(o||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}fs.prototype[t]=r(),fs.prototype[t+"Form"]=r(!0)});let n0=class il{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const a=this;this.promise.then(n=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](n);a._listeners=null}),this.promise.then=n=>{let i;const l=new Promise(o=>{a.subscribe(o),i=o}).then(n);return l.cancel=function(){a.unsubscribe(i)},l},t(function(i,l,o){a.reason||(a.reason=new Us(i,l,o),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new il(function(n){t=n}),cancel:t}}};function i0(s){return function(r){return s.apply(null,r)}}function l0(s){return D.isObject(s)&&s.isAxiosError===!0}const ka={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ka).forEach(([s,t])=>{ka[t]=s});function ll(s){const t=new fs(s),r=Ri(fs.prototype.request,t);return D.extend(r,fs.prototype,t,{allOwnKeys:!0}),D.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return ll(bs(s,n))},r}const Oe=ll(hr);Oe.Axios=fs;Oe.CanceledError=Us;Oe.CancelToken=n0;Oe.isCancel=Xi;Oe.VERSION=nl;Oe.toFormData=Gr;Oe.AxiosError=we;Oe.Cancel=Oe.CanceledError;Oe.all=function(t){return Promise.all(t)};Oe.spread=i0;Oe.isAxiosError=l0;Oe.mergeConfig=bs;Oe.AxiosHeaders=lt;Oe.formToJSON=s=>Qi(D.isHTMLForm(s)?new FormData(s):s);Oe.getAdapter=al.getAdapter;Oe.HttpStatusCode=ka;Oe.default=Oe;const{Axios:Lh,AxiosError:Th,CanceledError:Mh,isCancel:Eh,CancelToken:Ph,VERSION:$h,all:Ih,Cancel:Dh,isAxiosError:Rh,spread:Bh,toFormData:Oh,AxiosHeaders:Fh,HttpStatusCode:zh,formToJSON:Uh,getAdapter:Wh,mergeConfig:Vh}=Oe;var Sr=(s=>(s.NETWORK="network",s.AUTH="auth",s.VALIDATION="validation",s.SERVER="server",s.WEBSOCKET="websocket",s.API="api",s.UNKNOWN="unknown",s))(Sr||{});const ns=class ns{constructor(){Ne(this,"errorListeners",[])}static getInstance(){return ns.instance||(ns.instance=new ns),ns.instance}handle(t,r,a=!0){const n=this.parseError(t,r);return this.logError(n),a&&this.showErrorToast(n),this.notifyListeners(n),n}parseError(t,r){const a=Date.now();return t!=null&&t.isAxiosError||t!=null&&t.response?this.parseAxiosError(t,r,a):(t==null?void 0:t.type)==="websocket"||r==="websocket"?{type:"websocket",message:this.getWebSocketErrorMessage(t),details:t,timestamp:a,source:r}:t instanceof Error?{type:"unknown",message:t.message,details:{name:t.name,stack:t.stack},timestamp:a,source:r}:typeof t=="string"?{type:"unknown",message:t,timestamp:a,source:r}:{type:"unknown",message:"发生未知错误",details:t,timestamp:a,source:r}}parseAxiosError(t,r,a){const{response:n,request:i,message:l}=t;if(n){const o=n.status,c=n.data;return o===401?{type:"auth",code:o,message:(c==null?void 0:c.message)||"认证失败，请重新登录",details:c,timestamp:a||Date.now(),source:r}:o===403?{type:"auth",code:o,message:(c==null?void 0:c.message)||"权限不足",details:c,timestamp:a||Date.now(),source:r}:o===422||o===400?{type:"validation",code:o,message:(c==null?void 0:c.message)||"请求参数错误",details:c,timestamp:a||Date.now(),source:r}:o===429?{type:"api",code:o,message:(c==null?void 0:c.message)||"请求过于频繁，请稍后再试",details:c,timestamp:a||Date.now(),source:r}:o>=500?{type:"server",code:o,message:(c==null?void 0:c.message)||"服务器内部错误，请稍后再试",details:c,timestamp:a||Date.now(),source:r}:{type:"api",code:o,message:(c==null?void 0:c.message)||`请求失败 (${o})`,details:c,timestamp:a||Date.now(),source:r}}return i?{type:"network",message:"网络连接失败，请检查网络设置",details:{message:l,request:i},timestamp:a||Date.now(),source:r}:{type:"unknown",message:l||"请求配置错误",details:t,timestamp:a||Date.now(),source:r}}getWebSocketErrorMessage(t){if(t!=null&&t.code)switch(t.code){case 1006:return"连接异常关闭，正在尝试重连...";case 1e3:return"连接正常关闭";case 1001:return"服务器端点离线";case 1002:return"协议错误";case 1003:return"不支持的数据类型";case 1005:return"未收到关闭状态码";case 1011:return"服务器遇到意外情况";default:return`WebSocket连接错误 (${t.code})`}return(t==null?void 0:t.message)||"WebSocket连接失败"}showErrorToast(t){const{type:r,message:a}=t;switch(r){case"auth":O.error(a,{id:"auth-error",duration:5e3,icon:"🔒"});break;case"network":O.error(a,{id:"network-error",duration:6e3,icon:"🌐"});break;case"validation":O.error(a,{id:"validation-error",duration:4e3,icon:"⚠️"});break;case"websocket":O.error(a,{id:"websocket-error",duration:3e3,icon:"🔌"});break;case"server":O.error(a,{id:"server-error",duration:5e3,icon:"🔥"});break;default:O.error(a,{duration:4e3,icon:"❌"})}}logError(t){this.getLogLevel(t.type);const r=`[${t.type.toUpperCase()}] ${t.message}`;console.error(r,{type:t.type,code:t.code,source:t.source,timestamp:t.timestamp})}getLogLevel(t){switch(t){case"auth":case"server":return"error";case"network":case"websocket":return"warn";default:return"info"}}addErrorListener(t){this.errorListeners.push(t)}removeErrorListener(t){this.errorListeners=this.errorListeners.filter(r=>r!==t)}notifyListeners(t){this.errorListeners.forEach(r=>{try{r(t)}catch(a){console.error("Error in error listener:",a)}})}createRetryableHandler(t=3,r=1e3){return async(a,n)=>{let i;for(let l=1;l<=t;l++)try{return await a()}catch(o){i=o;const c=this.parseError(o,n);if(c.type==="auth"||c.type==="validation")throw o;if(l===t)throw this.handle(o,n),o;await new Promise(d=>setTimeout(d,r*Math.pow(2,l-1)))}throw i}}};Ne(ns,"instance");let Sa=ns;const qa=Sa.getInstance(),ol=(s,t,r=!0)=>qa.handle(s,t,r),o0=(s,t)=>qa.createRetryableHandler(s,t),cl=(s,t="api")=>{const r=Oe.create({baseURL:s,timeout:6e4,headers:{"Content-Type":"application/json"}});return r.interceptors.request.use(a=>{const n=localStorage.getItem("auth-storage");if(n)try{const{state:i}=JSON.parse(n);i!=null&&i.token&&(a.headers.Authorization=`Bearer ${i.token}`)}catch(i){console.error("Failed to parse auth data:",i)}return a},a=>Promise.reject(a)),r.interceptors.response.use(a=>a,async a=>{var l;const n=a.config;if(((l=a.response)==null?void 0:l.status)===401&&!n._retry){if(n._retry=!0,t==="user")try{const o=localStorage.getItem("auth-storage");if(o){const{state:c}=JSON.parse(o);if(c!=null&&c.token){const h=(await r.post("/auth/refresh",{token:c.token})).data.token,u={...c,token:h};return localStorage.setItem("auth-storage",JSON.stringify({state:u})),n.headers.Authorization=`Bearer ${h}`,r(n)}}}catch(o){console.error("Token refresh failed:",o)}return console.warn(`${t} service returned 401, clearing auth state`),localStorage.removeItem("auth-storage"),window.location.href="/login",Promise.reject(a)}const i=ol(a,"api-client",!1);return Promise.reject(i)}),r},c0="/api/v1",d0="/api/v1",dt=cl(c0,"user"),te=cl(d0,"trading"),Q=s=>s.data,J=s=>{if(s!=null&&s.type&&(s!=null&&s.message))throw new Error(s.message);const t=ol(s,"api-error",!0);throw new Error(t.message)},Vt={async login(s){try{const t=await dt.post("/auth/login",s),r=Q(t);return{user:r.data.user,token:r.data.access_token,refresh_token:r.data.refresh_token}}catch(t){J(t)}},async register(s){try{const t=await dt.post("/auth/register",s),r=Q(t);return{user:r.data.user||null,token:r.data.access_token||null,refresh_token:r.data.refresh_token||null}}catch(t){J(t)}},async loginWithGoogle(s){try{const t=await dt.post("/auth/google",{google_token:s}),r=Q(t);return{user:r.data.user,token:r.data.access_token,refresh_token:r.data.refresh_token}}catch(t){J(t)}},async forgotPassword(s){try{const t=await dt.post("/auth/forgot-password",{email:s});return Q(t)}catch(t){J(t)}},async getProfile(){try{const s=await dt.get("/auth/profile");return Q(s)}catch(s){J(s)}},async updateProfile(s){try{const t=await dt.put("/auth/profile",s);return Q(t)}catch(t){J(t)}},async refreshToken(){try{const s=await dt.post("/auth/refresh");return Q(s)}catch(s){J(s)}},async sendVerificationEmail(){try{const s=await dt.post("/auth/send-verification");return Q(s)}catch(s){J(s)}},async verifyEmail(s){try{const t=await dt.post("/auth/verify-email",{token:s});return Q(t)}catch(t){J(t)}},async sendPasswordReset(s){try{const t=await dt.post("/auth/password-reset",{email:s});return Q(t)}catch(t){J(t)}},async resetPassword(s,t){try{const r=await dt.post("/auth/password-reset/confirm",{token:s,password:t});return Q(r)}catch(r){J(r)}},async changePassword(s,t){try{const r=await dt.post("/auth/change-password",{current_password:s,new_password:t});return Q(r)}catch(r){J(r)}},async logout(){try{const s=await dt.post("/auth/logout");return Q(s)}catch(s){J(s)}}},et=Ut()(js((s,t)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,login:async r=>{var a,n;s({isLoading:!0,error:null});try{const i=await Vt.login(r);return s({user:i.user,token:i.token,isAuthenticated:!0,isLoading:!1,error:null}),{success:!0}}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||i.message||"登录失败";let o=l;return l.includes("not found")||l.includes("不存在")?o="用户不存在":(l.includes("password")||l.includes("密码"))&&(o="密码错误"),s({isLoading:!1,error:o}),{success:!1,message:o}}},register:async r=>{var a,n;s({isLoading:!0,error:null});try{const i=await Vt.register(r);return s({user:i.user,token:i.token,isAuthenticated:!0,isLoading:!1,error:null}),{success:!0}}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"注册失败";return s({isLoading:!1,error:l}),{success:!1,message:l}}},loginWithGoogle:async r=>{var a,n;s({isLoading:!0,error:null});try{const i=await Vt.loginWithGoogle(r);return s({user:i.user,token:i.token,isAuthenticated:!0,isLoading:!1,error:null}),{success:!0}}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"Google登录失败";return s({isLoading:!1,error:l}),{success:!1,message:l}}},forgotPassword:async r=>{try{return await Vt.forgotPassword(r),!0}catch{return!1}},resetPassword:async(r,a)=>{try{return await Vt.resetPassword(r,a),!0}catch{return!1}},logout:()=>{s({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null}),O.success("已退出登录")},checkAuth:async()=>{const{token:r,isAuthenticated:a,user:n}=t();if(r&&!(a&&n)){s({isLoading:!0,error:null});try{const i=await Vt.getProfile();s({user:i,isAuthenticated:!0,isLoading:!1,error:null})}catch{s({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:"Token已失效，请重新登录"})}}},updateProfile:async r=>{var a,n;try{const i=await Vt.updateProfile(r);return s(l=>({user:{...l.user,...i},error:null})),O.success("个人资料更新成功"),!0}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"更新失败";return s({error:l}),O.error(l),!1}},refreshToken:async()=>{try{const r=await Vt.refreshToken();return s({token:r.token,error:null}),!0}catch{return t().logout(),!1}},clearError:()=>{s({error:null})}}),{name:"auth-storage",partialize:s=>({token:s.token,user:s.user,isAuthenticated:s.isAuthenticated})})),Xr=Ut()(js(s=>({theme:"light",toggleTheme:()=>s(t=>({theme:t.theme==="light"?"dark":"light"})),setTheme:t=>s({theme:t})}),{name:"theme-storage",getStorage:()=>localStorage}));function u0(s={}){const{nonce:t,onScriptLoadSuccess:r,onScriptLoadError:a}=s,[n,i]=b.useState(!1),l=b.useRef(r);l.current=r;const o=b.useRef(a);return o.current=a,b.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",c.async=!0,c.defer=!0,c.nonce=t,c.onload=()=>{var d;i(!0),(d=l.current)===null||d===void 0||d.call(l)},c.onerror=()=>{var d;i(!1),(d=o.current)===null||d===void 0||d.call(o)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[t]),n}const dl=b.createContext(null);function h0({clientId:s,nonce:t,onScriptLoadSuccess:r,onScriptLoadError:a,children:n}){const i=u0({nonce:t,onScriptLoadSuccess:r,onScriptLoadError:a}),l=b.useMemo(()=>({clientId:s,scriptLoadedSuccessfully:i}),[s,i]);return Ke.createElement(dl.Provider,{value:l},n)}function m0(){const s=b.useContext(dl);if(!s)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return s}function x0(s){var t;return(t=s==null?void 0:s.clientId)!==null&&t!==void 0?t:s==null?void 0:s.client_id}const g0={large:40,medium:32,small:20};function p0({onSuccess:s,onError:t,useOneTap:r,promptMomentNotification:a,type:n="standard",theme:i="outline",size:l="large",text:o,shape:c,logo_alignment:d,width:h,locale:u,click_listener:j,containerProps:p,...f}){const x=b.useRef(null),{clientId:y,scriptLoadedSuccessfully:m}=m0(),g=b.useRef(s);g.current=s;const v=b.useRef(t);v.current=t;const P=b.useRef(a);return P.current=a,b.useEffect(()=>{var E,A,T,k,R,se,z,K,S;if(m)return(T=(A=(E=window==null?void 0:window.google)===null||E===void 0?void 0:E.accounts)===null||A===void 0?void 0:A.id)===null||T===void 0||T.initialize({client_id:y,callback:U=>{var V;if(!(U!=null&&U.credential))return(V=v.current)===null||V===void 0?void 0:V.call(v);const{credential:le,select_by:C}=U;g.current({credential:le,clientId:x0(U),select_by:C})},...f}),(se=(R=(k=window==null?void 0:window.google)===null||k===void 0?void 0:k.accounts)===null||R===void 0?void 0:R.id)===null||se===void 0||se.renderButton(x.current,{type:n,theme:i,size:l,text:o,shape:c,logo_alignment:d,width:h,locale:u,click_listener:j}),r&&((S=(K=(z=window==null?void 0:window.google)===null||z===void 0?void 0:z.accounts)===null||K===void 0?void 0:K.id)===null||S===void 0||S.prompt(P.current)),()=>{var U,V,le;r&&((le=(V=(U=window==null?void 0:window.google)===null||U===void 0?void 0:U.accounts)===null||V===void 0?void 0:V.id)===null||le===void 0||le.cancel())}},[y,m,r,n,i,l,o,c,d,h,u]),Ke.createElement("div",{...p,ref:x,style:{height:g0[l],...p==null?void 0:p.style}})}const f0={zh:{welcomeTitle:"欢迎来到Trademe",welcomeSubtitle:"专业的数字货币策略交易平台",activeUsers:"活跃用户",tradingVolume:"交易量",uptime:"系统稳定性",platformDescription:"基于人工智能的量化交易平台，支持多交易所、自动化策略和智能风控",createAccount:"创建账户",accountLogin:"账户登录",registerSubtitle:"开始您的智能交易之旅",loginSubtitle:"欢迎回来，请登录您的账户",orContinueWith:"或者使用其他方式",username:"用户名",enterUsername:"请输入用户名",email:"邮箱地址",enterEmail:"请输入邮箱地址",password:"密码",enterPassword:"请输入密码",confirmPassword:"确认密码",enterPasswordAgain:"请再次输入密码",forgotPassword:"忘记密码",enterEmailForReset:"输入邮箱以重置密码",sendReset:"发送重置链接",processing:"处理中...",login:"登录",haveAccount:"已有账户？",noAccount:"还没有账户？",loginNow:"立即登录",registerNow:"立即注册",byRegisteringAgree:"注册即表示您同意我们的",termsOfService:"服务条款",and:"和",privacyPolicy:"隐私政策",userNotFound:"用户不存在，请检查邮箱地址",wrongPassword:"密码错误，请重试或重置密码",loginFailed:"登录失败，请重试",loginSuccess:"登录成功",registerSuccess:"注册成功",authError:"认证错误，请重试",googleLoginSuccess:"Google登录成功",googleLoginFailed:"Google登录失败",googleLoginError:"Google登录出错",passwordResetSent:"密码重置链接已发送到您的邮箱",passwordResetFailed:"发送重置链接失败",passwordResetError:"重置密码时出错",wantToRegister:"该用户不存在，是否要注册新账户？",dashboard:"仪表板",strategies:"策略管理",trading:"实盘交易",backtest:"回测分析",aiAssistant:"AI助手",market:"市场数据",portfolio:"投资组合",settings:"设置",logout:"退出登录",profile:"个人资料",notifications:"通知",help:"帮助中心",about:"关于我们",contact:"联系我们",language_setting:"语言",theme_setting:"主题",lightMode:"浅色模式",darkMode:"深色模式",chartTrading:"图表交易",liveTrading:"实盘交易",tradingNotes:"交易心得",apiManagement:"API管理",accountCenter:"账户中心",membershipManagement:"会员管理",personalSettings:"个人设置",tradingOverview:"交易概览",welcomeBack:"欢迎回来",checkTradingDataAndQuickActions:"查看您的交易数据和快速操作",realTimeConnected:"实时连接",connectionLost:"连接断开",totalStrategies:"策略总数",running:"运行中",totalProfit:"总收益",winRate:"胜率",quickActions:"快捷操作",strategiesManagement:"策略管理",viewAndManageStrategies:"查看和管理您的交易策略",startAutomatedTrading:"开始实盘自动化交易",strategyBacktest:"策略回测",testStrategyPerformance:"测试策略历史表现",getIntelligentTradingAdvice:"获取智能交易建议",recentStrategies:"最近策略",viewAll:"查看全部",loadingStrategies:"加载策略中...",viewDetails:"查看详情",noStrategies:"暂无策略",createFirstStrategy:"开始创建您的第一个交易策略",createStrategy:"创建策略",upgradeToCreate:"升级后创建",createStrategyRequiresPremium:"创建策略需要升级到高级版本",stopped:"已停止",tradingPair:"交易对",timeframe:"周期",monitorRunningStrategies:"监控运行中的实盘交易，查看收益和交易详情",totalLiveStrategies:"总实盘数",runningLive:"运行中",stoppedLive:"已停止",pausedLive:"已暂停",searchStrategies:"搜索策略...",allStatus:"全部",paused:"已暂停",strategyName:"策略名称",status:"状态",profitLoss:"盈亏",lastUpdate:"最近更新",actions:"操作",start:"启动",stop:"停止",pause:"暂停",delete:"删除",confirmDelete:"确定要删除策略",strategyDeleted:"策略已删除",strategyStarted:"已启动",strategyStopped:"已停止",strategyPaused:"已暂停",startStrategyRequiresPremium:"启动策略需要高级版本",loadingStrategiesError:"加载实盘失败",strategiesLoaded:"个实盘",noStrategiesMessage:"暂无策略数据",createFirstStrategyMessage:"创建您的第一个交易策略开始实盘交易",selected:"已选中",currentFilter:"当前筛选",clearFilter:"清除筛选",aiChatWelcome:`您好！我是Trademe AI交易助手。我可以帮您：

• 📈 分析市场趋势和技术指标
• 🤖 生成量化交易策略代码
• 💡 提供交易建议和风险评估
• 📊 解读回测结果和优化建议

请告诉我您需要什么帮助？`,aiChatRequiresPremium:"AI对话功能需要升级到高级版本",aiResponseError:"AI响应出错，请重试",sendMessage:"发送",typeMessage:"输入您的问题...",aiTyping:"AI正在思考...",newChat:"新对话",verifyTradingStrategy:"验证您的交易策略，优化投资决策",totalBacktests:"总回测数",completedSuccessfully:"成功完成",executionFailed:"执行失败",createBacktest:"创建回测",backtestHistory:"回测历史",backtestConfig:"回测配置",selectStrategy:"选择策略",strategyRequired:"请选择策略",confirmDeleteBacktest:"确定要删除这个回测吗？",getStrategiesError:"获取策略列表失败",completed:"已完成",failed:"已失败",unknown:"未知",selectOption:"请选择...",required:"必填项",optional:"可选项",shareTradeThoughts:"分享交易心得，学习交流经验",totalNotes:"心得总数",publicNotes:"公开心得",privateNotes:"私密心得",drafts:"草稿",myNotes:"我的心得",publicDiscussion:"公开讨论",createNote:"创建心得",writeTitle:"写下标题",shareTradeStory:"分享您的交易故事、心得体会",selectCategory:"选择分类",technicalAnalysis:"技术分析",fundamentalAnalysis:"基本面分析",strategyDiscussion:"策略探讨",errorReview:"错误复盘",marketView:"市场观点",tradingPairOptional:"交易对（可选）",entryPrice:"入场价格",exitPrice:"出场价格",stopLoss:"止损价格",takeProfit:"止盈价格",positionSize:"仓位大小",tags:"标签",addTag:"添加标签",publicPost:"公开发布",saveDraft:"保存草稿",publishing:"发布中...",saving:"保存中...",searchNotes:"搜索心得...",allCategories:"全部分类",sortBy:"排序方式",newest:"最新",oldest:"最早",mostLiked:"最受欢迎",noNotesMessage:"还没有心得分享",createFirstNote:"写下您的第一篇交易心得",manageExchangeConnections:"管理交易所连接，配置API密钥",totalAPIs:"API总数",activeAPIs:"活跃API",testConnection:"测试连接",addNewAPI:"添加新API",apiKeyManagement:"API密钥管理",exchangeName:"交易所名称",apiKey:"API密钥",secretKey:"密钥Secret",passphrase:"密码短语",permissions:"权限",connectionStatus:"连接状态",connected:"已连接",disconnected:"未连接",editAPI:"编辑API",deleteAPI:"删除API",confirmDeleteAPI:"确定要删除这个API配置吗？",manageAccountAndSettings:"管理账户信息和系统设置",accountInfo:"账户信息",membershipInfo:"会员信息",securitySettings:"安全设置",systemSettings:"系统设置",basicInfo:"基本信息",avatar:"头像",changePassword:"修改密码",twoFactorAuth:"双重验证",currentPlan:"当前套餐",validUntil:"有效期至",upgrade:"升级",renewMembership:"续费会员",usageStatistics:"使用统计",changeAvatar:"更换头像",uploadImage:"上传图片",currentPassword:"当前密码",newPassword:"新密码",confirmNewPassword:"确认新密码",saveChanges:"保存更改",cancel:"取消",basicUser:"初级用户",premiumUser:"高级用户",professionalUser:"专业用户",monthlyFee:"每月",apiKeyBinding:"个API密钥",dailyAIQuota:"每日AI助手额度",tickBacktestMonthly:"每月Tick级数据回测",tradingNotesStorage:"交易心得记录存储",indicatorsStrategies:"个指标/策略",liveInstances:"个实盘"},en:{welcomeTitle:"Welcome to Trademe",welcomeSubtitle:"Professional Cryptocurrency Strategy Trading Platform",activeUsers:"Active Users",tradingVolume:"Trading Volume",uptime:"System Uptime",platformDescription:"AI-powered quantitative trading platform with multi-exchange support, automated strategies, and intelligent risk control",createAccount:"Create Account",accountLogin:"Account Login",registerSubtitle:"Start your intelligent trading journey",loginSubtitle:"Welcome back, please login to your account",orContinueWith:"Or continue with",username:"Username",enterUsername:"Enter username",email:"Email Address",enterEmail:"Enter email address",password:"Password",enterPassword:"Enter password",confirmPassword:"Confirm Password",enterPasswordAgain:"Enter password again",forgotPassword:"Forgot Password",enterEmailForReset:"Enter email to reset password",sendReset:"Send Reset Link",processing:"Processing...",login:"Login",haveAccount:"Already have an account?",noAccount:"Don't have an account?",loginNow:"Login Now",registerNow:"Register Now",byRegisteringAgree:"By registering, you agree to our ",termsOfService:"Terms of Service",and:" and ",privacyPolicy:"Privacy Policy",userNotFound:"User not found, please check email address",wrongPassword:"Wrong password, please try again or reset password",loginFailed:"Login failed, please try again",loginSuccess:"Login successful",registerSuccess:"Registration successful",authError:"Authentication error, please try again",googleLoginSuccess:"Google login successful",googleLoginFailed:"Google login failed",googleLoginError:"Google login error",passwordResetSent:"Password reset link has been sent to your email",passwordResetFailed:"Failed to send reset link",passwordResetError:"Error resetting password",wantToRegister:"User does not exist, would you like to register a new account?",dashboard:"Dashboard",strategies:"Strategies",trading:"Live Trading",backtest:"Backtest",aiAssistant:"AI Assistant",market:"Market Data",portfolio:"Portfolio",settings:"Settings",logout:"Logout",profile:"Profile",notifications:"Notifications",help:"Help Center",about:"About Us",contact:"Contact Us",language_setting:"Language",theme_setting:"Theme",lightMode:"Light Mode",darkMode:"Dark Mode",chartTrading:"Chart Trading",liveTrading:"Live Trading",tradingNotes:"Trading Notes",apiManagement:"API Management",accountCenter:"Account Center",membershipManagement:"Membership Management",personalSettings:"Personal Settings",tradingOverview:"Trading Overview",welcomeBack:"Welcome back",checkTradingDataAndQuickActions:"View your trading data and quick actions",realTimeConnected:"Real-time Connected",connectionLost:"Connection Lost",totalStrategies:"Total Strategies",running:"Running",totalProfit:"Total Profit",winRate:"Win Rate",quickActions:"Quick Actions",strategiesManagement:"Strategies Management",viewAndManageStrategies:"View and manage your trading strategies",startAutomatedTrading:"Start automated live trading",strategyBacktest:"Strategy Backtest",testStrategyPerformance:"Test strategy historical performance",getIntelligentTradingAdvice:"Get intelligent trading advice",recentStrategies:"Recent Strategies",viewAll:"View All",loadingStrategies:"Loading strategies...",viewDetails:"View Details",noStrategies:"No Strategies",createFirstStrategy:"Start creating your first trading strategy",createStrategy:"Create Strategy",upgradeToCreate:"Upgrade to Create",createStrategyRequiresPremium:"Creating strategies requires premium upgrade",stopped:"Stopped",tradingPair:"Trading Pair",timeframe:"Timeframe",monitorRunningStrategies:"Monitor running live strategies, view profits and trading details",totalLiveStrategies:"Total Live Strategies",runningLive:"Running",stoppedLive:"Stopped",pausedLive:"Paused",searchStrategies:"Search strategies...",allStatus:"All",paused:"Paused",strategyName:"Strategy Name",status:"Status",profitLoss:"P&L",lastUpdate:"Last Update",actions:"Actions",start:"Start",stop:"Stop",pause:"Pause",delete:"Delete",confirmDelete:"Are you sure you want to delete strategy",strategyDeleted:"Strategy deleted",strategyStarted:"started",strategyStopped:"stopped",strategyPaused:"paused",startStrategyRequiresPremium:"Starting strategies requires premium version",loadingStrategiesError:"Failed to load live strategies",strategiesLoaded:"live strategies loaded",noStrategiesMessage:"No strategy data available",createFirstStrategyMessage:"Create your first trading strategy to start live trading",selected:"Selected",currentFilter:"Current filter",clearFilter:"Clear filter",aiChatWelcome:`Hello! I am Trademe AI trading assistant. I can help you:

• 📈 Analyze market trends and technical indicators
• 🤖 Generate quantitative trading strategy code
• 💡 Provide trading advice and risk assessment
• 📊 Interpret backtest results and optimization suggestions

What can I help you with?`,aiChatRequiresPremium:"AI chat feature requires premium version upgrade",aiResponseError:"AI response error, please try again",sendMessage:"Send",typeMessage:"Type your question...",aiTyping:"AI is thinking...",newChat:"New Chat",verifyTradingStrategy:"Verify your trading strategies and optimize investment decisions",totalBacktests:"Total Backtests",completedSuccessfully:"Completed Successfully",executionFailed:"Execution Failed",createBacktest:"Create Backtest",backtestHistory:"Backtest History",backtestConfig:"Backtest Configuration",selectStrategy:"Select Strategy",strategyRequired:"Please select a strategy",confirmDeleteBacktest:"Are you sure you want to delete this backtest?",getStrategiesError:"Failed to get strategy list",completed:"Completed",failed:"Failed",unknown:"Unknown",selectOption:"Please select...",required:"Required",optional:"Optional",shareTradeThoughts:"Share trading insights and learn from experiences",totalNotes:"Total Notes",publicNotes:"Public Notes",privateNotes:"Private Notes",drafts:"Drafts",myNotes:"My Notes",publicDiscussion:"Public Discussion",createNote:"Create Note",writeTitle:"Write title",shareTradeStory:"Share your trading story and insights",selectCategory:"Select Category",technicalAnalysis:"Technical Analysis",fundamentalAnalysis:"Fundamental Analysis",strategyDiscussion:"Strategy Discussion",errorReview:"Error Review",marketView:"Market View",tradingPairOptional:"Trading Pair (Optional)",entryPrice:"Entry Price",exitPrice:"Exit Price",stopLoss:"Stop Loss Price",takeProfit:"Take Profit Price",positionSize:"Position Size",tags:"Tags",addTag:"Add Tag",publicPost:"Publish Publicly",saveDraft:"Save Draft",publishing:"Publishing...",saving:"Saving...",searchNotes:"Search notes...",allCategories:"All Categories",sortBy:"Sort By",newest:"Newest",oldest:"Oldest",mostLiked:"Most Liked",noNotesMessage:"No notes shared yet",createFirstNote:"Write your first trading note",manageExchangeConnections:"Manage exchange connections and configure API keys",totalAPIs:"Total APIs",activeAPIs:"Active APIs",testConnection:"Test Connection",addNewAPI:"Add New API",apiKeyManagement:"API Key Management",exchangeName:"Exchange Name",apiKey:"API Key",secretKey:"Secret Key",passphrase:"Passphrase",permissions:"Permissions",connectionStatus:"Connection Status",connected:"Connected",disconnected:"Disconnected",editAPI:"Edit API",deleteAPI:"Delete API",confirmDeleteAPI:"Are you sure you want to delete this API configuration?",manageAccountAndSettings:"Manage account information and system settings",accountInfo:"Account Information",membershipInfo:"Membership Information",securitySettings:"Security Settings",systemSettings:"System Settings",basicInfo:"Basic Information",avatar:"Avatar",changePassword:"Change Password",twoFactorAuth:"Two-Factor Authentication",currentPlan:"Current Plan",validUntil:"Valid Until",upgrade:"Upgrade",renewMembership:"Renew Membership",usageStatistics:"Usage Statistics",changeAvatar:"Change Avatar",uploadImage:"Upload Image",currentPassword:"Current Password",newPassword:"New Password",confirmNewPassword:"Confirm New Password",saveChanges:"Save Changes",cancel:"Cancel",basicUser:"Basic User",premiumUser:"Premium User",professionalUser:"Professional User",monthlyFee:"per month",apiKeyBinding:"API keys",dailyAIQuota:"daily AI assistant quota",tickBacktestMonthly:"monthly tick-level backtests",tradingNotesStorage:"trading notes storage",indicatorsStrategies:"indicators/strategies",liveInstances:"live instances"}},Wt=Ut()(js((s,t)=>({language:"zh",setLanguage:r=>s({language:r}),t:r=>{const a=t().language;return f0[a][r]||r}}),{name:"language-storage",getStorage:()=>localStorage})),y0=({data:s=[],title:t="收益率曲线",width:r="100%",height:a=300,className:n="",showBenchmark:i=!1,benchmarkName:l="基准",loading:o=!1})=>{const c=b.useRef(null),d=b.useRef(null);return b.useEffect(()=>{if(c.current)return d.current=Zs(c.current),()=>{var h;(h=d.current)==null||h.dispose()}},[]),b.useEffect(()=>{if(!d.current||o)return;if(s.length===0){d.current.clear();return}const h=s.map(v=>new Date(v.timestamp).toLocaleDateString()),u=s.map(v=>v.value),j=i?s.map(v=>v.benchmark||0):[],p=[],f=[];let x=100,y=100;for(let v=0;v<u.length;v++)v===0?(p.push(x),i&&f.push(y)):(x=x*(1+u[v]/100),p.push(x),i&&j[v]!==void 0&&(y=y*(1+j[v]/100),f.push(y)));const m=[{name:"策略收益",type:"line",data:p,smooth:!0,symbol:"none",lineStyle:{color:"#1a3d7c",width:2},areaStyle:{color:new ma(0,0,0,1,[{offset:0,color:"rgba(26, 61, 124, 0.3)"},{offset:1,color:"rgba(26, 61, 124, 0.05)"}])}}];i&&f.length>0&&m.push({name:l,type:"line",data:f,smooth:!0,symbol:"none",lineStyle:{color:"#94a3b8",width:1,type:"dashed"}});const g={title:{text:t,left:0,textStyle:{color:"#1a3d7c",fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"#e5e7eb",borderWidth:1,textStyle:{color:"#374151"},formatter:function(v){if(!v||v.length===0)return"";const P=v[0].dataIndex,E=u[P],A=(p[P]-100).toFixed(2);let T=`
            <div style="padding: 8px;">
              <div style="margin-bottom: 4px; font-weight: bold;">${v[0].name}</div>
              <div style="color: #1a3d7c;">
                当日收益: ${E>0?"+":""}${E.toFixed(2)}%
              </div>
              <div style="color: #1a3d7c;">
                累计收益: ${parseFloat(A)>0?"+":""}${A}%
              </div>
          `;if(i&&v.length>1){const k=(f[P]-100).toFixed(2);T+=`
              <div style="color: #94a3b8;">
                ${l}累计: ${parseFloat(k)>0?"+":""}${k}%
              </div>
            `}return T+="</div>",T}},legend:{data:i?["策略收益",l]:["策略收益"],top:35,right:0,textStyle:{color:"#666"}},grid:{left:"3%",right:"4%",bottom:"8%",top:i?"20%":"15%",containLabel:!0},xAxis:{type:"category",data:h,boundaryGap:!1,axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280",fontSize:11},splitLine:{show:!1}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280",fontSize:11,formatter:"{value}%"},splitLine:{lineStyle:{color:"#f3f4f6",type:"dashed"}}},series:m};d.current.setOption(g,!0)},[s,t,i,l,o]),b.useEffect(()=>{const h=()=>{var u;(u=d.current)==null||u.resize()};return window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]),e.jsxs("div",{className:`relative ${n}`,children:[e.jsx("div",{ref:c,style:{width:r,height:a},className:"bg-white"}),o&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-gray-500 text-sm",children:"加载中..."})]})}),!o&&s.length===0&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("p",{className:"text-gray-500",children:"暂无数据"})]})})]})},b0=({metrics:s,equityCurve:t=[],monthlyReturns:r=[],className:a=""})=>{const n=b.useRef(null),i=b.useRef(null),l=b.useRef(null),o=b.useRef(null),c=b.useRef(null),d=b.useRef(null);return b.useEffect(()=>(n.current&&(o.current=Zs(n.current)),i.current&&(c.current=Zs(i.current)),l.current&&(d.current=Zs(l.current)),()=>{var h,u,j;(h=o.current)==null||h.dispose(),(u=c.current)==null||u.dispose(),(j=d.current)==null||j.dispose()}),[]),b.useEffect(()=>{if(!o.current||t.length===0)return;const h=t.map(x=>new Date(x.timestamp).toLocaleDateString()),u=t.map(x=>x.equity),j=t.map(x=>-Math.abs(x.drawdown)),p=t.map(x=>x.rolling_max),f={title:{text:"权益曲线与回撤分析",left:0,textStyle:{fontSize:16,fontWeight:"bold",color:"#1f2937"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:x=>{const y=x[0].dataIndex;return`
            <div style="padding: 8px;">
              <div style="font-weight: bold; margin-bottom: 4px;">${h[y]}</div>
              <div style="color: #1e40af;">权益: $${u[y].toLocaleString()}</div>
              <div style="color: #dc2626;">回撤: ${j[y].toFixed(2)}%</div>
              <div style="color: #059669;">历史最高: $${p[y].toLocaleString()}</div>
            </div>
          `}},legend:{data:["权益曲线","历史最高","回撤"],top:25},grid:[{left:"8%",right:"8%",top:"15%",height:"50%"},{left:"8%",right:"8%",top:"70%",height:"20%"}],xAxis:[{type:"category",data:h,axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280",interval:"auto"}},{type:"category",data:h,gridIndex:1,axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{show:!1}}],yAxis:[{type:"value",position:"right",axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280",formatter:x=>"$"+x.toLocaleString()},splitLine:{lineStyle:{color:"#f3f4f6",type:"dashed"}}},{type:"value",gridIndex:1,position:"right",axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280",formatter:"{value}%"},max:0,min:Math.min(...j)*1.1}],series:[{name:"权益曲线",type:"line",data:u,smooth:!0,symbol:"none",lineStyle:{color:"#1e40af",width:2},areaStyle:{color:new ma(0,0,0,1,[{offset:0,color:"rgba(30, 64, 175, 0.3)"},{offset:1,color:"rgba(30, 64, 175, 0.05)"}])}},{name:"历史最高",type:"line",data:p,smooth:!0,symbol:"none",lineStyle:{color:"#059669",width:1,type:"dashed"}},{name:"回撤",type:"line",data:j,xAxisIndex:1,yAxisIndex:1,smooth:!0,symbol:"none",lineStyle:{color:"#dc2626",width:1},areaStyle:{color:new ma(0,0,0,1,[{offset:0,color:"rgba(220, 38, 38, 0.2)"},{offset:1,color:"rgba(220, 38, 38, 0.05)"}])}}],dataZoom:[{type:"inside",xAxisIndex:[0,1],start:0,end:100}]};o.current.setOption(f,!0)},[t]),b.useEffect(()=>{if(!c.current||r.length===0)return;const h=[...new Set(r.map(f=>f.year))].sort(),u=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],j=r.map(f=>[f.month-1,h.indexOf(f.year),f.return]),p={title:{text:"月度收益热力图",left:0,textStyle:{fontSize:16,fontWeight:"bold",color:"#1f2937"}},tooltip:{position:"top",formatter:f=>{const[x,y,m]=f.data,g=h[y],v=u[x],P=m>=0?"#059669":"#dc2626";return`
            <div style="padding: 8px;">
              <div style="font-weight: bold; margin-bottom: 4px;">${g}年${v}</div>
              <div style="color: ${P};">收益率: ${m.toFixed(2)}%</div>
            </div>
          `}},grid:{height:"60%",top:"15%",left:"10%",right:"10%"},xAxis:{type:"category",data:u,splitArea:{show:!1},axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280"}},yAxis:{type:"category",data:h.map(f=>f.toString()),splitArea:{show:!1},axisLine:{lineStyle:{color:"#e5e7eb"}},axisTick:{show:!1},axisLabel:{color:"#6b7280"}},visualMap:{min:Math.min(...r.map(f=>f.return)),max:Math.max(...r.map(f=>f.return)),calculable:!0,orient:"horizontal",left:"center",bottom:"5%",inRange:{color:["#dc2626","#ffffff","#059669"]},text:["高收益","低收益"],textStyle:{color:"#6b7280"}},series:[{name:"月度收益",type:"heatmap",data:j,label:{show:!0,formatter:f=>f.data[2].toFixed(1)+"%",color:"#1f2937",fontSize:10},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};c.current.setOption(p,!0)},[r]),b.useEffect(()=>{if(!d.current)return;const h={title:{text:"策略性能雷达图",left:0,textStyle:{fontSize:16,fontWeight:"bold",color:"#1f2937"}},tooltip:{trigger:"item",formatter:u=>{const{name:j,value:p}=u;return`<div style="padding: 8px;"><b>${j}</b><br/>评分: ${p}</div>`}},radar:{radius:"70%",center:["50%","55%"],indicator:[{name:"收益能力",max:100},{name:"风险控制",max:100},{name:"稳定性",max:100},{name:"交易效率",max:100},{name:"回撤控制",max:100},{name:"风险收益比",max:100}],axisName:{color:"#6b7280",fontSize:12},splitArea:{areaStyle:{color:["rgba(59, 130, 246, 0.05)","rgba(59, 130, 246, 0.1)"]}},axisLine:{lineStyle:{color:"#e5e7eb"}},splitLine:{lineStyle:{color:"#e5e7eb"}}},series:[{name:"策略性能",type:"radar",data:[{value:[Math.min(Math.max((s.annual_return+50)*2,0),100),Math.min(Math.max(100-s.volatility*2,0),100),Math.min(Math.max(s.sharpe_ratio*30,0),100),Math.min(Math.max(s.win_rate,0),100),Math.min(Math.max(100-Math.abs(s.max_drawdown)*2,0),100),Math.min(Math.max(s.profit_factor*20,0),100)],name:"当前策略",areaStyle:{color:new $l(.5,.5,1,[{offset:0,color:"rgba(59, 130, 246, 0.3)"},{offset:1,color:"rgba(59, 130, 246, 0.1)"}])},lineStyle:{color:"#3b82f6",width:2},symbol:"circle",symbolSize:6}]}]};d.current.setOption(h,!0)},[s]),b.useEffect(()=>{const h=()=>{var u,j,p;(u=o.current)==null||u.resize(),(j=c.current)==null||j.resize(),(p=d.current)==null||p.resize()};return window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]),e.jsxs("div",{className:`space-y-6 ${a}`,children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 text-center",children:[e.jsxs("div",{className:`text-2xl font-bold ${s.total_return>=0?"text-green-600":"text-red-600"}`,children:[s.total_return>=0?"+":"",s.total_return.toFixed(2),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"总收益率"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[s.max_drawdown.toFixed(2),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"最大回撤"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${s.sharpe_ratio>=1?"text-green-600":"text-orange-600"}`,children:s.sharpe_ratio.toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-500",children:"夏普比率"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[s.win_rate.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"胜率"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:s.sortino_ratio.toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-500",children:"索提诺比率"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:s.calmar_ratio.toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-500",children:"卡尔玛比率"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx("div",{ref:n,style:{width:"100%",height:"400px"}})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx("div",{ref:l,style:{width:"100%",height:"400px"}})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx("div",{ref:i,style:{width:"100%",height:"300px"}})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"详细统计"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"收益指标"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"年化收益率:"}),e.jsxs("span",{className:s.annual_return>=0?"text-green-600":"text-red-600",children:[s.annual_return.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"总交易次数:"}),e.jsx("span",{className:"text-gray-900",children:s.total_trades})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"盈亏比:"}),e.jsx("span",{className:"text-gray-900",children:s.profit_factor.toFixed(2)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"风险指标"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"波动率:"}),e.jsxs("span",{className:"text-gray-900",children:[s.volatility.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"VaR (95%):"}),e.jsxs("span",{className:"text-red-600",children:[s.var_95.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"CVaR (95%):"}),e.jsxs("span",{className:"text-red-600",children:[s.cvar_95.toFixed(2),"%"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"交易指标"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"平均盈利:"}),e.jsxs("span",{className:"text-green-600",children:[s.avg_win.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"平均亏损:"}),e.jsxs("span",{className:"text-red-600",children:[s.avg_loss.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"最大连胜:"}),e.jsx("span",{className:"text-green-600",children:s.max_consecutive_wins})]})]})]})]})]})]})},v0=()=>{var x;const s=ot(),{isAuthenticated:t,user:r}=et(),{theme:a}=Xr(),{t:n}=Wt(),[i,l]=b.useState(null),[o,c]=b.useState([]),[d,h]=b.useState(!1),[u,j]=b.useState(!1),[p,f]=b.useState("90");return b.useEffect(()=>{t&&s("/ai-chat",{replace:!0})},[t,s]),t?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:e.jsxs("div",{className:"w-full max-w-6xl min-h-screen bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 mx-auto transition-colors",children:[e.jsxs("header",{className:"py-4 px-8 flex justify-between items-center border-b border-gray-200 dark:border-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"w-7 h-7 mr-3 text-blue-600 dark:text-blue-400",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),e.jsx("path",{d:"M8 12h8M12 8v8",stroke:"currentColor",strokeWidth:"2"})]}),e.jsx("h1",{className:"text-xl font-bold text-blue-600 dark:text-blue-400 transition-colors",children:"Trademe"})]}),e.jsxs("nav",{className:"flex gap-2",children:[e.jsx("div",{className:"px-4 py-2 rounded-lg text-white font-medium bg-blue-600 dark:bg-blue-600 transition-colors",children:"首页"}),e.jsx(Ge,{to:"/strategies",className:"px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"策略交易"}),e.jsx(Ge,{to:"/trading",className:"px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"图表交易"}),e.jsx(Ge,{to:"/trading-notes",className:"px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"交易心得"}),e.jsx(Ge,{to:"/api-keys",className:"px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"API管理"}),e.jsx(Ge,{to:"/profile",className:"px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"账户中心"})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"w-9 h-9 rounded-full bg-gray-200 overflow-hidden",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-r from-blue-400 to-blue-600 flex items-center justify-center text-white font-semibold",children:(x=r==null?void 0:r.username)==null?void 0:x.charAt(0).toUpperCase()})})})]}),e.jsxs("main",{className:"p-8",children:[e.jsxs("section",{className:"grid grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-xl shadow-sm border border-gray-100 dark:border-gray-600 p-6 flex items-center transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4 bg-blue-100 dark:bg-blue-900",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1721 9z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"APIKEY数量"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d?e.jsx("span",{className:"animate-pulse bg-gray-200 dark:bg-gray-600 rounded h-8 w-16 inline-block"}):e.jsxs(e.Fragment,{children:[(i==null?void 0:i.api_keys.current)||0,e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["/",(i==null?void 0:i.api_keys.limit)||10]})]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-xl shadow-sm border border-gray-100 dark:border-gray-600 p-6 flex items-center transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4 bg-green-100 dark:bg-green-900",children:e.jsx("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"实盘策略数"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d?e.jsx("span",{className:"animate-pulse bg-gray-200 dark:bg-gray-600 rounded h-8 w-12 inline-block"}):(i==null?void 0:i.live_strategies.current)||0})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-xl shadow-sm border border-gray-100 dark:border-gray-600 p-6 flex items-center transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4 bg-yellow-100 dark:bg-yellow-900",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"本月收益率"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d?e.jsx("span",{className:"animate-pulse bg-gray-200 dark:bg-gray-600 rounded h-8 w-20 inline-block"}):e.jsxs("span",{className:`px-2 py-1 rounded-md ${((i==null?void 0:i.monthly_return)||0)>=0?"bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-400":"bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-400"}`,children:[((i==null?void 0:i.monthly_return)||0)>=0?"+":"",((i==null?void 0:i.monthly_return)||0).toFixed(1),"%"]})})]})]})]}),e.jsx("section",{className:"mb-8",children:e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-xl shadow-sm border border-gray-100 dark:border-gray-600 p-6 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:"当前收益率曲线"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f("7"),className:`px-3 py-1 rounded-lg text-sm transition-colors ${p==="7"?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500"}`,children:"近7天"}),e.jsx("button",{onClick:()=>f("30"),className:`px-3 py-1 rounded-lg text-sm transition-colors ${p==="30"?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500"}`,children:"本月"}),e.jsx("button",{onClick:()=>f("90"),className:`px-3 py-1 rounded-lg text-sm transition-colors ${p==="90"?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500"}`,children:"近3月"})]})]}),u?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-500 dark:text-gray-400",children:"加载收益数据..."})]}):e.jsx(y0,{data:o,title:"",height:250,className:"mt-2"})]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center transition-colors",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-brand-500 rounded-full flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-white font-bold text-xl",children:"T"})}),e.jsxs("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4 transition-colors",children:["欢迎使用 ",e.jsx("span",{className:"text-brand-500",children:"Trademe"})]}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 mb-8 transition-colors",children:"专业的数字货币策略交易平台，集成AI智能分析"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-12",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-200 dark:border-gray-700 transition-colors",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-gradient-to-r from-blue-500 to-cyan-500 rounded-2xl flex items-center justify-center mb-6",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-900 dark:text-white text-center",children:"AI策略回测"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6 leading-relaxed",children:"使用Claude 4先进AI技术，将您的交易想法智能转化为专业策略代码。平台提供tick级别的高精度历史数据回测， 确保策略验证的准确性。回测完成后，可一键部署至实盘交易，实现从想法到盈利的完整闭环。"}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Claude 4智能策略生成"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Tick级别高精度回测"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"一键转实盘运行"]})]}),e.jsx(Ge,{to:"/ai-backtest-intro",className:"block",children:e.jsx("button",{className:"w-full py-3 px-6 bg-gradient-to-r from-blue-500 to-cyan-500 text-white font-medium rounded-lg hover:from-blue-600 hover:to-cyan-600 transition-all transform hover:scale-105",children:"了解详情"})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-200 dark:border-gray-700 transition-colors",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl flex items-center justify-center mb-6",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-900 dark:text-white text-center",children:"AI智能分析"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6 leading-relaxed",children:"通过深度记录和分析您的策略开单情况及手动交易行为，AI助手能够学习您的交易逻辑和风格偏好。 与AI进行深度对话，共同构建个性化的智能交易系统，让AI成为您24小时不间断的专业交易顾问。"}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"智能交易行为分析"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"个性化交易逻辑学习"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"24/7智能交易助手"]})]}),e.jsx(Ge,{to:"/ai-analysis-intro",className:"block",children:e.jsx("button",{className:"w-full py-3 px-6 bg-gradient-to-r from-green-500 to-emerald-500 text-white font-medium rounded-lg hover:from-green-600 hover:to-emerald-600 transition-all transform hover:scale-105",children:"了解详情"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 text-center transition-colors",children:[e.jsx("div",{className:"w-12 h-12 mx-auto bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"多交易所支持"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"支持币安、OKX等主流交易所API，统一管理多个账户"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 text-center transition-colors",children:[e.jsx("div",{className:"w-12 h-12 mx-auto bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"安全可靠"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"银行级别的安全加密，API密钥本地加密存储"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 text-center transition-colors",children:[e.jsx("div",{className:"w-12 h-12 mx-auto bg-indigo-100 dark:bg-indigo-900 rounded-lg flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"实时监控"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"实时监控策略表现，智能风控保护您的资金安全"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center mb-8",children:[e.jsx(Ge,{to:"/login",className:"w-full sm:w-auto",children:e.jsx("button",{className:"w-full sm:w-auto px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all transform hover:scale-105 shadow-lg",children:"免费开始使用"})}),e.jsx(Ge,{to:"/pricing",className:"w-full sm:w-auto",children:e.jsx("button",{className:"w-full sm:w-auto px-8 py-4 bg-transparent border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 font-semibold rounded-xl hover:border-blue-500 dark:hover:border-blue-400 transition-colors",children:"查看会员方案"})})]}),e.jsxs("div",{className:"mt-20 mb-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"AI策略回测 - 让想法变成盈利"}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto",children:"使用Claude 4先进AI技术，将您的交易想法智能转化为专业策略代码"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:"1"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"描述您的策略想法"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:'用自然语言描述您的交易策略思路，比如"当RSI超卖且价格触及支撑位时买入"。 Claude 4能够理解复杂的交易逻辑和技术指标组合。'})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"2"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"AI智能策略生成"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"AI自动将您的想法转换为专业的Python交易策略代码，包含完整的开仓、平仓、止损止盈逻辑， 支持多种技术指标和风控机制。"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-bold",children:"3"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"Tick级别精确回测"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"使用真实的tick级别历史数据进行回测，精确模拟每一笔交易的执行过程， 包含滑点、手续费等真实交易成本，确保回测结果的可靠性。"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-orange-600 dark:text-orange-400 font-bold",children:"4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"一键转实盘运行"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"回测验证策略有效性后，一键部署到实盘交易环境。 平台自动处理API连接、订单执行、风险控制等技术细节，让您专注于策略优化。"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl p-8 text-white",children:[e.jsx("h3",{className:"text-2xl font-bold mb-6",children:"策略回测报告示例"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"总收益率"}),e.jsx("span",{className:"font-bold text-green-300",children:"+156.8%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"夏普比率"}),e.jsx("span",{className:"font-bold",children:"2.34"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"最大回撤"}),e.jsx("span",{className:"font-bold text-red-300",children:"-8.5%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"胜率"}),e.jsx("span",{className:"font-bold",children:"68.2%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"盈亏比"}),e.jsx("span",{className:"font-bold",children:"2.1:1"})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-white/10 rounded-lg",children:[e.jsx("p",{className:"text-sm",children:'"该策略在过去12个月的回测中表现优异，具有较低的风险和稳定的收益。建议配置20%的资金进行实盘交易。"'}),e.jsx("p",{className:"text-xs mt-2 opacity-80",children:"— AI策略分析师"})]})]})]})]}),e.jsxs("div",{className:"mt-20 mb-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"AI智能分析 - 您的24/7交易顾问"}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto",children:"通过深度学习您的交易行为，构建个性化的智能交易系统"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-teal-600 rounded-2xl p-8 text-white",children:[e.jsx("h3",{className:"text-2xl font-bold mb-6",children:"AI学习您的交易模式"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-white/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"交易心得记录"}),e.jsx("p",{className:"text-sm opacity-90",children:'"今天在BTCUSDT 45000附近看到双底形态，结合RSI超卖信号， 决定建立多头仓位。设置止损在44500，目标位46500。"'})]}),e.jsxs("div",{className:"p-4 bg-white/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"AI分析反馈"}),e.jsx("p",{className:"text-sm opacity-90",children:'"您偏好在技术形态确认后进场，风险控制意识较强。 建议在类似条件下可以适当加大仓位，历史胜率达72%。"'})]}),e.jsxs("div",{className:"p-4 bg-white/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"交易建议"}),e.jsx("p",{className:"text-sm opacity-90",children:'"当前ETHUSDT出现类似的双底+RSI超卖组合， 基于您的交易风格，建议关注入场机会。"'})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"1"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"记录交易心得"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"详细记录每次交易的思路、进场逻辑、情绪状态等。 平台支持文字、图片、语音等多种形式，让记录更加便捷真实。"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:"2"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"AI深度学习"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"AI分析您的交易记录，识别成功和失败的交易模式， 学习您的风险偏好、时间习惯、技术分析方法等个性化特征。"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-bold",children:"3"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"智能对话分析"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"与AI进行深度对话，讨论市场观点、交易策略、风险控制等。 AI会根据您的历史表现和当前市况，提供个性化的交易建议。"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center mr-4 flex-shrink-0",children:e.jsx("span",{className:"text-orange-600 dark:text-orange-400 font-bold",children:"4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"构建专属交易系统"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"基于学习结果，AI帮助构建符合您交易风格的智能系统， 包括自动监控、风险提醒、交易机会推送等功能。"})]})]})]})]})]}),e.jsxs("div",{className:"mt-20 mb-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"会员方案"}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300",children:"选择适合您的专业交易方案，开启AI助力的量化交易之旅"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 border border-gray-200 dark:border-gray-700 transition-colors",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"免费用户"}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:["$0",e.jsx("span",{className:"text-lg text-gray-500 dark:text-gray-400",children:"/月"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"体验基础功能"})]}),e.jsxs("ul",{className:"space-y-2 mb-8 text-sm",children:[e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"绑定 1 个API密钥"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"$10 AI对话额度 (总额)"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"无限次K线级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"1KB 交易心得存储"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"1个策略/1个指标"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"1个实盘交易"]})]}),e.jsx("button",{className:"w-full py-3 px-6 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors",children:"免费开始"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 border border-gray-200 dark:border-gray-700 transition-colors",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"初级会员"}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:["$19",e.jsx("span",{className:"text-lg text-gray-500 dark:text-gray-400",children:"/月"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"个人交易者首选"})]}),e.jsxs("ul",{className:"space-y-2 mb-8 text-sm",children:[e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"绑定 1 个API密钥"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"每日 $100 AI助手额度"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"每日 5次 Tick级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"无限次K线级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"1MB 交易心得存储"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"2个策略/2个指标"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"2个实盘交易"]})]}),e.jsx("button",{className:"w-full py-3 px-6 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"选择初级会员"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 border-2 border-blue-500 relative transition-colors",children:[e.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2",children:e.jsx("span",{className:"bg-blue-500 text-white px-4 py-1 rounded-full text-sm font-medium",children:"推荐"})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"高级会员"}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:["$99",e.jsx("span",{className:"text-lg text-gray-500 dark:text-gray-400",children:"/月"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"专业交易团队"})]}),e.jsxs("ul",{className:"space-y-2 mb-8 text-sm",children:[e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"绑定 5 个API密钥"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"每日 $100 AI助手额度"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"每月 30次 Tick级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"无限次K线级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"20MB 交易心得存储"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"10个策略/10个指标"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"10个实盘交易"]})]}),e.jsx("button",{className:"w-full py-3 px-6 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"选择高级会员"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 border border-gray-200 dark:border-gray-700 transition-colors",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"专业会员"}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:["$199",e.jsx("span",{className:"text-lg text-gray-500 dark:text-gray-400",children:"/月"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"机构投资者"})]}),e.jsxs("ul",{className:"space-y-2 mb-8 text-sm",children:[e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"绑定 10 个API密钥"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"每日 $200 AI对话额度"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"每月 100次 Tick级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"无限次K线级回测"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"50MB 交易心得存储"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"20个策略/20个指标"]}),e.jsxs("li",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"20个实盘交易"]})]}),e.jsx("button",{className:"w-full py-3 px-6 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"选择专业会员"})]})]}),e.jsxs("div",{className:"text-center mt-8",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"💡 AI额度已优化至最佳性价比 • 所有方案包含无限K线回测 • 免费用户可体验完整功能"}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 inline-block",children:e.jsx("p",{className:"text-blue-600 dark:text-blue-400 text-sm font-medium",children:"🎯 推荐：先使用免费账户体验，再根据需要升级付费方案"})})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"遇到问题？联系我们的专业团队"}),e.jsxs("a",{href:"https://t.me/+K2JBhvnMW2AwNGZl",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-lg transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 0C5.374 0 0 5.373 0 12s5.374 12 12 12 12-5.373 12-12S18.626 0 12 0zm5.568 8.16l-1.61 7.59c-.12.54-.44.67-.9.42l-2.47-1.82-1.19 1.14c-.13.13-.24.24-.5.24l.18-2.51 4.62-4.18c.2-.18-.04-.28-.32-.1L10.42 13l-2.42-.76c-.53-.16-.54-.53.11-.78l9.46-3.64c.44-.16.82.1.68.78z"})}),"加入 Telegram 群聊"]})]})]})})};var mr=s=>s.type==="checkbox",us=s=>s instanceof Date,rt=s=>s==null;const ul=s=>typeof s=="object";var Be=s=>!rt(s)&&!Array.isArray(s)&&ul(s)&&!us(s),j0=s=>Be(s)&&s.target?mr(s.target)?s.target.checked:s.target.value:s,w0=s=>s.substring(0,s.search(/\.\d+(\.|$)/))||s,N0=(s,t)=>s.has(w0(t)),k0=s=>{const t=s.constructor&&s.constructor.prototype;return Be(t)&&t.hasOwnProperty("isPrototypeOf")},Ka=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function He(s){let t;const r=Array.isArray(s),a=typeof FileList<"u"?s instanceof FileList:!1;if(s instanceof Date)t=new Date(s);else if(!(Ka&&(s instanceof Blob||a))&&(r||Be(s)))if(t=r?[]:Object.create(Object.getPrototypeOf(s)),!r&&!k0(s))t=s;else for(const n in s)s.hasOwnProperty(n)&&(t[n]=He(s[n]));else return s;return t}var Yr=s=>/^\w*$/.test(s),Ue=s=>s===void 0,Za=s=>Array.isArray(s)?s.filter(Boolean):[],Ga=s=>Za(s.replace(/["|']|\]/g,"").split(/\.|\[/)),de=(s,t,r)=>{if(!t||!Be(s))return r;const a=(Yr(t)?[t]:Ga(t)).reduce((n,i)=>rt(n)?n:n[i],s);return Ue(a)||a===s?Ue(s[t])?r:s[t]:a},St=s=>typeof s=="boolean",Ee=(s,t,r)=>{let a=-1;const n=Yr(t)?[t]:Ga(t),i=n.length,l=i-1;for(;++a<i;){const o=n[a];let c=r;if(a!==l){const d=s[o];c=Be(d)||Array.isArray(d)?d:isNaN(+n[a+1])?{}:[]}if(o==="__proto__"||o==="constructor"||o==="prototype")return;s[o]=c,s=s[o]}};const Cn={BLUR:"blur",FOCUS_OUT:"focusout"},bt={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Dt={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},S0=Ke.createContext(null);S0.displayName="HookFormContext";var _0=(s,t,r,a=!0)=>{const n={defaultValues:t._defaultValues};for(const i in s)Object.defineProperty(n,i,{get:()=>{const l=i;return t._proxyFormState[l]!==bt.all&&(t._proxyFormState[l]=!a||bt.all),s[l]}});return n};const C0=typeof window<"u"?Ke.useLayoutEffect:Ke.useEffect;var Mt=s=>typeof s=="string",A0=(s,t,r,a,n)=>Mt(s)?(a&&t.watch.add(s),de(r,s,n)):Array.isArray(s)?s.map(i=>(a&&t.watch.add(i),de(r,i))):(a&&(t.watchAll=!0),r),_a=s=>rt(s)||!ul(s);function Zt(s,t,r=new WeakSet){if(_a(s)||_a(t))return s===t;if(us(s)&&us(t))return s.getTime()===t.getTime();const a=Object.keys(s),n=Object.keys(t);if(a.length!==n.length)return!1;if(r.has(s)||r.has(t))return!0;r.add(s),r.add(t);for(const i of a){const l=s[i];if(!n.includes(i))return!1;if(i!=="ref"){const o=t[i];if(us(l)&&us(o)||Be(l)&&Be(o)||Array.isArray(l)&&Array.isArray(o)?!Zt(l,o,r):l!==o)return!1}}return!0}var hl=(s,t,r,a,n)=>t?{...r[s],types:{...r[s]&&r[s].types?r[s].types:{},[a]:n||!0}}:{},Gs=s=>Array.isArray(s)?s:[s],An=()=>{let s=[];return{get observers(){return s},next:n=>{for(const i of s)i.next&&i.next(n)},subscribe:n=>(s.push(n),{unsubscribe:()=>{s=s.filter(i=>i!==n)}}),unsubscribe:()=>{s=[]}}},nt=s=>Be(s)&&!Object.keys(s).length,Ja=s=>s.type==="file",vt=s=>typeof s=="function",Er=s=>{if(!Ka)return!1;const t=s?s.ownerDocument:0;return s instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},ml=s=>s.type==="select-multiple",Qa=s=>s.type==="radio",L0=s=>Qa(s)||mr(s),la=s=>Er(s)&&s.isConnected;function T0(s,t){const r=t.slice(0,-1).length;let a=0;for(;a<r;)s=Ue(s)?a++:s[t[a++]];return s}function M0(s){for(const t in s)if(s.hasOwnProperty(t)&&!Ue(s[t]))return!1;return!0}function Fe(s,t){const r=Array.isArray(t)?t:Yr(t)?[t]:Ga(t),a=r.length===1?s:T0(s,r),n=r.length-1,i=r[n];return a&&delete a[i],n!==0&&(Be(a)&&nt(a)||Array.isArray(a)&&M0(a))&&Fe(s,r.slice(0,-1)),s}var xl=s=>{for(const t in s)if(vt(s[t]))return!0;return!1};function Pr(s,t={}){const r=Array.isArray(s);if(Be(s)||r)for(const a in s)Array.isArray(s[a])||Be(s[a])&&!xl(s[a])?(t[a]=Array.isArray(s[a])?[]:{},Pr(s[a],t[a])):rt(s[a])||(t[a]=!0);return t}function gl(s,t,r){const a=Array.isArray(s);if(Be(s)||a)for(const n in s)Array.isArray(s[n])||Be(s[n])&&!xl(s[n])?Ue(t)||_a(r[n])?r[n]=Array.isArray(s[n])?Pr(s[n],[]):{...Pr(s[n])}:gl(s[n],rt(t)?{}:t[n],r[n]):r[n]=!Zt(s[n],t[n]);return r}var Vs=(s,t)=>gl(s,t,Pr(t));const Ln={value:!1,isValid:!1},Tn={value:!0,isValid:!0};var pl=s=>{if(Array.isArray(s)){if(s.length>1){const t=s.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return s[0].checked&&!s[0].disabled?s[0].attributes&&!Ue(s[0].attributes.value)?Ue(s[0].value)||s[0].value===""?Tn:{value:s[0].value,isValid:!0}:Tn:Ln}return Ln},fl=(s,{valueAsNumber:t,valueAsDate:r,setValueAs:a})=>Ue(s)?s:t?s===""?NaN:s&&+s:r&&Mt(s)?new Date(s):a?a(s):s;const Mn={isValid:!1,value:null};var yl=s=>Array.isArray(s)?s.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,Mn):Mn;function En(s){const t=s.ref;return Ja(t)?t.files:Qa(t)?yl(s.refs).value:ml(t)?[...t.selectedOptions].map(({value:r})=>r):mr(t)?pl(s.refs).value:fl(Ue(t.value)?s.ref.value:t.value,s)}var E0=(s,t,r,a)=>{const n={};for(const i of s){const l=de(t,i);l&&Ee(n,i,l._f)}return{criteriaMode:r,names:[...s],fields:n,shouldUseNativeValidation:a}},$r=s=>s instanceof RegExp,Hs=s=>Ue(s)?s:$r(s)?s.source:Be(s)?$r(s.value)?s.value.source:s.value:s,Pn=s=>({isOnSubmit:!s||s===bt.onSubmit,isOnBlur:s===bt.onBlur,isOnChange:s===bt.onChange,isOnAll:s===bt.all,isOnTouch:s===bt.onTouched});const $n="AsyncFunction";var P0=s=>!!s&&!!s.validate&&!!(vt(s.validate)&&s.validate.constructor.name===$n||Be(s.validate)&&Object.values(s.validate).find(t=>t.constructor.name===$n)),$0=s=>s.mount&&(s.required||s.min||s.max||s.maxLength||s.minLength||s.pattern||s.validate),In=(s,t,r)=>!r&&(t.watchAll||t.watch.has(s)||[...t.watch].some(a=>s.startsWith(a)&&/^\.\w+/.test(s.slice(a.length))));const Js=(s,t,r,a)=>{for(const n of r||Object.keys(s)){const i=de(s,n);if(i){const{_f:l,...o}=i;if(l){if(l.refs&&l.refs[0]&&t(l.refs[0],n)&&!a)return!0;if(l.ref&&t(l.ref,l.name)&&!a)return!0;if(Js(o,t))break}else if(Be(o)&&Js(o,t))break}}};function Dn(s,t,r){const a=de(s,r);if(a||Yr(r))return{error:a,name:r};const n=r.split(".");for(;n.length;){const i=n.join("."),l=de(t,i),o=de(s,i);if(l&&!Array.isArray(l)&&r!==i)return{name:r};if(o&&o.type)return{name:i,error:o};if(o&&o.root&&o.root.type)return{name:`${i}.root`,error:o.root};n.pop()}return{name:r}}var I0=(s,t,r,a)=>{r(s);const{name:n,...i}=s;return nt(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(l=>t[l]===(!a||bt.all))},D0=(s,t,r)=>!s||!t||s===t||Gs(s).some(a=>a&&(r?a===t:a.startsWith(t)||t.startsWith(a))),R0=(s,t,r,a,n)=>n.isOnAll?!1:!r&&n.isOnTouch?!(t||s):(r?a.isOnBlur:n.isOnBlur)?!s:(r?a.isOnChange:n.isOnChange)?s:!0,B0=(s,t)=>!Za(de(s,t)).length&&Fe(s,t),O0=(s,t,r)=>{const a=Gs(de(s,r));return Ee(a,"root",t[r]),Ee(s,r,a),s},_r=s=>Mt(s);function Rn(s,t,r="validate"){if(_r(s)||Array.isArray(s)&&s.every(_r)||St(s)&&!s)return{type:r,message:_r(s)?s:"",ref:t}}var ws=s=>Be(s)&&!$r(s)?s:{value:s,message:""},Bn=async(s,t,r,a,n,i)=>{const{ref:l,refs:o,required:c,maxLength:d,minLength:h,min:u,max:j,pattern:p,validate:f,name:x,valueAsNumber:y,mount:m}=s._f,g=de(r,x);if(!m||t.has(x))return{};const v=o?o[0]:l,P=K=>{n&&v.reportValidity&&(v.setCustomValidity(St(K)?"":K||""),v.reportValidity())},E={},A=Qa(l),T=mr(l),k=A||T,R=(y||Ja(l))&&Ue(l.value)&&Ue(g)||Er(l)&&l.value===""||g===""||Array.isArray(g)&&!g.length,se=hl.bind(null,x,a,E),z=(K,S,U,V=Dt.maxLength,le=Dt.minLength)=>{const C=K?S:U;E[x]={type:K?V:le,message:C,ref:l,...se(K?V:le,C)}};if(i?!Array.isArray(g)||!g.length:c&&(!k&&(R||rt(g))||St(g)&&!g||T&&!pl(o).isValid||A&&!yl(o).isValid)){const{value:K,message:S}=_r(c)?{value:!!c,message:c}:ws(c);if(K&&(E[x]={type:Dt.required,message:S,ref:v,...se(Dt.required,S)},!a))return P(S),E}if(!R&&(!rt(u)||!rt(j))){let K,S;const U=ws(j),V=ws(u);if(!rt(g)&&!isNaN(g)){const le=l.valueAsNumber||g&&+g;rt(U.value)||(K=le>U.value),rt(V.value)||(S=le<V.value)}else{const le=l.valueAsDate||new Date(g),C=_=>new Date(new Date().toDateString()+" "+_),B=l.type=="time",re=l.type=="week";Mt(U.value)&&g&&(K=B?C(g)>C(U.value):re?g>U.value:le>new Date(U.value)),Mt(V.value)&&g&&(S=B?C(g)<C(V.value):re?g<V.value:le<new Date(V.value))}if((K||S)&&(z(!!K,U.message,V.message,Dt.max,Dt.min),!a))return P(E[x].message),E}if((d||h)&&!R&&(Mt(g)||i&&Array.isArray(g))){const K=ws(d),S=ws(h),U=!rt(K.value)&&g.length>+K.value,V=!rt(S.value)&&g.length<+S.value;if((U||V)&&(z(U,K.message,S.message),!a))return P(E[x].message),E}if(p&&!R&&Mt(g)){const{value:K,message:S}=ws(p);if($r(K)&&!g.match(K)&&(E[x]={type:Dt.pattern,message:S,ref:l,...se(Dt.pattern,S)},!a))return P(S),E}if(f){if(vt(f)){const K=await f(g,r),S=Rn(K,v);if(S&&(E[x]={...S,...se(Dt.validate,S.message)},!a))return P(S.message),E}else if(Be(f)){let K={};for(const S in f){if(!nt(K)&&!a)break;const U=Rn(await f[S](g,r),v,S);U&&(K={...U,...se(S,U.message)},P(U.message),a&&(E[x]=K))}if(!nt(K)&&(E[x]={ref:v,...K},!a))return E}}return P(!0),E};const F0={mode:bt.onSubmit,reValidateMode:bt.onChange,shouldFocusError:!0};function z0(s={}){let t={...F0,...s},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:vt(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},a={},n=Be(t.defaultValues)||Be(t.values)?He(t.defaultValues||t.values)||{}:{},i=t.shouldUnregister?{}:He(n),l={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let u={...h};const j={array:An(),state:An()},p=t.criteriaMode===bt.all,f=N=>M=>{clearTimeout(d),d=setTimeout(N,M)},x=async N=>{if(!t.disabled&&(h.isValid||u.isValid||N)){const M=t.resolver?nt((await T()).errors):await R(a,!0);M!==r.isValid&&j.state.next({isValid:M})}},y=(N,M)=>{!t.disabled&&(h.isValidating||h.validatingFields||u.isValidating||u.validatingFields)&&((N||Array.from(o.mount)).forEach(I=>{I&&(M?Ee(r.validatingFields,I,M):Fe(r.validatingFields,I))}),j.state.next({validatingFields:r.validatingFields,isValidating:!nt(r.validatingFields)}))},m=(N,M=[],I,G,q=!0,Z=!0)=>{if(G&&I&&!t.disabled){if(l.action=!0,Z&&Array.isArray(de(a,N))){const ce=I(de(a,N),G.argA,G.argB);q&&Ee(a,N,ce)}if(Z&&Array.isArray(de(r.errors,N))){const ce=I(de(r.errors,N),G.argA,G.argB);q&&Ee(r.errors,N,ce),B0(r.errors,N)}if((h.touchedFields||u.touchedFields)&&Z&&Array.isArray(de(r.touchedFields,N))){const ce=I(de(r.touchedFields,N),G.argA,G.argB);q&&Ee(r.touchedFields,N,ce)}(h.dirtyFields||u.dirtyFields)&&(r.dirtyFields=Vs(n,i)),j.state.next({name:N,isDirty:z(N,M),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Ee(i,N,M)},g=(N,M)=>{Ee(r.errors,N,M),j.state.next({errors:r.errors})},v=N=>{r.errors=N,j.state.next({errors:r.errors,isValid:!1})},P=(N,M,I,G)=>{const q=de(a,N);if(q){const Z=de(i,N,Ue(I)?de(n,N):I);Ue(Z)||G&&G.defaultChecked||M?Ee(i,N,M?Z:En(q._f)):U(N,Z),l.mount&&x()}},E=(N,M,I,G,q)=>{let Z=!1,ce=!1;const Ce={name:N};if(!t.disabled){if(!I||G){(h.isDirty||u.isDirty)&&(ce=r.isDirty,r.isDirty=Ce.isDirty=z(),Z=ce!==Ce.isDirty);const Le=Zt(de(n,N),M);ce=!!de(r.dirtyFields,N),Le?Fe(r.dirtyFields,N):Ee(r.dirtyFields,N,!0),Ce.dirtyFields=r.dirtyFields,Z=Z||(h.dirtyFields||u.dirtyFields)&&ce!==!Le}if(I){const Le=de(r.touchedFields,N);Le||(Ee(r.touchedFields,N,I),Ce.touchedFields=r.touchedFields,Z=Z||(h.touchedFields||u.touchedFields)&&Le!==I)}Z&&q&&j.state.next(Ce)}return Z?Ce:{}},A=(N,M,I,G)=>{const q=de(r.errors,N),Z=(h.isValid||u.isValid)&&St(M)&&r.isValid!==M;if(t.delayError&&I?(c=f(()=>g(N,I)),c(t.delayError)):(clearTimeout(d),c=null,I?Ee(r.errors,N,I):Fe(r.errors,N)),(I?!Zt(q,I):q)||!nt(G)||Z){const ce={...G,...Z&&St(M)?{isValid:M}:{},errors:r.errors,name:N};r={...r,...ce},j.state.next(ce)}},T=async N=>{y(N,!0);const M=await t.resolver(i,t.context,E0(N||o.mount,a,t.criteriaMode,t.shouldUseNativeValidation));return y(N),M},k=async N=>{const{errors:M}=await T(N);if(N)for(const I of N){const G=de(M,I);G?Ee(r.errors,I,G):Fe(r.errors,I)}else r.errors=M;return M},R=async(N,M,I={valid:!0})=>{for(const G in N){const q=N[G];if(q){const{_f:Z,...ce}=q;if(Z){const Ce=o.array.has(Z.name),Le=q._f&&P0(q._f);Le&&h.validatingFields&&y([G],!0);const tt=await Bn(q,o.disabled,i,p,t.shouldUseNativeValidation&&!M,Ce);if(Le&&h.validatingFields&&y([G]),tt[Z.name]&&(I.valid=!1,M))break;!M&&(de(tt,Z.name)?Ce?O0(r.errors,tt,Z.name):Ee(r.errors,Z.name,tt[Z.name]):Fe(r.errors,Z.name))}!nt(ce)&&await R(ce,M,I)}}return I.valid},se=()=>{for(const N of o.unMount){const M=de(a,N);M&&(M._f.refs?M._f.refs.every(I=>!la(I)):!la(M._f.ref))&&W(N)}o.unMount=new Set},z=(N,M)=>!t.disabled&&(N&&M&&Ee(i,N,M),!Zt(_(),n)),K=(N,M,I)=>A0(N,o,{...l.mount?i:Ue(M)?n:Mt(N)?{[N]:M}:M},I,M),S=N=>Za(de(l.mount?i:n,N,t.shouldUnregister?de(n,N,[]):[])),U=(N,M,I={})=>{const G=de(a,N);let q=M;if(G){const Z=G._f;Z&&(!Z.disabled&&Ee(i,N,fl(M,Z)),q=Er(Z.ref)&&rt(M)?"":M,ml(Z.ref)?[...Z.ref.options].forEach(ce=>ce.selected=q.includes(ce.value)):Z.refs?mr(Z.ref)?Z.refs.forEach(ce=>{(!ce.defaultChecked||!ce.disabled)&&(Array.isArray(q)?ce.checked=!!q.find(Ce=>Ce===ce.value):ce.checked=q===ce.value||!!q)}):Z.refs.forEach(ce=>ce.checked=ce.value===q):Ja(Z.ref)?Z.ref.value="":(Z.ref.value=q,Z.ref.type||j.state.next({name:N,values:He(i)})))}(I.shouldDirty||I.shouldTouch)&&E(N,q,I.shouldTouch,I.shouldDirty,!0),I.shouldValidate&&re(N)},V=(N,M,I)=>{for(const G in M){if(!M.hasOwnProperty(G))return;const q=M[G],Z=N+"."+G,ce=de(a,Z);(o.array.has(N)||Be(q)||ce&&!ce._f)&&!us(q)?V(Z,q,I):U(Z,q,I)}},le=(N,M,I={})=>{const G=de(a,N),q=o.array.has(N),Z=He(M);Ee(i,N,Z),q?(j.array.next({name:N,values:He(i)}),(h.isDirty||h.dirtyFields||u.isDirty||u.dirtyFields)&&I.shouldDirty&&j.state.next({name:N,dirtyFields:Vs(n,i),isDirty:z(N,Z)})):G&&!G._f&&!rt(Z)?V(N,Z,I):U(N,Z,I),In(N,o)&&j.state.next({...r,name:N}),j.state.next({name:l.mount?N:void 0,values:He(i)})},C=async N=>{l.mount=!0;const M=N.target;let I=M.name,G=!0;const q=de(a,I),Z=Le=>{G=Number.isNaN(Le)||us(Le)&&isNaN(Le.getTime())||Zt(Le,de(i,I,Le))},ce=Pn(t.mode),Ce=Pn(t.reValidateMode);if(q){let Le,tt;const w=M.type?En(q._f):j0(N),ee=N.type===Cn.BLUR||N.type===Cn.FOCUS_OUT,Pe=!$0(q._f)&&!t.resolver&&!de(r.errors,I)&&!q._f.deps||R0(ee,de(r.touchedFields,I),r.isSubmitted,Ce,ce),Qe=In(I,o,ee);Ee(i,I,w),ee?(!M||!M.readOnly)&&(q._f.onBlur&&q._f.onBlur(N),c&&c(0)):q._f.onChange&&q._f.onChange(N);const ct=E(I,w,ee),Sl=!nt(ct)||Qe;if(!ee&&j.state.next({name:I,type:N.type,values:He(i)}),Pe)return(h.isValid||u.isValid)&&(t.mode==="onBlur"?ee&&x():ee||x()),Sl&&j.state.next({name:I,...Qe?{}:ct});if(!ee&&Qe&&j.state.next({...r}),t.resolver){const{errors:Ya}=await T([I]);if(Z(w),G){const _l=Dn(r.errors,a,I),en=Dn(Ya,a,_l.name||I);Le=en.error,I=en.name,tt=nt(Ya)}}else y([I],!0),Le=(await Bn(q,o.disabled,i,p,t.shouldUseNativeValidation))[I],y([I]),Z(w),G&&(Le?tt=!1:(h.isValid||u.isValid)&&(tt=await R(a,!0)));G&&(q._f.deps&&re(q._f.deps),A(I,tt,Le,ct))}},B=(N,M)=>{if(de(r.errors,M)&&N.focus)return N.focus(),1},re=async(N,M={})=>{let I,G;const q=Gs(N);if(t.resolver){const Z=await k(Ue(N)?N:q);I=nt(Z),G=N?!q.some(ce=>de(Z,ce)):I}else N?(G=(await Promise.all(q.map(async Z=>{const ce=de(a,Z);return await R(ce&&ce._f?{[Z]:ce}:ce)}))).every(Boolean),!(!G&&!r.isValid)&&x()):G=I=await R(a);return j.state.next({...!Mt(N)||(h.isValid||u.isValid)&&I!==r.isValid?{}:{name:N},...t.resolver||!N?{isValid:I}:{},errors:r.errors}),M.shouldFocus&&!G&&Js(a,B,N?q:o.mount),G},_=N=>{const M={...l.mount?i:n};return Ue(N)?M:Mt(N)?de(M,N):N.map(I=>de(M,I))},H=(N,M)=>({invalid:!!de((M||r).errors,N),isDirty:!!de((M||r).dirtyFields,N),error:de((M||r).errors,N),isValidating:!!de(r.validatingFields,N),isTouched:!!de((M||r).touchedFields,N)}),xe=N=>{N&&Gs(N).forEach(M=>Fe(r.errors,M)),j.state.next({errors:N?r.errors:{}})},_e=(N,M,I)=>{const G=(de(a,N,{_f:{}})._f||{}).ref,q=de(r.errors,N)||{},{ref:Z,message:ce,type:Ce,...Le}=q;Ee(r.errors,N,{...Le,...M,ref:G}),j.state.next({name:N,errors:r.errors,isValid:!1}),I&&I.shouldFocus&&G&&G.focus&&G.focus()},$e=(N,M)=>vt(N)?j.state.subscribe({next:I=>"values"in I&&N(K(void 0,M),I)}):K(N,M,!0),pe=N=>j.state.subscribe({next:M=>{D0(N.name,M.name,N.exact)&&I0(M,N.formState||h,ie,N.reRenderRoot)&&N.callback({values:{...i},...r,...M,defaultValues:n})}}).unsubscribe,X=N=>(l.mount=!0,u={...u,...N.formState},pe({...N,formState:u})),W=(N,M={})=>{for(const I of N?Gs(N):o.mount)o.mount.delete(I),o.array.delete(I),M.keepValue||(Fe(a,I),Fe(i,I)),!M.keepError&&Fe(r.errors,I),!M.keepDirty&&Fe(r.dirtyFields,I),!M.keepTouched&&Fe(r.touchedFields,I),!M.keepIsValidating&&Fe(r.validatingFields,I),!t.shouldUnregister&&!M.keepDefaultValue&&Fe(n,I);j.state.next({values:He(i)}),j.state.next({...r,...M.keepDirty?{isDirty:z()}:{}}),!M.keepIsValid&&x()},ne=({disabled:N,name:M})=>{(St(N)&&l.mount||N||o.disabled.has(M))&&(N?o.disabled.add(M):o.disabled.delete(M))},L=(N,M={})=>{let I=de(a,N);const G=St(M.disabled)||St(t.disabled);return Ee(a,N,{...I||{},_f:{...I&&I._f?I._f:{ref:{name:N}},name:N,mount:!0,...M}}),o.mount.add(N),I?ne({disabled:St(M.disabled)?M.disabled:t.disabled,name:N}):P(N,!0,M.value),{...G?{disabled:M.disabled||t.disabled}:{},...t.progressive?{required:!!M.required,min:Hs(M.min),max:Hs(M.max),minLength:Hs(M.minLength),maxLength:Hs(M.maxLength),pattern:Hs(M.pattern)}:{},name:N,onChange:C,onBlur:C,ref:q=>{if(q){L(N,M),I=de(a,N);const Z=Ue(q.value)&&q.querySelectorAll&&q.querySelectorAll("input,select,textarea")[0]||q,ce=L0(Z),Ce=I._f.refs||[];if(ce?Ce.find(Le=>Le===Z):Z===I._f.ref)return;Ee(a,N,{_f:{...I._f,...ce?{refs:[...Ce.filter(la),Z,...Array.isArray(de(n,N))?[{}]:[]],ref:{type:Z.type,name:N}}:{ref:Z}}}),P(N,!1,void 0,Z)}else I=de(a,N,{}),I._f&&(I._f.mount=!1),(t.shouldUnregister||M.shouldUnregister)&&!(N0(o.array,N)&&l.action)&&o.unMount.add(N)}}},ae=()=>t.shouldFocusError&&Js(a,B,o.mount),ge=N=>{St(N)&&(j.state.next({disabled:N}),Js(a,(M,I)=>{const G=de(a,I);G&&(M.disabled=G._f.disabled||N,Array.isArray(G._f.refs)&&G._f.refs.forEach(q=>{q.disabled=G._f.disabled||N}))},0,!1))},fe=(N,M)=>async I=>{let G;I&&(I.preventDefault&&I.preventDefault(),I.persist&&I.persist());let q=He(i);if(j.state.next({isSubmitting:!0}),t.resolver){const{errors:Z,values:ce}=await T();r.errors=Z,q=He(ce)}else await R(a);if(o.disabled.size)for(const Z of o.disabled)Fe(q,Z);if(Fe(r.errors,"root"),nt(r.errors)){j.state.next({errors:{}});try{await N(q,I)}catch(Z){G=Z}}else M&&await M({...r.errors},I),ae(),setTimeout(ae);if(j.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:nt(r.errors)&&!G,submitCount:r.submitCount+1,errors:r.errors}),G)throw G},Je=(N,M={})=>{de(a,N)&&(Ue(M.defaultValue)?le(N,He(de(n,N))):(le(N,M.defaultValue),Ee(n,N,He(M.defaultValue))),M.keepTouched||Fe(r.touchedFields,N),M.keepDirty||(Fe(r.dirtyFields,N),r.isDirty=M.defaultValue?z(N,He(de(n,N))):z()),M.keepError||(Fe(r.errors,N),h.isValid&&x()),j.state.next({...r}))},$=(N,M={})=>{const I=N?He(N):n,G=He(I),q=nt(N),Z=q?n:G;if(M.keepDefaultValues||(n=I),!M.keepValues){if(M.keepDirtyValues){const ce=new Set([...o.mount,...Object.keys(Vs(n,i))]);for(const Ce of Array.from(ce))de(r.dirtyFields,Ce)?Ee(Z,Ce,de(i,Ce)):le(Ce,de(Z,Ce))}else{if(Ka&&Ue(N))for(const ce of o.mount){const Ce=de(a,ce);if(Ce&&Ce._f){const Le=Array.isArray(Ce._f.refs)?Ce._f.refs[0]:Ce._f.ref;if(Er(Le)){const tt=Le.closest("form");if(tt){tt.reset();break}}}}if(M.keepFieldsRef)for(const ce of o.mount)le(ce,de(Z,ce));else a={}}i=t.shouldUnregister?M.keepDefaultValues?He(n):{}:He(Z),j.array.next({values:{...Z}}),j.state.next({values:{...Z}})}o={mount:M.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!h.isValid||!!M.keepIsValid||!!M.keepDirtyValues,l.watch=!!t.shouldUnregister,j.state.next({submitCount:M.keepSubmitCount?r.submitCount:0,isDirty:q?!1:M.keepDirty?r.isDirty:!!(M.keepDefaultValues&&!Zt(N,n)),isSubmitted:M.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:q?{}:M.keepDirtyValues?M.keepDefaultValues&&i?Vs(n,i):r.dirtyFields:M.keepDefaultValues&&N?Vs(n,N):M.keepDirty?r.dirtyFields:{},touchedFields:M.keepTouched?r.touchedFields:{},errors:M.keepErrors?r.errors:{},isSubmitSuccessful:M.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:n})},ye=(N,M)=>$(vt(N)?N(i):N,M),De=(N,M={})=>{const I=de(a,N),G=I&&I._f;if(G){const q=G.refs?G.refs[0]:G.ref;q.focus&&(q.focus(),M.shouldSelect&&vt(q.select)&&q.select())}},ie=N=>{r={...r,...N}},ke={control:{register:L,unregister:W,getFieldState:H,handleSubmit:fe,setError:_e,_subscribe:pe,_runSchema:T,_focusError:ae,_getWatch:K,_getDirty:z,_setValid:x,_setFieldArray:m,_setDisabledField:ne,_setErrors:v,_getFieldArray:S,_reset:$,_resetDefaultValues:()=>vt(t.defaultValues)&&t.defaultValues().then(N=>{ye(N,t.resetOptions),j.state.next({isLoading:!1})}),_removeUnmounted:se,_disableForm:ge,_subjects:j,_proxyFormState:h,get _fields(){return a},get _formValues(){return i},get _state(){return l},set _state(N){l=N},get _defaultValues(){return n},get _names(){return o},set _names(N){o=N},get _formState(){return r},get _options(){return t},set _options(N){t={...t,...N}}},subscribe:X,trigger:re,register:L,handleSubmit:fe,watch:$e,setValue:le,getValues:_,reset:ye,resetField:Je,clearErrors:xe,unregister:W,setError:_e,setFocus:De,getFieldState:H};return{...ke,formControl:ke}}function U0(s={}){const t=Ke.useRef(void 0),r=Ke.useRef(void 0),[a,n]=Ke.useState({isDirty:!1,isValidating:!1,isLoading:vt(s.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1,isReady:!1,defaultValues:vt(s.defaultValues)?void 0:s.defaultValues});if(!t.current)if(s.formControl)t.current={...s.formControl,formState:a},s.defaultValues&&!vt(s.defaultValues)&&s.formControl.reset(s.defaultValues,s.resetOptions);else{const{formControl:l,...o}=z0(s);t.current={...o,formState:a}}const i=t.current.control;return i._options=s,C0(()=>{const l=i._subscribe({formState:i._proxyFormState,callback:()=>n({...i._formState}),reRenderRoot:!0});return n(o=>({...o,isReady:!0})),i._formState.isReady=!0,l},[i]),Ke.useEffect(()=>i._disableForm(s.disabled),[i,s.disabled]),Ke.useEffect(()=>{s.mode&&(i._options.mode=s.mode),s.reValidateMode&&(i._options.reValidateMode=s.reValidateMode)},[i,s.mode,s.reValidateMode]),Ke.useEffect(()=>{s.errors&&(i._setErrors(s.errors),i._focusError())},[i,s.errors]),Ke.useEffect(()=>{s.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,s.shouldUnregister]),Ke.useEffect(()=>{if(i._proxyFormState.isDirty){const l=i._getDirty();l!==a.isDirty&&i._subjects.state.next({isDirty:l})}},[i,a.isDirty]),Ke.useEffect(()=>{s.values&&!Zt(s.values,r.current)?(i._reset(s.values,{keepFieldsRef:!0,...i._options.resetOptions}),r.current=s.values,n(l=>({...l}))):i._resetDefaultValues()},[i,s.values]),Ke.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),t.current.formState=_0(a,i),t.current}const On=(s,t,r)=>{if(s&&"reportValidity"in s){const a=de(r,t);s.setCustomValidity(a&&a.message||""),s.reportValidity()}},bl=(s,t)=>{for(const r in t.fields){const a=t.fields[r];a&&a.ref&&"reportValidity"in a.ref?On(a.ref,r,s):a.refs&&a.refs.forEach(n=>On(n,r,s))}},W0=(s,t)=>{t.shouldUseNativeValidation&&bl(s,t);const r={};for(const a in s){const n=de(t.fields,a),i=Object.assign(s[a]||{},{ref:n&&n.ref});if(V0(t.names||Object.keys(s),a)){const l=Object.assign({},de(r,a));Ee(l,"root",i),Ee(r,a,l)}else Ee(r,a,i)}return r},V0=(s,t)=>s.some(r=>r.startsWith(t+"."));var H0=function(s,t){for(var r={};s.length;){var a=s[0],n=a.code,i=a.message,l=a.path.join(".");if(!r[l])if("unionErrors"in a){var o=a.unionErrors[0].errors[0];r[l]={message:o.message,type:o.code}}else r[l]={message:i,type:n};if("unionErrors"in a&&a.unionErrors.forEach(function(h){return h.errors.forEach(function(u){return s.push(u)})}),t){var c=r[l].types,d=c&&c[a.code];r[l]=hl(l,t,r,n,d?[].concat(d,a.message):a.message)}s.shift()}return r},q0=function(s,t,r){return r===void 0&&(r={}),function(a,n,i){try{return Promise.resolve(function(l,o){try{var c=Promise.resolve(s[r.mode==="sync"?"parse":"parseAsync"](a,t)).then(function(d){return i.shouldUseNativeValidation&&bl({},i),{errors:{},values:r.raw?a:d}})}catch(d){return o(d)}return c&&c.then?c.then(void 0,o):c}(0,function(l){if(function(o){return Array.isArray(o==null?void 0:o.errors)}(l))return{values:{},errors:W0(H0(l.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw l}))}catch(l){return Promise.reject(l)}}},Me;(function(s){s.assertEqual=n=>{};function t(n){}s.assertIs=t;function r(n){throw new Error}s.assertNever=r,s.arrayToEnum=n=>{const i={};for(const l of n)i[l]=l;return i},s.getValidEnumValues=n=>{const i=s.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),l={};for(const o of i)l[o]=n[o];return s.objectValues(l)},s.objectValues=n=>s.objectKeys(n).map(function(i){return n[i]}),s.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const i=[];for(const l in n)Object.prototype.hasOwnProperty.call(n,l)&&i.push(l);return i},s.find=(n,i)=>{for(const l of n)if(i(l))return l},s.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&Number.isFinite(n)&&Math.floor(n)===n;function a(n,i=" | "){return n.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}s.joinValues=a,s.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(Me||(Me={}));var Fn;(function(s){s.mergeShapes=(t,r)=>({...t,...r})})(Fn||(Fn={}));const ue=Me.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),qt=s=>{switch(typeof s){case"undefined":return ue.undefined;case"string":return ue.string;case"number":return Number.isNaN(s)?ue.nan:ue.number;case"boolean":return ue.boolean;case"function":return ue.function;case"bigint":return ue.bigint;case"symbol":return ue.symbol;case"object":return Array.isArray(s)?ue.array:s===null?ue.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?ue.promise:typeof Map<"u"&&s instanceof Map?ue.map:typeof Set<"u"&&s instanceof Set?ue.set:typeof Date<"u"&&s instanceof Date?ue.date:ue.object;default:return ue.unknown}},Y=Me.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Ft extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},a={_errors:[]},n=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(n);else if(l.code==="invalid_return_type")n(l.returnTypeError);else if(l.code==="invalid_arguments")n(l.argumentsError);else if(l.path.length===0)a._errors.push(r(l));else{let o=a,c=0;for(;c<l.path.length;){const d=l.path[c];c===l.path.length-1?(o[d]=o[d]||{_errors:[]},o[d]._errors.push(r(l))):o[d]=o[d]||{_errors:[]},o=o[d],c++}}};return n(this),a}static assert(t){if(!(t instanceof Ft))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Me.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},a=[];for(const n of this.issues)if(n.path.length>0){const i=n.path[0];r[i]=r[i]||[],r[i].push(t(n))}else a.push(t(n));return{formErrors:a,fieldErrors:r}}get formErrors(){return this.flatten()}}Ft.create=s=>new Ft(s);const Ca=(s,t)=>{let r;switch(s.code){case Y.invalid_type:s.received===ue.undefined?r="Required":r=`Expected ${s.expected}, received ${s.received}`;break;case Y.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(s.expected,Me.jsonStringifyReplacer)}`;break;case Y.unrecognized_keys:r=`Unrecognized key(s) in object: ${Me.joinValues(s.keys,", ")}`;break;case Y.invalid_union:r="Invalid input";break;case Y.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Me.joinValues(s.options)}`;break;case Y.invalid_enum_value:r=`Invalid enum value. Expected ${Me.joinValues(s.options)}, received '${s.received}'`;break;case Y.invalid_arguments:r="Invalid function arguments";break;case Y.invalid_return_type:r="Invalid function return type";break;case Y.invalid_date:r="Invalid date";break;case Y.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(r=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?r=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?r=`Invalid input: must end with "${s.validation.endsWith}"`:Me.assertNever(s.validation):s.validation!=="regex"?r=`Invalid ${s.validation}`:r="Invalid";break;case Y.too_small:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="bigint"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:r="Invalid input";break;case Y.too_big:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?r=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:r="Invalid input";break;case Y.custom:r="Invalid input";break;case Y.invalid_intersection_types:r="Intersection results could not be merged";break;case Y.not_multiple_of:r=`Number must be a multiple of ${s.multipleOf}`;break;case Y.not_finite:r="Number must be finite";break;default:r=t.defaultError,Me.assertNever(s)}return{message:r}};let K0=Ca;function Z0(){return K0}const G0=s=>{const{data:t,path:r,errorMaps:a,issueData:n}=s,i=[...r,...n.path||[]],l={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let o="";const c=a.filter(d=>!!d).slice().reverse();for(const d of c)o=d(l,{data:t,defaultError:o}).message;return{...n,path:i,message:o}};function oe(s,t){const r=Z0(),a=G0({issueData:t,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,r,r===Ca?void 0:Ca].filter(n=>!!n)});s.common.issues.push(a)}class mt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const a=[];for(const n of r){if(n.status==="aborted")return be;n.status==="dirty"&&t.dirty(),a.push(n.value)}return{status:t.value,value:a}}static async mergeObjectAsync(t,r){const a=[];for(const n of r){const i=await n.key,l=await n.value;a.push({key:i,value:l})}return mt.mergeObjectSync(t,a)}static mergeObjectSync(t,r){const a={};for(const n of r){const{key:i,value:l}=n;if(i.status==="aborted"||l.status==="aborted")return be;i.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof l.value<"u"||n.alwaysSet)&&(a[i.value]=l.value)}return{status:t.value,value:a}}}const be=Object.freeze({status:"aborted"}),Ks=s=>({status:"dirty",value:s}),gt=s=>({status:"valid",value:s}),zn=s=>s.status==="aborted",Un=s=>s.status==="dirty",Rs=s=>s.status==="valid",Ir=s=>typeof Promise<"u"&&s instanceof Promise;var me;(function(s){s.errToObj=t=>typeof t=="string"?{message:t}:t||{},s.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(me||(me={}));class ss{constructor(t,r,a,n){this._cachedPath=[],this.parent=t,this.data=r,this._path=a,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Wn=(s,t)=>{if(Rs(t))return{success:!0,data:t.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Ft(s.common.issues);return this._error=r,this._error}}};function Se(s){if(!s)return{};const{errorMap:t,invalid_type_error:r,required_error:a,description:n}=s;if(t&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:n}:{errorMap:(l,o)=>{const{message:c}=s;return l.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:c??a??o.defaultError}:l.code!=="invalid_type"?{message:o.defaultError}:{message:c??r??o.defaultError}},description:n}}class Ae{get description(){return this._def.description}_getType(t){return qt(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:qt(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new mt,ctx:{common:t.parent.common,data:t.data,parsedType:qt(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(Ir(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const a=this.safeParse(t,r);if(a.success)return a.data;throw a.error}safeParse(t,r){const a={common:{issues:[],async:(r==null?void 0:r.async)??!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:qt(t)},n=this._parseSync({data:t,path:a.path,parent:a});return Wn(a,n)}"~validate"(t){var a,n;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:qt(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:r});return Rs(i)?{value:i.value}:{issues:r.common.issues}}catch(i){(n=(a=i==null?void 0:i.message)==null?void 0:a.toLowerCase())!=null&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(i=>Rs(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(t,r){const a=await this.safeParseAsync(t,r);if(a.success)return a.data;throw a.error}async safeParseAsync(t,r){const a={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:qt(t)},n=this._parse({data:t,path:a.path,parent:a}),i=await(Ir(n)?n:Promise.resolve(n));return Wn(a,i)}refine(t,r){const a=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,i)=>{const l=t(n),o=()=>i.addIssue({code:Y.custom,...a(n)});return typeof Promise<"u"&&l instanceof Promise?l.then(c=>c?!0:(o(),!1)):l?!0:(o(),!1)})}refinement(t,r){return this._refinement((a,n)=>t(a)?!0:(n.addIssue(typeof r=="function"?r(a,n):r),!1))}_refinement(t){return new Os({schema:this,typeName:ve.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return ts.create(this,this._def)}nullable(){return Fs.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Et.create(this)}promise(){return Or.create(this,this._def)}or(t){return Rr.create([this,t],this._def)}and(t){return Br.create(this,t,this._def)}transform(t){return new Os({...Se(this._def),schema:this,typeName:ve.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new La({...Se(this._def),innerType:this,defaultValue:r,typeName:ve.ZodDefault})}brand(){return new yu({typeName:ve.ZodBranded,type:this,...Se(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new Ta({...Se(this._def),innerType:this,catchValue:r,typeName:ve.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return Xa.create(this,t)}readonly(){return Ma.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const J0=/^c[^\s-]{8,}$/i,Q0=/^[0-9a-z]+$/,X0=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Y0=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,eu=/^[a-z0-9_-]{21}$/i,tu=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,su=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ru=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,au="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let oa;const nu=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,iu=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,lu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ou=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,cu=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,du=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,vl="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",uu=new RegExp(`^${vl}$`);function jl(s){let t="[0-5]\\d";s.precision?t=`${t}\\.\\d{${s.precision}}`:s.precision==null&&(t=`${t}(\\.\\d+)?`);const r=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function hu(s){return new RegExp(`^${jl(s)}$`)}function mu(s){let t=`${vl}T${jl(s)}`;const r=[];return r.push(s.local?"Z?":"Z"),s.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function xu(s,t){return!!((t==="v4"||!t)&&nu.test(s)||(t==="v6"||!t)&&lu.test(s))}function gu(s,t){if(!tu.test(s))return!1;try{const[r]=s.split(".");if(!r)return!1;const a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(a));return!(typeof n!="object"||n===null||"typ"in n&&(n==null?void 0:n.typ)!=="JWT"||!n.alg||t&&n.alg!==t)}catch{return!1}}function pu(s,t){return!!((t==="v4"||!t)&&iu.test(s)||(t==="v6"||!t)&&ou.test(s))}class es extends Ae{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ue.string){const i=this._getOrReturnCtx(t);return oe(i,{code:Y.invalid_type,expected:ue.string,received:i.parsedType}),be}const a=new mt;let n;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(n=this._getOrReturnCtx(t,n),oe(n,{code:Y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),a.dirty());else if(i.kind==="max")t.data.length>i.value&&(n=this._getOrReturnCtx(t,n),oe(n,{code:Y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),a.dirty());else if(i.kind==="length"){const l=t.data.length>i.value,o=t.data.length<i.value;(l||o)&&(n=this._getOrReturnCtx(t,n),l?oe(n,{code:Y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&oe(n,{code:Y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),a.dirty())}else if(i.kind==="email")ru.test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"email",code:Y.invalid_string,message:i.message}),a.dirty());else if(i.kind==="emoji")oa||(oa=new RegExp(au,"u")),oa.test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"emoji",code:Y.invalid_string,message:i.message}),a.dirty());else if(i.kind==="uuid")Y0.test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"uuid",code:Y.invalid_string,message:i.message}),a.dirty());else if(i.kind==="nanoid")eu.test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"nanoid",code:Y.invalid_string,message:i.message}),a.dirty());else if(i.kind==="cuid")J0.test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"cuid",code:Y.invalid_string,message:i.message}),a.dirty());else if(i.kind==="cuid2")Q0.test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"cuid2",code:Y.invalid_string,message:i.message}),a.dirty());else if(i.kind==="ulid")X0.test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"ulid",code:Y.invalid_string,message:i.message}),a.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{n=this._getOrReturnCtx(t,n),oe(n,{validation:"url",code:Y.invalid_string,message:i.message}),a.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"regex",code:Y.invalid_string,message:i.message}),a.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(t,n),oe(n,{code:Y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),a.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(n=this._getOrReturnCtx(t,n),oe(n,{code:Y.invalid_string,validation:{startsWith:i.value},message:i.message}),a.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(n=this._getOrReturnCtx(t,n),oe(n,{code:Y.invalid_string,validation:{endsWith:i.value},message:i.message}),a.dirty()):i.kind==="datetime"?mu(i).test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{code:Y.invalid_string,validation:"datetime",message:i.message}),a.dirty()):i.kind==="date"?uu.test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{code:Y.invalid_string,validation:"date",message:i.message}),a.dirty()):i.kind==="time"?hu(i).test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{code:Y.invalid_string,validation:"time",message:i.message}),a.dirty()):i.kind==="duration"?su.test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"duration",code:Y.invalid_string,message:i.message}),a.dirty()):i.kind==="ip"?xu(t.data,i.version)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"ip",code:Y.invalid_string,message:i.message}),a.dirty()):i.kind==="jwt"?gu(t.data,i.alg)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"jwt",code:Y.invalid_string,message:i.message}),a.dirty()):i.kind==="cidr"?pu(t.data,i.version)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"cidr",code:Y.invalid_string,message:i.message}),a.dirty()):i.kind==="base64"?cu.test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"base64",code:Y.invalid_string,message:i.message}),a.dirty()):i.kind==="base64url"?du.test(t.data)||(n=this._getOrReturnCtx(t,n),oe(n,{validation:"base64url",code:Y.invalid_string,message:i.message}),a.dirty()):Me.assertNever(i);return{status:a.value,value:t.data}}_regex(t,r,a){return this.refinement(n=>t.test(n),{validation:r,code:Y.invalid_string,...me.errToObj(a)})}_addCheck(t){return new es({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...me.errToObj(t)})}url(t){return this._addCheck({kind:"url",...me.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...me.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...me.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...me.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...me.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...me.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...me.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...me.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...me.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...me.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...me.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...me.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...me.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...me.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...me.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...me.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...me.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...me.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...me.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...me.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...me.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...me.errToObj(r)})}nonempty(t){return this.min(1,me.errToObj(t))}trim(){return new es({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new es({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new es({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}es.create=s=>new es({checks:[],typeName:ve.ZodString,coerce:(s==null?void 0:s.coerce)??!1,...Se(s)});function fu(s,t){const r=(s.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,n=r>a?r:a,i=Number.parseInt(s.toFixed(n).replace(".","")),l=Number.parseInt(t.toFixed(n).replace(".",""));return i%l/10**n}class sr extends Ae{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ue.number){const i=this._getOrReturnCtx(t);return oe(i,{code:Y.invalid_type,expected:ue.number,received:i.parsedType}),be}let a;const n=new mt;for(const i of this._def.checks)i.kind==="int"?Me.isInteger(t.data)||(a=this._getOrReturnCtx(t,a),oe(a,{code:Y.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(a=this._getOrReturnCtx(t,a),oe(a,{code:Y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(a=this._getOrReturnCtx(t,a),oe(a,{code:Y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?fu(t.data,i.value)!==0&&(a=this._getOrReturnCtx(t,a),oe(a,{code:Y.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(a=this._getOrReturnCtx(t,a),oe(a,{code:Y.not_finite,message:i.message}),n.dirty()):Me.assertNever(i);return{status:n.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,me.toString(r))}gt(t,r){return this.setLimit("min",t,!1,me.toString(r))}lte(t,r){return this.setLimit("max",t,!0,me.toString(r))}lt(t,r){return this.setLimit("max",t,!1,me.toString(r))}setLimit(t,r,a,n){return new sr({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:a,message:me.toString(n)}]})}_addCheck(t){return new sr({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:me.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:me.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:me.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:me.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:me.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:me.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:me.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:me.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:me.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Me.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return!0;a.kind==="min"?(r===null||a.value>r)&&(r=a.value):a.kind==="max"&&(t===null||a.value<t)&&(t=a.value)}return Number.isFinite(r)&&Number.isFinite(t)}}sr.create=s=>new sr({checks:[],typeName:ve.ZodNumber,coerce:(s==null?void 0:s.coerce)||!1,...Se(s)});class rr extends Ae{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==ue.bigint)return this._getInvalidInput(t);let a;const n=new mt;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(a=this._getOrReturnCtx(t,a),oe(a,{code:Y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(a=this._getOrReturnCtx(t,a),oe(a,{code:Y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(a=this._getOrReturnCtx(t,a),oe(a,{code:Y.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):Me.assertNever(i);return{status:n.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return oe(r,{code:Y.invalid_type,expected:ue.bigint,received:r.parsedType}),be}gte(t,r){return this.setLimit("min",t,!0,me.toString(r))}gt(t,r){return this.setLimit("min",t,!1,me.toString(r))}lte(t,r){return this.setLimit("max",t,!0,me.toString(r))}lt(t,r){return this.setLimit("max",t,!1,me.toString(r))}setLimit(t,r,a,n){return new rr({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:a,message:me.toString(n)}]})}_addCheck(t){return new rr({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:me.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:me.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:me.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:me.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:me.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}rr.create=s=>new rr({checks:[],typeName:ve.ZodBigInt,coerce:(s==null?void 0:s.coerce)??!1,...Se(s)});class Vn extends Ae{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==ue.boolean){const a=this._getOrReturnCtx(t);return oe(a,{code:Y.invalid_type,expected:ue.boolean,received:a.parsedType}),be}return gt(t.data)}}Vn.create=s=>new Vn({typeName:ve.ZodBoolean,coerce:(s==null?void 0:s.coerce)||!1,...Se(s)});class Dr extends Ae{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ue.date){const i=this._getOrReturnCtx(t);return oe(i,{code:Y.invalid_type,expected:ue.date,received:i.parsedType}),be}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return oe(i,{code:Y.invalid_date}),be}const a=new mt;let n;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(n=this._getOrReturnCtx(t,n),oe(n,{code:Y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),a.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(n=this._getOrReturnCtx(t,n),oe(n,{code:Y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),a.dirty()):Me.assertNever(i);return{status:a.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Dr({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:me.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:me.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}Dr.create=s=>new Dr({checks:[],coerce:(s==null?void 0:s.coerce)||!1,typeName:ve.ZodDate,...Se(s)});class Hn extends Ae{_parse(t){if(this._getType(t)!==ue.symbol){const a=this._getOrReturnCtx(t);return oe(a,{code:Y.invalid_type,expected:ue.symbol,received:a.parsedType}),be}return gt(t.data)}}Hn.create=s=>new Hn({typeName:ve.ZodSymbol,...Se(s)});class qn extends Ae{_parse(t){if(this._getType(t)!==ue.undefined){const a=this._getOrReturnCtx(t);return oe(a,{code:Y.invalid_type,expected:ue.undefined,received:a.parsedType}),be}return gt(t.data)}}qn.create=s=>new qn({typeName:ve.ZodUndefined,...Se(s)});class Kn extends Ae{_parse(t){if(this._getType(t)!==ue.null){const a=this._getOrReturnCtx(t);return oe(a,{code:Y.invalid_type,expected:ue.null,received:a.parsedType}),be}return gt(t.data)}}Kn.create=s=>new Kn({typeName:ve.ZodNull,...Se(s)});class Zn extends Ae{constructor(){super(...arguments),this._any=!0}_parse(t){return gt(t.data)}}Zn.create=s=>new Zn({typeName:ve.ZodAny,...Se(s)});class Gn extends Ae{constructor(){super(...arguments),this._unknown=!0}_parse(t){return gt(t.data)}}Gn.create=s=>new Gn({typeName:ve.ZodUnknown,...Se(s)});class rs extends Ae{_parse(t){const r=this._getOrReturnCtx(t);return oe(r,{code:Y.invalid_type,expected:ue.never,received:r.parsedType}),be}}rs.create=s=>new rs({typeName:ve.ZodNever,...Se(s)});class Jn extends Ae{_parse(t){if(this._getType(t)!==ue.undefined){const a=this._getOrReturnCtx(t);return oe(a,{code:Y.invalid_type,expected:ue.void,received:a.parsedType}),be}return gt(t.data)}}Jn.create=s=>new Jn({typeName:ve.ZodVoid,...Se(s)});class Et extends Ae{_parse(t){const{ctx:r,status:a}=this._processInputParams(t),n=this._def;if(r.parsedType!==ue.array)return oe(r,{code:Y.invalid_type,expected:ue.array,received:r.parsedType}),be;if(n.exactLength!==null){const l=r.data.length>n.exactLength.value,o=r.data.length<n.exactLength.value;(l||o)&&(oe(r,{code:l?Y.too_big:Y.too_small,minimum:o?n.exactLength.value:void 0,maximum:l?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),a.dirty())}if(n.minLength!==null&&r.data.length<n.minLength.value&&(oe(r,{code:Y.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),a.dirty()),n.maxLength!==null&&r.data.length>n.maxLength.value&&(oe(r,{code:Y.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),a.dirty()),r.common.async)return Promise.all([...r.data].map((l,o)=>n.type._parseAsync(new ss(r,l,r.path,o)))).then(l=>mt.mergeArray(a,l));const i=[...r.data].map((l,o)=>n.type._parseSync(new ss(r,l,r.path,o)));return mt.mergeArray(a,i)}get element(){return this._def.type}min(t,r){return new Et({...this._def,minLength:{value:t,message:me.toString(r)}})}max(t,r){return new Et({...this._def,maxLength:{value:t,message:me.toString(r)}})}length(t,r){return new Et({...this._def,exactLength:{value:t,message:me.toString(r)}})}nonempty(t){return this.min(1,t)}}Et.create=(s,t)=>new Et({type:s,minLength:null,maxLength:null,exactLength:null,typeName:ve.ZodArray,...Se(t)});function ks(s){if(s instanceof ze){const t={};for(const r in s.shape){const a=s.shape[r];t[r]=ts.create(ks(a))}return new ze({...s._def,shape:()=>t})}else return s instanceof Et?new Et({...s._def,type:ks(s.element)}):s instanceof ts?ts.create(ks(s.unwrap())):s instanceof Fs?Fs.create(ks(s.unwrap())):s instanceof vs?vs.create(s.items.map(t=>ks(t))):s}class ze extends Ae{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Me.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==ue.object){const d=this._getOrReturnCtx(t);return oe(d,{code:Y.invalid_type,expected:ue.object,received:d.parsedType}),be}const{status:a,ctx:n}=this._processInputParams(t),{shape:i,keys:l}=this._getCached(),o=[];if(!(this._def.catchall instanceof rs&&this._def.unknownKeys==="strip"))for(const d in n.data)l.includes(d)||o.push(d);const c=[];for(const d of l){const h=i[d],u=n.data[d];c.push({key:{status:"valid",value:d},value:h._parse(new ss(n,u,n.path,d)),alwaysSet:d in n.data})}if(this._def.catchall instanceof rs){const d=this._def.unknownKeys;if(d==="passthrough")for(const h of o)c.push({key:{status:"valid",value:h},value:{status:"valid",value:n.data[h]}});else if(d==="strict")o.length>0&&(oe(n,{code:Y.unrecognized_keys,keys:o}),a.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const h of o){const u=n.data[h];c.push({key:{status:"valid",value:h},value:d._parse(new ss(n,u,n.path,h)),alwaysSet:h in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const d=[];for(const h of c){const u=await h.key,j=await h.value;d.push({key:u,value:j,alwaysSet:h.alwaysSet})}return d}).then(d=>mt.mergeObjectSync(a,d)):mt.mergeObjectSync(a,c)}get shape(){return this._def.shape()}strict(t){return me.errToObj,new ze({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,a)=>{var i,l;const n=((l=(i=this._def).errorMap)==null?void 0:l.call(i,r,a).message)??a.defaultError;return r.code==="unrecognized_keys"?{message:me.errToObj(t).message??n}:{message:n}}}:{}})}strip(){return new ze({...this._def,unknownKeys:"strip"})}passthrough(){return new ze({...this._def,unknownKeys:"passthrough"})}extend(t){return new ze({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new ze({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:ve.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new ze({...this._def,catchall:t})}pick(t){const r={};for(const a of Me.objectKeys(t))t[a]&&this.shape[a]&&(r[a]=this.shape[a]);return new ze({...this._def,shape:()=>r})}omit(t){const r={};for(const a of Me.objectKeys(this.shape))t[a]||(r[a]=this.shape[a]);return new ze({...this._def,shape:()=>r})}deepPartial(){return ks(this)}partial(t){const r={};for(const a of Me.objectKeys(this.shape)){const n=this.shape[a];t&&!t[a]?r[a]=n:r[a]=n.optional()}return new ze({...this._def,shape:()=>r})}required(t){const r={};for(const a of Me.objectKeys(this.shape))if(t&&!t[a])r[a]=this.shape[a];else{let i=this.shape[a];for(;i instanceof ts;)i=i._def.innerType;r[a]=i}return new ze({...this._def,shape:()=>r})}keyof(){return wl(Me.objectKeys(this.shape))}}ze.create=(s,t)=>new ze({shape:()=>s,unknownKeys:"strip",catchall:rs.create(),typeName:ve.ZodObject,...Se(t)});ze.strictCreate=(s,t)=>new ze({shape:()=>s,unknownKeys:"strict",catchall:rs.create(),typeName:ve.ZodObject,...Se(t)});ze.lazycreate=(s,t)=>new ze({shape:s,unknownKeys:"strip",catchall:rs.create(),typeName:ve.ZodObject,...Se(t)});class Rr extends Ae{_parse(t){const{ctx:r}=this._processInputParams(t),a=this._def.options;function n(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const l=i.map(o=>new Ft(o.ctx.common.issues));return oe(r,{code:Y.invalid_union,unionErrors:l}),be}if(r.common.async)return Promise.all(a.map(async i=>{const l={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:l}),ctx:l}})).then(n);{let i;const l=[];for(const c of a){const d={...r,common:{...r.common,issues:[]},parent:null},h=c._parseSync({data:r.data,path:r.path,parent:d});if(h.status==="valid")return h;h.status==="dirty"&&!i&&(i={result:h,ctx:d}),d.common.issues.length&&l.push(d.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const o=l.map(c=>new Ft(c));return oe(r,{code:Y.invalid_union,unionErrors:o}),be}}get options(){return this._def.options}}Rr.create=(s,t)=>new Rr({options:s,typeName:ve.ZodUnion,...Se(t)});function Aa(s,t){const r=qt(s),a=qt(t);if(s===t)return{valid:!0,data:s};if(r===ue.object&&a===ue.object){const n=Me.objectKeys(t),i=Me.objectKeys(s).filter(o=>n.indexOf(o)!==-1),l={...s,...t};for(const o of i){const c=Aa(s[o],t[o]);if(!c.valid)return{valid:!1};l[o]=c.data}return{valid:!0,data:l}}else if(r===ue.array&&a===ue.array){if(s.length!==t.length)return{valid:!1};const n=[];for(let i=0;i<s.length;i++){const l=s[i],o=t[i],c=Aa(l,o);if(!c.valid)return{valid:!1};n.push(c.data)}return{valid:!0,data:n}}else return r===ue.date&&a===ue.date&&+s==+t?{valid:!0,data:s}:{valid:!1}}class Br extends Ae{_parse(t){const{status:r,ctx:a}=this._processInputParams(t),n=(i,l)=>{if(zn(i)||zn(l))return be;const o=Aa(i.value,l.value);return o.valid?((Un(i)||Un(l))&&r.dirty(),{status:r.value,value:o.data}):(oe(a,{code:Y.invalid_intersection_types}),be)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([i,l])=>n(i,l)):n(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}Br.create=(s,t,r)=>new Br({left:s,right:t,typeName:ve.ZodIntersection,...Se(r)});class vs extends Ae{_parse(t){const{status:r,ctx:a}=this._processInputParams(t);if(a.parsedType!==ue.array)return oe(a,{code:Y.invalid_type,expected:ue.array,received:a.parsedType}),be;if(a.data.length<this._def.items.length)return oe(a,{code:Y.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),be;!this._def.rest&&a.data.length>this._def.items.length&&(oe(a,{code:Y.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...a.data].map((l,o)=>{const c=this._def.items[o]||this._def.rest;return c?c._parse(new ss(a,l,a.path,o)):null}).filter(l=>!!l);return a.common.async?Promise.all(i).then(l=>mt.mergeArray(r,l)):mt.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new vs({...this._def,rest:t})}}vs.create=(s,t)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new vs({items:s,typeName:ve.ZodTuple,rest:null,...Se(t)})};class Qn extends Ae{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:a}=this._processInputParams(t);if(a.parsedType!==ue.map)return oe(a,{code:Y.invalid_type,expected:ue.map,received:a.parsedType}),be;const n=this._def.keyType,i=this._def.valueType,l=[...a.data.entries()].map(([o,c],d)=>({key:n._parse(new ss(a,o,a.path,[d,"key"])),value:i._parse(new ss(a,c,a.path,[d,"value"]))}));if(a.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const c of l){const d=await c.key,h=await c.value;if(d.status==="aborted"||h.status==="aborted")return be;(d.status==="dirty"||h.status==="dirty")&&r.dirty(),o.set(d.value,h.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const c of l){const d=c.key,h=c.value;if(d.status==="aborted"||h.status==="aborted")return be;(d.status==="dirty"||h.status==="dirty")&&r.dirty(),o.set(d.value,h.value)}return{status:r.value,value:o}}}}Qn.create=(s,t,r)=>new Qn({valueType:t,keyType:s,typeName:ve.ZodMap,...Se(r)});class ar extends Ae{_parse(t){const{status:r,ctx:a}=this._processInputParams(t);if(a.parsedType!==ue.set)return oe(a,{code:Y.invalid_type,expected:ue.set,received:a.parsedType}),be;const n=this._def;n.minSize!==null&&a.data.size<n.minSize.value&&(oe(a,{code:Y.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),r.dirty()),n.maxSize!==null&&a.data.size>n.maxSize.value&&(oe(a,{code:Y.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),r.dirty());const i=this._def.valueType;function l(c){const d=new Set;for(const h of c){if(h.status==="aborted")return be;h.status==="dirty"&&r.dirty(),d.add(h.value)}return{status:r.value,value:d}}const o=[...a.data.values()].map((c,d)=>i._parse(new ss(a,c,a.path,d)));return a.common.async?Promise.all(o).then(c=>l(c)):l(o)}min(t,r){return new ar({...this._def,minSize:{value:t,message:me.toString(r)}})}max(t,r){return new ar({...this._def,maxSize:{value:t,message:me.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}ar.create=(s,t)=>new ar({valueType:s,minSize:null,maxSize:null,typeName:ve.ZodSet,...Se(t)});class Xn extends Ae{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Xn.create=(s,t)=>new Xn({getter:s,typeName:ve.ZodLazy,...Se(t)});class Yn extends Ae{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return oe(r,{received:r.data,code:Y.invalid_literal,expected:this._def.value}),be}return{status:"valid",value:t.data}}get value(){return this._def.value}}Yn.create=(s,t)=>new Yn({value:s,typeName:ve.ZodLiteral,...Se(t)});function wl(s,t){return new Bs({values:s,typeName:ve.ZodEnum,...Se(t)})}class Bs extends Ae{_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),a=this._def.values;return oe(r,{expected:Me.joinValues(a),received:r.parsedType,code:Y.invalid_type}),be}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const r=this._getOrReturnCtx(t),a=this._def.values;return oe(r,{received:r.data,code:Y.invalid_enum_value,options:a}),be}return gt(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return Bs.create(t,{...this._def,...r})}exclude(t,r=this._def){return Bs.create(this.options.filter(a=>!t.includes(a)),{...this._def,...r})}}Bs.create=wl;class ei extends Ae{_parse(t){const r=Me.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(t);if(a.parsedType!==ue.string&&a.parsedType!==ue.number){const n=Me.objectValues(r);return oe(a,{expected:Me.joinValues(n),received:a.parsedType,code:Y.invalid_type}),be}if(this._cache||(this._cache=new Set(Me.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const n=Me.objectValues(r);return oe(a,{received:a.data,code:Y.invalid_enum_value,options:n}),be}return gt(t.data)}get enum(){return this._def.values}}ei.create=(s,t)=>new ei({values:s,typeName:ve.ZodNativeEnum,...Se(t)});class Or extends Ae{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ue.promise&&r.common.async===!1)return oe(r,{code:Y.invalid_type,expected:ue.promise,received:r.parsedType}),be;const a=r.parsedType===ue.promise?r.data:Promise.resolve(r.data);return gt(a.then(n=>this._def.type.parseAsync(n,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Or.create=(s,t)=>new Or({type:s,typeName:ve.ZodPromise,...Se(t)});class Os extends Ae{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ve.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:a}=this._processInputParams(t),n=this._def.effect||null,i={addIssue:l=>{oe(a,l),l.fatal?r.abort():r.dirty()},get path(){return a.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){const l=n.transform(a.data,i);if(a.common.async)return Promise.resolve(l).then(async o=>{if(r.value==="aborted")return be;const c=await this._def.schema._parseAsync({data:o,path:a.path,parent:a});return c.status==="aborted"?be:c.status==="dirty"||r.value==="dirty"?Ks(c.value):c});{if(r.value==="aborted")return be;const o=this._def.schema._parseSync({data:l,path:a.path,parent:a});return o.status==="aborted"?be:o.status==="dirty"||r.value==="dirty"?Ks(o.value):o}}if(n.type==="refinement"){const l=o=>{const c=n.refinement(o,i);if(a.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(a.common.async===!1){const o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return o.status==="aborted"?be:(o.status==="dirty"&&r.dirty(),l(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>o.status==="aborted"?be:(o.status==="dirty"&&r.dirty(),l(o.value).then(()=>({status:r.value,value:o.value}))))}if(n.type==="transform")if(a.common.async===!1){const l=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!Rs(l))return be;const o=n.transform(l.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(l=>Rs(l)?Promise.resolve(n.transform(l.value,i)).then(o=>({status:r.value,value:o})):be);Me.assertNever(n)}}Os.create=(s,t,r)=>new Os({schema:s,typeName:ve.ZodEffects,effect:t,...Se(r)});Os.createWithPreprocess=(s,t,r)=>new Os({schema:t,effect:{type:"preprocess",transform:s},typeName:ve.ZodEffects,...Se(r)});class ts extends Ae{_parse(t){return this._getType(t)===ue.undefined?gt(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}ts.create=(s,t)=>new ts({innerType:s,typeName:ve.ZodOptional,...Se(t)});class Fs extends Ae{_parse(t){return this._getType(t)===ue.null?gt(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Fs.create=(s,t)=>new Fs({innerType:s,typeName:ve.ZodNullable,...Se(t)});class La extends Ae{_parse(t){const{ctx:r}=this._processInputParams(t);let a=r.data;return r.parsedType===ue.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}La.create=(s,t)=>new La({innerType:s,typeName:ve.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Se(t)});class Ta extends Ae{_parse(t){const{ctx:r}=this._processInputParams(t),a={...r,common:{...r.common,issues:[]}},n=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return Ir(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Ft(a.common.issues)},input:a.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Ft(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}Ta.create=(s,t)=>new Ta({innerType:s,typeName:ve.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Se(t)});class ti extends Ae{_parse(t){if(this._getType(t)!==ue.nan){const a=this._getOrReturnCtx(t);return oe(a,{code:Y.invalid_type,expected:ue.nan,received:a.parsedType}),be}return{status:"valid",value:t.data}}}ti.create=s=>new ti({typeName:ve.ZodNaN,...Se(s)});class yu extends Ae{_parse(t){const{ctx:r}=this._processInputParams(t),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}}class Xa extends Ae{_parse(t){const{status:r,ctx:a}=this._processInputParams(t);if(a.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return i.status==="aborted"?be:i.status==="dirty"?(r.dirty(),Ks(i.value)):this._def.out._parseAsync({data:i.value,path:a.path,parent:a})})();{const n=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return n.status==="aborted"?be:n.status==="dirty"?(r.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:a.path,parent:a})}}static create(t,r){return new Xa({in:t,out:r,typeName:ve.ZodPipeline})}}class Ma extends Ae{_parse(t){const r=this._def.innerType._parse(t),a=n=>(Rs(n)&&(n.value=Object.freeze(n.value)),n);return Ir(r)?r.then(n=>a(n)):a(r)}unwrap(){return this._def.innerType}}Ma.create=(s,t)=>new Ma({innerType:s,typeName:ve.ZodReadonly,...Se(t)});var ve;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(ve||(ve={}));const fr=es.create;rs.create;Et.create;const bu=ze.create;Rr.create;Br.create;vs.create;Bs.create;Or.create;ts.create;Fs.create;const vu=bu({email:fr().email("请输入有效的邮箱地址"),password:fr().min(6,"密码至少6位字符"),username:fr().min(2,"用户名至少2位字符").optional(),confirmPassword:fr().optional()}).refine(s=>s.confirmPassword!==void 0?s.password===s.confirmPassword:!0,{message:"两次输入的密码不一致",path:["confirmPassword"]}),ju=()=>{var E,A;const[s,t]=b.useState(!0),r=ot(),a=Oa(),{login:n,register:i,isLoading:l}=et(),{theme:o,toggleTheme:c}=Xr(),{language:d,setLanguage:h,t:u}=Wt(),{register:j,handleSubmit:p,formState:{errors:f},reset:x}=U0({resolver:q0(vu)}),y=((A=(E=a.state)==null?void 0:E.from)==null?void 0:A.pathname)||"/",m=async T=>{try{const k=await et.getState().loginWithGoogle(T.credential);k.success?(O.success("Google登录成功！"),r(y,{replace:!0})):O.error(k.message||"Google登录失败")}catch(k){console.error("Google login error:",k),O.error("Google登录出错，请重试")}},g=()=>{console.error("Google登录失败"),O.error("Google登录失败，请重试")},v=async T=>{try{let k=!1;if(s){const R=await i({username:T.username||T.email.split("@")[0],email:T.email,password:T.password,confirmPassword:T.confirmPassword||T.password});if(k=R.success,!k){O.error(R.message||"注册失败");return}}else{const R=await n({email:T.email,password:T.password});if(k=R.success,!k){O.error(R.message||"登录失败");return}}k&&(O.success(s?"注册成功！":"登录成功！"),r(y,{replace:!0}))}catch(k){console.error("Authentication error:",k),O.error("操作失败，请重试")}},P=()=>{t(!s),x()};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-8 flex items-center justify-center transition-colors",children:e.jsxs("div",{className:"w-full max-w-5xl min-h-[800px] bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 relative transition-colors",children:[e.jsxs("div",{className:"absolute top-4 right-8 flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>h("zh"),className:`px-2 py-1 text-sm rounded-md transition-colors ${d==="zh"?"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:"中"}),e.jsx("button",{onClick:()=>h("en"),className:`px-2 py-1 text-sm rounded-md transition-colors ${d==="en"?"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:"EN"})]}),e.jsx("div",{className:"border-l border-gray-300 dark:border-gray-600 h-6"}),e.jsx("button",{onClick:c,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 transition-colors",children:o==="light"?e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("path",{d:"M12 1v2M12 21v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4"})]})})]}),e.jsx("header",{className:"py-6 px-8 flex justify-center border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-9 h-9 mr-3 text-blue-600 dark:text-blue-400",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M7 12h10M12 7v10",stroke:"currentColor",strokeWidth:"2",fill:"none"})]}),e.jsx("h1",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:"Trademe"})]})}),e.jsx("main",{className:"flex flex-col items-center justify-center py-16",children:e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsx("h2",{className:"text-center text-2xl font-bold mb-8 text-gray-800 dark:text-white",children:u("accountLogin")}),e.jsx("div",{className:"mb-6",children:e.jsx(p0,{onSuccess:m,onError:g,useOneTap:!1,theme:o==="dark"?"filled_black":"outline",size:"large",width:"100%",text:s?"signup_with":"signin_with",shape:"rectangular"})}),e.jsxs("div",{className:"relative flex justify-center mb-6",children:[e.jsx("hr",{className:"w-full border-gray-300 dark:border-gray-600"}),e.jsx("span",{className:"absolute px-4 bg-white dark:bg-gray-800 -top-3 text-gray-500 dark:text-gray-400",children:u("orContinueWith")})]}),e.jsxs("form",{onSubmit:p(v),children:[s&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:u("username")}),e.jsx("input",{type:"text",placeholder:u("enterUsername"),...j("username"),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 dark:bg-gray-700 dark:text-white transition-colors"}),f.username&&e.jsx("p",{className:"text-red-500 dark:text-red-400 text-sm mt-1",children:f.username.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:u("email")}),e.jsx("input",{type:"email",placeholder:u("enterEmail"),...j("email"),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 dark:bg-gray-700 dark:text-white transition-colors"}),f.email&&e.jsx("p",{className:"text-red-500 dark:text-red-400 text-sm mt-1",children:f.email.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:u("password")}),e.jsx("input",{type:"password",placeholder:u("enterPassword"),...j("password"),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 dark:bg-gray-700 dark:text-white transition-colors"}),f.password&&e.jsx("p",{className:"text-red-500 dark:text-red-400 text-sm mt-1",children:f.password.message})]}),s&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:u("confirmPassword")}),e.jsx("input",{type:"password",placeholder:u("enterPasswordAgain"),...j("confirmPassword"),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 dark:bg-gray-700 dark:text-white transition-colors"}),f.confirmPassword&&e.jsx("p",{className:"text-red-500 dark:text-red-400 text-sm mt-1",children:f.confirmPassword.message})]}),e.jsx("button",{type:"submit",disabled:l,className:"w-full py-3 mb-6 text-white font-medium rounded-lg transition-colors disabled:opacity-50 bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700",children:u(l?"processing":s?"createAccount":"login")})]}),e.jsx("div",{className:"text-center mb-4",children:e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[u(s?"haveAccount":"noAccount"),e.jsx("button",{type:"button",onClick:P,className:"text-blue-600 dark:text-blue-400 hover:underline ml-1",children:u(s?"loginNow":"registerNow")})]})}),s&&e.jsx("div",{className:"text-center text-xs text-gray-500 dark:text-gray-400",children:e.jsxs("p",{children:[u("byRegisteringAgree"),e.jsx("a",{href:"/terms",className:"text-blue-600 dark:text-blue-400 hover:underline",children:u("termsOfService")}),u("and"),e.jsx("a",{href:"/privacy",className:"text-blue-600 dark:text-blue-400 hover:underline",children:u("privacyPolicy")})]})})]})})]})})},Pt=({size:s="md",color:t="primary",className:r=""})=>{const a={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"},n={primary:"text-brand-500",secondary:"text-gray-500",white:"text-white"};return e.jsx("div",{className:`inline-block ${r}`,children:e.jsxs("svg",{className:`animate-spin ${a[s]} ${n[t]}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})},ys=({variant:s="primary",size:t="md",loading:r=!1,children:a,className:n="",disabled:i,...l})=>{const o="btn",c={primary:"btn-primary",secondary:"btn-secondary",outline:"btn-outline",ghost:"btn-ghost",danger:"bg-red-500 text-white hover:bg-red-600 active:bg-red-700"},d={sm:"btn-sm",md:"btn-md",lg:"btn-lg"},h=i||r;return e.jsxs("button",{className:`
        ${o}
        ${c[s]}
        ${d[t]}
        ${h?"opacity-50 cursor-not-allowed":""}
        ${n}
      `,disabled:h,...l,children:[r&&e.jsx(Pt,{size:"sm",color:s==="primary"?"white":"primary",className:"mr-2"}),a]})},wu=()=>{const s=ot();return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 transition-colors",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 p-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900 dark:text-white",children:"邮箱验证"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"请检查您的邮箱以完成账户验证"})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.2a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:"我们已向您的邮箱发送了验证链接，请点击链接完成账户激活。"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"如果您没有收到邮件，请检查垃圾邮件箱或稍后重试。"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(ys,{onClick:()=>window.location.reload(),variant:"outline",className:"w-full",children:"重新发送验证邮件"}),e.jsx(ys,{onClick:()=>s("/login"),variant:"primary",className:"w-full",children:"返回登录"})]})]})})]})})},Nu={async getKlineData(s,t,r="okx",a=500){try{const n=await fetch(`/klines/${s}?timeframe=${t}&limit=${a}`);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return(await n.json()).klines.map(l=>({timestamp:l[0],open:l[1],high:l[2],low:l[3],close:l[4],volume:l[5]}))}catch(n){throw console.error("获取K线数据失败:",n),n}},async getTicker(s,t="okx"){try{const r=await fetch(`/stats/${s}`);if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const a=await r.json();return{symbol:a.symbol,price:a.price,change:a.change_24h,change_percent:a.change_percent||0,high_24h:a.high_24h,low_24h:a.low_24h,volume_24h:a.volume_24h,timestamp:a.timestamp}}catch(r){throw console.error("获取价格数据失败:",r),r}},async getTickers(s,t){try{const r=await te.post("/market/tickers",{symbols:s,exchange:t});return Q(r)}catch(r){J(r)}},async getOrderBook(s,t,r=20){try{const a=await te.get("/market/orderbook",{params:{symbol:s,exchange:t,depth:r}});return Q(a)}catch(a){J(a)}},async getExchanges(){try{const s=await te.get("/market/exchanges");return Q(s)}catch(s){J(s)}},async getTradingPairs(s){try{const t=await te.get("/market/pairs",{params:{exchange:s}});return Q(t)}catch(t){J(t)}},async searchTradingPairs(s,t){try{const r=await te.get("/market/pairs/search",{params:{query:s,exchange:t}});return Q(r)}catch(r){J(r)}},async getHistoricalData(s,t,r,a,n="1d"){try{const i=await te.get("/market/historical",{params:{symbol:s,exchange:t,start_date:r,end_date:a,timeframe:n}});return Q(i)}catch(i){J(i)}},async getMarketStats(s){try{const t=await te.get("/market/stats",{params:{exchange:s}});return Q(t)}catch(t){J(t)}},async getTechnicalIndicators(s,t,r,a,n=20){try{const i=await te.post("/market/indicators",{symbol:s,exchange:t,timeframe:r,indicators:a,period:n});return Q(i)}catch(i){J(i)}}};class ku{constructor(t){Ne(this,"connections",new Map);Ne(this,"config");Ne(this,"heartbeatTimer",null);this.config=t,this.startHeartbeat()}connect(t,r,a={},n){try{this.connections.has(t)&&this.disconnect(t);const i=`${this.config.baseUrl}${r}`,o={ws:new WebSocket(i),url:i,key:t,isActive:!1,reconnectAttempts:0,maxReconnectAttempts:this.config.maxReconnectAttempts,reconnectDelay:this.config.reconnectDelay,authToken:n,...a};return this.setupWebSocketHandlers(o),this.connections.set(t,o),console.log(`WebSocket connecting: ${t} -> ${i}`),!0}catch(i){return console.error(`Failed to create WebSocket connection for ${t}:`,i),!1}}disconnect(t){const r=this.connections.get(t);return r?(r.isActive=!1,(r.ws.readyState===WebSocket.OPEN||r.ws.readyState===WebSocket.CONNECTING)&&r.ws.close(1e3,"Manual disconnect"),this.connections.delete(t),console.log(`WebSocket disconnected: ${t}`),!0):!1}disconnectAll(){for(const t of this.connections.keys())this.disconnect(t);this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null)}send(t,r){const a=this.connections.get(t);if(!a||a.ws.readyState!==WebSocket.OPEN)return console.warn(`WebSocket not ready for sending: ${t}`),!1;try{const n=typeof r=="string"?r:JSON.stringify(r);return a.ws.send(n),!0}catch(n){return console.error(`Failed to send message to ${t}:`,n),!1}}getConnectionStatus(t){const r=this.connections.get(t);return r?{isConnected:r.ws.readyState===WebSocket.OPEN,readyState:r.ws.readyState,reconnectAttempts:r.reconnectAttempts}:{isConnected:!1,readyState:null,reconnectAttempts:0}}getAllConnectionStatus(){const t={};for(const[r]of this.connections)t[r]=this.getConnectionStatus(r);return t}setupWebSocketHandlers(t){const{ws:r}=t;r.onopen=a=>{var n;if(t.isActive=!0,t.reconnectAttempts=0,console.log(`WebSocket connected: ${t.key}`),t.authToken){const i={type:"auth",token:t.authToken};r.send(JSON.stringify(i)),console.log(`🔐 Sent auth message for connection: ${t.key}`)}(n=t.onOpen)==null||n.call(t)},r.onmessage=a=>{var n,i;try{const l=JSON.parse(a.data);(n=t.onMessage)==null||n.call(t,l)}catch(l){console.error(`Failed to parse WebSocket message from ${t.key}:`,l),(i=t.onMessage)==null||i.call(t,a.data)}},r.onerror=a=>{var n;console.error(`WebSocket error on ${t.key}:`,a),(n=t.onError)==null||n.call(t,a)},r.onclose=a=>{var n;console.log(`WebSocket closed: ${t.key}, code: ${a.code}, reason: ${a.reason}`),(n=t.onClose)==null||n.call(t),t.isActive&&t.reconnectAttempts<t.maxReconnectAttempts&&a.code!==1e3?this.scheduleReconnect(t):t.reconnectAttempts>=t.maxReconnectAttempts&&(console.warn(`Max reconnect attempts reached for ${t.key}`),this.connections.delete(t.key))}}scheduleReconnect(t){t.reconnectAttempts++;const r=t.reconnectDelay*Math.pow(2,t.reconnectAttempts-1);console.log(`Scheduling reconnect for ${t.key} in ${r}ms (attempt ${t.reconnectAttempts})`),setTimeout(()=>{if(t.isActive){console.log(`Attempting to reconnect ${t.key}...`);const a=new WebSocket(t.url);t.ws=a,this.setupWebSocketHandlers(t)}},r)}startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>{for(const[t,r]of this.connections)r.ws.readyState===WebSocket.OPEN?this.send(t,{type:"ping",timestamp:Date.now()}):r.ws.readyState===WebSocket.CLOSED&&r.isActive&&r.reconnectAttempts<r.maxReconnectAttempts&&(console.log(`Heartbeat detected closed connection, triggering reconnect: ${t}`),this.scheduleReconnect(r))},this.config.heartbeatInterval)}getStats(){const t=Array.from(this.connections.values()).map(r=>({key:r.key,url:r.url,isActive:r.isActive,readyState:this.getReadyStateString(r.ws.readyState),reconnectAttempts:r.reconnectAttempts}));return{totalConnections:this.connections.size,activeConnections:t.filter(r=>r.readyState==="OPEN").length,connectionDetails:t}}getReadyStateString(t){switch(t){case WebSocket.CONNECTING:return"CONNECTING";case WebSocket.OPEN:return"OPEN";case WebSocket.CLOSING:return"CLOSING";case WebSocket.CLOSED:return"CLOSED";default:return"UNKNOWN"}}}const Ss=new ku({baseUrl:"wss://api.trademe.app/ws",maxReconnectAttempts:5,reconnectDelay:1e3,heartbeatInterval:3e4});typeof window<"u"&&window.addEventListener("beforeunload",()=>{Ss.disconnectAll()});const _s=Ut((s,t)=>({currentPrices:{},klineData:{},selectedSymbol:"BTC/USDT",selectedTimeframe:"1h",selectedExchange:"okx",isLoading:!1,isConnected:!1,lastUpdate:null,error:null,subscribedTickers:new Set,connectionStats:null,setSelectedSymbol:r=>{s({selectedSymbol:r});const{selectedTimeframe:a,selectedExchange:n,fetchKlineData:i}=t();i(r,a,n)},setSelectedTimeframe:r=>{s({selectedTimeframe:r});const{selectedSymbol:a,selectedExchange:n,fetchKlineData:i}=t();i(a,r,n)},setSelectedExchange:r=>{s({selectedExchange:r});const{selectedSymbol:a,selectedTimeframe:n,fetchKlineData:i}=t();i(a,n,r)},fetchKlineData:async(r,a,n)=>{var i,l;s({isLoading:!0});try{const o=await Nu.getKlineData(r,a,n);s(c=>({klineData:{...c.klineData,[`${n}:${r}:${a}`]:o},isLoading:!1,lastUpdate:new Date}))}catch(o){s({isLoading:!1});const c=((l=(i=o.response)==null?void 0:i.data)==null?void 0:l.message)||"获取K线数据失败";O.error(c)}},subscribeToTicker:(r,a)=>{const n=`${a}:${r}`,i=`/market/${a}/${r}/ticker`;Ss.connect(n,i,{onOpen:()=>{s(o=>({isConnected:!0,subscribedTickers:new Set([...o.subscribedTickers,n]),error:null})),console.log(`Subscribed to ticker: ${n}`)},onMessage:o=>{t().updatePrice(r,o)},onError:o=>{console.error(`WebSocket error for ${n}:`,o),s({error:`${r} 价格订阅失败`}),O.error(`${r} 价格订阅失败`)},onClose:()=>{s(o=>{const c=new Set(o.subscribedTickers);return c.delete(n),{subscribedTickers:c,isConnected:c.size>0}}),console.log(`Unsubscribed from ticker: ${n}`)}})||(O.error(`无法连接到 ${r} 价格推送`),s({error:`WebSocket连接失败: ${r}`}))},unsubscribeFromTicker:(r,a)=>{const n=`${a}:${r}`;Ss.disconnect(n)&&s(l=>{const o=new Set(l.subscribedTickers);return o.delete(n),{subscribedTickers:o,isConnected:o.size>0}})},connectWebSocket:()=>{const{selectedSymbol:r,selectedExchange:a}=t();t().subscribeToTicker(r,a)},disconnectWebSocket:()=>{Ss.disconnectAll(),s({subscribedTickers:new Set,isConnected:!1,connectionStats:null})},updatePrice:(r,a)=>{s(n=>({currentPrices:{...n.currentPrices,[r]:a},lastUpdate:new Date,error:null}))},clearError:()=>{s({error:null})},getConnectionStats:()=>{const r=Ss.getStats();return s({connectionStats:r}),r},reset:()=>{Ss.disconnectAll(),s({currentPrices:{},klineData:{},selectedSymbol:"BTC/USDT",selectedTimeframe:"1h",selectedExchange:"okx",isLoading:!1,isConnected:!1,lastUpdate:null,error:null,subscribedTickers:new Set,connectionStats:null})}})),ht={async getStrategies(s){try{const t=await te.get("/strategies",{params:s});return Q(t)}catch(t){J(t)}},async getStrategy(s){try{const t=await te.get(`/strategies/${s}`);return Q(t)}catch(t){J(t)}},async createStrategy(s){try{const t=await te.post("/strategies",s);return Q(t)}catch(t){J(t)}},async updateStrategy(s,t){try{const r=await te.put(`/strategies/${s}`,t);return Q(r)}catch(r){J(r)}},async deleteStrategy(s){try{const t=await te.delete(`/strategies/${s}`);return Q(t)}catch(t){J(t)}},async startStrategy(s){try{const t=await te.post(`/strategies/${s}/start`);return Q(t)}catch(t){J(t)}},async stopStrategy(s){try{const t=await te.post(`/strategies/${s}/stop`);return Q(t)}catch(t){J(t)}},async pauseStrategy(s){try{const t=await te.post(`/strategies/${s}/pause`);return Q(t)}catch(t){J(t)}},async runBacktest(s,t){try{const r=await te.post(`/strategies/${s}/backtest`,t);return Q(r)}catch(r){J(r)}},async getBacktestResults(s){try{const t=await te.get(`/strategies/${s}/backtests`);return Q(t)}catch(t){J(t)}},async getBacktestResult(s,t){try{const r=await te.get(`/strategies/${s}/backtests/${t}`);return Q(r)}catch(r){J(r)}},async getStrategyTrades(s,t){try{const r=await te.get(`/strategies/${s}/trades`,{params:t});return Q(r)}catch(r){J(r)}},async getStrategyPerformance(s,t){try{const r=await te.get(`/strategies/${s}/performance`,{params:{period:t}});return Q(r)}catch(r){J(r)}},async cloneStrategy(s,t){try{const r=await te.post(`/strategies/${s}/clone`,{name:t});return Q(r)}catch(r){J(r)}},async exportStrategy(s){try{const t=await te.get(`/strategies/${s}/export`);return Q(t)}catch(t){J(t)}},async importStrategy(s){try{const t=await te.post("/strategies/import",s);return Q(t)}catch(t){J(t)}},async getStrategyLiveDetails(s){try{const t=await te.get(`/strategies/${s}/live-details`);return Q(t)}catch(t){J(t)}},async createStrategyFromAI(s){try{const t=await te.post("/strategies/from-ai",s);return Q(t)}catch(t){J(t)}},async getStrategiesByType(s,t){try{const r=await te.get(`/strategies/by-type/${s}`,{params:t});return Q(r)}catch(r){J(r)}}},Su=Ut((s,t)=>({strategies:[],selectedStrategy:null,isLoading:!1,backtestResults:[],isBacktesting:!1,fetchStrategies:async()=>{var r,a;s({isLoading:!0});try{const n=await ht.getStrategies();s({strategies:n.strategies,isLoading:!1})}catch(n){s({isLoading:!1});const i=((a=(r=n.response)==null?void 0:r.data)==null?void 0:a.message)||"获取策略列表失败";O.error(i)}},createStrategy:async r=>{var a,n;try{const i=await ht.createStrategy(r);return s(l=>({strategies:[...l.strategies,i]})),O.success("策略创建成功"),!0}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"创建策略失败";return O.error(l),!1}},updateStrategy:async(r,a)=>{var n,i;try{const l=await ht.updateStrategy(r,a);return s(o=>{var c;return{strategies:o.strategies.map(d=>d.id===r?l:d),selectedStrategy:((c=o.selectedStrategy)==null?void 0:c.id)===r?l:o.selectedStrategy}}),O.success("策略更新成功"),!0}catch(l){const o=((i=(n=l.response)==null?void 0:n.data)==null?void 0:i.message)||"更新策略失败";return O.error(o),!1}},deleteStrategy:async r=>{var a,n;try{return await ht.deleteStrategy(r),s(i=>{var l;return{strategies:i.strategies.filter(o=>o.id!==r),selectedStrategy:((l=i.selectedStrategy)==null?void 0:l.id)===r?null:i.selectedStrategy}}),O.success("策略删除成功"),!0}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"删除策略失败";return O.error(l),!1}},selectStrategy:r=>{s({selectedStrategy:r})},runBacktest:async(r,a)=>{var n,i;s({isBacktesting:!0});try{const l=await ht.runBacktest(r,a);return s(o=>({backtestResults:[...o.backtestResults,l],isBacktesting:!1})),O.success("回测完成"),!0}catch(l){s({isBacktesting:!1});const o=((i=(n=l.response)==null?void 0:n.data)==null?void 0:i.message)||"回测失败";return O.error(o),!1}},fetchBacktestResults:async r=>{var a,n;try{const i=await ht.getBacktestResults(r);s({backtestResults:i})}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"获取回测结果失败";O.error(l)}},startStrategy:async r=>{var a,n;try{return await ht.startStrategy(r),s(i=>{var l;return{strategies:i.strategies.map(o=>o.id===r?{...o,status:"running"}:o),selectedStrategy:((l=i.selectedStrategy)==null?void 0:l.id)===r?{...i.selectedStrategy,status:"running"}:i.selectedStrategy}}),O.success("策略已启动"),!0}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"启动策略失败";return O.error(l),!1}},stopStrategy:async r=>{var a,n;try{return await ht.stopStrategy(r),s(i=>{var l;return{strategies:i.strategies.map(o=>o.id===r?{...o,status:"stopped"}:o),selectedStrategy:((l=i.selectedStrategy)==null?void 0:l.id)===r?{...i.selectedStrategy,status:"stopped"}:i.selectedStrategy}}),O.success("策略已停止"),!0}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"停止策略失败";return O.error(l),!1}}})),ut={async createSession(s){try{const t=await te.post("/ai/sessions",s);return Q(t)}catch(t){throw J(t),t}},async getSessions(s){try{const t=await te.get(`/ai/sessions?ai_mode=${s}`);return Q(t)}catch(t){J(t)}},async updateSessionStatus(s,t,r){try{const a=r!==void 0?`?progress=${r}`:"",n=await te.put(`/ai/sessions/${s}/status${a}`,{status:t});return Q(n)}catch(a){J(a)}},async deleteSession(s){try{const t=await te.delete(`/ai/sessions/${s}`);return Q(t)}catch(t){J(t)}},async sendChatMessage(s,t,r="developer",a="strategy",n){try{const i=await te.post("/ai/chat",{content:s,session_id:t,ai_mode:r,session_type:a,context:n||{}});return Q(i)}catch(i){J(i)}},async getChatHistory(s,t=50){try{const r=new URLSearchParams;s&&r.append("session_id",s),r.append("limit",t.toString());const a=await te.get(`/ai/chat/history?${r}`);return Q(a)}catch(r){J(r)}},async clearChatSession(s){try{const t=await te.delete(`/ai/chat/${s}`);return Q(t)}catch(t){J(t)}},async generateStrategy(s){try{const t=await te.post("/ai/strategy/generate",{description:s.description,indicators:s.indicators||[],timeframe:s.timeframe||"1h",risk_level:s.risk_level||"medium"});return Q(t)}catch(t){J(t)}},async getUsageStats(s=30){try{const t=await te.get(`/ai/usage/stats?days=${s}`);return Q(t)}catch(t){J(t)}},async generateTradingInsights(s,t="1d"){try{const r=await te.post(`/ai/insights/generate?symbol=${s}&timeframe=${t}`);return Q(r)}catch(r){J(r)}},async analyzeMarket(s){try{const t=await te.post("/ai/market/analyze",{symbols:s.symbols,timeframe:s.timeframe||"1d",analysis_type:s.analysis_type||"technical"});return Q(t)}catch(t){J(t)}},async analyzeBacktestResults(s){try{const t=await te.post(`/ai/backtest/analyze?backtest_id=${s}`);return Q(t)}catch(t){J(t)}}};class _u{constructor(t){Ne(this,"ws",null);Ne(this,"config");Ne(this,"events",{});Ne(this,"isConnected",!1);Ne(this,"isAuthenticated",!1);Ne(this,"reconnectAttempts",0);Ne(this,"connectionId",null);Ne(this,"userId",null);Ne(this,"heartbeatTimer",null);Ne(this,"reconnectTimer",null);this.config={reconnectInterval:3e3,maxReconnectAttempts:5,heartbeatInterval:3e4,...t}}on(t){this.events={...this.events,...t}}async connect(){return new Promise((t,r)=>{try{console.log("🔗 正在连接WebSocket AI服务:",this.config.url),this.ws=new WebSocket(this.config.url),this.ws.onopen=()=>{var a,n;console.log("✅ WebSocket连接已建立"),this.isConnected=!0,this.reconnectAttempts=0,(n=(a=this.events).onOpen)==null||n.call(a),this.authenticate().then(t).catch(r)},this.ws.onclose=a=>{var n,i;console.log("❌ WebSocket连接已断开:",a.code,a.reason),this.isConnected=!1,this.isAuthenticated=!1,this.connectionId=null,this.userId=null,this.clearTimers(),(i=(n=this.events).onClose)==null||i.call(n,a),a.code!==1e3&&this.handleReconnect(),this.reconnectAttempts===0&&r(new Error(`WebSocket连接失败: ${a.reason||"未知原因"} (Code: ${a.code})`))},this.ws.onerror=a=>{var n,i;console.error("❌ WebSocket错误:",a),(i=(n=this.events).onError)==null||i.call(n,a),r(a)},this.ws.onmessage=a=>{try{const n=JSON.parse(a.data);if(!n||typeof n!="object"){console.error("❌ WebSocket消息格式无效:",n);return}if(!n.type){console.error("❌ WebSocket消息缺少type字段:",n);return}this.handleMessage(n)}catch(n){console.error("❌ 解析WebSocket消息失败:",n,"Original data:",a.data)}}}catch(a){console.error("❌ WebSocket连接失败:",a),r(a)}})}async authenticate(){return new Promise((t,r)=>{if(!this.ws||this.ws.readyState!==WebSocket.OPEN){r(new Error("WebSocket未连接"));return}const a=setTimeout(()=>{r(new Error("认证超时"))},1e4),n=this.events.onAuthenticated;this.events.onAuthenticated=i=>{clearTimeout(a),this.isAuthenticated=!0,this.connectionId=i.connection_id||`user_${i.user_id}_${Date.now()}`,this.userId=i.user_id,this.startHeartbeat(),console.log("✅ WebSocket认证成功:",{connectionId:this.connectionId,userId:this.userId}),this.events.onAuthenticated=n,n==null||n(i),t(!0)},this.send({type:"auth",token:this.config.token})})}async sendAIChat(t,r="trader",a="strategy",n){if(console.log("🚀 [WebSocketClient] sendAIChat called:",{content:t.substring(0,100)+"...",aiMode:r,sessionType:a,sessionId:n,isConnected:this.isConnected,isAuthenticated:this.isAuthenticated}),!this.isConnected||!this.isAuthenticated){const o=`WebSocket状态异常 - 连接:${this.isConnected}, 认证:${this.isAuthenticated}`;throw console.error("❌ [WebSocketClient]",o),new Error(o)}const i=this.generateRequestId(),l={type:"ai_chat",request_id:i,content:t,ai_mode:r,session_type:a,session_id:n};return console.log("📤 [WebSocketClient] 发送AI消息:",l),this.send(l),i}cancelAIRequest(t){!this.isConnected||!this.isAuthenticated||this.send({type:"cancel_request",request_id:t})}ping(){this.isConnected&&this.send({type:"ping"})}disconnect(){this.clearTimers(),this.ws&&(this.ws.close(),this.ws=null),this.isConnected=!1,this.isAuthenticated=!1,this.connectionId=null,this.userId=null}getConnectionInfo(){return{isConnected:this.isConnected,isAuthenticated:this.isAuthenticated,connectionId:this.connectionId,userId:this.userId,reconnectAttempts:this.reconnectAttempts}}handleMessage(t){var a,n,i,l,o,c,d,h,u,j,p,f,x,y,m,g,v,P,E,A,T,k,R,se,z,K;const r={type:t.type,request_id:t.request_id||"N/A",...t.type==="ai_progress_update"&&{step:t.step,total_steps:t.total_steps,status:t.status,message:t.message},...t.type==="ai_stream_chunk"&&{chunk_length:((a=t.chunk)==null?void 0:a.length)||0},...t.type==="ai_stream_end"&&{response_length:((n=t.content)==null?void 0:n.length)||0,tokens_used:t.tokens_used,cost_usd:t.cost_usd}};switch(console.log("📨 收到WebSocket消息:",r),t.type){case"connection_established":console.log("✅ [WebSocketClient] 连接已建立:",t),this.connectionId=t.connection_id||null,this.userId=t.user_id||null,(l=(i=this.events).onAuthenticated)==null||l.call(i,t);break;case"auth_success":console.log("✅ [WebSocketClient] 认证成功:",t),this.isAuthenticated=!0,this.connectionId=t.connection_id||null,this.userId=t.user_id||null,(c=(o=this.events).onAuthenticated)==null||c.call(o,t);break;case"ai_chat_start":(h=(d=this.events).onAIStart)==null||h.call(d,t);break;case"ai_complexity_analysis":(j=(u=this.events).onComplexityAnalysis)==null||j.call(u,t);break;case"ai_progress_update":(f=(p=this.events).onProgressUpdate)==null||f.call(p,t);break;case"ai_chat_success":(y=(x=this.events).onAISuccess)==null||y.call(x,t);break;case"ai_chat_error":(g=(m=this.events).onAIError)==null||g.call(m,t);break;case"ai_stream_start":console.log("🌊 [WebSocketClient] 流式AI开始:",t),(P=(v=this.events).onStreamStart)==null||P.call(v,t);break;case"ai_stream_chunk":console.log("📝 [WebSocketClient] 流式AI数据块:",(t==null?void 0:t.chunk)||"[chunk为空]"),(A=(E=this.events).onStreamChunk)==null||A.call(E,t);break;case"ai_stream_end":console.log("✅ [WebSocketClient] 流式AI结束:",t),console.log("🔄 [WebSocketClient] 准备调用onStreamEnd回调"),this.events.onStreamEnd?(console.log("🎯 [WebSocketClient] onStreamEnd回调存在，正在调用..."),this.events.onStreamEnd(t),console.log("✅ [WebSocketClient] onStreamEnd回调调用完成")):console.log("⚠️ [WebSocketClient] onStreamEnd回调不存在!");break;case"ai_stream_error":console.log("❌ [WebSocketClient] 流式AI错误:",{error:t.error,error_type:t.error_type,message:t.message,request_id:t.request_id}),(k=(T=this.events).onStreamError)==null||k.call(T,t);break;case"heartbeat":case"pong":(se=(R=this.events).onHeartbeat)==null||se.call(R,t);break;default:(K=(z=this.events).onMessage)==null||K.call(z,t);break}}send(t){if(!this.ws||this.ws.readyState!==WebSocket.OPEN){console.warn("⚠️ WebSocket未连接，无法发送消息:",t);return}try{this.ws.send(JSON.stringify(t)),console.log("📤 发送WebSocket消息:",t.type)}catch(r){console.error("❌ 发送WebSocket消息失败:",r)}}startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>{this.ping()},this.config.heartbeatInterval)}clearTimers(){this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)}handleReconnect(){if(this.reconnectAttempts>=this.config.maxReconnectAttempts){console.error("❌ 达到最大重连次数，停止重连");return}this.reconnectAttempts++,console.log(`🔄 尝试重连 (${this.reconnectAttempts}/${this.config.maxReconnectAttempts})`),this.reconnectTimer=setTimeout(()=>{this.connect().catch(console.error)},this.config.reconnectInterval)}generateRequestId(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}}class Cu{constructor(t){Ne(this,"client");Ne(this,"pendingRequests",new Map);Ne(this,"isInitialized",!1);let r=t.baseUrl;r=r.replace(/\/api\/v1$/,""),r.match(/^https?:\/\//)||(r=window.location.protocol+"//"+r);const a=r.replace(/^http/,"ws")+"/ws/realtime";console.log("🔗 [WebSocketAI] 构建的WebSocket URL:",a),this.client=new _u({url:a,token:t.token,reconnectInterval:3e3,maxReconnectAttempts:5,heartbeatInterval:3e4}),this.setupEventHandlers()}async initialize(){if(this.isInitialized)return!0;try{return await this.client.connect(),this.isInitialized=!0,!0}catch(t){return console.error("❌ WebSocket AI服务初始化失败:",t),!1}}async sendChatMessage(t,r,a="trader",n="strategy",i){if(!this.isInitialized&&!await this.initialize())throw new Error("WebSocket连接失败");return new Promise(async(l,o)=>{try{const c=await this.client.sendAIChat(t,a,n,r);this.pendingRequests.set(c,{requestId:c,resolve:l,reject:o,callbacks:i}),setTimeout(()=>{this.pendingRequests.has(c)&&(this.pendingRequests.delete(c),o({type:"ai_chat_error",request_id:c,error:"WebSocket请求超时",error_code:"WEBSOCKET_TIMEOUT",message:"WebSocket请求超时，请重试"}))},6e5)}catch(c){console.error("❌ [WebSocketAI] sendChatMessage异常:",c),o({type:"ai_chat_error",error:c instanceof Error?c.message:"未知错误",error_code:"WEBSOCKET_ERROR",message:"WebSocket发送失败"})}})}cancelRequest(t){this.client.cancelAIRequest(t),this.pendingRequests.has(t)&&this.pendingRequests.delete(t)}getConnectionStatus(){return this.client.getConnectionInfo()}disconnect(){this.client.disconnect(),this.isInitialized=!1,this.pendingRequests.clear()}async reconnect(){return this.disconnect(),this.initialize()}setupEventHandlers(){this.client.on({onOpen:()=>{console.log("🔗 WebSocket AI服务已连接")},onClose:t=>{console.log("❌ WebSocket AI服务已断开:",t.code,t.reason),this.isInitialized=!1,this.pendingRequests.forEach(({reject:r,requestId:a})=>{r({type:"ai_chat_error",request_id:a,error:"WebSocket连接断开",error_code:"WEBSOCKET_DISCONNECTED",message:"WebSocket连接断开，请重试"})}),this.pendingRequests.clear()},onError:t=>{console.error("❌ WebSocket AI服务错误:",t)},onAuthenticated:t=>{console.log("✅ WebSocket AI服务认证成功:",t)},onAIStart:t=>{var a,n;const r=this.findRequestById(t.request_id);(n=(a=r==null?void 0:r.callbacks)==null?void 0:a.onStart)==null||n.call(a,t)},onComplexityAnalysis:t=>{var a,n;const r=this.findRequestById(t.request_id);(n=(a=r==null?void 0:r.callbacks)==null?void 0:a.onComplexityAnalysis)==null||n.call(a,t)},onProgressUpdate:t=>{var a,n;const r=this.findRequestById(t.request_id);(n=(a=r==null?void 0:r.callbacks)==null?void 0:a.onProgress)==null||n.call(a,t)},onAISuccess:t=>{var a,n;const r=this.findRequestById(t.request_id);r&&(this.pendingRequests.delete(r.requestId),(n=(a=r.callbacks)==null?void 0:a.onSuccess)==null||n.call(a,t),r.resolve(t))},onAIError:t=>{var a,n;const r=this.findRequestById(t.request_id);r&&(this.pendingRequests.delete(r.requestId),(n=(a=r.callbacks)==null?void 0:a.onError)==null||n.call(a,t),r.reject(t))},onStreamStart:t=>{var a,n;const r=this.findRequestById(t.request_id);(n=(a=r==null?void 0:r.callbacks)==null?void 0:a.onStreamStart)==null||n.call(a,t)},onStreamChunk:t=>{var a,n;const r=this.findRequestById(t.request_id);(n=(a=r==null?void 0:r.callbacks)==null?void 0:a.onStreamChunk)==null||n.call(a,t)},onStreamEnd:t=>{var a,n;const r=this.findRequestById(t.request_id);if(r){this.pendingRequests.delete(r.requestId),(n=(a=r.callbacks)==null?void 0:a.onStreamEnd)==null||n.call(a,t);const i={type:"ai_chat_success",request_id:t.request_id,response:t.content,session_id:t.session_id,tokens_used:t.tokens_used,model:"claude-3-5-sonnet-20241022",cost_usd:t.cost_usd,message:"对话成功"};r.resolve(i)}},onStreamError:t=>{var a,n;const r=this.findRequestById(t.request_id);if(r){this.pendingRequests.delete(r.requestId),(n=(a=r.callbacks)==null?void 0:a.onStreamError)==null||n.call(a,t);const i={type:"ai_chat_error",request_id:t.request_id,error:t.error,message:t.message};r.reject(i)}},onHeartbeat:()=>{}})}findRequestById(t){if(t)return this.pendingRequests.get(t)}}let yr=null;function si(s){if(!yr&&s&&(yr=new Cu(s)),!yr)throw new Error("WebSocket AI服务未初始化，请提供配置");return yr}const Cr=Ut()(js((s,t)=>({currentAIMode:"trader",chatSessions:{developer:[],trader:[]},currentSession:null,messages:[],isTyping:!1,useWebSocket:!0,wsConnected:!1,wsConnectionId:null,aiProgress:null,streamingMessage:null,generatedStrategies:[],isGenerating:!1,currentGeneratedStrategy:null,marketAnalyses:{},isAnalyzing:!1,usageStats:null,isLoading:!1,error:null,networkStatus:"connected",retryCount:0,setAIMode:r=>{s({currentAIMode:r,currentSession:null,messages:[],error:null})},createChatSession:async r=>{var a,n;s({isLoading:!0,error:null});try{const i=await ut.createSession(r),l={session_id:i.session_id,name:r.name,description:r.description,ai_mode:r.ai_mode,session_type:r.session_type,status:"active",progress:0,message_count:0,cost_total:0,created_at:i.created_at,updated_at:i.created_at,last_activity_at:i.created_at};if(s(o=>({chatSessions:{...o.chatSessions,[r.ai_mode]:[l,...o.chatSessions[r.ai_mode]]},currentSession:l,messages:[],isLoading:!1})),r.description&&r.description.trim()){const{sendMessage:o}=t();await o(r.description.trim())}return O.success(`创建${r.session_type==="strategy"?"策略":r.session_type==="indicator"?"指标":""}会话成功`),!0}catch(i){const l=String(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"创建会话失败");return s({error:l,isLoading:!1}),O.error(l),!1}},loadChatSessions:async r=>{var a,n;s({isLoading:!0,error:null});try{const i=await ut.getSessions(r);s(l=>({chatSessions:{...l.chatSessions,[r]:i.sessions},isLoading:!1}))}catch(i){const l=String(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"加载会话列表失败");s({error:l,isLoading:!1}),console.error("Load chat sessions error:",i)}},selectChatSession:r=>{s({currentSession:r,messages:[],error:null}),r&&setTimeout(async()=>{var a;try{const n=await ut.getChatHistory(r.session_id,20),l=((n==null?void 0:n.messages)||[]).map(c=>({role:c.message_type||c.role,content:String(c.content||""),timestamp:c.created_at||c.timestamp})).reverse();((a=t().currentSession)==null?void 0:a.session_id)===r.session_id&&(console.log("加载历史消息:",l.length,"条"),s({messages:l}))}catch(n){console.error("Load chat history failed:",n)}},0)},sendMessage:async r=>{var d;const{useWebSocket:a}=t();if(a)return t().sendMessageWebSocket(r);let{currentSession:n,currentAIMode:i,retryCount:l}=t();if(n)console.log("✅ [DEBUG] Using existing currentSession:",n.session_id);else{console.log("❌ [DEBUG] No currentSession, creating default session");try{const h=i==="trader"?"市场分析对话":"策略开发对话";if(!await t().createChatSession({name:h,ai_mode:i,session_type:"strategy",description:"自动创建的对话会话"}))return O.error("创建对话会话失败"),!1;if(n=t().currentSession,!n)return O.error("会话创建失败"),!1;console.log("✅ [DEBUG] Auto-created session:",n.session_id),O.success("已自动创建新对话")}catch(h){return console.log("❌ [DEBUG] Exception in session creation:",h),O.error("创建对话会话失败"),!1}}const o={role:"user",content:String(r||""),timestamp:new Date().toISOString()};s(h=>({messages:[...h.messages,o],isTyping:!0,error:null,networkStatus:"checking",retryCount:0}));const c=o0(2,1500);try{const u=await c(async()=>{const p=new Promise((x,y)=>{setTimeout(()=>y(new Error("TIMEOUT")),45e3)});console.log("📤 [DEBUG] Calling aiApi.sendChatMessage with:",{message:r,sessionId:n.session_id,aiMode:n.ai_mode,sessionType:n.session_type});const f=ut.sendChatMessage(r,n.session_id,n.ai_mode,n.session_type);return await Promise.race([f,p])},"ai-chat"),j={role:"assistant",content:String(u.response||""),timestamp:new Date().toISOString()};return s(p=>({messages:[...p.messages,j],isTyping:!1,error:null,networkStatus:"connected",retryCount:0})),u.cost_usd>0&&O.success(`AI回复完成 (消耗 $${u.cost_usd.toFixed(4)})`,{icon:"🧠",duration:3e3}),!0}catch(h){const u=()=>{s(x=>({isTyping:!1,networkStatus:"disconnected",retryCount:x.retryCount+1}))},j=qa.handle(h,"ai-chat-send",!1);let p="",f=!1;switch(j.type){case Sr.NETWORK:p="AI服务暂时不可用，请检查网络连接",f=!0;break;case Sr.SERVER:j.code===504?(p="Claude AI服务繁忙，请稍后重试",f=!0):p="AI服务器错误，请稍后再试";break;case Sr.AUTH:p="AI使用权限不足，请检查会员状态";break;default:h.message==="TIMEOUT"?(p="AI响应超时，服务可能繁忙",f=!0):(d=h.message)!=null&&d.includes("AI回复超时")?(p="AI回复超时，请稍后重试",f=!0):p=j.message||"发送消息失败"}return u(),s({error:p}),O.error(p,{duration:f?8e3:5e3,icon:f?"🔄":"❌",id:`ai-error-${Date.now()}`}),f&&setTimeout(()=>{O("可尝试重新发送消息或检查网络连接",{icon:"💡",duration:6e3,style:{background:"#FEF3C7",color:"#92400E",border:"1px solid #FCD34D"}})},1e3),!1}},updateSessionStatus:async(r,a,n)=>{var i,l;try{return await ut.updateSessionStatus(r,a,n),s(o=>{var d;const c={...o.chatSessions};return Object.keys(c).forEach(h=>{c[h]=c[h].map(u=>u.session_id===r?{...u,status:a,progress:n??u.progress}:u)}),{chatSessions:c,currentSession:((d=o.currentSession)==null?void 0:d.session_id)===r?{...o.currentSession,status:a,progress:n??o.currentSession.progress}:o.currentSession}}),O.success("会话状态更新成功"),!0}catch(o){const c=((l=(i=o.response)==null?void 0:i.data)==null?void 0:l.message)||"更新会话状态失败";return O.error(c),!1}},deleteChatSession:async r=>{var a,n;try{return await ut.deleteSession(r),s(i=>{var o,c;const l={...i.chatSessions};return Object.keys(l).forEach(d=>{l[d]=l[d].filter(h=>h.session_id!==r)}),{chatSessions:l,currentSession:((o=i.currentSession)==null?void 0:o.session_id)===r?null:i.currentSession,messages:((c=i.currentSession)==null?void 0:c.session_id)===r?[]:i.messages}}),O.success("会话删除成功"),!0}catch(i){const l=((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"删除会话失败";return O.error(l),!1}},loadUsageStats:async(r=30)=>{var a,n;s({isLoading:!0,error:null});try{const i=await ut.getUsageStats(r);s({usageStats:i,isLoading:!1})}catch(i){const l=String(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"获取使用统计失败");s({error:l,isLoading:!1}),console.error("Load usage stats error:",i)}},clearCurrentMessages:()=>{s({messages:[],currentSession:null})},generateStrategy:async r=>{var a,n;s({isGenerating:!0,error:null});try{const i=await ut.generateStrategy(r),l={name:r.description.split(" ").slice(0,3).join(" ")+" Strategy",description:r.description,code:i.code,explanation:i.explanation,parameters:i.parameters,risk_assessment:{level:r.risk_level||"medium",factors:i.warnings||[],recommendations:["Review and test thoroughly before live trading"]}};return s(o=>({generatedStrategies:[l,...o.generatedStrategies],currentGeneratedStrategy:l,isGenerating:!1})),O.success("策略生成成功"),l}catch(i){const l=String(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"策略生成失败");return s({error:l,isGenerating:!1}),O.error(l),null}},optimizeStrategy:async(r,a)=>{var n,i;s({isLoading:!0,error:null});try{const l=`请优化以下策略代码，优化目标：${a.join(", ")}

代码：
${r}`,o=await ut.sendChatMessage(l,void 0,"developer","strategy");return s({isLoading:!1}),O.success("策略优化完成"),{code:o.response,explanation:"通过AI聊天优化生成",improvements:a}}catch(l){const o=String(((i=(n=l.response)==null?void 0:n.data)==null?void 0:i.message)||"策略优化失败");throw s({error:o,isLoading:!1}),O.error(o),l}},explainStrategy:async r=>{var a,n;s({isLoading:!0,error:null});try{const i=`请详细解释以下策略代码的逻辑和功能：

${r}`,l=await ut.sendChatMessage(i,void 0,"developer","strategy");return s({isLoading:!1}),{explanation:l.response,complexity:"medium",features:[]}}catch(i){const l=String(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"策略解释失败");throw s({error:l,isLoading:!1}),O.error(l),i}},clearGeneratedStrategies:()=>{s({generatedStrategies:[],currentGeneratedStrategy:null})},analyzeMarket:async(r,a,n)=>{var l,o;const i=`${r}-${n}`;s({isAnalyzing:!0,error:null});try{const c=await ut.analyzeMarket({symbols:[r],timeframe:n,analysis_type:"technical"}),d={symbol:r,timeframe:n,trend_direction:"neutral",strength:.5,support_levels:[],resistance_levels:[],technical_indicators:c.risk_assessment||{},summary:c.summary,recommendations:c.recommendations,confidence:.75};return s(h=>({marketAnalyses:{...h.marketAnalyses,[i]:d},isAnalyzing:!1})),O.success(`${r} 市场分析完成`),d}catch(c){const d=String(((o=(l=c.response)==null?void 0:l.data)==null?void 0:o.message)||"市场分析失败");return s({error:d,isAnalyzing:!1}),O.error(d),null}},getTradingSignals:async(r,a,n)=>{var i,l;s({isLoading:!0,error:null});try{const o=[];for(const c of n){const d=await ut.analyzeMarket({symbols:[r],timeframe:c,analysis_type:"technical"});o.push({symbol:r,timeframe:c,signals:d.signals||[],summary:d.summary,recommendations:d.recommendations})}return s({isLoading:!1}),O.success(`${r} 交易信号获取成功`),o}catch(o){const c=String(((l=(i=o.response)==null?void 0:i.data)==null?void 0:l.message)||"获取交易信号失败");throw s({error:c,isLoading:!1}),O.error(c),o}},assessRisk:async(r,a)=>{var n,i;s({isLoading:!0,error:null});try{const l=r?`请评估以下策略代码的风险：
${r}`:`请评估以下投资组合的风险：
${JSON.stringify(a,null,2)}`,o=await ut.sendChatMessage(l,void 0,"trader","strategy"),c={riskLevel:"medium",riskFactors:["市场波动风险","流动性风险"],recommendations:o.response.split(`
`).filter(d=>d.trim()),score:.6};return s({isLoading:!1}),O.success("风险评估完成"),c}catch(l){const o=String(((i=(n=l.response)==null?void 0:n.data)==null?void 0:i.message)||"风险评估失败");throw s({error:o,isLoading:!1}),O.error(o),l}},clearError:()=>{s({error:null})},reset:()=>{s({currentAIMode:"developer",chatSessions:{developer:[],trader:[]},currentSession:null,messages:[],isTyping:!1,generatedStrategies:[],isGenerating:!1,currentGeneratedStrategy:null,marketAnalyses:{},isAnalyzing:!1,usageStats:null,isLoading:!1,error:null,networkStatus:"connected",retryCount:0})},toggleWebSocket:()=>{s(a=>({useWebSocket:!a.useWebSocket,aiProgress:null}));const{useWebSocket:r}=t();O.success(r?"已切换到WebSocket模式 (实时对话)":"已切换到HTTP模式")},initializeWebSocket:async()=>{var a,n;const{useWebSocket:r}=t();if(!r)return console.log("🔄 [AIStore] WebSocket未启用，跳过初始化"),!1;try{s({isLoading:!0,error:null});const i=localStorage.getItem("auth-storage");if(!i)throw new Error("未找到认证信息，请重新登录");const l=JSON.parse(i),o=((a=l==null?void 0:l.state)==null?void 0:a.token)||"",c=((n=l==null?void 0:l.state)==null?void 0:n.isAuthenticated)||!1;if(!o||!c)throw new Error("认证token无效或已过期，请重新登录");console.log("🔗 [AIStore] 开始初始化WebSocket连接..."),console.log("🔑 [AIStore] 使用token:",o.substring(0,20)+"...");const d=si({baseUrl:window.location.origin,token:o});if(console.log("🔄 [AIStore] WebSocket服务实例已创建，开始连接..."),await d.initialize()){const u=d.getConnectionStatus();return console.log("✅ [AIStore] WebSocket连接成功:",u),s({wsConnected:!0,wsConnectionId:u.connectionId,isLoading:!1,networkStatus:"connected"}),O.success("🌊 WebSocket AI服务连接成功!",{icon:"🔗",duration:3e3}),!0}else throw new Error("WebSocket连接失败")}catch(i){const l=String((i==null?void 0:i.message)||i||"WebSocket连接失败");return console.error("❌ [AIStore] WebSocket初始化失败:",i),s({wsConnected:!1,wsConnectionId:null,error:l,isLoading:!1,networkStatus:"disconnected"}),l.includes("认证")||l.includes("登录")?O.error(`🔐 ${l}`,{icon:"🔑",duration:6e3}):O.error(`🔌 WebSocket连接失败: ${l}`,{icon:"❌",duration:5e3}),!1}},sendMessageWebSocket:async r=>{var o;const{currentSession:a,currentAIMode:n,useWebSocket:i,wsConnected:l}=t();if(!i)return t().sendMessage(r);if(!l&&!await t().initializeWebSocket())return O.error("WebSocket未连接，请检查网络连接"),!1;if(!a){const c=n==="trader"?"市场分析对话":"策略开发对话";if(!await t().createChatSession({name:c,ai_mode:n,session_type:"strategy",description:"自动创建的WebSocket对话会话"}))return O.error("创建对话会话失败"),!1}s(c=>{const d={role:"user",content:String(r||""),timestamp:new Date().toISOString()};return{messages:[...c.messages,d],isTyping:!0,error:null,aiProgress:{isProcessing:!0,step:0,totalSteps:4,status:"preparing",message:"正在准备发送..."}}});try{const c=localStorage.getItem("auth-storage");if(!c)throw new Error("认证信息丢失，请重新登录");const d=JSON.parse(c),h=((o=d==null?void 0:d.state)==null?void 0:o.token)||"";if(!h)throw new Error("认证token无效，请重新登录");const u=si({baseUrl:window.location.origin,token:h}),j=t().currentSession;return await u.sendChatMessage(r,j.session_id,j.ai_mode,j.session_type,{onStart:p=>{s(f=>({aiProgress:{...f.aiProgress,status:"started",message:p.message||"AI开始处理..."}}))},onComplexityAnalysis:p=>{s(f=>({aiProgress:{...f.aiProgress,complexity:p.complexity,estimatedTime:p.estimated_time_seconds,message:p.message}}))},onProgress:p=>{s(f=>({aiProgress:{...f.aiProgress,step:p.step,totalSteps:p.total_steps,status:p.status,message:p.message}}))},onSuccess:p=>{let f;if(typeof p.response=="string"&&p.response)f=p.response;else if(p.response&&typeof p.response=="object"){const y=p.response;f=y.content||y.message||JSON.stringify(y)}else p.message?f=String(p.message):f="AI响应错误";f=String(f||"AI响应为空");const x={role:"assistant",content:f,timestamp:new Date().toISOString()};f&&f.includes("```")&&(x.metadata={codeBlock:f}),s(y=>{const m={role:"assistant",content:String(x.content),timestamp:String(x.timestamp)};return x.metadata&&(m.metadata={codeBlock:String(x.metadata.codeBlock||"")}),{messages:[...y.messages,m],isTyping:!1,aiProgress:null}}),p.cost_usd>0&&O.success(`AI回复完成 (消耗 $${p.cost_usd.toFixed(4)}, ${p.tokens_used} tokens)`,{icon:"🚀",duration:4e3})},onStreamStart:p=>{console.log("🌊 [AIStore] 流式开始:",p),s(f=>{const x={role:"assistant",content:"🤔 AI正在深度思考中，马上开始回复...",timestamp:new Date().toISOString(),metadata:{isStreaming:!0,isWaitingFirstChunk:!0}};return{messages:[...f.messages,x],isTyping:!1,streamingMessage:{isStreaming:!0,requestId:p.request_id,accumulatedContent:"",messageIndex:f.messages.length},aiProgress:{...f.aiProgress,status:"stream_waiting",message:"🌊 AI正在深度分析，即将开始流式回复..."}}})},onStreamChunk:p=>{console.log("📝 [AIStore] 流式数据块:",p.chunk),s(f=>{var g;const{streamingMessage:x}=f;if(!(x!=null&&x.isStreaming)||x.messageIndex===void 0)return f;const y=[...f.messages];let m=x.accumulatedContent;if(y[x.messageIndex]){const v=y[x.messageIndex];m=((g=v.metadata)==null?void 0:g.isWaitingFirstChunk)?p.chunk:x.accumulatedContent+p.chunk,y[x.messageIndex]={...v,content:m,metadata:{isStreaming:!0,isWaitingFirstChunk:!1}}}return{messages:y,streamingMessage:{...x,accumulatedContent:m},aiProgress:{...f.aiProgress,status:"streaming_active",message:"✍️ AI正在实时生成回复..."}}})},onStreamEnd:p=>{console.log("✅ [AIStore] 流式结束:",p),s(f=>{console.log("🔄 [AIStore] 流式结束前的状态:",{isTyping:f.isTyping,aiProgress:f.aiProgress,streamingMessage:f.streamingMessage});const{streamingMessage:x}=f;if(!(x!=null&&x.isStreaming)||x.messageIndex===void 0)return console.log("⚠️ [AIStore] 流式状态检查失败，直接清理状态"),{...f,isTyping:!1,streamingMessage:null,aiProgress:null};const y=[...f.messages];if(y[x.messageIndex]){const g=y[x.messageIndex],v=p.content||g.content||x.accumulatedContent||"";y[x.messageIndex]={...g,content:v,metadata:{codeBlock:v.includes("```")?v:void 0}}}const m={messages:y,isTyping:!1,streamingMessage:null,aiProgress:null};return console.log("✅ [AIStore] 流式结束后的状态:",{isTyping:m.isTyping,aiProgress:m.aiProgress,streamingMessage:m.streamingMessage,messageCount:m.messages.length}),m}),p.cost_usd>0&&O.success(`🌊 流式AI回复完成 (消耗 $${p.cost_usd.toFixed(4)}, ${p.tokens_used} tokens)`,{icon:"🚀",duration:4e3})},onStreamError:p=>{console.log("❌ [AIStore] 流式错误:",{error:p==null?void 0:p.error,error_type:p==null?void 0:p.error_type,message:p==null?void 0:p.message,request_id:p==null?void 0:p.request_id}),s(x=>({...x,isTyping:!1,streamingMessage:null,aiProgress:null,error:(p==null?void 0:p.error)||"流式处理失败"}));const f=t().getErrorMessage(p);O.error(f,{duration:6e3,id:`stream-error-${Date.now()}`})},onError:p=>{console.log("❌ [AIStore] onError - 处理AI对话错误:",p);const f=t().getErrorMessage(p);O.error(f);const x=`抱歉，${f}`;s(m=>{const g={role:"assistant",content:String(x),timestamp:new Date().toISOString(),metadata:{isError:!0}};return{messages:[...m.messages,g],isTyping:!1,error:String(x),aiProgress:null}});const y=p.retry_suggested?`${f} (可以重试)`:f;O.error(y,{duration:p.retry_suggested?8e3:5e3,icon:p.retry_suggested?"🔄":"❌"})}}),!0}catch(c){return console.error("❌ [DEBUG] WebSocket发送异常:",c),console.error("❌ [DEBUG] Error stack:",c.stack),console.error("❌ [DEBUG] Error details:",{message:c.message,name:c.name,type:typeof c,error:c}),s({isTyping:!1,error:c.message||"WebSocket发送失败",aiProgress:null}),O.error(`WebSocket发送失败: ${c.message}`),!1}},checkNetworkStatus:async()=>{try{s({networkStatus:"checking"});const r=new AbortController,a=setTimeout(()=>r.abort(),5e3);return await fetch("/api/v1/health",{method:"HEAD",signal:r.signal}),clearTimeout(a),s({networkStatus:"connected"}),!0}catch{return s({networkStatus:"disconnected"}),!1}},getErrorMessage:r=>{if(!r)return"未知错误，请重试";const a=r.error_code||r.code,n=r.error||r.message||"";switch(a){case"WEBSOCKET_TIMEOUT":return"⏰ AI响应超时，请重试或检查网络连接";case"WEBSOCKET_DISCONNECTED":return"🔌 连接断开，正在重新连接...";case"WEBSOCKET_ERROR":return"📡 网络连接出现问题，请检查网络设置";case"AI_PROCESSING_FAILED":return"🤖 AI处理失败，请稍后重试";case"RATE_LIMIT_EXCEEDED":return"⚡ 请求过于频繁，请稍等片刻再试";case"INSUFFICIENT_CREDITS":return"💳 AI对话额度不足，请升级会员";case"INVALID_SESSION":return"🔄 会话已过期，将为您创建新会话"}return n.includes("timeout")||n.includes("超时")?"⏰ 请求超时，请重试":n.includes("network")||n.includes("网络")?"📡 网络连接异常，请检查网络设置":n.includes("quota")||n.includes("额度")?"💳 AI对话额度已用尽，请明日再试或升级会员":n.includes("session")||n.includes("会话")?"🔄 会话异常，请刷新页面重试":n.includes("auth")||n.includes("认证")?"🔐 身份认证失败，请重新登录":n?`❌ ${n}`:"⚠️ 服务暂时不可用，请稍后重试"}}),{name:"ai-storage",partialize:s=>({currentAIMode:s.currentAIMode,chatSessions:s.chatSessions,generatedStrategies:s.generatedStrategies,marketAnalyses:s.marketAnalyses,usageStats:s.usageStats})})),Ve={async getAccountBalance(s){try{const t=await te.get(`/trading/accounts/${s}/balance`);return Q(t)}catch(t){J(t)}},async getSupportedExchanges(){try{const s=await te.get("/trading/exchanges");return Q(s)}catch(s){J(s)}},async getSymbols(s){try{const t=await te.get(`/trading/exchanges/${s}/symbols`);return Q(t)}catch(t){J(t)}},async createOrder(s){try{const t=await te.post("/trading/orders",s);return Q(t)}catch(t){J(t)}},async getOrders(s){try{const t=await te.get("/trading/orders",{params:s});return Q(t)}catch(t){J(t)}},async getOrder(s){try{const t=await te.get(`/trading/orders/${s}`);return Q(t)}catch(t){J(t)}},async cancelOrder(s){try{const t=await te.delete(`/trading/orders/${s}`);return Q(t)}catch(t){J(t)}},async getOrderStatistics(s=30){try{const t=await te.get(`/trading/orders/statistics?days=${s}`);return Q(t)}catch(t){J(t)}},async getPositions(s){try{const t=s?`/trading/positions?exchange=${s}`:"/trading/positions",r=await te.get(t);return Q(r)}catch(t){J(t)}},async getPositionPnL(s,t,r){try{const a=await te.get(`/trading/positions/${t}/${s}/pnl`,{params:{current_price:r}});return Q(a)}catch(a){J(a)}},async getTradingSummary(s=30){try{const t=await te.get(`/trading/summary?days=${s}`);return Q(t)}catch(t){J(t)}},async getDailyPnL(s=30){try{const t=await te.get(`/trading/daily-pnl?days=${s}`);return Q(t)}catch(t){J(t)}},async getTrades(s){try{const t=await te.get("/trading/trades",{params:s});return Q(t)}catch(t){J(t)}},async createTradingSession(s){try{const t=await te.post("/trading/sessions",s);return Q(t)}catch(t){J(t)}},async getTradingSessions(){try{const s=await te.get("/trading/sessions");return Q(s)}catch(s){J(s)}},async startTradingSession(s){try{const t=await te.post(`/trading/sessions/${s}/start`);return Q(t)}catch(t){J(t)}},async stopTradingSession(s){try{const t=await te.post(`/trading/sessions/${s}/stop`);return Q(t)}catch(t){J(t)}},async validateOrder(s){try{const t=await te.post("/trading/risk/validate-order",s);return Q(t)}catch(t){J(t)}},async getPortfolioRisk(){try{const s=await te.get("/trading/risk/portfolio");return Q(s)}catch(s){J(s)}},async getMarketData(s,t,r,a=100){try{const n=await te.get("/trading/market-data",{params:{exchange:s,symbol:t,timeframe:r,limit:a}});return Q(n)}catch(n){J(n)}},async getTradingFees(s){try{const t=await te.get(`/trading/fees/${s}`);return Q(t)}catch(t){J(t)}}},ca={exchange:"okx",symbol:"BTC/USDT",side:"buy",order_type:"limit",price:"",quantity:"",amount:""},Ea=Ut()(js((s,t)=>({accounts:{},selectedExchange:"okx",supportedExchanges:[],availableSymbols:[],orders:[],activeOrders:[],orderHistory:[],orderStats:null,positions:[],totalPortfolioValue:0,totalUnrealizedPnL:0,totalRealizedPnL:0,tradingSummary:null,dailyPnLData:[],recentTrades:[],tradingSessions:[],activeSessions:[],tradingForm:ca,lastRiskAssessment:null,selectedTimeframe:"15m",showAdvancedOptions:!1,isLoading:!1,isPlacingOrder:!1,isLoadingPositions:!1,isLoadingOrders:!1,error:null,loadSupportedExchanges:async()=>{try{s({isLoading:!0,error:null});const r=await Ve.getSupportedExchanges();s({supportedExchanges:r,isLoading:!1})}catch(r){s({error:r instanceof Error?r.message:"Failed to load exchanges",isLoading:!1})}},loadAccountBalance:async r=>{try{s({isLoading:!0,error:null});const a=await Ve.getAccountBalance(r);s(n=>({accounts:{...n.accounts,[r]:a},isLoading:!1}))}catch(a){s({error:a instanceof Error?a.message:"Failed to load account balance",isLoading:!1})}},loadAvailableSymbols:async r=>{try{const a=await Ve.getSymbols(r);s({availableSymbols:a})}catch(a){console.error("Failed to load symbols:",a)}},switchExchange:r=>{s({selectedExchange:r}),t().loadAccountBalance(r),t().loadAvailableSymbols(r),t().loadPositions(r)},createOrder:async r=>{try{s({isPlacingOrder:!0,error:null});const a=await Ve.createOrder(r);return s(n=>({orders:[a,...n.orders],activeOrders:a.status==="filled"?n.activeOrders:[a,...n.activeOrders],isPlacingOrder:!1})),t().loadPositions(),t().loadAccountBalance(r.exchange),a}catch(a){return s({error:a instanceof Error?a.message:"Failed to create order",isPlacingOrder:!1}),null}},loadOrders:async(r={})=>{try{s({isLoadingOrders:!0,error:null});const a=await Ve.getOrders(r),n=a.filter(l=>!["filled","canceled","rejected","failed"].includes(l.status)),i=a.filter(l=>["filled","canceled","rejected","failed"].includes(l.status));s({orders:a,activeOrders:n,orderHistory:i,isLoadingOrders:!1})}catch(a){s({error:a instanceof Error?a.message:"Failed to load orders",isLoadingOrders:!1})}},cancelOrder:async r=>{try{s({isLoading:!0,error:null}),await Ve.cancelOrder(r),s(a=>({orders:a.orders.map(n=>n.id===r?{...n,status:"canceled"}:n),activeOrders:a.activeOrders.filter(n=>n.id!==r),isLoading:!1}))}catch(a){s({error:a instanceof Error?a.message:"Failed to cancel order",isLoading:!1})}},refreshOrder:async r=>{try{const a=await Ve.getOrder(r);s(n=>({orders:n.orders.map(i=>i.id===r?a:i),activeOrders:n.activeOrders.map(i=>i.id===r?a:i)}))}catch(a){console.error("Failed to refresh order:",a)}},loadOrderStatistics:async(r=30)=>{try{const a=await Ve.getOrderStatistics(r);s({orderStats:a})}catch(a){console.error("Failed to load order statistics:",a)}},loadPositions:async r=>{try{s({isLoadingPositions:!0,error:null});const a=await Ve.getPositions(r),n=a.reduce((o,c)=>o+c.current_value,0),i=a.reduce((o,c)=>o+c.unrealized_pnl,0),l=a.reduce((o,c)=>o+c.realized_pnl,0);s({positions:a,totalPortfolioValue:n,totalUnrealizedPnL:i,totalRealizedPnL:l,isLoadingPositions:!1})}catch(a){s({error:a instanceof Error?a.message:"Failed to load positions",isLoadingPositions:!1})}},refreshPositions:async()=>{const{selectedExchange:r}=t();await t().loadPositions(r)},calculatePositionPnL:async(r,a,n)=>{try{const i=await Ve.getPositionPnL(r,a,n);s(l=>({positions:l.positions.map(o=>o.symbol===r&&o.exchange===a?i:o)}))}catch(i){console.error("Failed to calculate position PnL:",i)}},loadTradingSummary:async(r=30)=>{try{s({isLoading:!0,error:null});const a=await Ve.getTradingSummary(r);s({tradingSummary:a,isLoading:!1})}catch(a){s({error:a instanceof Error?a.message:"Failed to load trading summary",isLoading:!1})}},loadDailyPnL:async(r=30)=>{try{const a=await Ve.getDailyPnL(r);s({dailyPnLData:a})}catch(a){console.error("Failed to load daily PnL:",a)}},loadRecentTrades:async(r={})=>{try{const a=await Ve.getTrades({...r,limit:50});s({recentTrades:a})}catch(a){console.error("Failed to load recent trades:",a)}},createTradingSession:async r=>{try{s({isLoading:!0,error:null});const a=await Ve.createTradingSession(r);return s(n=>({tradingSessions:[a,...n.tradingSessions],isLoading:!1})),a}catch(a){return s({error:a instanceof Error?a.message:"Failed to create trading session",isLoading:!1}),null}},loadTradingSessions:async()=>{try{const r=await Ve.getTradingSessions(),a=r.filter(n=>n.status==="active");s({tradingSessions:r,activeSessions:a})}catch(r){console.error("Failed to load trading sessions:",r)}},startTradingSession:async r=>{try{s({isLoading:!0,error:null}),await Ve.startTradingSession(r),s(a=>({tradingSessions:a.tradingSessions.map(n=>n.id===r?{...n,status:"active"}:n),isLoading:!1}))}catch(a){s({error:a instanceof Error?a.message:"Failed to start trading session",isLoading:!1})}},stopTradingSession:async r=>{try{s({isLoading:!0,error:null}),await Ve.stopTradingSession(r),s(a=>({tradingSessions:a.tradingSessions.map(n=>n.id===r?{...n,status:"stopped"}:n),isLoading:!1}))}catch(a){s({error:a instanceof Error?a.message:"Failed to stop trading session",isLoading:!1})}},updateTradingForm:(r,a)=>{s(n=>({tradingForm:{...n.tradingForm,[r]:a}})),(r==="price"||r==="quantity")&&t().calculateOrderAmount()},resetTradingForm:()=>{s({tradingForm:ca,lastRiskAssessment:null})},calculateOrderAmount:()=>{const{tradingForm:r}=t(),{price:a,quantity:n}=r;if(a&&n){const i=(parseFloat(a)*parseFloat(n)).toFixed(2);s(l=>({tradingForm:{...l.tradingForm,amount:i}}))}},validateOrder:async()=>{try{const{tradingForm:r}=t();if(!r.quantity||!r.price)return null;const a={exchange:r.exchange,symbol:r.symbol,order_type:r.order_type,side:r.side,amount:parseFloat(r.quantity),price:r.order_type==="limit"?parseFloat(r.price):void 0},n=await Ve.validateOrder(a);return s({lastRiskAssessment:n}),n}catch(r){return console.error("Failed to validate order:",r),null}},setSelectedTimeframe:r=>{s({selectedTimeframe:r})},toggleAdvancedOptions:()=>{s(r=>({showAdvancedOptions:!r.showAdvancedOptions}))},setLoading:r=>s({isLoading:r}),setError:r=>s({error:r}),clearError:()=>s({error:null}),reset:()=>s({accounts:{},orders:[],activeOrders:[],orderHistory:[],positions:[],tradingSessions:[],activeSessions:[],tradingForm:ca,lastRiskAssessment:null,isLoading:!1,isPlacingOrder:!1,isLoadingPositions:!1,isLoadingOrders:!1,error:null})}),{name:"trading-store",partialize:s=>({selectedExchange:s.selectedExchange,tradingForm:s.tradingForm,selectedTimeframe:s.selectedTimeframe,showAdvancedOptions:s.showAdvancedOptions})})),Au=()=>Ea(s=>({accounts:s.accounts,selectedExchange:s.selectedExchange,supportedExchanges:s.supportedExchanges,switchExchange:s.switchExchange,loadAccountBalance:s.loadAccountBalance,loadSupportedExchanges:s.loadSupportedExchanges})),kt={async createBacktest(s){try{const t=await te.post("/backtests",s);return Q(t)}catch(t){J(t)}},async getBacktests(s){try{const t=await te.get("/backtests",{params:s});return Q(t)}catch(t){J(t)}},async getBacktest(s){try{const t=await te.get(`/backtests/${s}`);return Q(t)}catch(t){J(t)}},async getBacktestStatus(s){try{const t=await te.get(`/backtests/${s}/status`);return Q(t)}catch(t){J(t)}},async stopBacktest(s){try{const t=await te.post(`/backtests/${s}/stop`);return Q(t)}catch(t){J(t)}},async deleteBacktest(s){try{const t=await te.delete(`/backtests/${s}`);return Q(t)}catch(t){J(t)}},async downloadBacktestReport(s,t="html"){try{return(await te.get(`/backtests/${s}/report`,{params:{format:t},responseType:"blob"})).data}catch(r){J(r)}},async compareBacktests(s){try{const t=await te.post("/backtests/compare",{backtest_ids:s});return Q(t)}catch(t){J(t)}}},da={strategy_id:"",symbol:"BTC/USDT",exchange:"okx",start_date:"2024-01-01",end_date:"2024-03-31",initial_capital:1e4,commission_rate:.001,timeframe:"1h"},nr=Ut()(js((s,t)=>({backtests:[],currentBacktest:null,loading:!1,error:null,configForm:da,isCreatingBacktest:!1,runningBacktests:new Map,selectedForComparison:[],comparisonResult:null,pagination:{page:1,per_page:10,total:0,total_pages:0},filters:{},fetchBacktests:async r=>{s({loading:!0,error:null});try{const{page:a=1,per_page:n=10}=r||{},i=await kt.getBacktests({page:a,per_page:n,...t().filters}),l=Array.isArray(i)?i:[];s({backtests:l,pagination:{page:a,per_page:n,total:l.length,total_pages:Math.ceil(l.length/n)},loading:!1})}catch(a){console.error("Error fetching backtests:",a),s({backtests:[],error:a instanceof Error?a.message:"Failed to fetch backtests",loading:!1})}},fetchBacktest:async r=>{s({loading:!0,error:null});try{const a=await kt.getBacktest(r);s({currentBacktest:a,loading:!1})}catch(a){s({error:a instanceof Error?a.message:"Failed to fetch backtest",loading:!1})}},refreshBacktest:async r=>{try{const a=await kt.getBacktest(r);s(n=>{var i;return{backtests:n.backtests.map(l=>l.id===r?a:l),currentBacktest:((i=n.currentBacktest)==null?void 0:i.id)===r?a:n.currentBacktest}})}catch(a){console.error("Failed to refresh backtest:",a)}},deleteBacktest:async r=>{s({loading:!0,error:null});try{await kt.deleteBacktest(r),s(a=>{var n;return{backtests:a.backtests.filter(i=>i.id!==r),currentBacktest:((n=a.currentBacktest)==null?void 0:n.id)===r?null:a.currentBacktest,loading:!1}})}catch(a){s({error:a instanceof Error?a.message:"Failed to delete backtest",loading:!1})}},createBacktest:async r=>{s({isCreatingBacktest:!0,error:null});try{const a=await kt.createBacktest(r);return s(n=>({backtests:[a,...n.backtests],currentBacktest:a,isCreatingBacktest:!1})),a.status==="running"&&t().pollBacktestStatus(a.id),a}catch(a){return s({error:a instanceof Error?a.message:"Failed to create backtest",isCreatingBacktest:!1}),null}},stopBacktest:async r=>{try{await kt.stopBacktest(r),s(a=>{var n;return{backtests:a.backtests.map(i=>i.id===r?{...i,status:"failed"}:i),currentBacktest:((n=a.currentBacktest)==null?void 0:n.id)===r?{...a.currentBacktest,status:"failed"}:a.currentBacktest}})}catch(a){s({error:a instanceof Error?a.message:"Failed to stop backtest"})}},updateBacktestForm:(r,a)=>{s(n=>({configForm:{...n.configForm,[r]:a}}))},resetBacktestForm:()=>{s({configForm:da})},updateBacktestStatus:(r,a,n)=>{s(i=>({runningBacktests:new Map(i.runningBacktests).set(r,{status:a,progress:n})}))},pollBacktestStatus:async r=>{const n=async()=>{try{const i=await kt.getBacktestStatus(r);if(t().updateBacktestStatus(r,i.status,i.progress),i.status==="completed"||i.status==="failed"){t().refreshBacktest(r);return}setTimeout(n,3e3)}catch(i){console.error("Failed to poll backtest status:",i)}};n()},toggleComparisonSelection:r=>{s(a=>({selectedForComparison:a.selectedForComparison.includes(r)?a.selectedForComparison.filter(n=>n!==r):[...a.selectedForComparison,r].slice(0,5)}))},compareBacktests:async()=>{const{selectedForComparison:r}=t();if(!(r.length<2)){s({loading:!0,error:null});try{const a=await kt.compareBacktests(r);s({comparisonResult:a,loading:!1})}catch(a){s({error:a instanceof Error?a.message:"Failed to compare backtests",loading:!1})}}},clearComparison:()=>{s({selectedForComparison:[],comparisonResult:null})},downloadReport:async(r,a="html")=>{try{const n=await kt.downloadBacktestReport(r,a),i=window.URL.createObjectURL(n),l=document.createElement("a");l.href=i,l.download=`backtest-report-${r}.${a}`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(i)}catch(n){s({error:n instanceof Error?n.message:"Failed to download report"})}},setLoading:r=>s({loading:r}),setError:r=>s({error:r}),clearError:()=>s({error:null}),reset:()=>s({backtests:[],currentBacktest:null,loading:!1,error:null,configForm:da,isCreatingBacktest:!1,runningBacktests:new Map,selectedForComparison:[],comparisonResult:null,pagination:{page:1,per_page:10,total:0,total_pages:0},filters:{}})}),{name:"backtest-store",partialize:s=>({configForm:s.configForm,selectedForComparison:s.selectedForComparison})})),Lu=()=>nr(s=>({backtests:s.backtests,loading:s.loading,error:s.error,pagination:s.pagination,fetchBacktests:s.fetchBacktests,deleteBacktest:s.deleteBacktest,downloadReport:s.downloadReport})),Tu=()=>nr(s=>({configForm:s.configForm,isCreatingBacktest:s.isCreatingBacktest,createBacktest:s.createBacktest,updateBacktestForm:s.updateBacktestForm,resetBacktestForm:s.resetBacktestForm})),Mu=()=>nr(s=>({selectedForComparison:s.selectedForComparison,comparisonResult:s.comparisonResult,toggleComparisonSelection:s.toggleComparisonSelection,compareBacktests:s.compareBacktests,clearComparison:s.clearComparison})),ea=()=>{const s=et(h=>h.isLoading),t=_s(h=>h.isLoading),r=Su(h=>h.isLoading),a=Cr(h=>h.isLoading),n=Cr(h=>h.isGenerating),i=Cr(h=>h.isAnalyzing),l=Ea(h=>h.isLoading),o=Ea(h=>h.isPlacingOrder),c=nr(h=>h.loading),d=nr(h=>h.isCreatingBacktest);return{isLoading:s||t||r||a||l||c,isGenerating:n,isAnalyzing:i,isPlacingOrder:o,isCreatingBacktest:d,loadingStates:{auth:s,market:t,strategy:r,ai:a,aiGenerating:n,aiAnalyzing:i,trading:l,placingOrder:o,backtest:c,creatingBacktest:d}}},ta=()=>{const s=_s(a=>a.isConnected),t=_s(a=>a.subscribedTickers),r=_s(a=>a.connectionStats);return{isConnected:s,subscribedCount:t.size,subscribedTickers:Array.from(t),connectionStats:r,refreshStats:_s.getState().getConnectionStats}},$t=()=>{const s=et(a=>a.user),t=et(a=>a.isAuthenticated),r=(s==null?void 0:s.membership_level)||"basic";return{user:s,isAuthenticated:t,membershipLevel:r,isPremium:r==="premium"||r==="professional",isProfessional:r==="professional"}},Eu=()=>{const s=ot(),{user:t,isPremium:r}=$t(),{isConnected:a}=ta();ea();const{t:n}=Wt(),[i,l]=b.useState({totalStrategies:0,runningStrategies:0,totalIndicators:0,totalTrades:0,totalProfit:0,winRate:0,dailyPnl:0}),[o,c]=b.useState([]),[d,h]=b.useState(!1),u=async()=>{if(r)try{h(!0);const x=await ht.getStrategies();let y=[];x&&typeof x=="object"&&(y=Array.isArray(x)?x:x.strategies||[]),c(y);const m=y.filter(v=>{var P;return!v.name.includes("指标")&&!v.name.includes("RSI")&&!v.name.includes("MACD")&&!((P=v.description)!=null&&P.includes("指标"))}),g=y.filter(v=>{var P;return v.name.includes("指标")||v.name.includes("RSI")||v.name.includes("MACD")||((P=v.description)==null?void 0:P.includes("指标"))});l({totalStrategies:m.length,runningStrategies:3,totalTrades:0,totalProfit:1234.56,winRate:68.5,dailyPnl:123.45,totalIndicators:g.length})}catch(x){console.error("Failed to load overview data:",x),O.error("加载概览数据失败")}finally{h(!1)}};b.useEffect(()=>{u()},[r]);const j=[{title:n("strategiesManagement"),description:n("viewAndManageStrategies"),icon:"strategy",color:"blue",action:()=>s("/strategies")},{title:n("liveTrading"),description:n("startAutomatedTrading"),icon:"trading",color:"green",action:()=>s("/trading")},{title:n("strategyBacktest"),description:n("testStrategyPerformance"),icon:"backtest",color:"purple",action:()=>s("/backtest")},{title:n("aiAssistant"),description:n("getIntelligentTradingAdvice"),icon:"ai",color:"orange",action:()=>s("/ai-chat")}],p=x=>{const y={strategy:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M6 6V5a3 3 0 013-3h2a3 3 0 013 3v1h2a2 2 0 012 2v3.57A22.952 22.952 0 0110 13a22.95 22.95 0 01-8-1.43V8a2 2 0 012-2h2zm2-1a1 1 0 011-1h2a1 1 0 011 1v1H8V5zm1 5a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})}),trading:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}),backtest:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",clipRule:"evenodd"})}),ai:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})};return y[x]||y.strategy},f=x=>{const y={blue:{bg:"from-blue-50 to-blue-100",text:"text-blue-900",icon:"bg-blue-200 text-blue-600",hover:"hover:from-blue-100 hover:to-blue-200"},green:{bg:"from-green-50 to-green-100",text:"text-green-900",icon:"bg-green-200 text-green-600",hover:"hover:from-green-100 hover:to-green-200"},purple:{bg:"from-purple-50 to-purple-100",text:"text-purple-900",icon:"bg-purple-200 text-purple-600",hover:"hover:from-purple-100 hover:to-purple-200"},orange:{bg:"from-orange-50 to-orange-100",text:"text-orange-900",icon:"bg-orange-200 text-orange-600",hover:"hover:from-orange-100 hover:to-orange-200"}};return y[x]||y.blue};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n("tradingOverview")}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[n("welcomeBack"),"，",t==null?void 0:t.username,"！",n("checkTradingDataAndQuickActions")]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${a?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm text-gray-600",children:n(a?"realTimeConnected":"connectionLost")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:n("totalStrategies")}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:i.totalStrategies})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-200 flex items-center justify-center",children:p("strategy")})]})}),e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-xl p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:n("running")}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:i.runningStrategies})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-200 flex items-center justify-center",children:p("trading")})]})}),e.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-indigo-100 rounded-xl p-4 border border-indigo-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-indigo-600",children:"指标数量"}),e.jsx("p",{className:"text-2xl font-bold text-indigo-900",children:i.totalIndicators})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-200 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-indigo-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 0l-2 2a1 1 0 001.414 1.414L8 10.414l1.293 1.293a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-xl p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-600",children:n("totalProfit")}),e.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:["+",i.totalProfit.toFixed(2)]})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-200 flex items-center justify-center",children:e.jsxs("svg",{className:"w-5 h-5 text-purple-600",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"}),e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z",clipRule:"evenodd"})]})})]})}),e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-xl p-4 border border-orange-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600",children:n("winRate")}),e.jsxs("p",{className:"text-2xl font-bold text-orange-900",children:[i.winRate,"%"]})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-200 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-orange-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:n("quickActions")}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:j.map(x=>{const y=f(x.color);return e.jsx("div",{onClick:x.action,className:`bg-gradient-to-r ${y.bg} rounded-xl p-6 border cursor-pointer transition-all ${y.hover} hover:shadow-md`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${y.icon}`,children:p(x.icon)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold ${y.text} mb-1`,children:x.title}),e.jsx("p",{className:"text-sm text-gray-600",children:x.description})]})]})},x.title)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n("recentStrategies")}),e.jsxs("button",{onClick:()=>s("/strategies"),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:[n("viewAll")," →"]})]}),d?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("p",{className:"text-gray-500",children:n("loadingStrategies")})]}):o.length>0?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:o.slice(0,4).map(x=>{var y,m;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-shadow p-4",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:x.name}),e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${x.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:x.is_active?n("running"):n("stopped")})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:x.description}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsxs("span",{children:[n("tradingPair"),": ",((y=x.parameters)==null?void 0:y.symbol)||"N/A"]}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsxs("span",{children:[n("timeframe"),": ",((m=x.parameters)==null?void 0:m.timeframe)||"N/A"]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>s("/strategies"),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:n("viewDetails")})})]},x.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:n("noStrategies")}),e.jsx("p",{className:"text-gray-500 mb-4",children:n("createFirstStrategy")}),r?e.jsx("button",{onClick:()=>s("/strategies"),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:n("createStrategy")}):e.jsx("button",{onClick:()=>O.error(n("createStrategyRequiresPremium")),className:"inline-flex items-center px-4 py-2 bg-gray-300 text-gray-500 font-medium rounded-lg cursor-not-allowed",children:n("upgradeToCreate")})]})]})]})},Qs={async getLiveStrategies(s){try{const t=await te.get("/strategies",{params:s}),r=Q(t);return{strategies:r.strategies.map(n=>{var i,l;return{id:n.id.toString(),name:n.name,description:n.description,trading_pair:((i=n.parameters)==null?void 0:i.symbol)||"BTC/USDT",exchange:((l=n.parameters)==null?void 0:l.exchange)||"binance",status:n.is_active?"running":"stopped",profit_rate:Math.random()*20-5,signal_count:Math.floor(Math.random()*50),created_at:n.created_at,win_rate:Math.random()*100,total_trades:Math.floor(Math.random()*100),parameters:n.parameters}}),total:r.total,page:(s==null?void 0:s.page)||1,per_page:(s==null?void 0:s.per_page)||20}}catch(t){J(t)}},async getLiveStrategyStats(){try{const s=await te.get("/trading/stats");return Q(s)}catch(s){J(s)}},async getLiveStrategyDetails(s){try{const t=await te.get(`/strategies/${s}/live-details`);return Q(t)}catch(t){J(t)}},async executeStrategyAction(s,t){try{const r=await te.post(`/strategies/${s}/action`,t);return Q(r)}catch(r){J(r)}},async createLiveStrategy(s){try{const t=await te.post("/strategies",{...s,type:"live"});return Q(t)}catch(t){J(t)}},async updateStrategyParameters(s,t){try{const r=await te.put(`/strategies/${s}/parameters`,{parameters:t});return Q(r)}catch(r){J(r)}},async getStrategyTrades(s,t){try{const r=await te.get(`/strategies/${s}/trades`,{params:t});return Q(r)}catch(r){J(r)}},async getStrategyPerformance(s,t){try{const r=await te.get(`/strategies/${s}/performance`,{params:{period:t}});return Q(r)}catch(r){J(r)}},async getUserLiveStrategies(s){try{const t=await te.get("/trading/live-strategies",{params:s});return Q(t).map(a=>{var n,i;return{id:a.id.toString(),name:a.name,description:a.description||"",trading_pair:((n=a.parameters)==null?void 0:n.symbol)||"BTC/USDT",exchange:((i=a.parameters)==null?void 0:i.exchange)||"binance",status:a.status,profit_rate:a.profit_loss||0,signal_count:a.total_trades||0,created_at:a.created_at,total_trades:a.total_trades||0,win_rate:Math.random()*100,parameters:a.parameters}})}catch(t){J(t)}},async deleteLiveStrategy(s){try{const t=await te.delete(`/trading/live-strategies/${s}`);return Q(t)}catch(t){J(t)}}},Pu=()=>{const s=ot(),{isPremium:t}=$t();ta(),ea();const{t:r}=Wt(),[a,n]=b.useState(null),[i,l]=b.useState(""),[o,c]=b.useState("all"),[d,h]=b.useState([]),[u,j]=b.useState(!1),p=async()=>{if(t)try{j(!0);const T=(await Qs.getUserLiveStrategies()).map(k=>{const R=k.profit_rate/1e3||0;return{id:parseInt(k.id),name:k.name,description:k.description,code:"",parameters:{symbol:k.trading_pair,exchange:k.exchange,...k.parameters},is_active:k.status!=="stopped",user_id:9,created_at:k.created_at,status:k.status,profit:R>=0?`+${R.toFixed(2)}`:R.toFixed(2),profitPercent:R,lastUpdate:k.created_at,runningTime:k.status==="running"?"运行中":k.status==="paused"?"已暂停":"已停止",totalTrades:k.total_trades||0,winRate:k.win_rate||0}});h(T),O.success(`加载了 ${T.length} 个实盘策略`)}catch(A){console.error("Failed to load live strategies:",A),O.error("加载实盘策略失败")}finally{j(!1)}};b.useEffect(()=>{p()},[t]);const f={total:d.length,running:d.filter(A=>A.status==="running").length,stopped:d.filter(A=>A.status==="stopped").length,paused:d.filter(A=>A.status==="paused").length},x=d.filter(A=>{var se;const T=((se=A.parameters)==null?void 0:se.symbol)||"",k=A.name.toLowerCase().includes(i.toLowerCase())||A.description.toLowerCase().includes(i.toLowerCase())||T.toLowerCase().includes(i.toLowerCase()),R=o==="all"||A.status===o;return k&&R}),y=A=>{if(!t){O.error(r("startStrategyRequiresPremium"));return}h(T=>T.map(k=>k.id===A.id?{...k,status:"running",lastUpdate:new Date().toLocaleString("zh-CN")}:k)),O.success(`${A.name} ${r("strategyStarted")}`)},m=A=>{h(T=>T.map(k=>k.id===A.id?{...k,status:"stopped",lastUpdate:new Date().toLocaleString("zh-CN")}:k)),O.success(`${A.name} ${r("strategyStopped")}`)},g=A=>{h(T=>T.map(k=>k.id===A.id?{...k,status:"paused",lastUpdate:new Date().toLocaleString("zh-CN")}:k)),O.success(`${A.name} ${r("strategyPaused")}`)},v=async A=>{if(A.status!=="stopped"){O.error("只能删除已停止的实盘策略");return}if(window.confirm(`确认删除实盘策略 "${A.name}"?
此操作不可撤销。`))try{await Qs.deleteLiveStrategy(A.id.toString()),h(T=>T.filter(k=>k.id!==A.id)),O.success(`实盘策略 "${A.name}" 删除成功`)}catch(T){console.error("Delete strategy failed:",T),O.error("删除实盘策略失败")}},P=A=>{switch(A){case"running":return r("runningLive");case"stopped":return r("stoppedLive");case"paused":return r("pausedLive");default:return"Unknown"}},E=A=>{s(`/strategy/${A.id}/live`)};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:r("liveTrading")}),e.jsx("p",{className:"text-gray-600",children:r("monitorRunningStrategies")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:`bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4 border border-blue-200 cursor-pointer transition-all hover:shadow-md ${o==="all"?"ring-2 ring-blue-500 shadow-md":""}`,onClick:()=>c("all"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:r("totalLiveStrategies")}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:f.total})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-200 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z",clipRule:"evenodd"})})})]}),o==="all"&&e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:r("selected")})})]}),e.jsxs("div",{className:`bg-gradient-to-r from-green-50 to-green-100 rounded-xl p-4 border border-green-200 cursor-pointer transition-all hover:shadow-md ${o==="running"?"ring-2 ring-green-500 shadow-md":""}`,onClick:()=>c("running"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:r("runningLive")}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:f.running})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-200 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})]}),o==="running"&&e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-xs text-green-600 font-medium",children:r("selected")})})]}),e.jsxs("div",{className:`bg-gradient-to-r from-yellow-50 to-yellow-100 rounded-xl p-4 border border-yellow-200 cursor-pointer transition-all hover:shadow-md ${o==="paused"?"ring-2 ring-yellow-500 shadow-md":""}`,onClick:()=>c("paused"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-600",children:r("pausedLive")}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:f.paused})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-yellow-200 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]}),o==="paused"&&e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-xs text-yellow-600 font-medium",children:r("selected")})})]}),e.jsxs("div",{className:`bg-gradient-to-r from-red-50 to-red-100 rounded-xl p-4 border border-red-200 cursor-pointer transition-all hover:shadow-md ${o==="stopped"?"ring-2 ring-red-500 shadow-md":""}`,onClick:()=>c("stopped"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-600",children:r("stoppedLive")}),e.jsx("p",{className:"text-2xl font-bold text-red-900",children:f.stopped})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-200 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})})})]}),o==="stopped"&&e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-xs text-red-600 font-medium",children:r("selected")})})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",placeholder:r("searchStrategies"),value:i,onChange:A=>l(A.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-transparent"}),e.jsx("svg",{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsxs("select",{value:o,onChange:A=>c(A.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:r("allStatus")}),e.jsx("option",{value:"running",children:r("runningLive")}),e.jsx("option",{value:"paused",children:r("pausedLive")}),e.jsx("option",{value:"stopped",children:r("stoppedLive")})]})]}),o!=="all"&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"inline-flex items-center px-3 py-2 rounded-lg bg-gray-100 text-gray-700",children:[e.jsxs("span",{className:"text-sm",children:[r("currentFilter"),": "]}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs font-medium ${o==="running"?"bg-green-100 text-green-800":o==="paused"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:r(o==="running"?"runningLive":o==="paused"?"pausedLive":"stoppedLive")}),e.jsx("button",{onClick:()=>c("all"),className:"ml-2 text-gray-500 hover:text-gray-700",title:r("clearFilter"),children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{children:u?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-10 h-10 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:r("loadingStrategies")}),e.jsx("p",{className:"text-gray-500",children:r("monitorRunningStrategies")})]}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:r("noStrategiesMessage")}),e.jsx("p",{className:"text-gray-500 mb-6",children:r("createFirstStrategyMessage")})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:x.map(A=>{var T;return e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-shadow cursor-pointer",onClick:()=>E(A),children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:A.name}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${A.status==="running"?"bg-green-100 text-green-800":A.status==="paused"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:P(A.status)})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:A.description})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:r("tradingPair")}),e.jsx("p",{className:"font-medium",children:((T=A.parameters)==null?void 0:T.symbol)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:r("profitLoss")}),e.jsxs("p",{className:`font-medium ${A.profitPercent>=0?"text-green-600":"text-red-600"}`,children:[A.profit," (",A.profitPercent>=0?"+":"",A.profitPercent,"%)"]})]}),A.runningTime&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:r("runningTime")}),e.jsx("p",{className:"font-medium",children:A.runningTime})]}),A.totalTrades!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:r("totalTrades")}),e.jsxs("p",{className:"font-medium",children:[A.totalTrades,"次"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsx("div",{className:"flex items-center space-x-2",children:A.status==="stopped"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:k=>{k.stopPropagation(),y(A)},disabled:!t,className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${t?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:r("start")}),e.jsx("button",{onClick:k=>{k.stopPropagation(),v(A)},className:"px-3 py-1.5 bg-red-100 text-red-700 rounded text-sm font-medium hover:bg-red-200 transition-colors",title:"删除实盘策略",children:"删除"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:k=>{k.stopPropagation(),m(A)},className:"px-3 py-1.5 bg-red-100 text-red-700 rounded text-sm font-medium hover:bg-red-200 transition-colors",children:r("stop")}),A.status==="running"&&e.jsx("button",{onClick:k=>{k.stopPropagation(),g(A)},className:"px-3 py-1.5 bg-yellow-100 text-yellow-700 rounded text-sm font-medium hover:bg-yellow-200 transition-colors",children:r("pause")}),A.status==="paused"&&e.jsx("button",{onClick:k=>{k.stopPropagation(),y(A)},disabled:!t,className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${t?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:r("start")})]})}),e.jsx("div",{className:"text-xs text-gray-500",children:r("viewDetails")})]})]})},A.id)})})})]})]})},$u=()=>{const{strategyId:s}=gi(),t=ot(),{isPremium:r}=$t(),[a,n]=b.useState(null),[i,l]=b.useState([]),[o,c]=b.useState(!0),[d,h]=b.useState(!1),[u,j]=b.useState(0),[p,f]=b.useState(!0),x=20,y=async()=>{if(s)try{c(!0);const z=await ht.getStrategyLiveDetails(parseInt(s));n(z)}catch(z){console.error("Failed to load live details:",z),O.error("加载实盘详情失败")}finally{c(!1)}},m=async(z=0,K=!1)=>{if(s)try{h(!0);const S=await ht.getStrategyTrades(s,{page:z+1,per_page:x});l(K?V=>[...V,...S.items]:S.items);const U=S.items?S.items.length===x:!1;f(U)}catch(S){console.error("Failed to load trades:",S),O.error("加载交易记录失败")}finally{h(!1)}};b.useEffect(()=>{if(!r){O.error("查看实盘详情需要高级版本"),t("/strategies");return}y(),m()},[s,r,t]);const g=()=>{const z=u+1;j(z),m(z,!0)},v=(z,K=2)=>z.toFixed(K),P=z=>new Date(z).toLocaleString("zh-CN"),E=z=>z==="BUY"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",A=z=>z>=0?"text-green-600":"text-red-600";if(o)return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-10 h-10 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"加载实盘详情中..."}),e.jsx("p",{className:"text-gray-500",children:"正在获取策略运行数据"})]})});if(!a)return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"实盘详情不存在"}),e.jsx("button",{onClick:()=>t("/strategies"),className:"text-blue-600 hover:text-blue-800",children:"返回策略列表"})]})});const{strategy:T,live_stats:k,performance:R,status:se}=a;return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("button",{onClick:()=>t("/strategies"),className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:T.name}),e.jsx("p",{className:"text-gray-600",children:"实盘运行详情"})]}),e.jsx("div",{className:"flex-1"}),e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${se==="running"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:se==="running"?"运行中":"已停止"})]}),e.jsx("p",{className:"text-gray-600",children:T.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总收益"}),e.jsx("p",{className:`text-2xl font-bold ${A(k.profit_loss)}`,children:v(k.profit_loss,4)}),e.jsxs("p",{className:`text-sm ${A(k.profit_percentage)}`,children:[k.profit_percentage>=0?"+":"",v(k.profit_percentage),"%"]})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"})})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"交易次数"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.total_trades}),e.jsx("p",{className:"text-sm text-gray-500",children:"总成交量"})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z",clipRule:"evenodd"})})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"买入量"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v(k.buy_volume,4)}),e.jsx("p",{className:"text-sm text-gray-500",children:"总买入金额"})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-yellow-100 flex items-center justify-center",children:e.jsxs("svg",{className:"w-6 h-6 text-yellow-600",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"}),e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z",clipRule:"evenodd"})]})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"手续费"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:v(k.total_fees,4)}),e.jsx("p",{className:"text-sm text-gray-500",children:"总费用"})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"性能指标"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"总回报率"}),e.jsxs("p",{className:`text-xl font-bold ${A(R.total_return)}`,children:[R.total_return>=0?"+":"",v(R.total_return),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"胜率"}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[v(R.win_rate),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"最大回撤"}),e.jsxs("p",{className:"text-xl font-bold text-red-600",children:[v(R.max_drawdown),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"夏普比率"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:v(R.sharpe_ratio,3)})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"交易记录"}),e.jsx("p",{className:"text-sm text-gray-600",children:"最近的实盘交易明细"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"时间"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"交易对"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"方向"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"数量"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"价格"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"总额"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"手续费"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"订单ID"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:"暂无交易记录"})}):i.map(z=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:P(z.timestamp)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:z.symbol}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${E(z.side)}`,children:z.side})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:v(z.quantity,6)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:v(z.price,4)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:v(z.total_amount,4)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600",children:v(z.fee,6)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:z.order_id||"N/A"})]},z.id))})]})}),p&&i.length>0&&e.jsx("div",{className:"p-6 border-t border-gray-200 text-center",children:e.jsx("button",{onClick:g,disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed",children:d?"加载中...":"加载更多"})})]}),k.first_trade&&e.jsxs("div",{className:"mt-8 bg-gray-50 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"运行信息"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"首次交易"}),e.jsx("p",{className:"font-medium",children:P(k.first_trade)})]}),k.last_trade&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"最新交易"}),e.jsx("p",{className:"font-medium",children:P(k.last_trade)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"平均成交价"}),e.jsx("p",{className:"font-medium",children:v(k.avg_price,4)})]})]})]})]})},Iu=()=>{var y,m,g,v,P,E,A,T;const s=ot(),{user:t}=$t();ta(),ea();const[r,a]=b.useState(""),[n,i]=b.useState(null),[l,o]=b.useState(!1),[c,d]=b.useState([]),[h,u]=b.useState(null),[j,p]=b.useState(!0);b.useEffect(()=>{(async()=>{try{p(!0);const[R,se]=await Promise.all([Qs.getLiveStrategies({per_page:100}),Qs.getLiveStrategyStats()]);d(R.strategies),u(se)}catch(R){console.error("加载实盘策略数据失败:",R),O.error("加载实盘策略数据失败，使用模拟数据"),d([{id:"1",name:"EMA交叉策略",trading_pair:"BTC/USDT",exchange:"binance",status:"running",profit_rate:8.2,signal_count:16,created_at:"2024-05-10",win_rate:68.4,total_trades:16},{id:"2",name:"RSI超买超卖策略",trading_pair:"ETH/USDT",exchange:"okx",status:"paused",profit_rate:5.7,signal_count:12,created_at:"2024-05-12"}]),u({active_strategies:1,total_return:15.8,max_drawdown:-6.3,last_trade_time:"2小时前",total_trades:28,win_rate:65.2})}finally{p(!1)}})()},[]);const f=async(k,R)=>{try{const se={action:R==="start"?"start":R},z=await Qs.executeStrategyAction(k,se);z.success?(O.success(`策略${R==="pause"?"已暂停":R==="stop"?"已停止":"已启动"}`),d(K=>K.map(S=>S.id===k?{...S,status:z.new_status||R}:S))):O.error(z.message||"操作失败")}catch(se){console.error("策略操作失败:",se),O.error("策略操作失败，请稍后重试")}},x=k=>{const R={running:"bg-green-50 text-green-700 border-green-200",paused:"bg-yellow-50 text-yellow-700 border-yellow-200",stopped:"bg-gray-50 text-gray-700 border-gray-200"},se={running:"运行中",paused:"已暂停",stopped:"已停止"};return e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-md text-xs font-medium border ${R[k]}`,children:se[k]})};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"w-full max-w-7xl min-h-screen bg-white rounded-xl shadow-xl border border-gray-200 mx-auto",children:[e.jsxs("header",{className:"py-4 px-8 flex justify-between border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-7 h-7 mr-3 flex items-center justify-center",children:e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-full h-full",style:{color:"#1a3d7c"},children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M8 12h8M12 8v8",stroke:"currentColor",strokeWidth:"2"})]})}),e.jsx("h1",{className:"text-xl font-bold",style:{color:"#1a3d7c"},children:"Trademe"})]}),e.jsxs("nav",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>s("/"),className:"px-4 py-2 text-blue-600 font-medium hover:bg-blue-50 rounded-lg",children:"首页"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white font-medium rounded-lg",children:"策略交易"}),e.jsx("button",{onClick:()=>s("/trading"),className:"px-4 py-2 text-blue-600 font-medium hover:bg-blue-50 rounded-lg",children:"图表交易"}),e.jsx("button",{onClick:()=>s("/api-keys"),className:"px-4 py-2 text-blue-600 font-medium hover:bg-blue-50 rounded-lg",children:"API管理"}),e.jsx("button",{className:"px-4 py-2 text-blue-600 font-medium hover:bg-blue-50 rounded-lg",children:"交易心得"}),e.jsx("button",{onClick:()=>s("/profile"),className:"px-4 py-2 text-blue-600 font-medium hover:bg-blue-50 rounded-lg",children:"账户中心"})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"w-9 h-9 rounded-full bg-gray-200 overflow-hidden",children:t!=null&&t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:"User avatar",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-blue-100 text-blue-600 font-medium",children:((y=t==null?void 0:t.username)==null?void 0:y.charAt(0).toUpperCase())||"U"})})})]}),e.jsxs("div",{className:"p-8",children:[j&&e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"加载实盘策略数据中..."})]}),!j&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsxs("button",{onClick:()=>s("/strategies"),className:"text-blue-600 hover:underline flex items-center mr-2",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"返回策略列表"]}),e.jsx("span",{className:"text-gray-500",children:"/ 实盘管理"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",style:{color:"#1a3d7c"},children:"实盘策略管理"}),e.jsx("p",{className:"text-gray-500",children:"管理您当前运行中的实盘策略"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4",style:{backgroundColor:"#e9f1fe"},children:e.jsx("svg",{className:"w-6 h-6",style:{color:"#1a3d7c"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 mb-1",children:"活跃策略"}),e.jsx("p",{className:"text-2xl font-bold",children:(h==null?void 0:h.active_strategies)||0})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4",style:{backgroundColor:"#e9faf3"},children:e.jsx("svg",{className:"w-6 h-6",style:{color:"#21ce90"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 mb-1",children:"总收益率"}),e.jsx("p",{className:"text-2xl font-bold",children:e.jsxs("span",{className:"bg-green-50 text-green-600 px-2 py-1 rounded",children:["+",(h==null?void 0:h.total_return)||0,"%"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4",style:{backgroundColor:"#f8f3d6"},children:e.jsx("svg",{className:"w-6 h-6",style:{color:"#f0b90b"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 mb-1",children:"最大回撤"}),e.jsx("p",{className:"text-2xl font-bold",children:e.jsxs("span",{className:"bg-red-50 text-red-600 px-2 py-1 rounded",children:[(h==null?void 0:h.max_drawdown)||0,"%"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex items-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center mr-4",style:{backgroundColor:"#fef1f1"},children:e.jsx("svg",{className:"w-6 h-6",style:{color:"#f53d3d"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 mb-1",children:"上次交易"}),e.jsx("p",{className:"text-lg font-bold",children:(h==null?void 0:h.last_trade_time)||"暂无"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",style:{color:"#1a3d7c"},children:"实盘策略列表"}),e.jsxs("div",{className:"flex",children:[e.jsxs("button",{className:"bg-blue-600 text-white rounded-lg px-4 py-2 font-medium hover:bg-blue-700 transition-colors flex items-center mr-2",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"添加策略"]}),e.jsx("input",{type:"text",className:"border border-gray-200 bg-gray-50 rounded-lg px-4 py-2 w-64 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",placeholder:"搜索策略...",value:r,onChange:k=>a(k.target.value)})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"策略名称"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"交易对"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"交易所"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"收益率"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"信号数量"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"创建时间"}),e.jsx("th",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{children:c.filter(k=>k.name.toLowerCase().includes(r.toLowerCase())).map(k=>e.jsxs("tr",{className:"cursor-pointer hover:bg-blue-50 border-b border-gray-100",onClick:()=>i(n===k.id?null:k.id),children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:k.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:k.trading_pair}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:k.exchange}),e.jsx("td",{className:"px-4 py-3 text-sm",children:x(k.status)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("span",{className:`px-2 py-1 rounded ${k.profit_rate>0?"bg-green-50 text-green-600":"bg-red-50 text-red-600"}`,children:[k.profit_rate>0?"+":"",k.profit_rate,"%"]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:k.signal_count}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:k.created_at}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex space-x-2",children:[k.status==="running"?e.jsx("button",{onClick:R=>{R.stopPropagation(),f(k.id,"pause")},className:"text-blue-600 hover:text-blue-800",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6"})})}):e.jsx("button",{onClick:R=>{R.stopPropagation(),f(k.id,"start")},className:"text-green-600 hover:text-green-800",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1.586a1 1 0 01.707.293l2.414 2.414a1 1 0 00.707.293H15"})})}),e.jsx("button",{onClick:R=>{R.stopPropagation(),f(k.id,"stop")},className:"text-red-600 hover:text-red-800",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 10h6v4H9z"})]})}),e.jsx("button",{className:"text-gray-600 hover:text-gray-800",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})]})})]},k.id))})]})})]}),n&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold mb-2",style:{color:"#1a3d7c"},children:[(m=c.find(k=>k.id===n))==null?void 0:m.name," 详情"]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-sm text-gray-600",children:(g=c.find(k=>k.id===n))==null?void 0:g.trading_pair}),e.jsx("span",{className:"text-sm text-gray-600",children:(v=c.find(k=>k.id===n))==null?void 0:v.exchange}),x(((P=c.find(k=>k.id===n))==null?void 0:P.status)||"stopped")]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"border border-blue-600 text-blue-600 rounded-lg px-4 py-2 text-sm font-medium hover:bg-blue-50",children:"暂停"}),e.jsx("button",{className:"border border-red-600 text-red-600 rounded-lg px-4 py-2 text-sm font-medium hover:bg-red-50",children:"终止"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 mb-2 text-sm",children:"总收益率"}),e.jsx("p",{className:"text-2xl font-bold",children:e.jsxs("span",{className:"bg-green-50 text-green-600 px-2 py-1 rounded",children:["+",(E=c.find(k=>k.id===n))==null?void 0:E.profit_rate,"%"]})})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 mb-2 text-sm",children:"胜率"}),e.jsxs("p",{className:"text-2xl font-bold",children:[((A=c.find(k=>k.id===n))==null?void 0:A.win_rate)||0,"%"]})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 mb-2 text-sm",children:"交易次数"}),e.jsx("p",{className:"text-2xl font-bold",children:((T=c.find(k=>k.id===n))==null?void 0:T.total_trades)||0})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-bold mb-4",children:"策略收益曲线"}),e.jsx("div",{className:"h-64 bg-gray-50 rounded-lg border border-gray-200 flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"📈 收益曲线图表（需要ECharts集成）"})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-6",style:{color:"#1a3d7c"},children:"策略参数设置"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"策略类型"}),e.jsxs("select",{className:"w-full border border-gray-200 bg-gray-50 rounded-lg px-4 py-3 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",children:[e.jsx("option",{children:"EMA交叉策略"}),e.jsx("option",{children:"RSI超买超卖策略"}),e.jsx("option",{children:"布林带突破策略"}),e.jsx("option",{children:"MACD背离策略"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易对"}),e.jsxs("select",{className:"w-full border border-gray-200 bg-gray-50 rounded-lg px-4 py-3 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",children:[e.jsx("option",{children:"BTC/USDT"}),e.jsx("option",{children:"ETH/USDT"}),e.jsx("option",{children:"SOL/USDT"}),e.jsx("option",{children:"DOGE/USDT"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易所"}),e.jsxs("select",{className:"w-full border border-gray-200 bg-gray-50 rounded-lg px-4 py-3 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",children:[e.jsx("option",{children:"币安"}),e.jsx("option",{children:"OKX"}),e.jsx("option",{children:"火币"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EMA短周期"}),e.jsx("input",{type:"number",className:"w-full border border-gray-200 bg-gray-50 rounded-lg px-4 py-3 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",defaultValue:"10"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EMA长周期"}),e.jsx("input",{type:"number",className:"w-full border border-gray-200 bg-gray-50 rounded-lg px-4 py-3 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",defaultValue:"50"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"止损比例"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",className:"w-full border border-gray-200 bg-gray-50 rounded-lg px-4 py-3 pr-8 text-sm focus:border-blue-600 focus:outline-none focus:bg-white",defaultValue:"1.5"}),e.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm",children:"%"})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6 mt-6 flex justify-end",children:[e.jsx("button",{className:"border border-gray-300 rounded-lg px-4 py-2 text-gray-700 font-medium mr-3 hover:bg-gray-50",children:"取消"}),e.jsx("button",{className:"bg-blue-600 text-white rounded-lg px-4 py-2 font-medium hover:bg-blue-700 transition-colors",children:"更新策略参数"})]})]})]})]})]})})},Ze=({children:s,requireMembership:t})=>{const r=Oa(),{isAuthenticated:a,isLoading:n,user:i,checkAuth:l}=et();if(b.useEffect(()=>{!a&&!n&&l()},[a,n,l]),n)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx(Pt,{size:"lg"})});if(!a)return e.jsx(Ml,{to:"/login",state:{from:r},replace:!0});if(t&&i){const o={basic:1,premium:2,professional:3},c=o[i.membership_level]||0,d=o[t]||0;if(c<d)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"w-16 h-16 mx-auto bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z"})})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"需要升级会员"}),e.jsxs("p",{className:"text-gray-500 mb-4",children:["此功能需要 ",t==="premium"?"高级版":"专业版"," 会员权限"]}),e.jsx("button",{onClick:()=>window.location.href="/profile/membership",className:"btn btn-primary btn-md",children:"升级会员"})]})})}return e.jsx(e.Fragment,{children:s})},Du=b.forwardRef(({label:s,error:t,helperText:r,icon:a,iconPosition:n="left",className:i="",...l},o)=>{const c=!!a,h=`
    input
    ${c&&n==="left"?"pl-10":""}
    ${c&&n==="right"?"pr-10":""}
    ${!!t?"border-red-300 focus-visible:ring-red-500":""}
    ${i}
  `;return e.jsxs("div",{className:"w-full",children:[s&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s}),e.jsxs("div",{className:"relative",children:[c&&n==="left"&&e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-400 sm:text-sm",children:a})}),e.jsx("input",{ref:o,className:h,...l}),c&&n==="right"&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-400 sm:text-sm",children:a})})]}),t&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t}),r&&!t&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r})]})});Du.displayName="Input";const Pa=(s,t="",r=2)=>{const a=new Intl.NumberFormat("zh-CN",{minimumFractionDigits:r,maximumFractionDigits:r}).format(s);return t?`${t}${a}`:a},Nl=(s,t=1,r=!1)=>`${(r?s:s*100).toFixed(t)}%`,$a=(s,t="datetime")=>{const r=new Date(s);if(isNaN(r.getTime()))return"无效日期";const a=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getDate()).padStart(2,"0"),l=String(r.getHours()).padStart(2,"0"),o=String(r.getMinutes()).padStart(2,"0"),c=String(r.getSeconds()).padStart(2,"0");switch(t){case"date":return`${a}-${n}-${i}`;case"time":return`${l}:${o}:${c}`;case"short":return`${n}-${i} ${l}:${o}`;case"datetime":default:return`${a}-${n}-${i} ${l}:${o}:${c}`}},Ru=()=>{const{user:s}=et(),{t}=Wt(),[r,a]=b.useState("create"),{backtests:n,loading:i,error:l,fetchBacktests:o,deleteBacktest:c,downloadReport:d}=Lu(),{configForm:h,isCreatingBacktest:u,createBacktest:j,updateBacktestForm:p,resetBacktestForm:f}=Tu(),{selectedForComparison:x,toggleComparisonSelection:y,compareBacktests:m,clearComparison:g}=Mu(),[v,P]=b.useState([]),[E,A]=b.useState(!1),T=Array.isArray(n)?n:[],k=async()=>{try{A(!0);const S=await ht.getStrategies({active_only:!0});S&&S.strategies&&P(S.strategies)}catch(S){console.error(t("getStrategiesError"),S)}finally{A(!1)}};b.useEffect(()=>{o(),k()},[]);const R=async()=>{if(!h.strategy_id){alert(t("strategyRequired"));return}await j(h)&&a("history")},se=async S=>{confirm(t("confirmDeleteBacktest"))&&await c(S)},z=S=>{switch(S){case"completed":return"bg-green-100 text-green-800";case"running":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},K=S=>{switch(S){case"completed":return t("completed");case"running":return t("running");case"failed":return t("failed");default:return t("unknown")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t("strategyBacktest")}),e.jsx("p",{className:"text-gray-600 mt-1",children:t("verifyTradingStrategy")})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:t("totalBacktests")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:T.length})]}),e.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:t("completedSuccessfully")}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:T.filter(S=>S.status==="completed").length})]}),e.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-50 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:t("running")}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:T.filter(S=>S.status==="running").length})]}),e.jsx("div",{className:"w-12 h-12 rounded-xl bg-yellow-50 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:t("executionFailed")}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:T.filter(S=>S.status==="failed").length})]}),e.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-50 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm",children:[e.jsxs("div",{className:"flex border-b border-gray-100",children:[e.jsxs("button",{onClick:()=>a("create"),className:`flex-1 px-6 py-4 font-medium transition-all duration-200 relative ${r==="create"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-50"}`,children:[t("createBacktest"),r==="create"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-t-full"})]}),e.jsxs("button",{onClick:()=>a("history"),className:`flex-1 px-6 py-4 font-medium transition-all duration-200 relative ${r==="history"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-50"}`,children:[t("backtestHistory"),r==="history"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-t-full"})]})]}),e.jsxs("div",{className:"p-6",children:[r==="create"?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:t("backtestConfig")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[t("selectStrategy")," *"]}),e.jsxs("select",{value:h.strategy_id,onChange:S=>p("strategy_id",S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0,disabled:E,children:[e.jsx("option",{value:"",children:E?"加载策略中...":"请选择策略"}),v.map(S=>{var U;return e.jsxs("option",{value:S.id,children:[S.name," - ",((U=S.parameters)==null?void 0:U.symbol)||"N/A"]},S.id)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"开始日期 *"}),e.jsx("input",{type:"date",value:h.start_date,onChange:S=>p("start_date",S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"结束日期 *"}),e.jsx("input",{type:"date",value:h.end_date,onChange:S=>p("end_date",S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易对 *"}),e.jsxs("select",{value:h.symbol,onChange:S=>p("symbol",S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"请选择交易对"}),e.jsx("option",{value:"BTC/USDT",children:"BTC/USDT"}),e.jsx("option",{value:"ETH/USDT",children:"ETH/USDT"}),e.jsx("option",{value:"BNB/USDT",children:"BNB/USDT"}),e.jsx("option",{value:"ADA/USDT",children:"ADA/USDT"}),e.jsx("option",{value:"SOL/USDT",children:"SOL/USDT"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易所 *"}),e.jsxs("select",{value:h.exchange,onChange:S=>p("exchange",S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"请选择交易所"}),e.jsx("option",{value:"binance",children:"Binance"}),e.jsx("option",{value:"okx",children:"OKX"}),e.jsx("option",{value:"huobi",children:"Huobi"}),e.jsx("option",{value:"kraken",children:"Kraken"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"时间周期 *"}),e.jsxs("select",{value:h.timeframe,onChange:S=>p("timeframe",S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"请选择时间周期"}),e.jsx("option",{value:"1m",children:"1分钟"}),e.jsx("option",{value:"5m",children:"5分钟"}),e.jsx("option",{value:"15m",children:"15分钟"}),e.jsx("option",{value:"1h",children:"1小时"}),e.jsx("option",{value:"4h",children:"4小时"}),e.jsx("option",{value:"1d",children:"1天"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"手续费率 *"}),e.jsx("input",{type:"number",value:h.commission_rate,onChange:S=>p("commission_rate",parseFloat(S.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",placeholder:"0.001",min:"0",max:"0.01",step:"0.0001",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"初始资金 *"}),e.jsx("input",{type:"number",value:h.initial_capital,onChange:S=>p("initial_capital",parseFloat(S.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent",placeholder:"10000",min:"1000",step:"1000",required:!0})]}),e.jsx("button",{onClick:R,disabled:u,className:`w-full py-3 px-4 rounded-xl font-medium transition-all duration-200 ${u?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-lg transform hover:scale-[1.02]"}`,children:u?"创建中...":"开始回测"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"回测说明"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-600 text-sm font-bold",children:"1"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"选择策略"}),e.jsx("p",{className:"text-sm text-gray-600",children:"选择您要回测的交易策略"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-600 text-sm font-bold",children:"2"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"设定回测周期"}),e.jsx("p",{className:"text-sm text-gray-600",children:"选择回测的开始和结束日期"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-600 text-sm font-bold",children:"3"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"设定初始资金"}),e.jsx("p",{className:"text-sm text-gray-600",children:"设定回测使用的初始资金金额"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-600 text-sm font-bold",children:"4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"开始回测"}),e.jsx("p",{className:"text-sm text-gray-600",children:"点击开始回测，查看策略历史表现"})]})]})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"回测历史"}),x.length>=2&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:m,className:"px-4 py-2 bg-blue-600 text-white text-sm rounded-xl hover:bg-blue-700 hover:shadow-lg transform hover:scale-[1.02] transition-all duration-200",children:["比较回测 (",x.length,")"]}),e.jsx("button",{onClick:g,className:"px-4 py-2 bg-gray-500 text-white text-sm rounded-xl hover:bg-gray-600 hover:shadow-lg transform hover:scale-[1.02] transition-all duration-200",children:"清除选择"})]})]}),i?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Pt,{}),e.jsx("span",{className:"ml-2 text-gray-600",children:"加载回测数据..."})]}):T.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"暂无回测记录"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"开始您的第一次策略回测"}),e.jsxs("button",{onClick:()=>a("create"),className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-xl hover:bg-blue-700 hover:shadow-lg transform hover:scale-[1.02] transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"创建回测"]})]}):e.jsx("div",{className:"grid grid-cols-1 gap-6",children:T.map(S=>{var U,V,le,C,B,re;return e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm hover:shadow-md transition-all duration-200 p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("input",{type:"checkbox",checked:x.includes(S.id),onChange:()=>y(S.id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:((U=S.config)==null?void 0:U.strategy_id)||"未知策略"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${z(S.status)}`,children:K(S.status)})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"回测周期:"}),e.jsxs("p",{className:"font-medium",children:[(V=S.config)==null?void 0:V.start_date," - ",(le=S.config)==null?void 0:le.end_date]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"初始资金:"}),e.jsx("p",{className:"font-medium",children:Pa(((C=S.config)==null?void 0:C.initial_capital)||0)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"总收益:"}),e.jsx("p",{className:`font-medium ${(((B=S.results)==null?void 0:B.total_return)||0)>=0?"text-green-600":"text-red-600"}`,children:Nl(((re=S.results)==null?void 0:re.total_return)||0)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"创建时间:"}),e.jsx("p",{className:"font-medium",children:$a(S.created_at,"short")})]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsx("div",{className:"flex items-center space-x-2",children:S.status==="completed"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>d(S.id),className:"px-4 py-2 text-sm text-blue-600 border border-blue-200 rounded-xl hover:bg-blue-50 hover:border-blue-300 transition-all duration-200",children:"下载报告"}),e.jsx(Ge,{to:`/backtest/${S.id}/details`,className:"px-4 py-2 text-sm text-green-600 border border-green-200 rounded-xl hover:bg-green-50 hover:border-green-300 transition-all duration-200",children:"查看详情"})]})}),e.jsx("button",{onClick:()=>se(S.id),className:"text-gray-500 hover:text-red-500 transition-colors",title:"删除回测",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},S.id)})})]}),l&&e.jsx("div",{className:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700 text-sm",children:l})})]})]})]})},Bu=()=>{const{id:s}=gi(),[t,r]=b.useState(null),[a,n]=b.useState(!0),[i,l]=b.useState(null),[o,c]=b.useState("overview");b.useEffect(()=>{if(!s)return;(async()=>{try{n(!0);const p=await kt.getBacktest(s),f={id:s,strategy_name:"BTC均线策略",symbol:"BTC/USDT",exchange:"binance",start_date:"2024-01-01",end_date:"2024-12-31",initial_capital:1e4,final_capital:12500,total_return:25,status:"completed",created_at:"2024-01-01T00:00:00Z",metrics:{total_return:25,annual_return:22.3,max_drawdown:-8.5,sharpe_ratio:1.35,sortino_ratio:1.62,calmar_ratio:2.63,volatility:16.5,var_95:-3.2,cvar_95:-4.8,win_rate:62.5,profit_factor:1.45,total_trades:156,avg_win:2.8,avg_loss:-1.9,max_consecutive_wins:8,max_consecutive_losses:4,avg_trade_duration:2.5,max_trade_duration:12},equity_curve:d(),monthly_returns:h(),trades:u()};r(f)}catch(p){l("加载回测详情失败"),console.error("Failed to fetch backtest details:",p)}finally{n(!1)}})()},[s]);const d=()=>{const j=[];let p=1e4,f=1e4;const x=new Date("2024-01-01");for(let y=0;y<365;y++){const m=new Date(x);m.setDate(m.getDate()+y);const g=(Math.random()-.45)*.02;p*=1+g,f=Math.max(f,p);const v=(p-f)/f*100;j.push({timestamp:m.toISOString(),equity:Math.round(p),drawdown:v,rolling_max:Math.round(f)})}return j},h=()=>{const j=[];for(let p=2024;p<=2024;p++)for(let f=1;f<=12;f++)j.push({year:p,month:f,return:(Math.random()-.4)*10});return j},u=()=>{const j=[],p=new Date("2024-01-01");for(let f=0;f<156;f++){const x=new Date(p);x.setDate(x.getDate()+Math.floor(f*2.3));const y=Math.random()>.5?"buy":"sell",m=45e3+Math.random()*2e4,g=.01+Math.random()*.09,v=(Math.random()-.4)*500;j.push({timestamp:x.toISOString(),side:y,price:Math.round(m),quantity:parseFloat(g.toFixed(4)),pnl:Math.round(v*100)/100})}return j};return a?e.jsxs("div",{className:"min-h-screen flex items-center justify-center",children:[e.jsx(Pt,{size:"lg"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"加载回测详情中..."})]}):i||!t?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"加载失败"}),e.jsx("p",{className:"text-gray-500 mb-4",children:i||"回测不存在"}),e.jsx(Ge,{to:"/backtest",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"返回回测页面"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ge,{to:"/backtest",className:"text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"回测详情"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.status==="completed"?"bg-green-100 text-green-800":t.status==="running"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.status==="completed"?"已完成":t.status==="running"?"运行中":"已失败"})]}),e.jsxs("p",{className:"text-gray-600",children:[t.strategy_name," - ",t.symbol," (",t.exchange,")"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ys,{variant:"outline",className:"px-4 py-2",children:"下载报告"}),e.jsx(ys,{variant:"primary",className:"px-4 py-2",children:"复制配置"})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"回测周期"}),e.jsxs("div",{className:"font-medium",children:[t.start_date," 至 ",t.end_date]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"初始资金"}),e.jsx("div",{className:"font-medium",children:Pa(t.initial_capital)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"最终资金"}),e.jsx("div",{className:"font-medium",children:Pa(t.final_capital)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"总收益"}),e.jsx("div",{className:`font-medium ${t.total_return>=0?"text-green-600":"text-red-600"}`,children:Nl(t.total_return/100)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"交易次数"}),e.jsx("div",{className:"font-medium",children:t.metrics.total_trades})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"创建时间"}),e.jsx("div",{className:"font-medium",children:$a(t.created_at,"short")})]})]})}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex border-b border-gray-100",children:[e.jsxs("button",{onClick:()=>c("overview"),className:`flex-1 px-6 py-4 font-medium transition-all duration-200 relative ${o==="overview"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-50"}`,children:["概览分析",o==="overview"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-t-full"})]}),e.jsxs("button",{onClick:()=>c("analysis"),className:`flex-1 px-6 py-4 font-medium transition-all duration-200 relative ${o==="analysis"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-50"}`,children:["深度分析",o==="analysis"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-t-full"})]}),e.jsxs("button",{onClick:()=>c("trades"),className:`flex-1 px-6 py-4 font-medium transition-all duration-200 relative ${o==="trades"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-gray-900 hover:bg-gray-50"}`,children:["交易记录",o==="trades"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-t-full"})]})]}),e.jsxs("div",{className:"p-6",children:[o==="overview"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"性能概览"}),e.jsx(b0,{metrics:t.metrics,equityCurve:t.equity_curve,monthlyReturns:t.monthly_returns})]}),o==="analysis"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"深度分析"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"风险指标分析"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"最大回撤"}),e.jsxs("span",{className:"font-medium text-red-600",children:[t.metrics.max_drawdown.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"VaR (95%)"}),e.jsxs("span",{className:"font-medium text-red-600",children:[t.metrics.var_95.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"CVaR (95%)"}),e.jsxs("span",{className:"font-medium text-red-600",children:[t.metrics.cvar_95.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"波动率"}),e.jsxs("span",{className:"font-medium",children:[t.metrics.volatility.toFixed(2),"%"]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"收益质量分析"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"夏普比率"}),e.jsx("span",{className:`font-medium ${t.metrics.sharpe_ratio>=1?"text-green-600":"text-orange-600"}`,children:t.metrics.sharpe_ratio.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"索提诺比率"}),e.jsx("span",{className:"font-medium text-blue-600",children:t.metrics.sortino_ratio.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"卡尔玛比率"}),e.jsx("span",{className:"font-medium text-purple-600",children:t.metrics.calmar_ratio.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"盈亏比"}),e.jsx("span",{className:"font-medium",children:t.metrics.profit_factor.toFixed(2)})]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-6",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-3",children:"策略评估总结"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[e.jsxs("p",{children:["• 该策略在回测期间表现",t.metrics.sharpe_ratio>=1?"优秀":"一般","，年化收益率达到 ",t.metrics.annual_return.toFixed(1),"%"]}),e.jsxs("p",{children:["• 风险控制",Math.abs(t.metrics.max_drawdown)<=10?"良好":"需要改进","，最大回撤控制在 ",Math.abs(t.metrics.max_drawdown).toFixed(1),"% 以内"]}),e.jsxs("p",{children:["• 交易胜率为 ",t.metrics.win_rate.toFixed(1),"%，",t.metrics.win_rate>=60?"表现出色":"有提升空间"]}),e.jsx("p",{children:"• 建议在实盘交易前进一步优化参数，控制单笔交易风险"})]})]})]}),o==="trades"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"交易记录"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"时间"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"方向"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"价格"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"数量"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"盈亏"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.trades.slice(0,50).map((j,p)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:$a(j.timestamp,"short")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${j.side==="buy"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:j.side==="buy"?"买入":"卖出"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",j.price.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.quantity}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsxs("span",{className:j.pnl>=0?"text-green-600":"text-red-600",children:[j.pnl>=0?"+":"","$",j.pnl.toFixed(2)]})})]},p))})]})}),t.trades.length>50&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx(ys,{variant:"outline",className:"px-4 py-2",children:"加载更多交易记录"})})]})]})]})]})},Ou={symbol:"BTC/USDT",timeframe:"15m",exchange:"OKX",indicators:[],drawingTools:[],aiAnalysisEnabled:!0,theme:"dark",layout:"single",priceAxisMode:"linear",chartStyle:"candlestick",autoScale:!0,displayMode:"normal"},zt=Ut()(js((s,t)=>({selectedSymbol:"BTC/USDT",selectedTimeframe:"15m",selectedExchange:"OKX",chartConfig:Ou,strategyLibrary:[],indicatorLibrary:[],analysisLibrary:[],activeStrategies:[],aiRecommendations:[],tradingOpportunities:[],aiAnalysisEnabled:!0,watchList:[],orderBookData:null,klineDataStore:{},isDataLoading:!1,currentPriceData:{},leftPanelCollapsed:!1,rightPanelCollapsed:!1,activeLeftTab:"strategies",activeRightTab:"market",setSelectedSymbol:r=>{s(a=>({selectedSymbol:r,chartConfig:{...a.chartConfig,symbol:r}}))},setSelectedTimeframe:r=>{s(a=>({selectedTimeframe:r,chartConfig:{...a.chartConfig,timeframe:r}}))},setSelectedExchange:r=>{s(a=>({selectedExchange:r,chartConfig:{...a.chartConfig,exchange:r}}))},updateChartConfig:r=>{s(a=>({chartConfig:{...a.chartConfig,...r}}))},addDrawingTool:r=>{s(a=>({chartConfig:{...a.chartConfig,drawingTools:[...a.chartConfig.drawingTools,r]}}))},removeDrawingTool:r=>{s(a=>({chartConfig:{...a.chartConfig,drawingTools:a.chartConfig.drawingTools.filter(n=>n.id!==r)}}))},clearDrawingTools:()=>{s(r=>({chartConfig:{...r.chartConfig,drawingTools:[]}}))},addStrategy:r=>{s(a=>({strategyLibrary:[...a.strategyLibrary,r]}))},removeStrategy:r=>{s(a=>({strategyLibrary:a.strategyLibrary.filter(n=>n.id!==r),activeStrategies:a.activeStrategies.filter(n=>n!==r)}))},activateStrategy:r=>{s(a=>({activeStrategies:a.activeStrategies.includes(r)?a.activeStrategies:[...a.activeStrategies,r]}))},deactivateStrategy:r=>{s(a=>({activeStrategies:a.activeStrategies.filter(n=>n!==r)}))},addIndicator:r=>{s(a=>({indicatorLibrary:[...a.indicatorLibrary,r]}))},removeIndicator:r=>{s(a=>({indicatorLibrary:a.indicatorLibrary.filter(n=>n.id!==r),chartConfig:{...a.chartConfig,indicators:a.chartConfig.indicators.filter(n=>n!==r)}}))},toggleIndicator:r=>{s(a=>{const n=a.chartConfig.indicators.includes(r);return{chartConfig:{...a.chartConfig,indicators:n?a.chartConfig.indicators.filter(i=>i!==r):[...a.chartConfig.indicators,r]},indicatorLibrary:a.indicatorLibrary.map(i=>i.id===r?{...i,isActive:!i.isActive}:i)}})},addAnalysis:r=>{s(a=>({analysisLibrary:[...a.analysisLibrary,r]}))},removeAnalysis:r=>{s(a=>({analysisLibrary:a.analysisLibrary.filter(n=>n.id!==r)}))},runAnalysis:async r=>{console.log(`Running analysis: ${r}`)},setAIAnalysisEnabled:r=>{s(a=>({aiAnalysisEnabled:r,chartConfig:{...a.chartConfig,aiAnalysisEnabled:r}}))},addAIRecommendation:r=>{s(a=>({aiRecommendations:[...a.aiRecommendations,r]}))},clearAIRecommendations:()=>{s({aiRecommendations:[]})},addTradingOpportunity:r=>{s(a=>({tradingOpportunities:[...a.tradingOpportunities,r]}))},clearTradingOpportunities:()=>{s({tradingOpportunities:[]})},addToWatchList:r=>{s(a=>a.watchList.find(i=>i.symbol===r.symbol&&i.exchange===r.exchange)?a:{watchList:[...a.watchList,r]})},removeFromWatchList:(r,a)=>{s(n=>({watchList:n.watchList.filter(i=>!(i.symbol===r&&i.exchange===a))}))},updateWatchListPrices:r=>{s(a=>({watchList:a.watchList.map(n=>{const i=r.find(l=>l.symbol===n.symbol&&l.exchange===n.exchange);return i?{...n,...i}:n})}))},updateOrderBook:r=>{s({orderBookData:r})},toggleLeftPanel:()=>{s(r=>({leftPanelCollapsed:!r.leftPanelCollapsed}))},toggleRightPanel:()=>{s(r=>({rightPanelCollapsed:!r.rightPanelCollapsed}))},setActiveLeftTab:r=>{s({activeLeftTab:r})},setActiveRightTab:r=>{s({activeRightTab:r})},updateKlineData:(r,a,n)=>{const i=`${t().selectedExchange}:${r}:${a}`;s(l=>({klineDataStore:{...l.klineDataStore,[i]:n}}))},updateCurrentPrice:r=>{const a=t().selectedSymbol;s(n=>({currentPriceData:{...n.currentPriceData,[a]:parseFloat(r)}}))},updateStrategyLibrary:r=>{s({strategyLibrary:r})},updateAnalysisLibrary:r=>{s({analysisLibrary:r})},syncFromAIChat:(r,a)=>{s(n=>({strategyLibrary:[...n.strategyLibrary.filter(i=>i.source!=="ai_chat"),...r],indicatorLibrary:[...n.indicatorLibrary.filter(i=>i.type!=="ai_enhanced"),...a]}))}}),{name:"trading-page-store",partialize:s=>({chartConfig:s.chartConfig,strategyLibrary:s.strategyLibrary,indicatorLibrary:s.indicatorLibrary,analysisLibrary:s.analysisLibrary,watchList:s.watchList,leftPanelCollapsed:s.leftPanelCollapsed,rightPanelCollapsed:s.rightPanelCollapsed,activeLeftTab:s.activeLeftTab,activeRightTab:s.activeRightTab,aiAnalysisEnabled:s.aiAnalysisEnabled})})),is=class is{constructor(){Ne(this,"cache",new Map);Ne(this,"CACHE_TTL",5e3)}static getInstance(){return is.instance||(is.instance=new is),is.instance}async getKlineData(t,r,a=100){try{console.log(`🔍 获取K线数据: ${t} ${r} (${a}条) - 使用模拟数据`);const n=this.generateMockKlineData(t,r,a);return console.log(`✅ 模拟K线数据生成成功: ${n.length}条记录`),n}catch(n){throw console.error("❌ K线数据获取失败:",n),new Error(`获取K线数据失败: ${n instanceof Error?n.message:String(n)}`)}}generateMockKlineData(t,r,a){const n=[];let i=43250;t.includes("ETH")?i=2800:t.includes("ADA")?i=.45:t.includes("SOL")&&(i=125);const l=Date.now(),o=this.getTimeframeMilliseconds(r);for(let c=a-1;c>=0;c--){const d=l-c*o,h=(Math.random()-.5)*.02,u=i*(1+h),j=Math.random()*.01,p=Math.random()*.01,f=(Math.random()-.5)*.015,x=u+u*j,y=u-u*p,m=u+u*f,g=Math.random()*50+10;n.push({timestamp:d,open:parseFloat(u.toFixed(2)),high:parseFloat(x.toFixed(2)),low:parseFloat(y.toFixed(2)),close:parseFloat(m.toFixed(2)),volume:parseFloat(g.toFixed(4))}),i=m}return n}getTimeframeMilliseconds(t){const r={"1m":6e4,"5m":3e5,"15m":9e5,"30m":18e5,"1h":36e5,"2h":72e5,"4h":144e5,"6h":216e5,"12h":432e5,"1d":864e5,"3d":2592e5,"1w":6048e5,"1M":2592e6};return r[t]||r["15m"]}async getTickerData(t){try{console.log(`🔍 获取价格数据: ${t} - 使用模拟数据`);const r=this.generateMockTickerData(t);return console.log(`✅ 模拟价格数据生成成功: ${t} = $${r.price}`),r}catch(r){throw console.error("❌ 价格数据获取失败:",r),new Error(`获取价格数据失败: ${r instanceof Error?r.message:String(r)}`)}}generateMockTickerData(t){let r=43250;t.includes("ETH")?r=2800:t.includes("ADA")?r=.45:t.includes("SOL")?r=125:t.includes("DOT")?r=7.5:t.includes("MATIC")&&(r=.85);const a=(Math.random()-.5)*.02,n=r*(1+a),i=r*((Math.random()-.5)*.08),l=i/r*100,o=n+n*Math.random()*.03,c=n-n*Math.random()*.03,d=Math.random()*1e6+1e5;return{symbol:t,price:parseFloat(n.toFixed(2)),change:parseFloat(i.toFixed(2)),change_percent:parseFloat(l.toFixed(2)),high_24h:parseFloat(o.toFixed(2)),low_24h:parseFloat(c.toFixed(2)),volume_24h:parseFloat(d.toFixed(2)),timestamp:Date.now()}}async getMultipleTickerData(t){try{console.log(`🔍 批量获取价格数据: ${t.length}个交易对`);const r=t.join(","),a=await te.get("/api/v1/market-data/tickers",{params:{symbols:r}});if(!a.data.success)throw new Error(a.data.message||"批量价格数据获取失败");const n=a.data.data,i=[];for(const l of t)if(n[l]){const o=n[l];i.push({symbol:o.symbol,price:o.price,change:o.change_24h,change_percent:o.change_percent_24h,high_24h:o.high_24h,low_24h:o.low_24h,volume_24h:o.volume_24h,timestamp:o.timestamp})}return console.log(`✅ 批量价格数据获取成功: ${i.length}个交易对`),i}catch(r){throw console.error("❌ 批量价格数据获取失败:",r),new Error(`批量获取价格数据失败: ${r instanceof Error?r.message:String(r)}`)}}async getSupportedSymbols(){const t="supported_symbols",r=this.getFromCache(t);if(r)return r;try{console.log("🔍 获取支持的交易对列表");const a=await te.get("/api/v1/market-data/supported-symbols");if(!a.data.success)throw new Error(a.data.message||"获取交易对列表失败");const n=a.data.data.symbols;return this.setCache(t,n),console.log(`✅ 支持的交易对获取成功: ${n.length}个`),n}catch(a){throw console.error("❌ 获取交易对列表失败:",a),new Error(`获取交易对列表失败: ${a instanceof Error?a.message:String(a)}`)}}async getPopularTradingPairs(t=8){try{console.log(`🔍 获取热门交易对: ${t}个`);const r=await te.get("/api/v1/market-data/trading-pairs",{params:{limit:t}});if(!r.data.success)throw new Error(r.data.message||"获取热门交易对失败");const a=r.data.data.trading_pairs.map(n=>({symbol:n.symbol,price:n.price,change_24h:n.change_24h,change_percent_24h:n.change_percent_24h,volume_24h:n.volume_24h,exchange:"OKX"}));return console.log(`✅ 热门交易对获取成功: ${a.length}个`),a}catch(r){throw console.error("❌ 获取热门交易对失败:",r),new Error(`获取热门交易对失败: ${r instanceof Error?r.message:String(r)}`)}}getFromCache(t){const r=this.cache.get(t);return r?Date.now()-r.timestamp>this.CACHE_TTL?(this.cache.delete(t),null):r.data:null}setCache(t,r){this.cache.set(t,{data:r,timestamp:Date.now()})}clearCache(){this.cache.clear()}};Ne(is,"instance");let Ia=is;const ua=Ia.getInstance(),ls=class ls{static getInstance(){return ls.instance||(ls.instance=new ls),ls.instance}async getStrategies(){try{console.log("🔍 获取用户策略列表");const t=await te.get("/strategies/");console.log("🔍 后端策略原始响应:",t.data);let r=[];t.data&&Array.isArray(t.data.strategies)?r=t.data.strategies:Array.isArray(t.data)?r=t.data:t.data&&t.data.data&&Array.isArray(t.data.data)&&(r=t.data.data),console.log("🔍 解析后的策略数组:",r);const a=r.map(n=>({id:n.id,name:n.name,description:n.description,code:n.code,parameters:n.parameters,type:"custom",source:"user",performance:n.performance_metrics?{returns:n.performance_metrics.total_return,winRate:n.performance_metrics.win_rate,maxDrawdown:n.performance_metrics.max_drawdown}:{returns:0,winRate:0,maxDrawdown:0},createdAt:new Date(n.created_at).getTime(),lastUsed:n.updated_at?new Date(n.updated_at).getTime():void 0}));return console.log(`✅ 策略列表获取成功: ${a.length}个策略`),a}catch(t){throw console.error("❌ 获取策略列表失败:",t),new Error(`获取策略列表失败: ${t instanceof Error?t.message:String(t)}`)}}async createStrategy(t){try{console.log(`🔍 创建新策略: ${t.name}`);const r={name:t.name,description:t.description,code:t.code,parameters:t.parameters},a=await te.post("/strategies/",r);if(!a.data.success)throw new Error(a.data.message||"创建策略失败");const n=a.data.data,i={id:n.id,name:n.name,description:n.description,code:n.code,parameters:n.parameters,type:"custom",source:"user",performance:t.performance,createdAt:new Date(n.created_at).getTime()};return console.log(`✅ 策略创建成功: ${i.name}`),i}catch(r){throw console.error("❌ 创建策略失败:",r),new Error(`创建策略失败: ${r instanceof Error?r.message:String(r)}`)}}async updateStrategyStatus(t,r){try{console.log(`🔍 更新策略状态: ${t} -> ${r}`);const a=await te.patch(`/strategies/${t}`,{is_active:r});if(!a.data.success)throw new Error(a.data.message||"更新策略状态失败");console.log(`✅ 策略状态更新成功: ${t}`)}catch(a){throw console.error("❌ 更新策略状态失败:",a),new Error(`更新策略状态失败: ${a instanceof Error?a.message:String(a)}`)}}async deleteStrategy(t){try{console.log(`🔍 删除策略: ${t}`);const r=await te.delete(`/strategies/${t}`);if(!r.data.success)throw new Error(r.data.message||"删除策略失败");console.log(`✅ 策略删除成功: ${t}`)}catch(r){throw console.error("❌ 删除策略失败:",r),new Error(`删除策略失败: ${r instanceof Error?r.message:String(r)}`)}}async runBacktest(t,r,a,n=30){try{console.log(`🔍 运行策略回测: ${t} on ${r} ${a}`);const i=await te.post("/backtests/",{strategy_id:t,symbol:r,timeframe:a,days:n});if(!i.data.success)throw new Error(i.data.message||"策略回测失败");return console.log(`✅ 策略回测完成: ${t}`),i.data.data.performance_metrics}catch(i){throw console.error("❌ 策略回测失败:",i),new Error(`策略回测失败: ${i instanceof Error?i.message:String(i)}`)}}async chatWithAI(t,r="strategy"){try{console.log(`🤖 AI策略对话: ${r}`);const a=await te.post("/ai/chat",{content:t,session_type:r,ai_mode:"trader"});if(!a.data.success)throw new Error(a.data.message||"AI对话失败");return console.log("✅ AI对话成功"),a.data.data.response||a.data.data.content}catch(a){throw console.error("❌ AI对话失败:",a),new Error(`AI对话失败: ${a instanceof Error?a.message:String(a)}`)}}async getAnalysisLibrary(){return console.log("📊 获取分析库 (使用模拟数据)"),[{id:"breakout_pattern",name:"突破形态分析",description:"识别价格突破关键支撑或阻力位的形态",type:"pattern",criteria:{volume_spike:!0,price_breakout:!0,momentum_confirm:!0},confidence:.85,lastAnalysis:{result:"发现2个潜在突破机会",timestamp:Date.now()-36e5,opportunities:[]}},{id:"trend_reversal",name:"趋势反转分析",description:"检测趋势可能发生反转的信号",type:"trend",criteria:{divergence:!0,support_resistance:!0,candlestick_patterns:!0},confidence:.78,lastAnalysis:{result:"发现1个反转信号",timestamp:Date.now()-18e5,opportunities:[]}}]}async runAnalysis(t,r){return console.log(`📊 运行分析: ${t} on ${r}`),await new Promise(a=>setTimeout(a,2e3)),{result:`基于${t}分析${r}，发现3个交易机会`,opportunities:[{type:"buy",confidence:.82,price:43200,reason:"突破上升趋势线"},{type:"sell",confidence:.75,price:43800,reason:"遇到阻力位"}],confidence:.78}}};Ne(ls,"instance");let Da=ls;const qs=Da.getInstance(),os=class os{constructor(){Ne(this,"ws",null);Ne(this,"reconnectTimer",null);Ne(this,"pingTimer",null);Ne(this,"handlers",{});Ne(this,"reconnectAttempts",0);Ne(this,"maxReconnectAttempts",5);Ne(this,"reconnectInterval",5e3);Ne(this,"isManualClose",!1);Ne(this,"subscribedSymbols",new Set)}static getInstance(){return os.instance||(os.instance=new os),os.instance}connect(t){this.handlers=t,this.isManualClose=!1,this.createConnection()}createConnection(){try{console.log("🔌 WebSocket暂时使用模拟连接，避免Trading页面阻塞"),setTimeout(()=>{var t,r;console.log("✅ 模拟WebSocket连接成功"),this.reconnectAttempts=0,(r=(t=this.handlers).onConnect)==null||r.call(t),this.startMockHeartbeat(),this.startMockPriceUpdates()},100)}catch(t){console.error("❌ WebSocket连接创建失败:",t),this.handleError("WebSocket连接创建失败")}}setupEventListeners(){this.ws&&(this.ws.onopen=()=>{var t,r;console.log("✅ WebSocket连接成功"),this.reconnectAttempts=0,(r=(t=this.handlers).onConnect)==null||r.call(t),this.authenticate(),this.startHeartbeat(),this.resubscribeSymbols()},this.ws.onmessage=t=>{try{const r=JSON.parse(t.data);this.handleMessage(r)}catch(r){console.error("❌ WebSocket消息解析失败:",r)}},this.ws.onclose=t=>{var r,a;console.log(`🔌 WebSocket连接关闭: ${t.code} ${t.reason}`),this.cleanup(),(a=(r=this.handlers).onDisconnect)==null||a.call(r),!this.isManualClose&&this.reconnectAttempts<this.maxReconnectAttempts&&this.scheduleReconnect()},this.ws.onerror=t=>{console.error("❌ WebSocket错误:",t),this.handleError("WebSocket连接错误")})}handleMessage(t){var r,a,n,i,l,o;switch(t.type){case"ticker":(a=(r=this.handlers).onTicker)==null||a.call(r,t.data);break;case"analysis":(i=(n=this.handlers).onAnalysis)==null||i.call(n,t.data);break;case"strategy_signal":(o=(l=this.handlers).onStrategySignal)==null||o.call(l,t.data);break;case"pong":break;case"error":this.handleError(t.data.message||"服务器错误");break;default:console.warn("⚠️ 未知的WebSocket消息类型:",t.type)}}authenticate(){const t=localStorage.getItem("auth-storage");let r="";if(t)try{const{state:a}=JSON.parse(t);r=(a==null?void 0:a.token)||""}catch(a){console.error("❌ 认证数据解析失败:",a)}this.send({type:"auth",data:{token:r},timestamp:Date.now()})}subscribeToSymbol(t){console.log(`📡 订阅实时价格: ${t}`),this.subscribedSymbols.add(t),this.send({type:"subscribe",data:{symbol:t,channel:"ticker"},timestamp:Date.now()})}unsubscribeFromSymbol(t){console.log(`📡 取消订阅: ${t}`),this.subscribedSymbols.delete(t),this.send({type:"unsubscribe",data:{symbol:t,channel:"ticker"},timestamp:Date.now()})}startAnalysis(t,r){console.log(`🤖 启动AI分析: ${t} on ${r}`),this.send({type:"start_analysis",data:{analysis_id:t,symbol:r},timestamp:Date.now()})}send(t){this.ws&&this.ws.readyState===WebSocket.OPEN?this.ws.send(JSON.stringify(t)):console.warn("⚠️ WebSocket未连接，无法发送消息")}startHeartbeat(){this.pingTimer=setInterval(()=>{this.send({type:"ping",data:{},timestamp:Date.now()})},3e4)}startMockHeartbeat(){this.pingTimer=setInterval(()=>{console.log("💓 模拟心跳")},3e4)}startMockPriceUpdates(){setInterval(()=>{var t,r;if(this.subscribedSymbols.size>0){const n=Array.from(this.subscribedSymbols)[0]||"BTC-USDT",i=43250,l=(Math.random()-.5)*1e3,o=i+l,c=l*.1,d=c/i*100,h={symbol:n,price:o,change_24h:c,change_percent_24h:d,volume_24h:Math.random()*1e5,timestamp:Date.now()};(r=(t=this.handlers).onTicker)==null||r.call(t,h)}},5e3),this.startMockKlineUpdates()}startMockKlineUpdates(){setInterval(()=>{var t,r;if(this.subscribedSymbols.size>0){const n=Array.from(this.subscribedSymbols)[0]||"BTC-USDT";console.log(`📊 模拟K线数据推送: ${n}`);const i=this.generateMockKlineUpdate(n);(r=(t=this.handlers).onAnalysis)==null||r.call(t,{analysis_id:"kline_update",symbol:n,result:"K线数据更新",confidence:1,opportunities:[],timestamp:Date.now(),kline_data:i})}},3e4)}generateMockKlineUpdate(t){let r=43250;t.includes("ETH")?r=2800:t.includes("ADA")?r=.45:t.includes("SOL")&&(r=125);const a=Date.now(),n=(Math.random()-.5)*.02,i=r*(1+n),l=Math.random()*.01,o=Math.random()*.01,c=(Math.random()-.5)*.015,d=i+i*l,h=i-i*o,u=i+i*c,j=Math.random()*50+10;return{timestamp:a,open:parseFloat(i.toFixed(2)),high:parseFloat(d.toFixed(2)),low:parseFloat(h.toFixed(2)),close:parseFloat(u.toFixed(2)),volume:parseFloat(j.toFixed(4))}}resubscribeSymbols(){this.subscribedSymbols.forEach(t=>{this.subscribeToSymbol(t)})}scheduleReconnect(){this.reconnectAttempts++;const t=this.reconnectInterval*this.reconnectAttempts;console.log(`🔄 安排重连 (${this.reconnectAttempts}/${this.maxReconnectAttempts}): ${t}ms后重试`),this.reconnectTimer=setTimeout(()=>{this.createConnection()},t)}handleError(t){var r,a;console.error("❌ WebSocket服务错误:",t),(a=(r=this.handlers).onError)==null||a.call(r,t)}cleanup(){this.pingTimer&&(clearInterval(this.pingTimer),this.pingTimer=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)}disconnect(){console.log("🔌 手动断开WebSocket连接"),this.isManualClose=!0,this.cleanup(),this.ws&&(this.ws.close(),this.ws=null)}getConnectionState(){return"connected"}};Ne(os,"instance");let Ra=os;const Ns=Ra.getInstance(),cs=class cs{constructor(){Ne(this,"callbacks",{});Ne(this,"isConnected",!1);Ne(this,"currentSymbol","BTC/USDT");Ne(this,"currentTimeframe","15m");Ne(this,"dataRefreshInterval",null)}static getInstance(){return cs.instance||(cs.instance=new cs),cs.instance}initialize(t){console.log("🚀 初始化Trading数据管理器"),this.callbacks=t,this.initializeWebSocket(),this.loadInitialData(),this.startDataRefresh()}initializeWebSocket(){const t={onConnect:()=>{var r,a;console.log("✅ WebSocket连接成功"),this.isConnected=!0,(a=(r=this.callbacks).onConnectionUpdate)==null||a.call(r,!0),Ns.subscribeToSymbol(this.currentSymbol)},onDisconnect:()=>{var r,a;console.log("❌ WebSocket连接断开"),this.isConnected=!1,(a=(r=this.callbacks).onConnectionUpdate)==null||a.call(r,!1)},onTicker:r=>{var n,i;console.log(`💰 实时价格更新: ${r.symbol} = $${r.price}`);const a={symbol:r.symbol,price:r.price,change:r.change_24h,change_percent:r.change_percent_24h,high_24h:0,low_24h:0,volume_24h:r.volume_24h,timestamp:r.timestamp};(i=(n=this.callbacks).onTickerUpdate)==null||i.call(n,a)},onAnalysis:r=>{console.log(`📊 分析结果更新: ${r.analysis_id}`),this.loadAnalysisLibrary()},onError:r=>{var a,n;console.error("❌ WebSocket错误:",r),(n=(a=this.callbacks).onError)==null||n.call(a,r)}};Ns.connect(t)}async loadInitialData(){var t,r;try{console.log("📊 加载初始数据..."),await Promise.all([this.loadKlineData(this.currentSymbol,this.currentTimeframe),this.loadTickerData(this.currentSymbol),this.loadStrategies(),this.loadAnalysisLibrary()]),console.log("✅ 初始数据加载完成")}catch(a){console.error("❌ 初始数据加载失败:",a),(r=(t=this.callbacks).onError)==null||r.call(t,`初始数据加载失败: ${a}`)}}async loadKlineData(t,r,a=100){var n,i,l,o;try{console.log(`📊 加载K线数据: ${t} ${r}`);const c=await ua.getKlineData(t,r,a);(i=(n=this.callbacks).onKlineUpdate)==null||i.call(n,t,r,c),console.log(`✅ K线数据加载完成: ${c.length}条`)}catch(c){console.error("❌ K线数据加载失败:",c),(o=(l=this.callbacks).onError)==null||o.call(l,`K线数据加载失败: ${c}`)}}async loadTickerData(t){var r,a,n,i;try{console.log(`💰 加载价格数据: ${t}`);const l=await ua.getTickerData(t);(a=(r=this.callbacks).onTickerUpdate)==null||a.call(r,l),console.log(`✅ 价格数据加载完成: $${l.price}`)}catch(l){console.error("❌ 价格数据加载失败:",l),(i=(n=this.callbacks).onError)==null||i.call(n,`价格数据加载失败: ${l}`)}}async loadStrategies(){var t,r,a,n;try{console.log("🎯 加载策略库...");const i=await qs.getStrategies();(r=(t=this.callbacks).onStrategyUpdate)==null||r.call(t,i),console.log(`✅ 策略库加载完成: ${i.length}个策略`)}catch(i){console.error("❌ 策略库加载失败:",i),(n=(a=this.callbacks).onError)==null||n.call(a,`策略库加载失败: ${i}`)}}async loadAnalysisLibrary(){var t,r,a,n;try{console.log("📊 加载分析库...");const i=await qs.getAnalysisLibrary();(r=(t=this.callbacks).onAnalysisUpdate)==null||r.call(t,i),console.log(`✅ 分析库加载完成: ${i.length}个分析`)}catch(i){console.error("❌ 分析库加载失败:",i),(n=(a=this.callbacks).onError)==null||n.call(a,`分析库加载失败: ${i}`)}}async switchSymbol(t,r){console.log(`🔄 切换交易对: ${t} ${r||this.currentTimeframe}`),this.isConnected&&Ns.unsubscribeFromSymbol(this.currentSymbol),this.currentSymbol=t,r&&(this.currentTimeframe=r),this.isConnected&&Ns.subscribeToSymbol(this.currentSymbol),await Promise.all([this.loadKlineData(t,this.currentTimeframe),this.loadTickerData(t)])}async switchTimeframe(t){console.log(`🔄 切换时间框架: ${this.currentSymbol} ${t}`),this.currentTimeframe=t,await this.loadKlineData(this.currentSymbol,t)}async runStrategyBacktest(t){var r,a;try{console.log(`🎯 运行策略回测: ${t}`);const n=await qs.runBacktest(t,this.currentSymbol,this.currentTimeframe);console.log("✅ 策略回测完成:",n),await this.loadStrategies()}catch(n){console.error("❌ 策略回测失败:",n),(a=(r=this.callbacks).onError)==null||a.call(r,`策略回测失败: ${n}`)}}async runAIAnalysis(t){var r,a;try{if(console.log(`🤖 运行AI分析: ${t}`),this.isConnected)Ns.startAnalysis(t,this.currentSymbol);else{const n=await qs.runAnalysis(t,this.currentSymbol);console.log("✅ AI分析完成:",n),await this.loadAnalysisLibrary()}}catch(n){console.error("❌ AI分析失败:",n),(a=(r=this.callbacks).onError)==null||a.call(r,`AI分析失败: ${n}`)}}async chatWithAI(t,r="strategy"){try{console.log(`🤖 AI对话: ${r}`);const a=await qs.chatWithAI(t,r);return console.log("✅ AI对话完成"),a}catch(a){throw console.error("❌ AI对话失败:",a),a}}startDataRefresh(){this.dataRefreshInterval=setInterval(()=>{this.isConnected||(console.log("🔄 定时刷新价格数据 (WebSocket未连接)"),this.loadTickerData(this.currentSymbol))},3e4)}getConnectionStatus(){return{websocket:this.isConnected,api:!0}}getCurrentSettings(){return{symbol:this.currentSymbol,timeframe:this.currentTimeframe}}destroy(){console.log("🧹 清理Trading数据管理器资源"),Ns.disconnect(),this.dataRefreshInterval&&(clearInterval(this.dataRefreshInterval),this.dataRefreshInterval=null),ua.clearCache()}};Ne(cs,"instance");let Ba=cs;const br=Ba.getInstance(),Fu=[{symbol:"BTC/USDT",exchange:"OKX",price:"43,250.00",change:"+2.45%",volume:"2.1B"},{symbol:"ETH/USDT",exchange:"OKX",price:"2,680.50",change:"+3.21%",volume:"1.8B"},{symbol:"BNB/USDT",exchange:"OKX",price:"645.80",change:"-1.15%",volume:"450M"},{symbol:"SOL/USDT",exchange:"OKX",price:"98.45",change:"+5.67%",volume:"680M"},{symbol:"ADA/USDT",exchange:"OKX",price:"0.4521",change:"+1.89%",volume:"320M"},{symbol:"XRP/USDT",exchange:"OKX",price:"0.6234",change:"-0.78%",volume:"560M"},{symbol:"DOT/USDT",exchange:"OKX",price:"7.89",change:"+2.34%",volume:"180M"},{symbol:"LINK/USDT",exchange:"OKX",price:"15.67",change:"+4.12%",volume:"210M"},{symbol:"AVAX/USDT",exchange:"OKX",price:"32.45",change:"-2.11%",volume:"150M"},{symbol:"MATIC/USDT",exchange:"OKX",price:"1.234",change:"+1.56%",volume:"290M"}],zu=["OKX","Binance","Huobi","Bybit"],Uu=({selectedSymbol:s,selectedExchange:t,onSymbolChange:r,onExchangeChange:a})=>{const[n,i]=b.useState(!1),[l,o]=b.useState(""),[c,d]=b.useState(t),h=b.useRef(null),u=b.useRef(null),j=Fu.filter(x=>x.exchange===c&&(x.symbol.toLowerCase().includes(l.toLowerCase())||l===""));b.useEffect(()=>{const x=y=>{h.current&&!h.current.contains(y.target)&&(i(!1),o(""))};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const p=(x,y)=>{r(x),a(y),i(!1),o("")},f=x=>{d(x),a(x)};return e.jsxs("div",{className:"relative",ref:h,children:[e.jsxs("div",{className:"flex items-center bg-white border border-gray-300 rounded-lg px-3 py-2 cursor-pointer hover:border-blue-400 transition-colors min-w-[300px]",onClick:()=>{i(!n),n||setTimeout(()=>{var x;return(x=u.current)==null?void 0:x.focus()},100)},children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:t}),e.jsx("span",{className:"font-medium text-gray-900",children:s})]}),e.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${n?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-96 overflow-hidden",children:[e.jsx("div",{className:"flex border-b border-gray-200",children:zu.map(x=>e.jsx("button",{onClick:()=>f(x),className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${c===x?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:x},x))}),e.jsx("div",{className:"p-3 border-b border-gray-100",children:e.jsx("input",{ref:u,type:"text",placeholder:"搜索交易品种...",value:l,onChange:x=>o(x.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:j.map((x,y)=>e.jsxs("div",{onClick:()=>p(x.symbol,x.exchange),className:"flex items-center justify-between px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-50 last:border-b-0",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-gray-900 text-sm",children:x.symbol}),e.jsx("span",{className:"text-xs text-gray-500",children:x.exchange})]})}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium text-gray-900",children:x.price}),e.jsx("div",{className:`${x.change.startsWith("+")?"text-green-600":"text-red-600"}`,children:x.change})]}),e.jsx("div",{className:"text-gray-500 min-w-[50px] text-right",children:x.volume})]})]},`${x.exchange}-${x.symbol}-${y}`))}),j.length===0&&e.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"未找到匹配的交易品种"})]})]})},Wu={cursor:{color:"#666666",lineWidth:1,lineType:"solid",opacity:1},line:{color:"#2563eb",lineWidth:2,lineType:"solid",opacity:.8},rectangle:{color:"#7c3aed",lineWidth:2,lineType:"solid",opacity:.8,fill:"#7c3aed",fillOpacity:.1},circle:{color:"#059669",lineWidth:2,lineType:"solid",opacity:.8,fill:"#059669",fillOpacity:.1},fibonacci:{color:"#dc2626",lineWidth:1,lineType:"dashed",opacity:.7,fill:"#dc2626",fillOpacity:.05},text:{color:"#1f2937",lineWidth:1,lineType:"solid",opacity:1,fontSize:12,fontColor:"#1f2937"}},Vu=[0,.236,.382,.5,.618,.786,1],ri={cursor:{requiresPoints:0,allowsMultiPoint:!1,showWhileDrawing:!1},line:{requiresPoints:2,allowsMultiPoint:!1,showWhileDrawing:!0},rectangle:{requiresPoints:2,allowsMultiPoint:!1,showWhileDrawing:!0},circle:{requiresPoints:2,allowsMultiPoint:!1,showWhileDrawing:!0},fibonacci:{requiresPoints:2,allowsMultiPoint:!1,showWhileDrawing:!0},text:{requiresPoints:1,allowsMultiPoint:!1,showWhileDrawing:!1}},Hu=({chartInstance:s,symbol:t,timeframe:r})=>{const[a,n]=b.useState({drawings:[],selectedDrawing:null,isDrawing:!1,currentPoints:[],activeTool:null}),i=b.useCallback(y=>{const m=`drawings_${t}_${r}`;localStorage.setItem(m,JSON.stringify(y))},[t,r]),l=b.useCallback(()=>{const y=`drawings_${t}_${r}`,m=localStorage.getItem(y);if(m)try{const g=JSON.parse(m);return n(v=>({...v,drawings:g})),g}catch(g){console.error("Failed to load drawings from storage:",g)}return[]},[t,r]),o=b.useCallback(y=>{n(m=>({...m,activeTool:y,isDrawing:!1,currentPoints:[],selectedDrawing:null}))},[]),c=b.useCallback(y=>{!a.activeTool||a.activeTool==="cursor"||(ri[a.activeTool],n(m=>({...m,isDrawing:!0,currentPoints:[y]})))},[a.activeTool]),d=b.useCallback(y=>{if(!a.isDrawing||!a.activeTool)return;const m=ri[a.activeTool],g=[...a.currentPoints,y];n(v=>({...v,currentPoints:g})),g.length>=m.requiresPoints&&h(g)},[a.isDrawing,a.activeTool,a.currentPoints]),h=b.useCallback(y=>{if(!a.activeTool)return;const m={id:`drawing_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:a.activeTool,points:y,style:Wu[a.activeTool],created:Date.now(),modified:Date.now(),visible:!0,locked:!1},g=[...a.drawings,m];n(v=>({...v,drawings:g,isDrawing:!1,currentPoints:[],selectedDrawing:m.id})),i(g),f(g)},[a.activeTool,a.drawings,i]),u=b.useCallback(()=>{n(y=>({...y,isDrawing:!1,currentPoints:[]}))},[]),j=b.useCallback(y=>{const m=a.drawings.filter(g=>g.id!==y);n(g=>({...g,drawings:m,selectedDrawing:g.selectedDrawing===y?null:g.selectedDrawing})),i(m),f(m)},[a.drawings,i]),p=b.useCallback(()=>{n(y=>({...y,drawings:[],selectedDrawing:null,isDrawing:!1,currentPoints:[]})),i([]),f([])},[i]),f=b.useCallback((y,m)=>{var A,T;if(!s.current)return;const g=s.current.getOption();m||(T=(A=g.series)==null?void 0:A[0])!=null&&T.data;const v=[],P=[],E=[];y.forEach(k=>{if(k.visible)switch(k.type){case"line":if(k.points.length>=2){const[R,se]=k.points;v.push({name:`Line_${k.id}`,lineStyle:{color:k.style.color,width:k.style.lineWidth,type:k.style.lineType==="dashed"?"dashed":"solid"},data:[{coord:[R.dataIndex,R.y]},{coord:[se.dataIndex,se.y]}]})}break;case"rectangle":if(k.points.length>=2){const[R,se]=k.points;P.push({name:`Rect_${k.id}`,itemStyle:{color:k.style.fill||k.style.color,opacity:k.style.fillOpacity||.2,borderColor:k.style.color,borderWidth:k.style.lineWidth},data:[[{coord:[R.dataIndex,R.y]},{coord:[se.dataIndex,se.y]}]]})}break;case"text":if(k.points.length>=1){const R=k.points[0];E.push({name:`Text_${k.id}`,coord:[R.dataIndex,R.y],value:k.label||"Text",itemStyle:{color:k.style.color,borderWidth:0},label:{show:!0,formatter:k.label||"Text",color:k.style.fontColor||k.style.color,fontSize:k.style.fontSize||12}})}break;case"fibonacci":if(k.points.length>=2){const[R,se]=k.points,z=R.y,S=se.y-z;Vu.forEach(U=>{const V=z+S*U;v.push({name:`Fib_${k.id}_${U}`,lineStyle:{color:k.style.color,width:1,type:"dashed",opacity:.7},label:{show:!0,formatter:`${(U*100).toFixed(1)}%`,position:"end"},data:[{coord:[R.dataIndex,V]},{coord:[se.dataIndex,V]}]})})}break}}),s.current.setOption({series:[{markLine:{data:v,symbol:"none",animation:!1},markArea:{data:P,animation:!1},markPoint:{data:E,animation:!1}}]},!1)},[s]),x=b.useCallback(y=>{var g,v;if(!a.activeTool||a.activeTool==="cursor")return;const m={x:y.dataIndex,y:((g=y.value)==null?void 0:g[4])||y.value,timestamp:(v=y.value)==null?void 0:v[0],dataIndex:y.dataIndex};a.isDrawing?d(m):c(m)},[a.activeTool,a.isDrawing,c,d]);return{drawingState:a,setActiveTool:o,handleChartClick:x,deleteDrawing:j,clearAllDrawings:p,cancelDrawing:u,loadDrawingsFromStorage:l,updateChartDrawings:f}},kl=(s,t)=>{const r=[];for(let a=0;a<s.length;a++)if(a<t-1)r.push(null);else{const n=s.slice(a-t+1,a+1).reduce((i,l)=>i+l,0);r.push(n/t)}return r},ha=(s,t)=>{const r=[],a=2/(t+1);for(let n=0;n<s.length;n++)if(n===0)r.push(s[n]);else if(n<t-1)r.push(null);else{const i=s[n]*a+(r[n-1]??s[n])*(1-a);r.push(i)}return r},qu=(s,t=12,r=26,a=9)=>{const n=s.map(p=>p.close),i=ha(n,t),l=ha(n,r),o=i.map((p,f)=>{const x=l[f];return p===null||x===null?null:p-x}),c=o.filter(p=>p!==null),d=ha(c,a),h=[];let u=0;for(let p=0;p<o.length;p++)o[p]===null?h.push(null):(h.push(d[u]??null),u++);const j=o.map((p,f)=>{const x=h[f];return p===null||x===null?null:p-x});return{macd:o,signal:h,histogram:j}},Ku=(s,t=14)=>{const r=s.map(i=>i.close),a=[];if(r.length<t+1)return new Array(r.length).fill(null);const n=[];for(let i=1;i<r.length;i++)n.push(r[i]-r[i-1]);a.push(null);for(let i=0;i<n.length;i++)if(i<t-1)a.push(null);else{const l=n.slice(i-t+1,i+1),o=l.filter(u=>u>0),c=l.filter(u=>u<0).map(u=>Math.abs(u)),d=o.length>0?o.reduce((u,j)=>u+j,0)/t:0,h=c.length>0?c.reduce((u,j)=>u+j,0)/t:0;if(h===0)a.push(100);else{const j=100-100/(1+d/h);a.push(j)}}return a},Zu=(s,t=20,r=2)=>{const a=s.map(o=>o.close),n=kl(a,t),i=[],l=[];for(let o=0;o<a.length;o++)if(o<t-1||n[o]===null)i.push(null),l.push(null);else{const c=a.slice(o-t+1,o+1),d=n[o],u=c.map(p=>Math.pow(p-d,2)).reduce((p,f)=>p+f,0)/t,j=Math.sqrt(u);i.push(d+r*j),l.push(d-r*j)}return{upper:i,middle:n,lower:l}},Gu=(s,t=9)=>{const r=[],a=[],n=[];let i=50,l=50;for(let o=0;o<s.length;o++)if(o<t-1)r.push(null),a.push(null),n.push(null);else{const c=s.slice(o-t+1,o+1),d=Math.max(...c.map(y=>y.high)),h=Math.min(...c.map(y=>y.low)),u=s[o].close;let j=50;d!==h&&(j=(u-h)/(d-h)*100);const p=(2*i+j)/3,f=(2*l+p)/3,x=3*p-2*f;r.push(p),a.push(f),n.push(x),i=p,l=f}return{k:r,d:a,j:n}},Ju=({symbol:s,timeframe:t,exchange:r,config:a,className:n="",chartRef:i,drawingTools:l})=>{const o=b.useRef(null),c=b.useRef(null),d=(S,U)=>{if(!S||S.length===0)return{processedOhlc:[],processedVolumes:[]};const V=S[0].close;let le=S.map(B=>[B.open,B.close,B.low,B.high]),C=S.map(B=>B.volume);return U.displayMode==="percentage"&&(le=S.map(B=>[(B.open-V)/V*100,(B.close-V)/V*100,(B.low-V)/V*100,(B.high-V)/V*100])),{processedOhlc:le,processedVolumes:C}},h=S=>{if(!S||S.length<50)return{start:0,end:100};const U=Math.min(100,Math.max(50,S.length*.8)),V=Math.max(0,(S.length-U)/S.length*100);return{start:Math.round(V),end:100}},{chartConfig:u,klineDataStore:j,isDataLoading:p}=zt(),{klineData:f,isLoading:x,fetchKlineData:y}=_s(),m=`${r}:${s}:${t}`;j[m];const g=p||x;console.log("🔍 KlineChart调试信息:",{symbol:s,timeframe:t,exchange:r,dataKey:m,storeData:j[m],fallbackData:f,klineDataKeys:Object.keys(j),isLoading:g}),b.useEffect(()=>{if(o.current)return console.log("📏 图表容器尺寸信息:",{width:o.current.offsetWidth,height:o.current.offsetHeight,clientWidth:o.current.clientWidth,clientHeight:o.current.clientHeight,scrollHeight:o.current.scrollHeight}),c.current=Zs(o.current,a.theme==="dark"?"dark":null),i&&(i.current=c.current),l&&c.current.on("click",l.handleChartClick),a.theme==="dark"&&c.current.setOption({backgroundColor:"#1f2937"}),()=>{var S;(S=c.current)==null||S.dispose()}},[a.theme]),b.useEffect(()=>{y(s,t,r)},[s,t,r,y]),b.useEffect(()=>{if(!c.current)return;let S=j[m]||(Array.isArray(f)?f:[]);if((!S||S.length===0)&&(console.log("🔧 生成模拟K线数据用于图表显示"),S=R(s,t,100)),console.log(`📊 使用的K线数据: ${(S==null?void 0:S.length)||0}条记录`),!S||S.length===0){console.warn("⚠️ 仍然没有可用的K线数据");return}const U=K(S,a);c.current.setOption(U,!0),v(a.drawingTools||[])},[j,f,s,t,r,a,m]),b.useEffect(()=>{const S=()=>{c.current&&setTimeout(()=>{var U;(U=c.current)==null||U.resize()},100)};return window.addEventListener("resize",S),S(),()=>window.removeEventListener("resize",S)},[a.priceAxisMode,a.chartStyle,a.theme]),b.useEffect(()=>{c.current&&setTimeout(()=>{var S;(S=c.current)==null||S.resize()},50)},[a.priceAxisMode,a.autoScale]);const v=S=>{c.current&&S.forEach(U=>{switch(U.type){case"trendline":P();break;case"rectangle":E();break;case"horizontal":A();break;case"vertical":T();break;case"fibonacci":k();break}})},P=S=>{},E=S=>{},A=S=>{},T=S=>{},k=S=>{},R=(S,U,V)=>{const le=[];let C=43250;S.includes("ETH")?C=2800:S.includes("ADA")?C=.45:S.includes("SOL")&&(C=125);const B=Date.now(),re=se(U);for(let _=V-1;_>=0;_--){const H=B-_*re,xe=(Math.random()-.5)*.02,_e=C*(1+xe),$e=Math.random()*.01,pe=Math.random()*.01,X=(Math.random()-.5)*.015,W=_e+_e*$e,ne=_e-_e*pe,L=_e+_e*X,ae=Math.random()*50+10;le.push({timestamp:H,open:parseFloat(_e.toFixed(2)),high:parseFloat(W.toFixed(2)),low:parseFloat(ne.toFixed(2)),close:parseFloat(L.toFixed(2)),volume:parseFloat(ae.toFixed(4))}),C=L}return le},se=S=>{const U={"1m":6e4,"5m":3e5,"15m":9e5,"30m":18e5,"1h":36e5,"2h":72e5,"4h":144e5,"6h":216e5,"12h":432e5,"1d":864e5,"3d":2592e5,"1w":6048e5,"1M":2592e6};return U[S]||U["15m"]},z=S=>{if(!S||S.length===0)return[];const U=[];let V={open:0,close:0};return S.forEach((le,C)=>{let B,re,_,H;re=(le.open+le.high+le.low+le.close)/4,C===0?B=(le.open+le.close)/2:B=(V.open+V.close)/2,_=Math.max(le.high,B,re),H=Math.min(le.low,B,re),U.push([parseFloat(B.toFixed(2)),parseFloat(re.toFixed(2)),parseFloat(H.toFixed(2)),parseFloat(_.toFixed(2))]),V={open:B,close:re}}),U},K=(S,U)=>{const V=S.map(ie=>new Date(ie.timestamp).toLocaleString()),{processedOhlc:le,processedVolumes:C}=d(S,U),B=le,re=C,_=S.map(ie=>ie.close),H=U.indicators,xe={ma:{enabled:H.some(ie=>ie.startsWith("ma_")),periods:[5,10,20,60]},volume:{enabled:H.includes("volume")},macd:{enabled:H.includes("macd"),params:{fast:12,slow:26,signal:9}},rsi:{enabled:H.includes("rsi"),params:{period:14}},boll:{enabled:H.includes("boll"),params:{period:20,multiplier:2}},kdj:{enabled:H.includes("kdj"),params:{period:9}}},_e=qu(S,xe.macd.params.fast,xe.macd.params.slow,xe.macd.params.signal),$e=Ku(S,xe.rsi.params.period),pe=Zu(S,xe.boll.params.period,xe.boll.params.multiplier),X=Gu(S,xe.kdj.params.period);let W=1,ne=1;xe.volume.enabled&&W++,xe.macd.enabled&&W++,xe.rsi.enabled&&W++,xe.kdj.enabled&&W++;const L=ie=>kl(_,ie).map(ke=>ke===null?"-":ke.toFixed(2)),ae=[];let ge=[];if(U.chartStyle==="line")ae.push({name:"收盘价",type:"line",data:_,xAxisIndex:0,yAxisIndex:0,lineStyle:{color:"#4f46e5",width:2},showSymbol:!1,smooth:!1}),ge.push("收盘价");else if(U.chartStyle==="area")ae.push({name:"收盘价",type:"line",data:_,xAxisIndex:0,yAxisIndex:0,lineStyle:{color:"#4f46e5",width:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(79, 70, 229, 0.4)"},{offset:1,color:"rgba(79, 70, 229, 0.1)"}]}},showSymbol:!1,smooth:!0}),ge.push("收盘价");else if(U.chartStyle==="heikin-ashi"){const ie=z(S);ae.push({name:"Heikin-Ashi",type:"candlestick",data:ie,xAxisIndex:0,yAxisIndex:0,itemStyle:{color:"#21ce90",color0:"#f53d3d",borderColor:"#21ce90",borderColor0:"#f53d3d",opacity:.8}}),ge.push("Heikin-Ashi")}else ae.push({name:"K线",type:"candlestick",data:B,xAxisIndex:0,yAxisIndex:0,itemStyle:{color:"#21ce90",color0:"#f53d3d",borderColor:"#21ce90",borderColor0:"#f53d3d"}}),ge.push("K线");xe.ma.enabled&&H.filter(he=>he.startsWith("ma_")).map(he=>parseInt(he.split("_")[1])).filter(he=>xe.ma.periods.includes(he)).forEach((he,ke)=>{const N=["#ff6b6b","#4ecdc4","#45b7d1","#ffa726"],M=`MA${he}`;ae.push({name:M,type:"line",data:L(he),smooth:!0,lineStyle:{color:N[ke%N.length],width:2},showSymbol:!1,xAxisIndex:0,yAxisIndex:0}),ge.push(M)}),xe.boll.enabled&&(ae.push({name:"BOLL上轨",type:"line",data:pe.upper.map(ie=>ie===null?"-":ie.toFixed(2)),lineStyle:{color:"#ff9800",width:1,type:"dashed"},showSymbol:!1,xAxisIndex:0,yAxisIndex:0},{name:"BOLL中轨",type:"line",data:pe.middle.map(ie=>ie===null?"-":ie.toFixed(2)),lineStyle:{color:"#9c27b0",width:1},showSymbol:!1,xAxisIndex:0,yAxisIndex:0},{name:"BOLL下轨",type:"line",data:pe.lower.map(ie=>ie===null?"-":ie.toFixed(2)),lineStyle:{color:"#ff9800",width:1,type:"dashed"},showSymbol:!1,xAxisIndex:0,yAxisIndex:0}),ge.push("BOLL上轨","BOLL中轨","BOLL下轨")),xe.volume.enabled&&(ae.push({name:"成交量",type:"bar",data:re,xAxisIndex:ne,yAxisIndex:ne,itemStyle:{color:function(ie){const he=ie.dataIndex;if(he===0)return"#21ce90";const ke=B[he],N=B[he-1];return ke[1]>=N[1]?"#21ce90":"#f53d3d"}}}),ge.push("成交量"),ne++),xe.macd.enabled&&(ae.push({name:"MACD",type:"line",data:_e.macd.map(ie=>ie===null?"-":ie.toFixed(4)),lineStyle:{color:"#2196f3",width:2},showSymbol:!1,xAxisIndex:ne,yAxisIndex:ne},{name:"SIGNAL",type:"line",data:_e.signal.map(ie=>ie===null?"-":ie.toFixed(4)),lineStyle:{color:"#ff9800",width:2},showSymbol:!1,xAxisIndex:ne,yAxisIndex:ne},{name:"HISTOGRAM",type:"bar",data:_e.histogram.map(ie=>ie===null?0:ie),xAxisIndex:ne,yAxisIndex:ne,itemStyle:{color:function(ie){return ie.data>=0?"#21ce90":"#f53d3d"}}}),ge.push("MACD","SIGNAL","HISTOGRAM"),ne++),xe.rsi.enabled&&(ae.push({name:"RSI",type:"line",data:$e.map(ie=>ie===null?"-":ie.toFixed(2)),lineStyle:{color:"#9c27b0",width:2},showSymbol:!1,xAxisIndex:ne,yAxisIndex:ne}),ae.push({name:"RSI-70",type:"line",data:new Array(S.length).fill(70),lineStyle:{color:"#f44336",width:1,type:"dashed"},showSymbol:!1,xAxisIndex:ne,yAxisIndex:ne,silent:!0},{name:"RSI-30",type:"line",data:new Array(S.length).fill(30),lineStyle:{color:"#4caf50",width:1,type:"dashed"},showSymbol:!1,xAxisIndex:ne,yAxisIndex:ne,silent:!0}),ge.push("RSI"),ne++),xe.kdj.enabled&&(ae.push({name:"K",type:"line",data:X.k.map(ie=>ie===null?"-":ie.toFixed(2)),lineStyle:{color:"#2196f3",width:1},showSymbol:!1,xAxisIndex:ne,yAxisIndex:ne},{name:"D",type:"line",data:X.d.map(ie=>ie===null?"-":ie.toFixed(2)),lineStyle:{color:"#ff9800",width:1},showSymbol:!1,xAxisIndex:ne,yAxisIndex:ne},{name:"J",type:"line",data:X.j.map(ie=>ie===null?"-":ie.toFixed(2)),lineStyle:{color:"#9c27b0",width:1},showSymbol:!1,xAxisIndex:ne,yAxisIndex:ne}),ge.push("K","D","J"),ne++);const fe=U.theme==="dark",Je=fe?"#1f2937":"#ffffff",$=fe?"#e5e7eb":"#666666",ye=fe?"#374151":"#f5f5f5",De=fe?"#4b5563":"#ddd";return{animation:!1,backgroundColor:Je,legend:{data:ge,top:10,left:"center",textStyle:{color:$,fontSize:11},type:"scroll",itemWidth:12,itemHeight:8},tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:$}},backgroundColor:fe?"rgba(31, 41, 55, 0.95)":"rgba(0, 0, 0, 0.8)",borderColor:De,textStyle:{color:fe?"#e5e7eb":"#fff",fontSize:12},formatter:function(ie){if(!ie||ie.length===0)return"";let he='<div style="text-align: left; min-width: 200px;">';he+=`<div style="margin-bottom: 8px; font-weight: bold;">${s}</div>`,he+=`<div style="margin-bottom: 8px; color: ${fe?"#9ca3af":"#ccc"};">${ie[0].name}</div>`;const ke=ie.find(N=>N.seriesName==="K线");if(ke&&ke.data){const[N,M,I,G]=ke.data,q=((M-N)/N*100).toFixed(2),Z=M>=N?"#21ce90":"#f53d3d";he+='<div style="display: flex; justify-content: space-between; margin-bottom: 4px;">',he+=`<span>开盘:</span><span>${N}</span></div>`,he+='<div style="display: flex; justify-content: space-between; margin-bottom: 4px;">',he+=`<span>收盘:</span><span style="color: ${Z}">${M} (${q}%)</span></div>`,he+='<div style="display: flex; justify-content: space-between; margin-bottom: 4px;">',he+=`<span>最高:</span><span>${G}</span></div>`,he+='<div style="display: flex; justify-content: space-between; margin-bottom: 8px;">',he+=`<span>最低:</span><span>${I}</span></div>`}return he+="</div>",he}},axisPointer:{link:{xAxisIndex:"all"}},grid:(()=>{const ie=[];let M=7,I,G;W===1?I=83:W===2?(I=Math.floor(85*.7),G=Math.floor(85*.28)):W===3?(I=Math.floor(85*.6),G=Math.floor(85*.38/2)):(I=Math.floor(85*.5),G=Math.floor(85*.48/(W-1))),ie.push({left:"6%",right:"6%",top:`${M}%`,height:`${I}%`,backgroundColor:"transparent"}),M+=I+1;for(let q=1;q<W;q++)ie.push({left:"6%",right:"6%",top:`${M}%`,height:`${G}%`,backgroundColor:"transparent"}),M+=G+1;return ie})(),xAxis:(()=>{const ie=[];for(let he=0;he<W;he++)ie.push({type:"category",data:V,gridIndex:he,axisLine:{lineStyle:{color:De}},axisTick:{show:!1},axisLabel:{show:he===W-1,color:$,formatter:function(ke){return new Date(ke).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}},splitLine:{show:!1}});return ie})(),yAxis:(()=>{const ie=[];for(let he=0;he<W;he++){const ke={gridIndex:he,position:"right",axisLine:{lineStyle:{color:De}},axisTick:{show:!1},axisLabel:{color:$,fontSize:11},splitLine:{lineStyle:{color:ye,width:1}}};if(he===0){const N={...ke,scale:U.autoScale,axisLabel:{...ke.axisLabel,formatter:M=>{if(U.priceAxisMode==="percentage"){const I=S.length>0?S[0].close:M;return`${((M-I)/I*100).toFixed(2)}%`}return M.toFixed(2)}}};U.priceAxisMode==="logarithmic"?ie.push({...N,type:"log",logBase:10}):U.priceAxisMode==="percentage"?ie.push({...N,type:"value",axisLabel:{...N.axisLabel,formatter:M=>`${M.toFixed(2)}%`}}):ie.push({...N,type:"value"})}else ie.push({...ke,type:"value",scale:!0})}return ie})(),dataZoom:[{type:"inside",xAxisIndex:Array.from({length:W},(ie,he)=>he),start:U.autoScale?h(S).start:80,end:U.autoScale?h(S).end:100},{show:!0,xAxisIndex:Array.from({length:W},(ie,he)=>he),type:"slider",bottom:10,start:U.autoScale?h(S).start:80,end:U.autoScale?h(S).end:100,textStyle:{color:$},borderColor:De,backgroundColor:fe?"#374151":"#f8f9fa"}],series:ae}};return e.jsxs("div",{className:`relative w-full h-full ${n}`,children:[e.jsx("div",{ref:o,className:`w-full h-full min-h-[500px] ${a.theme==="dark"?"bg-gray-800":"bg-white"}`,style:{height:"100%",minHeight:"500px"}}),g&&e.jsx("div",{className:`absolute inset-0 flex items-center justify-center ${a.theme==="dark"?"bg-gray-800 bg-opacity-75":"bg-white bg-opacity-75"}`,children:e.jsx("div",{className:`${a.theme==="dark"?"text-gray-300":"text-gray-500"}`,children:"加载中..."})})]})},Qu=({activeIndicators:s,className:t=""})=>{const[r,a]=b.useState(!1),{indicatorLibrary:n,toggleIndicator:i}=zt(),l=[{id:"ma_5",name:"MA(5)",description:"5日移动平均线",type:"overlay",color:"#ff6b6b"},{id:"ma_10",name:"MA(10)",description:"10日移动平均线",type:"overlay",color:"#4ecdc4"},{id:"ma_20",name:"MA(20)",description:"20日移动平均线",type:"overlay",color:"#45b7d1"},{id:"ma_60",name:"MA(60)",description:"60日移动平均线",type:"overlay",color:"#f9ca24"},{id:"boll",name:"BOLL",description:"布林带",type:"overlay",color:"#6c5ce7"},{id:"volume",name:"VOL",description:"成交量",type:"sub",color:"#a29bfe"},{id:"macd",name:"MACD",description:"MACD指标",type:"sub",color:"#fd79a8"},{id:"rsi",name:"RSI",description:"RSI指标",type:"sub",color:"#00b894"},{id:"kdj",name:"KDJ",description:"KDJ指标",type:"sub",color:"#e17055"},{id:"cci",name:"CCI",description:"CCI指标",type:"sub",color:"#00cec9"}],o=l.filter(d=>d.type==="overlay"),c=l.filter(d=>d.type==="sub");return e.jsxs("div",{className:`relative ${t}`,children:[e.jsx("button",{onClick:()=>a(!r),className:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm hover:shadow-md transition-shadow",title:"技术指标",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-600 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"指标"}),e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs rounded-full",children:s.length})]})}),r&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-80 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"技术指标"}),e.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"主图指标"}),e.jsx("div",{className:"space-y-2",children:o.map(d=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:d.color}}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm text-white",children:d.name}),e.jsx("div",{className:"text-xs text-gray-400",children:d.description})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.includes(d.id),onChange:()=>i(d.id),className:"sr-only peer"}),e.jsx("div",{className:"w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]},d.id))})]}),e.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"分图指标"}),e.jsx("div",{className:"space-y-2",children:c.map(d=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:d.color}}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm text-white",children:d.name}),e.jsx("div",{className:"text-xs text-gray-400",children:d.description})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.includes(d.id),onChange:()=>i(d.id),className:"sr-only peer"}),e.jsx("div",{className:"w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]},d.id))})]}),e.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"自定义指标"}),e.jsx("button",{className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200",children:"添加指标"})]}),n.length===0?e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center py-4",children:"暂无自定义指标"}):e.jsx("div",{className:"space-y-2",children:n.map(d=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-white",children:d.name}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:d.description})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.isActive,onChange:()=>i(d.id),className:"sr-only peer"}),e.jsx("div",{className:"w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]},d.id))})]})]})]})},Xu=({opportunities:s,recommendations:t,onOpportunityClick:r,className:a=""})=>{const[n,i]=b.useState(null),[l,o]=b.useState(!1),c=u=>{switch(u){case"buy":return"text-green-600 bg-green-50 border-green-200";case"sell":return"text-red-600 bg-red-50 border-red-200";case"watch":return"text-yellow-600 bg-yellow-50 border-yellow-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},d=u=>u>=.8?"text-green-600 bg-green-100":u>=.6?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100",h=u=>{i(u),o(!0),r(u)};return e.jsxs("div",{className:`absolute inset-0 pointer-events-none ${a}`,children:[s.map((u,j)=>e.jsxs("div",{className:"absolute pointer-events-auto cursor-pointer transform -translate-x-1/2 -translate-y-1/2 z-20",style:{left:`${20+j*15}%`,top:`${30+Math.random()*40}%`},onClick:()=>h(u),children:[e.jsxs("div",{className:`relative w-4 h-4 rounded-full border-2 ${c(u.signal)} flex items-center justify-center`,children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-current animate-pulse"}),e.jsx("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 whitespace-nowrap",children:e.jsx("div",{className:`px-1.5 py-0.5 rounded text-xs font-medium ${c(u.signal)} border`,children:u.signal.toUpperCase()})})]}),e.jsx("div",{className:"absolute top-6 left-1/2 transform -translate-x-1/2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg p-3 min-w-48 opacity-0 hover:opacity-100 transition-opacity z-30",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[u.type==="breakout"&&"突破",u.type==="support"&&"支撑",u.type==="resistance"&&"阻力",u.type==="pattern"&&"形态"]}),e.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${d(u.confidence)}`,children:[(u.confidence*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:["价格: $",u.price.toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:u.description}),u.suggestedStrategy&&e.jsx("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:["推荐策略: ",u.suggestedStrategy]})})]})})]},u.id)),s.filter(u=>["support","resistance"].includes(u.type)).map((u,j)=>e.jsxs("div",{className:"absolute pointer-events-none z-10",style:{left:"10%",right:"10%",top:`${30+j*5}%`,height:"1px"},children:[e.jsx("div",{className:`w-full h-full ${u.type==="support"?"bg-green-400 border-green-400":"bg-red-400 border-red-400"} opacity-60`,style:{borderTop:`1px dashed ${u.type==="support"?"#4ade80":"#f87171"}`}}),e.jsxs("div",{className:`absolute right-0 -top-2 px-1.5 py-0.5 rounded text-xs font-medium ${u.type==="support"?"text-green-700 bg-green-100":"text-red-700 bg-red-100"}`,children:["$",u.price.toFixed(2)]})]},`line-${u.id}`)),l&&n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 pointer-events-auto",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"交易机会详情"}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"机会类型"}),e.jsxs("div",{className:"font-medium text-gray-900 dark:text-white",children:[n.type==="breakout"&&"价格突破",n.type==="support"&&"支撑位",n.type==="resistance"&&"阻力位",n.type==="pattern"&&"技术形态"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"信号强度"}),e.jsxs("div",{className:`inline-block px-2 py-1 rounded text-sm font-medium ${c(n.signal)}`,children:[n.signal==="buy"&&"买入信号",n.signal==="sell"&&"卖出信号",n.signal==="watch"&&"观察信号"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"目标价格"}),e.jsxs("div",{className:"font-medium text-gray-900 dark:text-white",children:["$",n.price.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"置信度"}),e.jsxs("div",{className:`inline-block px-2 py-1 rounded text-sm font-medium ${d(n.confidence)}`,children:[(n.confidence*100).toFixed(0),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"分析描述"}),e.jsx("p",{className:"text-gray-900 dark:text-white mt-1",children:n.description})]}),n.suggestedStrategy&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 dark:text-gray-400",children:"推荐策略"}),e.jsx("div",{className:"mt-1 p-3 bg-blue-50 dark:bg-blue-900 rounded-lg",children:e.jsx("p",{className:"text-blue-700 dark:text-blue-300 text-sm",children:n.suggestedStrategy})})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["发现时间: ",new Date(n.timestamp).toLocaleString()]})]}),e.jsxs("div",{className:"flex space-x-2 p-4 border-t border-gray-200 dark:border-gray-600",children:[e.jsx("button",{className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"创建策略"}),e.jsx("button",{onClick:()=>o(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"关闭"})]})]})}),s.length>0&&e.jsx("div",{className:"absolute top-4 left-4 pointer-events-auto",children:e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg px-3 py-2 flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-blue-700 dark:text-blue-300 font-medium",children:"AI实时扫描中..."}),e.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:[s.length,"个机会"]})]})}),t.length>0&&e.jsx("div",{className:"absolute bottom-4 left-4 pointer-events-auto max-w-xs",children:e.jsxs("div",{className:"bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"AI策略推荐"}),e.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[t.length,"个"]})]}),e.jsx("div",{className:"space-y-2",children:t.slice(0,2).map(u=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-2",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-900 dark:text-white",children:u.strategyName}),e.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[(u.confidence*100).toFixed(0),"%"]})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 line-clamp-2",children:u.reason})]},u.id))}),t.length>2&&e.jsxs("button",{className:"w-full mt-2 text-xs text-green-700 dark:text-green-300 hover:text-green-800 dark:hover:text-green-200",children:["查看全部 (",t.length,"个)"]})]})})]})},Yu=({isFullscreen:s,theme:t,onFullscreenToggle:r,onThemeToggle:a,onSettingsClick:n})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded hover:bg-gray-700 text-gray-300 transition-colors",title:"图表设置",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),e.jsx("button",{onClick:r,className:"w-8 h-8 flex items-center justify-center rounded hover:bg-gray-700 text-gray-300 transition-colors",title:s?"退出全屏":"进入全屏",children:s?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]}),eh=({isOpen:s,config:t,onClose:r,onConfigChange:a})=>{if(!s)return null;const n=c=>{a({priceAxisMode:c})},i=c=>{a({chartStyle:c})},l=c=>{a({displayMode:c})},o=()=>{a({autoScale:!t.autoScale})};return e.jsxs("div",{className:"absolute top-12 right-2 z-20 bg-gray-800 border border-gray-600 rounded-lg shadow-xl p-4 min-w-64",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"图表设置"}),e.jsx("button",{onClick:r,className:"w-6 h-6 flex items-center justify-center rounded text-gray-400 hover:text-white hover:bg-gray-700",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"图表样式"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{key:"candlestick",label:"蜡烛图",icon:"📊"},{key:"line",label:"线图",icon:"📈"},{key:"area",label:"面积图",icon:"🌊"},{key:"heikin-ashi",label:"平均蜡烛",icon:"🕯️"}].map(c=>e.jsxs("button",{onClick:()=>i(c.key),className:`p-2 rounded text-xs transition-colors ${t.chartStyle===c.key?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[e.jsx("span",{className:"mr-1",children:c.icon}),c.label]},c.key))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"价格轴模式"}),e.jsx("div",{className:"space-y-2",children:[{key:"linear",label:"线性",desc:"常规价格轴"},{key:"percentage",label:"百分比",desc:"相对于基准价格的百分比"},{key:"logarithmic",label:"对数",desc:"对数坐标轴，适合大幅价格变化"}].map(c=>e.jsxs("button",{onClick:()=>n(c.key),className:`w-full p-2 rounded text-left text-xs transition-colors ${t.priceAxisMode===c.key?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[e.jsx("div",{className:"font-medium",children:c.label}),e.jsx("div",{className:"text-xs opacity-80",children:c.desc})]},c.key))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"数据显示模式"}),e.jsx("div",{className:"space-y-2",children:[{key:"normal",label:"正常",desc:"显示实际价格"},{key:"percentage",label:"百分比",desc:"显示相对第一根K线的百分比变化"}].map(c=>e.jsxs("button",{onClick:()=>l(c.key),className:`w-full p-2 rounded text-left text-xs transition-colors ${t.displayMode===c.key?"bg-green-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[e.jsx("div",{className:"font-medium",children:c.label}),e.jsx("div",{className:"text-xs opacity-80",children:c.desc})]},c.key))})]}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"自适应缩放"}),e.jsx("p",{className:"text-xs text-gray-400",children:"自动调整图表范围以适应屏幕"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:t.autoScale,onChange:o}),e.jsx("div",{className:`w-10 h-6 rounded-full transition-colors ${t.autoScale?"bg-blue-600":"bg-gray-600"}`,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full mt-1 transition-transform ${t.autoScale?"translate-x-5":"translate-x-1"}`})})]})]})}),e.jsx("div",{className:"pt-4 border-t border-gray-600",children:e.jsx("button",{onClick:()=>a({chartStyle:"candlestick",priceAxisMode:"linear",displayMode:"normal",autoScale:!0}),className:"w-full py-2 px-3 bg-gray-600 hover:bg-gray-500 text-white text-sm rounded transition-colors",children:"恢复默认设置"})})]})]})},ai=[{id:"cursor",name:"选择工具",icon:s=>e.jsx("svg",{className:"w-4 h-4",fill:s?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:s?0:1.5,d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"})}),shortcut:"Alt+S",category:"basic"},{id:"separator-1",type:"separator"},{id:"line",name:"趋势线",icon:s=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:s?2:1.5,d:"M4 20L20 4"})}),shortcut:"Alt+T",category:"lines"},{id:"separator-2",type:"separator"},{id:"rectangle",name:"矩形",icon:s=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:s?2:1.5,d:"M4 6h16v12H4z"})}),shortcut:"Alt+Shift+R",category:"shapes"},{id:"circle",name:"圆形",icon:s=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("circle",{cx:"12",cy:"12",r:"8",strokeWidth:s?2:1.5})}),shortcut:"Alt+Shift+C",category:"shapes"},{id:"separator-3",type:"separator"},{id:"fibonacci",name:"斐波那契回调",icon:s=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:s?2:1.5,d:"M4 20L20 4M4 16h16M4 12h16M4 8h16"})}),shortcut:"Alt+F",category:"fibonacci"},{id:"separator-4",type:"separator"},{id:"text",name:"文本标注",icon:s=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:s?2:1.5,d:"M7 8h10M7 12h4m-7-8V4a2 2 0 012-2h8a2 2 0 012 2v4M7 20h10"})}),shortcut:"Alt+X",category:"annotation"}],th=({className:s="",drawingTools:t})=>{var l;const[r,a]=b.useState(null),n=((l=t==null?void 0:t.drawingState)==null?void 0:l.activeTool)||"cursor",i=o=>{t&&(o===n?t.setActiveTool("cursor"):t.setActiveTool(o),console.log(`激活绘图工具: ${o}`))};return ai.filter(o=>o.type!=="separator"),e.jsxs("div",{className:`flex flex-col bg-gray-900/95 backdrop-blur-sm border-r border-gray-700/50 ${s}`,children:[e.jsx("div",{className:"px-1 py-2 border-b border-gray-700/30",children:e.jsx("div",{className:"text-xs font-medium text-gray-400 text-center",children:"绘图工具"})}),e.jsx("div",{className:"flex flex-col flex-1 px-1 py-2 space-y-1 overflow-y-auto",children:ai.map((o,c)=>{if(o.type==="separator")return e.jsx("div",{className:"h-px bg-gray-700/50 mx-2 my-1"},o.id);const d=n===o.id;return e.jsxs("div",{className:"relative",onMouseEnter:()=>a(o.id),onMouseLeave:()=>a(null),children:[e.jsxs("button",{onClick:()=>i(o.id),className:`w-8 h-8 rounded-md flex items-center justify-center transition-all duration-200 relative group ${d?"bg-blue-600 text-white shadow-lg shadow-blue-600/25 ring-2 ring-blue-400/30":"text-gray-400 hover:text-white hover:bg-gray-800/80"}`,title:`${o.name} (${o.shortcut})`,children:[o.icon(d),d&&e.jsx("div",{className:"absolute -right-0.5 top-1/2 transform -translate-y-1/2 w-1 h-4 bg-blue-400 rounded-full"})]}),r===o.id&&e.jsxs("div",{className:"absolute left-full ml-2 top-1/2 transform -translate-y-1/2 z-50 px-2 py-1.5 bg-gray-800 text-white text-xs rounded shadow-lg border border-gray-600 whitespace-nowrap",children:[e.jsx("div",{className:"font-medium",children:o.name}),e.jsx("div",{className:"text-gray-400 text-xs",children:o.shortcut}),e.jsx("div",{className:"absolute right-full top-1/2 transform -translate-y-1/2 w-0 h-0 border-t-4 border-b-4 border-r-4 border-transparent border-r-gray-800"})]})]},o.id)})}),e.jsxs("div",{className:"px-1 py-2 border-t border-gray-700/30 space-y-1",children:[e.jsx("button",{onClick:()=>{t==null||t.clearAllDrawings(),console.log("清除所有绘图")},className:"w-8 h-8 rounded-md flex items-center justify-center text-gray-400 hover:text-red-400 hover:bg-red-500/10 transition-all duration-200",title:"清除所有绘图 (Alt+Del)",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("button",{className:"w-8 h-8 rounded-md flex items-center justify-center text-gray-400 hover:text-yellow-400 hover:bg-yellow-500/10 transition-all duration-200",title:"锁定/解锁绘图 (Alt+L)",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("button",{className:"w-8 h-8 rounded-md flex items-center justify-center text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 transition-all duration-200",title:"绘图样式 (Alt+Shift+S)",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM7 21h16M7 5a2 2 0 012-2h10a2 2 0 012 2v12a4 4 0 01-4 4H9a4 4 0 01-4-4V5z"})})})]})]})},sh=({className:s=""})=>{const t=b.useRef(null),r=b.useRef(null),[a,n]=b.useState(!1),[i,l]=b.useState(!1),{chartConfig:o,selectedSymbol:c,selectedTimeframe:d,selectedExchange:h,aiAnalysisEnabled:u,tradingOpportunities:j,aiRecommendations:p,updateChartConfig:f}=zt(),x=Hu({chartInstance:r,symbol:c,timeframe:d}),y=()=>{t.current&&(a?document.exitFullscreen&&document.exitFullscreen():t.current.requestFullscreen&&t.current.requestFullscreen())};b.useEffect(()=>{const g=()=>{n(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",g),()=>document.removeEventListener("fullscreenchange",g)},[]);const m=()=>{const g=o.theme==="light"?"dark":"light";f({theme:g})};return e.jsxs("div",{ref:t,className:`relative w-full h-full bg-gray-900 overflow-hidden ${s}`,children:[e.jsxs("div",{className:"flex w-full h-full",children:[e.jsx(th,{className:"w-10 flex-shrink-0",drawingTools:x}),e.jsxs("div",{className:"relative flex-1 h-full",children:[e.jsx(Ju,{symbol:c,timeframe:d,exchange:h,config:o,className:"w-full h-full",chartRef:r,drawingTools:x}),u&&e.jsx(Xu,{opportunities:j,recommendations:p,onOpportunityClick:g=>{console.log("Opportunity clicked:",g)}}),e.jsx(Qu,{activeIndicators:o.indicators,className:"absolute top-2 left-2 z-10"}),u&&e.jsxs("div",{className:"absolute top-2 right-20 flex items-center space-x-2 bg-gray-800/80 backdrop-blur-sm rounded px-3 py-1.5 z-10",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-green-400",children:"AI分析"})]}),e.jsxs("div",{className:"absolute top-2 right-2 z-10",children:[e.jsx(Yu,{isFullscreen:a,theme:o.theme,onFullscreenToggle:y,onThemeToggle:m,onSettingsClick:()=>l(!0)}),e.jsx(eh,{isOpen:i,config:o,onClose:()=>l(!1),onConfigChange:f})]})]})," "]})," ",p.length>0&&e.jsx("div",{className:"absolute bottom-14 right-4 max-w-sm z-20",children:e.jsxs("div",{className:"bg-blue-900/90 backdrop-blur-sm border border-blue-700 rounded-lg p-4 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-medium text-blue-100 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),"AI策略推荐"]}),e.jsx("button",{onClick:()=>{},className:"text-blue-400 hover:text-blue-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"space-y-2",children:p.slice(0,2).map(g=>e.jsxs("div",{className:"p-2 bg-gray-800/80 rounded border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-white",children:g.strategyName}),e.jsxs("span",{className:"text-xs text-green-400",children:[(g.confidence*100).toFixed(0),"%"]})]}),e.jsx("p",{className:"text-xs text-gray-300",children:g.reason})]},g.id))})]})})]})},rh=()=>{const{selectedSymbol:s,selectedExchange:t,setSelectedSymbol:r,setSelectedExchange:a,addToWatchList:n}=zt(),[i,l]=b.useState(""),[o,c]=b.useState("all"),d=b.useMemo(()=>[{symbol:"BTC/USDT",exchange:"OKX",price:42580.5,change24h:1280.3,changePercent24h:3.1,volume24h:245e7,category:"spot",baseAsset:"BTC",quoteAsset:"USDT"},{symbol:"BTC/USDT",exchange:"Binance",price:42575.2,change24h:1275.1,changePercent24h:3.09,volume24h:238e7,category:"spot",baseAsset:"BTC",quoteAsset:"USDT"},{symbol:"BTC/ETH",exchange:"OKX",price:18.45,change24h:.32,changePercent24h:1.77,volume24h:145e6,category:"spot",baseAsset:"BTC",quoteAsset:"ETH"},{symbol:"ETH/USDT",exchange:"OKX",price:2310.8,change24h:45.2,changePercent24h:2,volume24h:185e7,category:"spot",baseAsset:"ETH",quoteAsset:"USDT"},{symbol:"ETH/USDT",exchange:"Binance",price:2308.5,change24h:42.8,changePercent24h:1.89,volume24h:172e7,category:"spot",baseAsset:"ETH",quoteAsset:"USDT"},{symbol:"ETH/BTC",exchange:"OKX",price:.0542,change24h:-8e-4,changePercent24h:-1.45,volume24h:89e6,category:"spot",baseAsset:"ETH",quoteAsset:"BTC"},{symbol:"SOL/USDT",exchange:"OKX",price:98.45,change24h:5.23,changePercent24h:5.6,volume24h:65e7,category:"spot",baseAsset:"SOL",quoteAsset:"USDT"},{symbol:"ADA/USDT",exchange:"OKX",price:.485,change24h:.018,changePercent24h:3.85,volume24h:28e7,category:"spot",baseAsset:"ADA",quoteAsset:"USDT"},{symbol:"DOT/USDT",exchange:"OKX",price:6.78,change24h:-.15,changePercent24h:-2.17,volume24h:18e7,category:"spot",baseAsset:"DOT",quoteAsset:"USDT"},{symbol:"LINK/USDT",exchange:"OKX",price:14.52,change24h:.68,changePercent24h:4.91,volume24h:32e7,category:"spot",baseAsset:"LINK",quoteAsset:"USDT"},{symbol:"BTC-PERPETUAL",exchange:"OKX",price:42585,change24h:1285,changePercent24h:3.12,volume24h:52e8,category:"futures",baseAsset:"BTC",quoteAsset:"USD"},{symbol:"ETH-PERPETUAL",exchange:"OKX",price:2312.5,change24h:46.8,changePercent24h:2.07,volume24h:31e8,category:"futures",baseAsset:"ETH",quoteAsset:"USD"}],[]),h=[{key:"all",name:"全部",icon:"📊"},{key:"spot",name:"现货",icon:"💰"},{key:"futures",name:"合约",icon:"📈"},{key:"favorites",name:"热门",icon:"🔥"}],u=b.useMemo(()=>d.filter(m=>{const g=m.symbol.toLowerCase().includes(i.toLowerCase())||m.baseAsset.toLowerCase().includes(i.toLowerCase())||m.quoteAsset.toLowerCase().includes(i.toLowerCase()),v=o==="all"||m.category===o||o==="favorites"&&["BTC/USDT","ETH/USDT","SOL/USDT"].includes(m.symbol);return g&&v}),[d,i,o]),j=b.useMemo(()=>u.reduce((m,g)=>(m[g.exchange]||(m[g.exchange]=[]),m[g.exchange].push(g),m),{}),[u]),p=(m,g)=>{r(m),a(g)},f=m=>{const g={symbol:m.symbol,exchange:m.exchange,price:m.price,change24h:m.change24h,changePercent24h:m.changePercent24h,volume24h:m.volume24h,lastUpdated:Date.now()};n(g)},x=m=>m>=1e3?m.toLocaleString():m>=1?m.toFixed(2):m>=.01?m.toFixed(4):m.toFixed(6),y=m=>m>=1e9?(m/1e9).toFixed(1)+"B":m>=1e6?(m/1e6).toFixed(1)+"M":m>=1e3?(m/1e3).toFixed(1)+"K":m.toFixed(0);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"搜索交易对...",value:i,onChange:m=>l(m.target.value),className:"w-full pl-9 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("svg",{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{className:"flex space-x-1",children:h.map(m=>e.jsxs("button",{onClick:()=>c(m.key),className:`flex items-center space-x-1 px-3 py-1 rounded text-xs font-medium transition-colors ${o===m.key?"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[e.jsx("span",{children:m.icon}),e.jsx("span",{children:m.name})]},m.key))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 pb-4",children:Object.keys(j).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 dark:text-gray-500 mb-2",children:e.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"未找到匹配的交易对"})]}):e.jsx("div",{className:"space-y-4",children:Object.entries(j).map(([m,g])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 dark:bg-blue-900 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-blue-600 dark:text-blue-400",children:m[0]})}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:m}),e.jsx("div",{className:"flex-1 border-t border-gray-200 dark:border-gray-600"})]}),e.jsx("div",{className:"space-y-1",children:g.map((v,P)=>{const E=s===v.symbol&&t===v.exchange,A=v.changePercent24h>=0;return e.jsxs("div",{className:`p-3 rounded-lg cursor-pointer transition-all ${E?"bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700":"hover:bg-gray-50 dark:hover:bg-gray-700"}`,onClick:()=>p(v.symbol,v.exchange),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-sm",children:v.symbol}),v.category==="futures"&&e.jsx("span",{className:"px-1.5 py-0.5 bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200 text-xs rounded",children:"合约"})]}),e.jsx("button",{onClick:T=>{T.stopPropagation(),f(v)},className:"p-1 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"添加到自选",children:e.jsx("svg",{className:"w-3 h-3 text-gray-400 hover:text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-900 dark:text-white font-medium",children:["$",x(v.price)]}),e.jsxs("span",{className:`font-medium ${A?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[A?"+":"",v.changePercent24h.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[e.jsxs("span",{children:["24h量: ",y(v.volume24h)]}),e.jsxs("span",{className:A?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:[A?"+":"",x(Math.abs(v.change24h))]})]})]},`${v.exchange}-${v.symbol}-${P}`)})})]},m))})})]})},ah=()=>{const{watchList:s,selectedSymbol:t,selectedExchange:r,setSelectedSymbol:a,setSelectedExchange:n,removeFromWatchList:i,updateWatchListPrices:l}=zt(),[o,c]=b.useState("symbol"),[d,h]=b.useState("asc"),u=[...s].sort((m,g)=>{let v,P;switch(o){case"price":v=m.price,P=g.price;break;case"change":v=m.changePercent24h,P=g.changePercent24h;break;case"volume":v=m.volume24h,P=g.volume24h;break;default:v=m.symbol,P=g.symbol}return typeof v=="string"&&typeof P=="string"?d==="asc"?v.localeCompare(P):P.localeCompare(v):d==="asc"?v-P:P-v}),j=m=>{o===m?h(d==="asc"?"desc":"asc"):(c(m),h("desc"))},p=(m,g)=>{a(m),n(g)},f=m=>m>=1e3?m.toLocaleString():m>=1?m.toFixed(2):m>=.01?m.toFixed(4):m.toFixed(6),x=m=>m>=1e9?(m/1e9).toFixed(1)+"B":m>=1e6?(m/1e6).toFixed(1)+"M":m>=1e3?(m/1e3).toFixed(1)+"K":m.toFixed(0),y=m=>o!==m?e.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):d==="asc"?e.jsx("svg",{className:"w-3 h-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):e.jsx("svg",{className:"w-3 h-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})});return s.length===0?e.jsx("div",{className:"h-full flex flex-col",children:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-400 dark:text-gray-500 mb-3",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"暂无自选品种"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mb-4",children:"在市场列表中点击❤️图标添加自选品种"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"浏览市场"})]})})}):e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-12 gap-2 text-xs font-medium text-gray-500 dark:text-gray-400",children:[e.jsxs("button",{onClick:()=>j("symbol"),className:"col-span-4 flex items-center space-x-1 hover:text-gray-700 dark:hover:text-gray-300",children:[e.jsx("span",{children:"品种"}),y("symbol")]}),e.jsxs("button",{onClick:()=>j("price"),className:"col-span-3 flex items-center space-x-1 justify-end hover:text-gray-700 dark:hover:text-gray-300",children:[e.jsx("span",{children:"价格"}),y("price")]}),e.jsxs("button",{onClick:()=>j("change"),className:"col-span-3 flex items-center space-x-1 justify-end hover:text-gray-700 dark:hover:text-gray-300",children:[e.jsx("span",{children:"涨跌幅"}),y("change")]}),e.jsxs("button",{onClick:()=>j("volume"),className:"col-span-2 flex items-center space-x-1 justify-end hover:text-gray-700 dark:hover:text-gray-300",children:[e.jsx("span",{children:"量"}),y("volume")]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"space-y-1 p-2",children:u.map((m,g)=>{const v=t===m.symbol&&r===m.exchange,P=m.changePercent24h>=0,A=Date.now()-m.lastUpdated>6e4;return e.jsxs("div",{className:`grid grid-cols-12 gap-2 p-2 rounded-lg cursor-pointer transition-all group ${v?"bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700":"hover:bg-gray-50 dark:hover:bg-gray-700"}`,onClick:()=>p(m.symbol,m.exchange),children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-sm",children:m.symbol.split("/")[0]}),A&&e.jsx("div",{className:"w-1.5 h-1.5 bg-yellow-400 rounded-full",title:"数据可能不是最新"})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:m.exchange}),e.jsxs("span",{children:["/",m.symbol.split("/")[1]]})]})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center items-end",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["$",f(m.price)]}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["$",f(Math.abs(m.change24h))]})]}),e.jsx("div",{className:"col-span-3 flex flex-col justify-center items-end",children:e.jsxs("span",{className:`text-sm font-medium ${P?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[P?"+":"",m.changePercent24h.toFixed(2),"%"]})}),e.jsxs("div",{className:"col-span-2 flex items-center justify-end space-x-1",children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:x(m.volume24h)}),e.jsx("button",{onClick:T=>{T.stopPropagation(),i(m.symbol,m.exchange)},className:"opacity-0 group-hover:opacity-100 p-1 rounded hover:bg-red-100 dark:hover:bg-red-900 transition-all",title:"从自选中移除",children:e.jsx("svg",{className:"w-3 h-3 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},`${m.exchange}-${m.symbol}-${g}`)})})}),e.jsx("div",{className:"p-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:["共",s.length,"个品种"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>{const m=s.map(g=>({...g,price:g.price*(1+(Math.random()-.5)*.02),change24h:g.change24h*(1+(Math.random()-.5)*.1),changePercent24h:g.changePercent24h*(1+(Math.random()-.5)*.1),lastUpdated:Date.now()}));l(m)},className:"hover:text-blue-600 dark:hover:text-blue-400 transition-colors",children:"刷新"}),e.jsx("button",{onClick:()=>{s.forEach(m=>{i(m.symbol,m.exchange)})},className:"hover:text-red-600 dark:hover:text-red-400 transition-colors",children:"清空"})]})]})})]})},nh=()=>{var x,y;const{selectedSymbol:s,selectedExchange:t,orderBookData:r,updateOrderBook:a}=zt(),[n,i]=b.useState(2),[l,o]=b.useState(20);b.useEffect(()=>{if(!s||!t)return;const m=()=>{const v=42500+Math.random()*1e3,P=1+Math.random()*5,E=[],A=[];for(let T=0;T<l;T++){const k=v-P/2-T*(.5+Math.random()*2),R=.1+Math.random()*5;E.push([k,R])}for(let T=0;T<l;T++){const k=v+P/2+T*(.5+Math.random()*2),R=.1+Math.random()*5;A.push([k,R])}a({symbol:s,bids:E.sort((T,k)=>k[0]-T[0]),asks:A.sort((T,k)=>T[0]-k[0]),timestamp:Date.now()})};m();const g=setInterval(m,1e3);return()=>clearInterval(g)},[s,t,l,a]);const c=b.useMemo(()=>{var T,k;if(!r)return null;const m=r.bids.reduce((R,[,se])=>R+se,0),g=r.asks.reduce((R,[,se])=>R+se,0),v=((T=r.bids[0])==null?void 0:T[0])||0,P=((k=r.asks[0])==null?void 0:k[0])||0,E=P-v,A=v>0?E/v*100:0;return{totalBidVolume:m,totalAskVolume:g,bestBid:v,bestAsk:P,spread:E,spreadPercent:A,midPrice:(v+P)/2}},[r]),d=m=>m.toFixed(n),h=m=>m>=1e3?(m/1e3).toFixed(2)+"K":m>=1?m.toFixed(3):m.toFixed(4),u=(m,g=!1)=>{let v=0;const P=[],E=g?[...m].reverse():m;for(const[A,T]of E)v+=T,P.push([A,T,v]);return g?P.reverse():P};if(!s)return e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-400 dark:text-gray-500 mb-2",children:e.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})})}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"请选择交易品种查看深度数据"})]})});if(!r)return e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"加载订单薄数据..."})]})});const j=u(r.bids.slice(0,l)),p=u(r.asks.slice(0,l)),f=Math.max(((x=j[j.length-1])==null?void 0:x[2])||0,((y=p[p.length-1])==null?void 0:y[2])||0);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white text-sm",children:s}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t," · 深度"]})]}),c&&e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["$",d(c.midPrice)]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["点差 ",c.spreadPercent.toFixed(3),"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400",children:"精度:"}),e.jsxs("select",{value:n,onChange:m=>i(Number(m.target.value)),className:"text-xs border border-gray-300 dark:border-gray-600 rounded px-2 py-1 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:0,children:"1"}),e.jsx("option",{value:1,children:"0.1"}),e.jsx("option",{value:2,children:"0.01"}),e.jsx("option",{value:3,children:"0.001"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400",children:"深度:"}),e.jsxs("select",{value:l,onChange:m=>o(Number(m.target.value)),className:"text-xs border border-gray-300 dark:border-gray-600 rounded px-2 py-1 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:10,children:"10档"}),e.jsx("option",{value:20,children:"20档"}),e.jsx("option",{value:50,children:"50档"})]})]})]})]}),e.jsx("div",{className:"px-3 py-2 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs font-medium text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{children:["价格(",s.split("/")[1],")"]}),e.jsxs("div",{className:"text-right",children:["数量(",s.split("/")[0],")"]}),e.jsx("div",{className:"text-right",children:"累计"})]})}),e.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"space-y-0.5 p-2",children:p.slice(0,Math.floor(l/2)).reverse().map(([m,g,v],P)=>e.jsxs("div",{className:"relative grid grid-cols-3 gap-2 text-xs py-1 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors group",children:[e.jsx("div",{className:"absolute inset-y-0 right-0 bg-red-100 dark:bg-red-900/30 opacity-30",style:{width:`${v/f*100}%`}}),e.jsx("div",{className:"text-red-600 dark:text-red-400 font-medium relative z-10",children:d(m)}),e.jsx("div",{className:"text-right text-gray-900 dark:text-white relative z-10",children:h(g)}),e.jsx("div",{className:"text-right text-gray-500 dark:text-gray-400 relative z-10",children:h(v)})]},`ask-${m}-${P}`))})}),c&&e.jsx("div",{className:"px-3 py-2 bg-gray-50 dark:bg-gray-800 border-y border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["点差: $",d(c.spread)]}),e.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["$",d(c.midPrice)]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[c.spreadPercent.toFixed(3),"%"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"space-y-0.5 p-2",children:j.slice(0,Math.floor(l/2)).map(([m,g,v],P)=>e.jsxs("div",{className:"relative grid grid-cols-3 gap-2 text-xs py-1 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors group",children:[e.jsx("div",{className:"absolute inset-y-0 right-0 bg-green-100 dark:bg-green-900/30 opacity-30",style:{width:`${v/f*100}%`}}),e.jsx("div",{className:"text-green-600 dark:text-green-400 font-medium relative z-10",children:d(m)}),e.jsx("div",{className:"text-right text-gray-900 dark:text-white relative z-10",children:h(g)}),e.jsx("div",{className:"text-right text-gray-500 dark:text-gray-400 relative z-10",children:h(v)})]},`bid-${m}-${P}`))})})]}),c&&e.jsxs("div",{className:"p-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500 dark:text-gray-400 mb-1",children:"买单总量"}),e.jsx("div",{className:"text-green-600 dark:text-green-400 font-medium",children:h(c.totalBidVolume)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500 dark:text-gray-400 mb-1",children:"卖单总量"}),e.jsx("div",{className:"text-red-600 dark:text-red-400 font-medium",children:h(c.totalAskVolume)})]})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-400 dark:text-gray-500 text-center",children:["更新时间: ",new Date(r.timestamp).toLocaleTimeString()]})]})]})},ih=({className:s=""})=>{const{activeRightTab:t,setActiveRightTab:r,watchList:a,orderBookData:n,rightPanelCollapsed:i,toggleRightPanel:l}=zt(),o=[{id:"market",name:"市场",count:0,icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{id:"watchlist",name:"自选",count:a.length,icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})},{id:"orderbook",name:"深度",count:0,icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})})}];return i?e.jsx("div",{className:`w-16 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 ${s}`,children:e.jsxs("div",{className:"p-2",children:[e.jsx("button",{onClick:l,className:"w-full p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"展开面板",children:e.jsx("svg",{className:"w-5 h-5 mx-auto text-gray-600 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("div",{className:"mt-4 space-y-2",children:o.map(c=>e.jsxs("button",{onClick:()=>r(c.id),className:`w-full p-3 rounded-lg transition-colors relative ${t===c.id?"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:c.name,children:[c.icon,c.count>0&&e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-xs rounded-full flex items-center justify-center",children:c.count>99?"99+":c.count})]},c.id))})]})}):e.jsxs("div",{className:`w-80 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 flex flex-col ${s}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"市场数据"}),e.jsx("button",{onClick:l,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"收起面板",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("nav",{className:"flex space-x-1 p-2",children:o.map(c=>e.jsxs("button",{onClick:()=>r(c.id),className:`flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${t===c.id?"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[c.icon,e.jsx("span",{children:c.name}),c.count>0&&e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${t===c.id?"bg-blue-200 dark:bg-blue-800 text-blue-800 dark:text-blue-200":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300"}`,children:c.count})]},c.id))})}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[t==="market"&&e.jsx(rh,{}),t==="watchlist"&&e.jsx(ah,{}),t==="orderbook"&&e.jsx(nh,{})]}),e.jsx("div",{className:"p-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-green-50 dark:bg-green-900 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-green-700 dark:text-green-300",children:"实时数据连接正常"}),n&&e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 ml-auto",children:new Date(n.timestamp).toLocaleTimeString()})]})})]})},lh=()=>{var C,B,re;const s=ot(),{user:t,isPremium:r}=$t();ta(),ea();const{selectedExchange:a,switchExchange:n}=Au(),{selectedSymbol:i,selectedTimeframe:l,chartConfig:o,setSelectedSymbol:c,setSelectedTimeframe:d,updateChartConfig:h,leftPanelCollapsed:u,rightPanelCollapsed:j,toggleLeftPanel:p,toggleRightPanel:f,updateKlineData:x,updateCurrentPrice:y,updateStrategyLibrary:m,updateAnalysisLibrary:g}=zt(),[v,P]=b.useState({websocket:!1,api:!1}),[E,A]=b.useState("43,250.00"),[T,k]=b.useState("+2.34%"),[R,se]=b.useState(2.34),z=b.useRef(!1);b.useEffect(()=>{z.current||(console.log("🚀 初始化Trading页面数据管理器"),br.initialize({onKlineUpdate:(_,H,xe)=>{console.log(`📊 K线数据更新: ${_} ${H} - ${xe.length}条`),x(_,H,xe)},onTickerUpdate:_=>{console.log(`💰 价格更新: ${_.symbol} = $${_.price}`),A(_.price.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}));const H=_.change_percent||0;se(H),k(`${H>=0?"+":""}${H.toFixed(2)}%`),y(_.price.toString());const xe={symbol:_.symbol,exchange:a||"OKX",price:_.price,change24h:_.change||0,changePercent24h:_.change_percent||0,volume24h:_.volume_24h||0,high24h:_.high_24h||_.price,low24h:_.low_24h||_.price,lastUpdated:_.timestamp||Date.now()},{watchList:_e,updateWatchListPrices:$e}=zt.getState();_e.find(X=>X.symbol===_.symbol&&X.exchange===(a||"OKX"))&&$e([xe])},onStrategyUpdate:_=>{console.log(`🎯 策略库更新: ${_.length}个策略`),m(_)},onAnalysisUpdate:_=>{console.log(`📊 分析库更新: ${_.length}个分析`),g(_)},onConnectionUpdate:_=>{console.log(`🔌 连接状态更新: ${_?"已连接":"已断开"}`),P(H=>({...H,websocket:_,api:!0}))},onError:_=>{console.error("❌ 数据管理器错误:",_),O.error(`数据加载错误: ${_}`),le(`数据加载失败: ${_}`)}}),z.current=!0)},[x,y,m,g]);const K=_=>{n(_),O.success(`已切换到 ${_.toUpperCase()}`)},S=async _=>{c(_),O.success(`已切换到 ${_}`);try{await br.switchSymbol(_,l)}catch(H){console.error("❌ 切换交易对失败:",H),O.error(`切换交易对失败: ${H}`)}},U=async _=>{d(_),O.success(`已切换到 ${_}`);try{await br.switchTimeframe(_)}catch(H){console.error("❌ 切换时间周期失败:",H),O.error(`切换时间周期失败: ${H}`)}};b.useEffect(()=>()=>{z.current&&(console.log("🧹 清理Trading页面数据管理器资源"),br.destroy(),z.current=!1)},[]);const[V,le]=b.useState(null);return V?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:V}),e.jsx("p",{className:"text-gray-500 mb-4",children:"交易服务可能暂时不可用"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"重新加载"})]})}):e.jsxs("div",{className:"fixed inset-0 w-screen h-screen bg-gray-900 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"h-14 bg-gradient-to-r from-gray-800 via-gray-800 to-gray-750 border-b border-gray-700 flex items-center justify-between px-6 flex-shrink-0 shadow-lg",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>s("/overview"),className:"flex items-center space-x-2 px-3 py-2 rounded-lg bg-gray-700/50 hover:bg-gray-600 transition-all duration-200 group",title:"返回主页",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-300 group-hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{className:"text-sm font-medium text-gray-300 group-hover:text-white",children:"Trademe"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-px h-6 bg-gray-600"}),e.jsxs("h1",{className:"text-lg font-bold text-white flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"专业交易"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{className:"px-4 py-2 text-sm font-medium rounded-lg bg-blue-600 hover:bg-blue-700 text-white shadow-md transition-all duration-200",children:"策略库"}),e.jsx("button",{className:"px-4 py-2 text-sm font-medium rounded-lg text-gray-300 hover:text-white hover:bg-gray-700 transition-all duration-200",children:"指标库"}),e.jsx("button",{className:"px-4 py-2 text-sm font-medium rounded-lg text-gray-300 hover:text-white hover:bg-gray-700 transition-all duration-200",children:"交易系统"})]})]}),e.jsx("div",{className:"flex items-center space-x-6",children:e.jsx("div",{className:"bg-gray-700/50 backdrop-blur-sm rounded-xl px-6 py-3 border border-gray-600/50 shadow-lg",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-white",children:"B"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-lg font-bold text-white",children:i}),e.jsx("span",{className:"text-xs text-gray-400 ml-2",children:a||"OKX"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xl font-bold text-white",children:["$",E]}),e.jsx("div",{className:`text-sm font-medium ${R>=0?"text-green-400":"text-red-400"}`,children:T})]}),e.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[e.jsx("div",{children:"成交量: 1.2B"}),e.jsx("div",{children:"振幅: 3.2%"})]})]})]})})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 bg-gray-700/50 rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${v.websocket?"bg-green-500 animate-pulse":"bg-red-500"}`}),e.jsx("span",{className:"text-xs text-gray-300",children:"WebSocket"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${v.api?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-xs text-gray-300",children:"API"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-white",children:((B=(C=t==null?void 0:t.email)==null?void 0:C[0])==null?void 0:B.toUpperCase())||"U"})}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-white font-medium",children:((re=t==null?void 0:t.email)==null?void 0:re.split("@")[0])||"User"}),e.jsx("div",{className:"text-xs text-gray-400",children:r?"Premium":"Basic"})]})]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"flex-1 bg-gray-900",children:e.jsx(sh,{className:"w-full h-full"})}),e.jsx("div",{className:"h-16 bg-gradient-to-r from-gray-800 to-gray-750 border-t border-gray-700 flex items-center px-4 flex-shrink-0 shadow-lg overflow-x-auto",children:e.jsxs("div",{className:"flex items-center space-x-6 min-w-max",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-400 mr-2",children:"时间周期:"}),e.jsx("div",{className:"flex items-center space-x-1 bg-gray-700/50 rounded-lg p-1",children:["1m","5m","15m","30m","1h","4h","1d","1w"].map(_=>e.jsx("button",{onClick:()=>U(_),className:`px-2 py-1 text-xs font-medium rounded-md transition-all duration-200 ${l===_?"bg-blue-600 text-white shadow-md":"text-gray-300 hover:text-white hover:bg-gray-600"}`,children:_},_))})]}),e.jsx("div",{className:"w-px h-8 bg-gray-600"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-400 mr-2",children:"图表样式:"}),e.jsx("div",{className:"flex items-center space-x-1 bg-gray-700/50 rounded-lg p-1",children:[{value:"candlestick",label:"K线",icon:"📊"},{value:"line",label:"线图",icon:"📈"},{value:"area",label:"面积",icon:"🏔️"},{value:"heikin-ashi",label:"HA",icon:"🕯️"}].map(_=>e.jsxs("button",{onClick:()=>h({chartStyle:_.value}),className:`px-2 py-1 text-xs font-medium rounded-md transition-all duration-200 flex items-center space-x-1 ${o.chartStyle===_.value?"bg-blue-600 text-white shadow-md":"text-gray-300 hover:text-white hover:bg-gray-600"}`,title:_.label,children:[e.jsx("span",{className:"text-xs",children:_.icon}),e.jsx("span",{children:_.label})]},_.value))})]}),e.jsx("div",{className:"w-px h-8 bg-gray-600"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-400 mr-2",children:"价格轴:"}),e.jsx("div",{className:"flex items-center space-x-1 bg-gray-700/50 rounded-lg p-1",children:[{value:"linear",label:"线性",desc:"线性价格坐标"},{value:"percentage",label:"百分比",desc:"百分比变化显示"},{value:"logarithmic",label:"对数",desc:"对数价格坐标"}].map(_=>e.jsx("button",{onClick:()=>h({priceAxisMode:_.value}),className:`px-2 py-1 text-xs font-medium rounded-md transition-all duration-200 ${o.priceAxisMode===_.value?"bg-green-600 text-white shadow-md":"text-gray-300 hover:text-white hover:bg-gray-600"}`,title:_.desc,children:_.label},_.value))})]}),e.jsx("div",{className:"w-px h-8 bg-gray-600"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{className:"px-2 py-1 text-xs font-medium text-gray-300 hover:text-white hover:bg-gray-700 rounded-lg transition-all duration-200 flex items-center space-x-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("span",{children:"指标"})]}),e.jsxs("button",{className:"px-2 py-1 text-xs font-medium text-gray-300 hover:text-white hover:bg-gray-700 rounded-lg transition-all duration-200 flex items-center space-x-1",children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{children:"设置"})]})]})]})})]}),e.jsxs("div",{className:"w-80 bg-gradient-to-b from-gray-800 to-gray-850 border-l border-gray-700 flex flex-col flex-shrink-0 shadow-lg",children:[e.jsxs("div",{className:"h-12 bg-gray-750 border-b border-gray-600 flex items-center justify-between px-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})}),e.jsx("span",{className:"text-sm font-bold text-white",children:"市场数据"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-gray-400",children:"实时"})]})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:"flex-1 px-4 py-3 text-sm font-medium bg-blue-600/20 text-blue-400 border-b-2 border-blue-600",children:"自选"}),e.jsx("button",{className:"flex-1 px-4 py-3 text-sm font-medium text-gray-400 hover:text-white hover:bg-gray-700 transition-colors",children:"热门"}),e.jsx("button",{className:"flex-1 px-4 py-3 text-sm font-medium text-gray-400 hover:text-white hover:bg-gray-700 transition-colors",children:"涨幅榜"})]})}),e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx(Uu,{selectedSymbol:i,selectedExchange:a||"OKX",onSymbolChange:S,onExchangeChange:K})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(ih,{className:"w-full h-full"})}),e.jsx("div",{className:"border-t border-gray-700 p-4 bg-gray-800/50",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400",children:"市值"}),e.jsx("div",{className:"text-white font-bold",children:"$1.2T"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400",children:"24h成交"}),e.jsx("div",{className:"text-white font-bold",children:"$89.2B"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400",children:"恐惧指数"}),e.jsx("div",{className:"text-green-400 font-bold",children:"72"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400",children:"BTC占比"}),e.jsx("div",{className:"text-white font-bold",children:"52.3%"})]})]})})]})]})]})};class ni extends Ke.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return console.error("🚨 ErrorBoundary捕获错误:",t),{hasError:!0,error:t}}componentDidCatch(t,r){console.error("🚨 ErrorBoundary详细信息:",t,r),console.error("🚨 组件堆栈:",r.componentStack),this.setState({error:t,errorInfo:r})}render(){var t,r;return this.state.hasError?e.jsxs("div",{className:"error-boundary p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"React渲染错误"}),e.jsxs("div",{className:"text-sm text-red-700 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"错误:"})," ",((t=this.state.error)==null?void 0:t.message)||"Unknown error"]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer font-medium",children:"错误详情"}),e.jsx("pre",{className:"mt-2 text-xs bg-red-100 p-2 rounded overflow-auto",children:(r=this.state.error)==null?void 0:r.stack}),this.state.errorInfo&&e.jsx("pre",{className:"mt-2 text-xs bg-red-100 p-2 rounded overflow-auto",children:this.state.errorInfo.componentStack})]})]}),e.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"重试渲染"})]}):this.props.children}}const oh=(s,t)=>{if(s==null)return console.warn("filterMessageContent: content is undefined or null"),"";if(typeof s!="string"){console.warn("filterMessageContent: content is not a string, converting:",typeof s,s);try{return typeof s=="object"&&s!==null?JSON.stringify(s):String(s||"")}catch(i){return console.error("Failed to stringify content:",i),"[Invalid Content]"}}if(t==="user")return s;const r=/```[\s\S]*?```/g;return r.test(s)?s.replace(r,`
📝 **策略代码已生成**
代码已在后台生成并准备用于回测，您可以：
• 点击"回测分析"配置并运行回测
• 点击"添加到策略库"保存策略
• 继续讨论优化方案
`).trim():s},ch=s=>{const t=s.match(/```(?:python)?\s*([\s\S]*?)\s*```/);return t?t[1].trim():null},dh=({isOpen:s,onClose:t,onCreateSession:r,aiMode:a})=>{const[n,i]=b.useState(""),[l,o]=b.useState("strategy"),[c,d]=b.useState(""),[h,u]=b.useState(!1),j=async p=>{if(p.preventDefault(),!!n.trim()){u(!0);try{await r({name:n,ai_mode:"trader",session_type:l,description:c||void 0}),i(""),d(""),t()}finally{u(!1)}}};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"创建新对话"}),e.jsxs("form",{onSubmit:j,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"对话名称"}),e.jsx("input",{type:"text",value:n,onChange:p=>i(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"为你的对话起个名字",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"对话类型"}),e.jsxs("select",{value:l,onChange:p=>o(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"strategy",children:"策略开发"}),e.jsx("option",{value:"indicator",children:"指标开发"}),e.jsx("option",{value:"trading_system",children:"交易系统搭建"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"描述 (可选)"}),e.jsx("textarea",{value:c,onChange:p=>d(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"简单描述这个对话的目的"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"取消"}),e.jsx("button",{type:"submit",disabled:!n.trim()||h,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:h?"创建中...":"创建"})]})]})]})}):null},uh=()=>{var pe;const{user:s,isPremium:t}=$t(),{chatSessions:r,currentSession:a,messages:n,isTyping:i,isLoading:l,error:o,clearError:c,createChatSession:d,loadChatSessions:h,selectChatSession:u,sendMessage:j,loadUsageStats:p,usageStats:f,deleteChatSession:x,networkStatus:y,retryCount:m,checkNetworkStatus:g,useWebSocket:v,wsConnected:P,initializeWebSocket:E}=Cr(),[A,T]=b.useState(!1),[k,R]=b.useState(!1),[se,z]=b.useState(""),[K,S]=b.useState([]),[U,V]=b.useState(!1),[le,C]=b.useState({phase:"discussion",currentSession:void 0}),[B,re]=b.useState({isRunning:!1,progress:0,currentStep:""});if(b.useEffect(()=>{t&&p(1)},[t]),b.useEffect(()=>{if(n.length>0&&a){const X=n.slice().reverse().find(W=>W.role==="assistant");if(X){const W=ch(X.content);W&&(le.currentSession!==a.session_id||le.phase==="optimization")&&(C({phase:"ready_for_backtest",strategyCode:W,currentSession:a.session_id}),re({isRunning:!1,progress:0,currentStep:""}))}}},[n,a,le.phase]),b.useEffect(()=>{a&&(C(X=>({phase:"discussion",currentSession:a.session_id})),re({isRunning:!1,progress:0,currentStep:""}))},[a==null?void 0:a.session_id]),o)return e.jsx("div",{className:"flex h-[calc(100vh-140px)] items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-red-600 mb-4",children:"加载出错"}),e.jsx("p",{className:"text-gray-600 mb-4",children:o}),e.jsx("button",{onClick:()=>{c(),window.location.reload()},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"重新加载"})]})});if(!t)return e.jsx("div",{className:"flex h-[calc(100vh-140px)] items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-yellow-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"AI功能需要高级版"}),e.jsx("p",{className:"text-gray-600",children:"AI对话助手是高级版专享功能，升级后即可使用智能策略生成和交易分析"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-left bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{children:"AI策略代码生成"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{children:"智能市场分析"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{children:"专业交易建议"})]})]}),e.jsx("button",{onClick:()=>window.location.href="/profile",className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"升级到高级版"})]})});b.useEffect(()=>{t&&h("trader")},[t]),b.useEffect(()=>{const W=setTimeout(async()=>{var fe,Je;const ne=localStorage.getItem("auth-storage");if(!ne){console.log("⚠️ [AIChatPage] 未找到认证信息，跳过WebSocket初始化");return}let L;try{L=JSON.parse(ne)}catch($){console.error("❌ [AIChatPage] 认证数据解析失败:",$);return}const ae=(fe=L==null?void 0:L.state)==null?void 0:fe.token,ge=(Je=L==null?void 0:L.state)==null?void 0:Je.isAuthenticated;if(!ae||!ge){console.log("⚠️ [AIChatPage] 用户未认证或token无效，跳过WebSocket初始化");return}if(t&&v&&!P&&!l){console.log("🔄 [AIChatPage] 自动初始化WebSocket连接..."),console.log("🔑 [AIChatPage] 使用token:",ae.substring(0,20)+"...");try{const $=await E();console.log($?"✅ [AIChatPage] WebSocket自动连接成功":"❌ [AIChatPage] WebSocket自动连接失败，将回退到HTTP模式")}catch($){console.error("❌ [AIChatPage] WebSocket自动连接异常:",$)}}},1e3);return()=>clearTimeout(W)},[t,v,P,l]);const _=r.trader||[],H=async X=>{await d(X)},xe=async X=>{var L;const W=(L=X.clipboardData)==null?void 0:L.items;if(!W)return;const ne=[];for(let ae=0;ae<W.length;ae++){const ge=W[ae];if(ge.type.startsWith("image/")){const fe=ge.getAsFile();fe&&ne.push(fe)}}ne.length>0&&(X.preventDefault(),S(ae=>[...ae,...ne]),O.success(`已粘贴 ${ne.length} 张图片`))},_e=X=>{S(W=>W.filter((ne,L)=>L!==X))},$e=async X=>{if(X.preventDefault(),console.log("🎯 [DEBUG] handleSendMessage called:",{messageInput:se,isTyping:i,currentSession:a}),!se.trim()&&K.length===0||i){console.log("⚠️ [DEBUG] Early return:",{emptyMessage:!se.trim(),isTyping:i,noImages:K.length===0});return}let W=se;K.length>0&&(W+=`

📷 [已上传 ${K.length} 张图片，请帮我分析]`),console.log("📨 [DEBUG] Calling sendMessage with:",W);const ne=await j(W);console.log("📬 [DEBUG] sendMessage result:",ne),ne&&(z(""),S([]))};return e.jsxs("div",{className:"flex h-[calc(100vh-140px)]",children:[e.jsxs("div",{className:"w-60 border-r border-gray-200 bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"p-3 border-b border-gray-200 bg-white",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-500 via-teal-500 to-cyan-500 rounded-lg flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"T"})}),e.jsx("div",{className:"text-sm font-medium text-gray-800",children:"Trademe助手"})]})})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"对话列表"}),e.jsx("button",{onClick:()=>T(!0),className:"px-2 py-1 bg-blue-500 text-white text-xs rounded-md hover:bg-blue-600 transition-colors",children:"+ 新建"})]}),l?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"加载中..."}):_.length===0?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-2",children:"💬"}),e.jsx("p",{className:"text-xs mb-2",children:"还没有对话"}),e.jsx("button",{onClick:()=>T(!0),className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"创建第一个对话"})]}):e.jsx("div",{className:"space-y-1",children:_.map(X=>e.jsx("div",{onClick:()=>u(X),className:`group p-2 rounded-md cursor-pointer transition-colors ${(a==null?void 0:a.session_id)===X.session_id?"bg-blue-50 border-blue-200 border":"bg-white hover:bg-gray-50 border border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-xs text-gray-900 truncate",children:X.name}),e.jsxs("div",{className:"flex items-center space-x-2 mt-0.5",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[X.message_count,"条"]}),e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${X.status==="active"?"bg-green-400":"bg-gray-300"}`}),e.jsx("span",{className:"text-xs text-gray-400 capitalize",children:X.session_type})]})]}),e.jsx("button",{onClick:W=>{W.stopPropagation(),window.confirm("确定要删除这个对话吗？")&&x(X.session_id)},className:"opacity-0 group-hover:opacity-100 p-1 text-gray-400 hover:text-red-500 transition-all duration-200",title:"删除对话",children:e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})},X.session_id))})]})})]}),e.jsx("div",{className:"flex-1 flex flex-col",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-gray-900",children:a.name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Trademe助手"}),e.jsx("span",{className:"px-2 py-0.5 bg-gradient-to-r from-blue-500 to-purple-500 text-white text-xs font-bold rounded-full",children:"Claude 4"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1.5 bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-emerald-500 via-teal-500 to-cyan-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"T"})}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:(s==null?void 0:s.membership_level)==="premium"?"高级版":"专业版"})]}),e.jsx("div",{className:"h-3 w-px bg-gray-300"}),e.jsxs("div",{className:"text-xs text-gray-600",children:["已用 ",e.jsxs("span",{className:"font-semibold text-blue-600",children:["$",((pe=f==null?void 0:f.daily_cost_usd)==null?void 0:pe.toFixed(2))||"0.00"]}),e.jsx("span",{className:"text-gray-400",children:"/"}),e.jsx("span",{className:"text-gray-500",children:(s==null?void 0:s.membership_level)==="premium"?"$100":"$200"})]}),e.jsx("div",{className:"w-12 bg-gray-200 rounded-full h-1",children:e.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-cyan-500 h-1 rounded-full transition-all duration-300",style:{width:`${f?Math.min(100,f.daily_cost_usd/((s==null?void 0:s.membership_level)==="premium"?100:200)*100):0}%`}})})]}),e.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 text-xs rounded-full transition-all duration-200 ${y==="connected"?"bg-green-100 text-green-700":y==="checking"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${y==="connected"?"bg-green-500":y==="checking"?"bg-yellow-500 animate-pulse":"bg-red-500 animate-pulse"}`}),e.jsx("span",{children:y==="connected"?"AI在线":y==="checking"?"检查中":"AI离线"}),m>0&&e.jsxs("span",{className:"text-orange-600",children:["(",m,"次重试)"]})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${a.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:a.status==="active"?"进行中":"已完成"})]})]})}),(o||y==="disconnected")&&e.jsx("div",{className:"bg-red-50 border-b border-red-200 px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full flex-shrink-0 animate-pulse"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-red-800 font-medium",children:o||"AI服务连接中断"}),e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Claude AI服务可能正在维护，请稍后重试或检查网络连接"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:async()=>{c(),await g()?O.success("网络连接已恢复",{icon:"🔗"}):O.error("网络仍然不可用，请检查连接",{icon:"⚠️"})},className:"px-3 py-1 bg-red-100 hover:bg-red-200 text-red-700 text-xs rounded-md transition-colors duration-200 flex items-center space-x-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{children:"重试连接"})]}),e.jsx("button",{onClick:()=>c(),className:"text-red-600 hover:text-red-800 p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})}),e.jsx(ni,{children:e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:"🤖"}),e.jsx("p",{children:"开始你的AI对话吧！"})]}):n.map((X,W)=>{if(!X||typeof X!="object")return console.warn("Invalid message object at index",W,":",X),null;const ne=X.role||"assistant",L=X.content||"",ae=X.timestamp||new Date().toISOString();return e.jsx(ni,{children:e.jsx("div",{className:`flex ${ne==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] rounded-lg px-4 py-2 ${ne==="user"?"bg-blue-600 text-white":"bg-white border border-gray-200 text-gray-900"}`,children:[e.jsx("div",{className:"whitespace-pre-wrap",children:(()=>{try{const ge=oh(L,ne);return typeof ge=="string"?ge:String(ge||"")}catch(ge){return console.error("Error filtering message content:",ge),"[消息显示错误]"}})()}),e.jsx("div",{className:`text-xs mt-1 ${ne==="user"?"text-blue-100":"text-gray-400"}`,children:(()=>{try{return new Date(ae).toLocaleTimeString()}catch{return new Date().toLocaleTimeString()}})()})]})})},`msg-${W}-${ae}`)}).filter(Boolean),i&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-lg px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-emerald-500 via-teal-500 to-cyan-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"T"})}),e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-cyan-400 animate-ping"})]}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-gradient-to-r from-emerald-500 to-cyan-500 rounded-full animate-bounce"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-gradient-to-r from-emerald-500 to-cyan-500 rounded-full animate-bounce",style:{animationDelay:"0.15s"}}),e.jsx("div",{className:"w-1.5 h-1.5 bg-gradient-to-r from-emerald-500 to-cyan-500 rounded-full animate-bounce",style:{animationDelay:"0.3s"}})]}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Trademe助手正在思考"})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"分析中...请稍候"})]})]})})})]})}),B.isRunning&&e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full animate-pulse"}),e.jsx("h3",{className:"font-medium text-blue-900",children:"回测执行中"})]}),e.jsxs("span",{className:"text-sm text-blue-600 font-medium",children:[B.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2 mb-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${B.progress}%`}})}),B.currentStep&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-blue-700",children:[e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a7.646 7.646 0 110 15.292"})}),e.jsx("span",{children:B.currentStep})]}),e.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:["预计剩余时间: ",Math.round((100-B.progress)/10)," 分钟"]})]})}),B.results&&le.phase==="analysis"&&e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full"}),e.jsx("h3",{className:"font-medium text-green-900",children:"回测完成"})]}),e.jsx("button",{onClick:async()=>{const X=B.results,W=`📊 **回测分析请求**

回测已完成，请帮我详细分析以下结果：

**关键指标**：
• 总收益率: +${X.totalReturn}%
• 夏普比率: ${X.sharpeRatio}
• 最大回撤: -${X.maxDrawdown}%
• 胜率: ${X.winRate}%

**分析要求**：
1. 评估策略表现的优缺点
2. 识别风险管理问题
3. 提供具体的优化建议
4. 建议参数调整方向

如果您认为策略需要优化，请直接提供改进方案。我将根据您的建议决定是否进行策略优化。`;C(L=>({...L,phase:"analysis",backtestResults:X})),await j(W)||z(W)},className:"px-3 py-1 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 transition-colors",children:"AI分析结果"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-green-700",children:"总收益率"}),e.jsxs("div",{className:"text-lg font-bold text-green-900",children:["+",B.results.totalReturn||0,"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-green-700",children:"夏普比率"}),e.jsx("div",{className:"text-lg font-bold text-green-900",children:B.results.sharpeRatio||0})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-green-700",children:"最大回撤"}),e.jsxs("div",{className:"text-lg font-bold text-red-600",children:["-",B.results.maxDrawdown||0,"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-green-700",children:"胜率"}),e.jsxs("div",{className:"text-lg font-bold text-green-900",children:[B.results.winRate||0,"%"]})]})]})]})}),e.jsx("div",{className:"px-4 py-2 border-t border-gray-100 bg-gray-50",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[le.phase==="analysis"&&e.jsxs("button",{onClick:async()=>{const X=`🔄 **策略优化请求**

基于刚才的回测分析，我希望对策略进行优化改进。

**优化要求**：
1. 请根据您刚才提出的建议修改策略代码
2. 重点关注风险管理和收益率提升
3. 保持策略的核心逻辑不变，主要优化参数和细节
4. 提供优化后的完整策略代码

优化完成后，我将进行新的回测来验证改进效果。`;C(ne=>({...ne,phase:"optimization"})),await j(X)||z(X)},className:"flex items-center space-x-2 px-3 py-1.5 bg-white border border-orange-300 rounded-lg text-sm text-orange-600 hover:bg-orange-50 hover:border-orange-400 transition-colors shadow-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{children:"优化策略"})]}),le.phase==="ready_for_backtest"&&e.jsxs("button",{onClick:()=>R(!0),className:"flex items-center space-x-2 px-3 py-1.5 bg-white border border-blue-300 rounded-lg text-sm text-blue-600 hover:bg-blue-50 hover:border-blue-400 transition-colors shadow-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 00-2-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("span",{children:"配置回测"})]}),(le.phase==="ready_for_backtest"||le.phase==="backtesting"||le.phase==="analysis"||le.phase==="optimization")&&e.jsxs("button",{onClick:async()=>{if(!a){O.error("请先选择会话");return}const X=(a==null?void 0:a.session_type)==="indicator",W=X?"指标":"策略",ne=X?"指标库":"策略库",L=le.strategyCode;if(!L){O.error(`未找到${W}代码`);return}let ae=`AI生成的${W}_${Date.now()}`;const ge=n.slice().reverse().find(fe=>fe.role==="assistant");if(ge){const fe=ge.content.match(/(?:策略|指标)名称[:：]\s*([^\n]+)/i)||L.match(/class\s+(\w+)/i)||L.match(/def\s+(\w+)/i);fe&&(ae=fe[1].trim())}try{O.loading(`正在保存${W}到${ne}...`),await ht.createStrategyFromAI({name:ae,description:`从AI会话生成的${W}`,code:L,parameters:{},strategy_type:X?"indicator":"strategy",ai_session_id:a.session_id}),O.dismiss(),O.success(`${W}已成功添加到${ne}`)}catch(fe){O.dismiss(),console.error("保存策略/指标失败:",fe),O.error(`保存失败: ${fe.message||"未知错误"}`)}},className:"flex items-center space-x-2 px-3 py-1.5 bg-white border border-green-300 rounded-lg text-sm text-green-600 hover:bg-green-50 hover:border-green-400 transition-colors shadow-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{children:(a==null?void 0:a.session_type)==="indicator"?"保存指标":"保存策略"})]}),(le.phase==="ready_for_backtest"||le.phase==="backtesting"||le.phase==="analysis"||le.phase==="optimization")&&e.jsxs("button",{onClick:()=>{const X=le.strategyCode?"，使用当前开发的策略":"，使用我的策略库中表现最好的策略";z(`请帮我启动实盘交易${X}，初始资金设为1000USDT`)},className:"flex items-center space-x-2 px-3 py-1.5 bg-white border border-orange-300 rounded-lg text-sm text-orange-600 hover:bg-orange-50 hover:border-orange-400 transition-colors shadow-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),e.jsx("span",{children:"运行实盘"})]})]})}),e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-white",children:[K.length>0&&e.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["已粘贴的图片 (",K.length,")"]}),e.jsx("button",{onClick:()=>S([]),className:"text-xs text-red-500 hover:text-red-700",children:"清除全部"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:K.map((X,W)=>e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center border overflow-hidden",children:e.jsx("img",{src:URL.createObjectURL(X),alt:`粘贴图片 ${W+1}`,className:"w-full h-full object-cover",onLoad:ne=>URL.revokeObjectURL(ne.target.src)})}),e.jsx("button",{onClick:()=>_e(W),className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white rounded-full text-xs opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:"×"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1 text-center truncate w-16",children:X.name.split(".")[0]})]},W))})]}),e.jsxs("form",{onSubmit:$e,className:"flex space-x-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:se,onChange:X=>z(X.target.value),onPaste:xe,placeholder:K.length>0?"添加描述文字（可选）...":"与Trademe助手对话，支持直接粘贴图片...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent",disabled:i}),K.length>0&&e.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-cyan-100 text-cyan-600 px-2 py-1 rounded text-xs",children:["📷 ",K.length]})]}),e.jsx("button",{type:"submit",disabled:!se.trim()&&K.length===0||i,className:"px-4 py-2 bg-gradient-to-r from-emerald-500 to-cyan-500 text-white rounded-lg hover:from-emerald-600 hover:to-cyan-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:i?"发送中":K.length>0?`发送 📷${K.length}`:"发送"})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-400 text-center",children:"💡 提示：直接粘贴图片到输入框即可上传分析"})]})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:"🤖"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Trademe助手"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"选择或创建对话开始智能交流"}),e.jsx("button",{onClick:()=>T(!0),className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"创建新对话"})]})})}),e.jsx(dh,{isOpen:A,onClose:()=>T(!1),onCreateSession:H,aiMode:"trader"}),e.jsx(hh,{isOpen:k,onClose:()=>R(!1),onSubmit:async X=>{C(fe=>({...fe,phase:"backtesting"})),re({isRunning:!0,progress:0,currentStep:"准备回测环境..."});const W=[{progress:10,step:"加载策略代码..."},{progress:25,step:"下载历史数据..."},{progress:45,step:"执行回测逻辑..."},{progress:70,step:"计算性能指标..."},{progress:90,step:"生成分析报告..."},{progress:100,step:"回测完成！"}];let ne=0;const L=setInterval(()=>{ne<W.length?(re(fe=>({...fe,progress:W[ne].progress,currentStep:W[ne].step})),ne++):(clearInterval(L),setTimeout(()=>{re(fe=>({...fe,isRunning:!1,results:{totalReturn:(Math.random()*50+10).toFixed(2),sharpeRatio:(Math.random()*2+.5).toFixed(2),maxDrawdown:(Math.random()*20+5).toFixed(2),winRate:(Math.random()*40+40).toFixed(0)}})),C(fe=>({...fe,phase:"analysis"})),O.success("回测完成！您可以查看结果并请求AI分析")},1e3))},2e3),ae=`🚀 正在执行回测分析...

**回测配置**：
• 交易所：${X.exchange}
• 品种类型：${X.productType}
• 交易品种：${X.symbols.join(", ")}
• 时间周期：${X.timeframes.join(", ")}
• 数据类型：${X.dataType==="tick"?"Tick数据回测（高精度）":"K线数据回测（标准）"}
• 手续费率：${X.feeRate}
• 初始资金：${X.initialCapital} USDT
• 回测时间：${X.startDate} 至 ${X.endDate}

回测正在后台执行中，您可以在下方查看实时进度。回测完成后，我将为您详细分析结果并提供优化建议。`;R(!1),await j(ae)||(z(ae),clearInterval(L),re({isRunning:!1,progress:0,currentStep:""}),C(fe=>({...fe,phase:"ready_for_backtest"})))}})]})},hh=({isOpen:s,onClose:t,onSubmit:r})=>{const{user:a}=$t(),[n,i]=b.useState(!1),[l,o]=b.useState({exchange:"binance",productType:"spot",symbols:["BTC/USDT"],timeframes:["1h"],feeRate:"vip0",initialCapital:1e4,startDate:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],dataType:"kline"}),c=[{value:"binance",label:"币安 (Binance)"},{value:"okx",label:"OKX"},{value:"huobi",label:"火币 (Huobi)"},{value:"bybit",label:"Bybit"}],d=[{value:"spot",label:"现货"},{value:"perpetual",label:"永续合约"},{value:"delivery",label:"交割合约"}],h=[{value:"1m",label:"1分钟"},{value:"5m",label:"5分钟"},{value:"15m",label:"15分钟"},{value:"30m",label:"30分钟"},{value:"1h",label:"1小时"},{value:"4h",label:"4小时"},{value:"1d",label:"1天"}],u=[{value:"vip0",label:"VIP0 (0.1%/0.1%)"},{value:"vip1",label:"VIP1 (0.09%/0.09%)"},{value:"vip2",label:"VIP2 (0.08%/0.08%)"},{value:"vip3",label:"VIP3 (0.07%/0.07%)"}],j=["BTC/USDT","ETH/USDT","BNB/USDT","ADA/USDT","DOT/USDT","SOL/USDT","MATIC/USDT","LINK/USDT","UNI/USDT","LTC/USDT"],p=g=>{o(v=>({...v,symbols:v.symbols.includes(g)?v.symbols.filter(P=>P!==g):[...v.symbols,g]}))},f=g=>{o(v=>({...v,timeframes:v.timeframes.includes(g)?v.timeframes.filter(P=>P!==g):[...v.timeframes,g]}))},x=()=>{var v;switch((v=a==null?void 0:a.membership_level)==null?void 0:v.toLowerCase()){case"premium":return 30;case"professional":return 100;default:return 0}},y=()=>{var g;return((g=a==null?void 0:a.membership_level)==null?void 0:g.toLowerCase())==="basic"},m=async()=>{if(l.symbols.length===0){alert("请至少选择一个交易品种");return}if(l.timeframes.length===0){alert("请至少选择一个时间周期");return}if(l.dataType==="tick"&&y()){alert("Tick数据回测需要高级版或专业版会员");return}i(!0);try{await r(l)}catch(g){console.error("回测配置提交失败:",g)}finally{i(!1)}};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"回测参数配置"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易所"}),e.jsx("select",{value:l.exchange,onChange:g=>o(v=>({...v,exchange:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:c.map(g=>e.jsx("option",{value:g.value,children:g.label},g.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"品种类型"}),e.jsx("select",{value:l.productType,onChange:g=>o(v=>({...v,productType:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:d.map(g=>e.jsx("option",{value:g.value,children:g.label},g.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["数据类型",l.dataType==="tick"&&!y()&&e.jsxs("span",{className:"text-xs text-orange-600 ml-2",children:["(本月剩余 ",x()," 次)"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"kline",checked:l.dataType==="kline",onChange:g=>o(v=>({...v,dataType:g.target.value})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsxs("span",{className:"ml-3 text-sm",children:["K线数据回测",e.jsx("span",{className:"text-gray-500",children:"(标准精度，免费)"})]})]}),e.jsxs("label",{className:`flex items-center ${y()?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("input",{type:"radio",value:"tick",checked:l.dataType==="tick",onChange:g=>!y()&&o(v=>({...v,dataType:g.target.value})),disabled:y(),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 disabled:opacity-50"}),e.jsxs("span",{className:"ml-3 text-sm",children:["Tick数据回测",e.jsxs("span",{className:"text-gray-500",children:["(最高精度，",y()?"需要高级版":`每月${x()}次`,")"]}),y()&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded",children:"升级解锁"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"手续费率等级"}),e.jsx("select",{value:l.feeRate,onChange:g=>o(v=>({...v,feeRate:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:u.map(g=>e.jsx("option",{value:g.value,children:g.label},g.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"初始资金 (USDT)"}),e.jsx("input",{type:"number",value:l.initialCapital,onChange:g=>o(v=>({...v,initialCapital:Number(g.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"100",step:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"开始时间"}),e.jsx("input",{type:"date",value:l.startDate,onChange:g=>o(v=>({...v,startDate:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"结束时间"}),e.jsx("input",{type:"date",value:l.endDate,onChange:g=>o(v=>({...v,endDate:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["交易品种 (已选择 ",l.symbols.length," 个)"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2",children:j.map(g=>e.jsx("button",{onClick:()=>p(g),className:`px-3 py-2 text-sm rounded-md border transition-colors ${l.symbols.includes(g)?"bg-blue-50 border-blue-300 text-blue-700":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:g},g))})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["时间周期 (已选择 ",l.timeframes.length," 个)"]}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-7 gap-2",children:h.map(g=>e.jsx("button",{onClick:()=>f(g.value),className:`px-3 py-2 text-sm rounded-md border transition-colors ${l.timeframes.includes(g.value)?"bg-green-50 border-green-300 text-green-700":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:g.label},g.value))})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:t,disabled:n,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"取消"}),e.jsx("button",{onClick:m,disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:n?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"正在发送..."})]}):"开始回测分析"})]})]})})}):null},Lt=()=>{try{const s=localStorage.getItem("auth-storage");if(s){const{state:t}=JSON.parse(s);return(t==null?void 0:t.token)||null}}catch(s){console.error("Failed to parse auth data:",s)}return null},ii=()=>{const{isPremium:s}=$t(),{t}=Wt(),[r,a]=b.useState({name:"",exchange:"okx",api_key:"",secret_key:"",passphrase:""}),[n,i]=b.useState([]),[l,o]=b.useState(!1),[c,d]=b.useState(!1),[h,u]=b.useState({}),j=[{value:"okx",label:"OKX",icon:"🟢"},{value:"binance",label:"Binance",icon:"🟡"},{value:"huobi",label:"Huobi",icon:"🔴"},{value:"bybit",label:"Bybit",icon:"🟠"},{value:"kraken",label:"Kraken",icon:"🟣"},{value:"coinbase",label:"Coinbase",icon:"🔵"}],p=async()=>{if(s)try{o(!0);const E=await fetch("/api/v1/api-keys/",{headers:{Authorization:`Bearer ${Lt()}`}});if(E.ok){let A={api_keys:[]};try{const T=await E.text();A=T?JSON.parse(T):{api_keys:[]}}catch{console.log("Response is not JSON, using empty array")}i(A.api_keys||[])}else{let A="Failed to load API keys";try{const T=await E.text(),k=T?JSON.parse(T):null;A=(k==null?void 0:k.detail)||`HTTP ${E.status}: ${E.statusText}`}catch{A=`HTTP ${E.status}: ${E.statusText}`}throw new Error(A)}}catch(E){console.error("Error loading API keys:",E),O.error("加载API密钥失败")}finally{o(!1)}},f=async E=>{if(E.preventDefault(),!s){O.error("添加API密钥需要高级版本");return}if(!r.api_key||!r.secret_key||!r.name){O.error("请填写完整的信息");return}try{d(!0);const A=await fetch("/api/v1/api-keys/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Lt()}`},body:JSON.stringify({name:r.name,exchange:r.exchange,api_key:r.api_key,secret_key:r.secret_key,passphrase:r.passphrase||void 0})});if(A.ok){let T=null;try{const k=await A.text();T=k?JSON.parse(k):{}}catch{console.log("Response is not JSON, treating as success")}O.success("API密钥添加成功"),a({name:"",exchange:"okx",api_key:"",secret_key:"",passphrase:""}),p()}else{let T={detail:"Unknown error"};try{const k=await A.text();T=k?JSON.parse(k):{detail:`HTTP ${A.status}: ${A.statusText}`}}catch{T={detail:`HTTP ${A.status}: ${A.statusText}`}}throw new Error(T.detail||"Failed to add API key")}}catch(A){console.error("Error adding API key:",A),O.error(`添加API密钥失败: ${A instanceof Error?A.message:"未知错误"}`)}finally{d(!1)}},x=async(E,A)=>{if(window.confirm(`确定要删除API密钥 "${A}" 吗？`))try{if((await fetch(`/api/v1/api-keys/${E}`,{method:"DELETE",headers:{Authorization:`Bearer ${Lt()}`}})).ok)O.success("API密钥删除成功"),p();else throw new Error("Failed to delete API key")}catch(T){console.error("Error deleting API key:",T),O.error("删除API密钥失败")}},y=async(E,A)=>{try{const T=await fetch(`/api/v1/api-keys/${E}/test`,{method:"POST",headers:{Authorization:`Bearer ${Lt()}`}});if(T.ok){const k=await T.json();O.success(`${A} 连接测试成功`)}else{const k=await T.json();O.error(`${A} 连接测试失败: ${k.detail}`)}}catch(T){console.error("Error testing API key:",T),O.error("连接测试失败")}},m=E=>{u(A=>({...A,[E]:!A[E]}))},g=E=>{switch(E){case"active":return e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"});case"inactive":return e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"});case"error":return e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"});default:return e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"})}},v=E=>{switch(E){case"active":return"有效";case"inactive":return"无效";case"error":return"错误";default:return"未知"}},P=()=>{a({name:"OKX测试账户",exchange:"okx",api_key:"76ba9b3a-38b6-4ed3-9ce7-44d603188b13",secret_key:"4021858325F5A3BEC3F64B6D0533E412",passphrase:"Woaiziji..123"}),O("已填充OKX测试数据")};return b.useEffect(()=>{p()},[s]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"API密钥管理"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"管理您的交易所API密钥，确保安全可靠的交易连接"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:s?`高级版最多可添加5个API密钥 (已使用${n.length}/5)`:"升级到高级版以添加API密钥"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"新增API密钥"}),e.jsx("button",{onClick:P,className:"text-sm text-blue-600 hover:text-blue-700 font-medium px-3 py-1 rounded-md hover:bg-blue-50 transition-colors",children:"填充测试数据"})]}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易所"}),e.jsx("select",{value:r.exchange,onChange:E=>a({...r,exchange:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-sm",children:j.map(E=>e.jsxs("option",{value:E.value,children:[E.icon," ",E.label]},E.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API名称"}),e.jsx("input",{type:"text",value:r.name,onChange:E=>a({...r,name:E.target.value}),placeholder:"例如：OKX现货账户",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"公钥 (API KEY)"}),e.jsx("input",{type:"text",value:r.api_key,onChange:E=>a({...r,api_key:E.target.value}),placeholder:"输入API公钥",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"密钥 (SECRET KEY)"}),e.jsx("input",{type:"password",value:r.secret_key,onChange:E=>a({...r,secret_key:E.target.value}),placeholder:"输入API密钥",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm font-mono"})]}),(r.exchange==="okx"||r.exchange==="bybit")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["密码短语 ",r.exchange==="okx"?"(Passphrase)":"(可选)"]}),e.jsx("input",{type:"password",value:r.passphrase,onChange:E=>a({...r,passphrase:E.target.value}),placeholder:r.exchange==="okx"?"输入Passphrase密码":"输入密码短语(可选)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),e.jsx("button",{type:"submit",disabled:!s||c,className:`w-full py-3 rounded-lg font-medium transition-colors ${s?"bg-blue-600 text-white hover:bg-blue-700 disabled:bg-blue-400":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:c?"添加中...":s?"添加API密钥":"升级后可添加"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6 backdrop-blur-sm",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"已添加API密钥"}),l?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("p",{className:"text-gray-500",children:"加载API密钥中..."})]}):n.length>0?e.jsx("div",{className:"space-y-4",children:n.map(E=>{var A;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:((A=j.find(T=>T.value===E.exchange))==null?void 0:A.icon)||"🔧"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:E.name}),e.jsx("p",{className:"text-sm text-gray-500",children:E.exchange.toUpperCase()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[g(E.status),e.jsx("span",{className:"text-sm text-gray-600",children:v(E.status)})]})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"API KEY:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded font-mono",children:h[E.id]?E.api_key:`${E.api_key.slice(0,8)}...${E.api_key.slice(-4)}`}),e.jsx("button",{onClick:()=>m(E.id),className:"text-xs text-blue-600 hover:text-blue-700",children:h[E.id]?"隐藏":"显示"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["权限: ",E.permissions||"交易权限"]}),e.jsxs("span",{children:["添加时间: ",new Date(E.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>y(E.id,E.name),className:"px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",children:"测试连接"}),e.jsx("button",{onClick:()=>x(E.id,E.name),className:"px-3 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:"删除"})]})]},E.id)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"暂无API密钥"}),e.jsx("p",{className:"text-gray-500",children:"添加您的第一个交易所API密钥以开始交易"})]})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-5 h-5 text-yellow-600 mt-0.5",children:e.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-yellow-800 mb-1",children:"安全提示"}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsx("li",{children:"• API密钥采用安全加密存储，但请确保您的账户安全"}),e.jsx("li",{children:"• 建议为API密钥设置最小必要权限（仅交易权限，禁用提现）"}),e.jsx("li",{children:"• 定期检查API密钥状态，及时更新或删除不用的密钥"}),e.jsx("li",{children:"• 不要在公共场所或他人面前输入API密钥信息"})]})]})]})})]})},mh=()=>{$t();const{t:s}=Wt(),[t,r]=b.useState(""),[a,n]=b.useState("all"),[i,l]=b.useState("all"),[o,c]=b.useState([]),[d,h]=b.useState(""),[u,j]=b.useState([]),[p,f]=b.useState(null),[x,y]=b.useState(!1),[m,g]=b.useState(1),[v,P]=b.useState(1),[E,A]=b.useState([]),[T,k]=b.useState(!1),[R,se]=b.useState(null),[z,K]=b.useState({title:"",content:"",category:"technical_analysis",symbol:"",entry_price:"",exit_price:"",stop_loss:"",take_profit:"",position_size:"",result:"",tags:[],is_public:!1}),S=[{value:"all",label:"所有分类"},{value:"technical_analysis",label:"技术分析"},{value:"fundamental",label:"基本面"},{value:"strategy_summary",label:"策略总结"},{value:"error_review",label:"错误复盘"},{value:"market_view",label:"市场观点"}],U=[{value:"all",label:"全部时间"},{value:"today",label:"今天"},{value:"week",label:"本周"},{value:"month",label:"本月"},{value:"quarter",label:"过去3个月"}],V=L=>{switch(L){case"technical_analysis":return"bg-blue-100 text-blue-800";case"fundamental":return"bg-green-100 text-green-800";case"strategy_summary":return"bg-purple-100 text-purple-800";case"error_review":return"bg-red-100 text-red-800";case"market_view":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},le=L=>{const ae=S.find(ge=>ge.value===L);return(ae==null?void 0:ae.label)||L},C=async()=>{try{y(!0);const L=new URLSearchParams({page:m.toString(),page_size:"10"});t&&L.append("search",t),a!=="all"&&L.append("category",a),o.length>0&&L.append("tags",o.join(","));const ae=await fetch(`/api/v1/trading-notes/?${L}`,{headers:{Authorization:`Bearer ${Lt()}`}});if(ae.ok){const ge=await ae.json();j(ge.notes||[]),P(ge.total_pages||1)}else throw new Error("Failed to load trading notes")}catch(L){console.error("Error loading trading notes:",L),O.error("加载交易心得失败")}finally{y(!1)}},B=async()=>{try{const L=await fetch("/api/v1/trading-notes/stats/summary",{headers:{Authorization:`Bearer ${Lt()}`}});if(L.ok){const ae=await L.json();f(ae)}}catch(L){console.error("Error loading stats:",L)}},re=async L=>{if(L.preventDefault(),!z.title||!z.content){O.error("请填写标题和内容");return}try{const ae=R?`/api/v1/trading-notes/${R.id}`:"/api/v1/trading-notes/",fe=await fetch(ae,{method:R?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Lt()}`},body:JSON.stringify(z)});if(fe.ok)O.success(R?"心得更新成功":"心得创建成功"),k(!1),se(null),pe(),C(),B();else{const Je=await fe.json();throw new Error(Je.detail||"Failed to save note")}}catch(ae){console.error("Error saving note:",ae),O.error(`保存失败: ${ae instanceof Error?ae.message:"未知错误"}`)}},_=async(L,ae)=>{if(window.confirm(`确定要删除心得 "${ae}" 吗？`))try{if((await fetch(`/api/v1/trading-notes/${L}`,{method:"DELETE",headers:{Authorization:`Bearer ${Lt()}`}})).ok)O.success("心得删除成功"),C(),B();else throw new Error("Failed to delete note")}catch(ge){console.error("Error deleting note:",ge),O.error("删除失败")}},H=async L=>{try{const ae=await fetch(`/api/v1/trading-notes/${L}/like`,{method:"POST",headers:{Authorization:`Bearer ${Lt()}`}});if(ae.ok){const ge=await ae.json();j(u.map(fe=>fe.id===L?{...fe,likes_count:ge.likes_count,is_liked:ge.is_liked}:fe))}}catch(ae){console.error("Error toggling like:",ae),O.error("操作失败")}},xe=async()=>{if(u.length===0){O.error("没有交易心得可分析");return}try{const L=E.length>0?E:u.slice(0,10).map(ge=>ge.id),ae=await fetch("/api/v1/trading-notes/ai-analysis",{method:"POST",headers:{Authorization:`Bearer ${Lt()}`}});if(ae.ok){const ge=await ae.json(),fe=window.open("","_blank","width=800,height=600,scrollbars=yes");fe&&(fe.document.write(`
            <html>
              <head>
                <title>AI交易心得分析报告</title>
                <meta charset="utf-8">
                <style>
                  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; margin: 40px; }
                  .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #3b82f6; padding-bottom: 20px; }
                  .content { white-space: pre-wrap; }
                  .stats { background: #f3f4f6; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
                </style>
              </head>
              <body>
                <div class="header">
                  <h1>🤖 AI交易心得分析报告</h1>
                  <p>分析了 ${ge.analyzed_notes_count} 条交易记录</p>
                </div>
                <div class="stats">
                  <strong>分析类型：</strong>综合交易分析<br>
                  <strong>生成时间：</strong>${new Date().toLocaleString()}
                </div>
                <div class="content">${ge.analysis}</div>
              </body>
            </html>
          `),fe.document.close()),O.success(`AI分析完成！分析了 ${ge.analyzed_notes_count} 条记录`)}else{const ge=await ae.json();throw new Error(ge.detail||"AI分析失败")}}catch(L){console.error("AI分析失败:",L),O.error(`AI分析失败: ${L instanceof Error?L.message:"未知错误"}`)}},_e=()=>{d&&!o.includes(d.toUpperCase())&&(c([...o,d.toUpperCase()]),h(""))},$e=L=>{c(o.filter(ae=>ae!==L))},pe=()=>{K({title:"",content:"",category:"technical_analysis",symbol:"",entry_price:"",exit_price:"",stop_loss:"",take_profit:"",position_size:"",result:"",tags:[],is_public:!1})},X=L=>{A(ae=>ae.includes(L)?ae.filter(ge=>ge!==L):[...ae,L])},W=()=>{A([])},ne=L=>{se(L),K({title:L.title,content:L.content,category:L.category,symbol:L.symbol||"",entry_price:L.entry_price||"",exit_price:L.exit_price||"",stop_loss:L.stop_loss||"",take_profit:L.take_profit||"",position_size:L.position_size||"",result:L.result||"",tags:L.tags,is_public:L.is_public}),k(!0)};return b.useEffect(()=>{C(),B()},[m,t,a,o]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"交易心得"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"记录和分析您的交易经验，提升交易技能"})]}),e.jsxs("button",{onClick:()=>k(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"记录心得"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"筛选条件"}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",value:t,onChange:L=>r(L.target.value),placeholder:"搜索心得记录...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"分类筛选"}),e.jsx("select",{value:a,onChange:L=>n(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:S.map(L=>e.jsx("option",{value:L.value,children:L.label},L.value))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"时间范围"}),e.jsx("select",{value:i,onChange:L=>l(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:U.map(L=>e.jsx("option",{value:L.value,children:L.label},L.value))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"币种"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:o.map(L=>e.jsxs("span",{className:"bg-blue-50 text-blue-700 px-2 py-1 rounded-md text-sm flex items-center",children:[L,e.jsx("button",{onClick:()=>$e(L),className:"ml-1 text-blue-500 hover:text-blue-700",children:"×"})]},L))}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",value:d,onChange:L=>h(L.target.value),placeholder:"添加币种",className:"flex-1 px-2 py-1 border border-gray-300 rounded-l-md text-sm",onKeyPress:L=>L.key==="Enter"&&_e()}),e.jsx("button",{onClick:_e,className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-r-md text-sm hover:bg-gray-200",children:"+"})]})]}),e.jsxs("button",{onClick:xe,disabled:x||u.length===0,className:"w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center mb-2 disabled:bg-gray-400 disabled:cursor-not-allowed",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),u.length===0?"AI分析（无数据）":`AI分析交易记录${E.length>0?`（已选${E.length}条）`:"（最新10条）"}`]}),E.length>0&&e.jsxs("button",{onClick:W,className:"w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors flex items-center justify-center mb-4 text-sm",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"清除选择（",E.length,"条）"]}),p&&e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"共有心得记录"}),e.jsxs("span",{className:"font-medium",children:[p.total_notes,"条"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"存储空间"}),e.jsxs("span",{className:"font-medium",children:[p.storage_used.toFixed(1),"GB/",p.storage_limit,"GB"]})]})]})})]}),e.jsx("div",{className:"lg:col-span-3 bg-white border border-gray-200 rounded-xl shadow-lg p-6",children:x?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("p",{className:"text-gray-500",children:"加载交易心得中..."})]}):u.length>0?e.jsxs("div",{className:"space-y-6",children:[u.map(L=>e.jsxs("div",{className:"border-b border-gray-200 pb-6 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("input",{type:"checkbox",checked:E.includes(L.id),onChange:()=>X(L.id),className:"mt-2 w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 flex-1",children:L.title})]}),e.jsx("span",{className:`px-2 py-1 rounded text-sm ${V(L.category)}`,children:le(L.category)})]}),e.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[new Date(L.created_at).toLocaleString(),L.symbol&&` · ${L.symbol}`]}),e.jsxs("div",{className:"mb-4 text-gray-700",children:[e.jsx("p",{children:L.content}),(L.entry_price||L.exit_price||L.stop_loss||L.take_profit)&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[L.entry_price&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"入场："}),e.jsx("span",{className:"font-medium",children:L.entry_price})]}),L.exit_price&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"出场："}),e.jsx("span",{className:"font-medium",children:L.exit_price})]}),L.stop_loss&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"止损："}),e.jsx("span",{className:"font-medium",children:L.stop_loss})]}),L.take_profit&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"止盈："}),e.jsx("span",{className:"font-medium",children:L.take_profit})]})]}),L.result&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-500",children:"结果："}),e.jsx("span",{className:"font-medium",children:L.result})]})]}),L.tags.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-1",children:L.tags.map((ae,ge)=>e.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs",children:["#",ae]},ge))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>H(L.id),className:`flex items-center text-sm ${L.is_liked?"text-blue-600":"text-gray-500 hover:text-blue-600"}`,children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:L.is_liked?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})}),L.likes_count]}),e.jsxs("span",{className:"flex items-center text-sm text-gray-500",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),L.comments_count]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>ne(L),className:"text-blue-600 text-sm flex items-center hover:text-blue-700",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"编辑"]}),e.jsxs("button",{onClick:()=>_(L.id,L.title),className:"text-red-600 text-sm flex items-center hover:text-red-700",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"删除"]})]})]})]},L.id)),v>1&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("nav",{className:"inline-flex rounded-md shadow",children:[e.jsx("button",{onClick:()=>g(Math.max(1,m-1)),disabled:m===1,className:"py-2 px-4 bg-white border border-gray-300 text-sm rounded-l-md hover:bg-gray-100 disabled:bg-gray-50 disabled:text-gray-400",children:"上一页"}),Array.from({length:v},(L,ae)=>ae+1).map(L=>e.jsx("button",{onClick:()=>g(L),className:`py-2 px-4 border border-gray-300 text-sm hover:bg-gray-100 ${m===L?"bg-blue-50 text-blue-700 border-blue-500":"bg-white"}`,children:L},L)),e.jsx("button",{onClick:()=>g(Math.min(v,m+1)),disabled:m===v,className:"py-2 px-4 bg-white border border-gray-300 text-sm rounded-r-md hover:bg-gray-100 disabled:bg-gray-50 disabled:text-gray-400",children:"下一页"})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"暂无交易心得"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"开始记录您的第一个交易心得"}),e.jsx("button",{onClick:()=>k(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"记录心得"})]})})]}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:R?"编辑交易心得":"记录交易心得"}),e.jsx("button",{onClick:()=>{k(!1),se(null),pe()},className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:re,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"标题"}),e.jsx("input",{type:"text",value:z.title,onChange:L=>K({...z,title:L.target.value}),placeholder:"输入心得标题...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"分类"}),e.jsx("select",{value:z.category,onChange:L=>K({...z,category:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:S.slice(1).map(L=>e.jsx("option",{value:L.value,children:L.label},L.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易对"}),e.jsx("input",{type:"text",value:z.symbol,onChange:L=>K({...z,symbol:L.target.value}),placeholder:"如：BTC/USDT",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"心得内容"}),e.jsx("textarea",{value:z.content,onChange:L=>K({...z,content:L.target.value}),placeholder:"分享您的交易心得、策略分析或经验总结...",rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"入场价格"}),e.jsx("input",{type:"text",value:z.entry_price,onChange:L=>K({...z,entry_price:L.target.value}),placeholder:"63600",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"出场价格"}),e.jsx("input",{type:"text",value:z.exit_price,onChange:L=>K({...z,exit_price:L.target.value}),placeholder:"64800",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"止损价格"}),e.jsx("input",{type:"text",value:z.stop_loss,onChange:L=>K({...z,stop_loss:L.target.value}),placeholder:"62900",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"止盈价格"}),e.jsx("input",{type:"text",value:z.take_profit,onChange:L=>K({...z,take_profit:L.target.value}),placeholder:"65200",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"仓位大小"}),e.jsx("input",{type:"text",value:z.position_size,onChange:L=>K({...z,position_size:L.target.value}),placeholder:"0.1 BTC",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易结果"}),e.jsx("input",{type:"text",value:z.result,onChange:L=>K({...z,result:L.target.value}),placeholder:"获利1.9%",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_public",checked:z.is_public,onChange:L=>K({...z,is_public:L.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"is_public",className:"ml-2 block text-sm text-gray-700",children:"公开分享（其他用户可以查看）"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{k(!1),se(null),pe()},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"取消"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:R?"更新心得":"保存心得"})]})]})]})})]})},vr=[{level:"basic",name:"初级会员",price:19,period:"月",color:"green",description:"入门级功能套餐",highlight:"适合刚开始量化交易的新手用户",features:["AI交易员模式/AI开发者模式","AI交易心得功能","每天使用$20额度的AI助手","绑定1个交易所API KEY","包含1个免费实盘"],benefits:["✅ AI交易员模式","✅ AI开发者模式","✅ AI交易心得功能","✅ 每日$20 AI助手额度","✅ 1个交易所API密钥","✅ 1个免费实盘交易","✅ 基础策略模板库","✅ 邮件技术支持"],limitations:["❌ 无Tick级别数据回测","❌ 多API密钥管理","❌ 大量AI对话额度","❌ 高级策略优化"]},{level:"premium",name:"高级会员",price:99,period:"月",color:"blue",popular:!0,description:"全功能专业套餐",highlight:"热门选择，功能全面且性价比高",features:["初级会员所有功能","每天使用$100额度的AI助手","每月可使用Tick级别数据回测30次","绑定5个API交易所API KEY","包含5个免费实盘"],benefits:["✅ 初级会员所有功能","✅ 每日$100 AI助手额度","✅ 每月30次Tick级别回测","✅ 5个交易所API密钥","✅ 5个免费实盘交易","✅ 高级技术指标","✅ 策略性能分析","✅ 7×24小时技术支持"],limitations:["❌ AI图表交易模式","❌ 企业定制服务","❌ 专属客户经理"]},{level:"professional",name:"专业会员",price:199,period:"月",color:"purple",popular:!1,description:"专业交易者首选",highlight:"专业交易者和机构用户的完整解决方案",features:["高级会员所有功能","AI图表交易模式","每天使用$200额度的AI对话","每月可使用Tick级别数据回测100次","绑定10个交易所API KEY","包含10个免费实盘"],benefits:["✅ 高级会员所有功能","✅ AI图表交易模式","✅ 每日$200 AI对话额度","✅ 每月100次Tick级别回测","✅ 10个交易所API密钥","✅ 10个免费实盘交易","✅ 定制化策略开发","✅ 专属客户经理","✅ 7×24小时VIP支持","✅ 优先技术服务"],limitations:[]}],xh=()=>{var le;const{user:s}=$t(),{token:t,logout:r}=et(),{t:a}=Wt(),n=ot(),[i,l]=b.useState(null),[o,c]=b.useState([]),[d,h]=b.useState(!1),[u,j]=b.useState(!1),[p,f]=b.useState(!1),[x,y]=b.useState(""),m=async()=>{try{h(!0),console.log("🔍 ProfilePage - 获取token:",t?"已获取":"未获取"),console.log("🔍 ProfilePage - API URL:","/api/v1/membership/usage-stats");const C=await fetch("/api/v1/membership/usage-stats",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(console.log("🔍 ProfilePage - 响应状态:",C.status),C.ok){const B=await C.json();console.log("🔍 ProfilePage - 获取数据成功:",B),l(B.data)}else{const B=await C.text();console.error("🔍 ProfilePage - 请求失败:",C.status,B),C.status===401?console.warn("Token已过期，需要重新登录"):C.status===500&&console.error("服务器内部错误，请稍后重试")}}catch(C){console.error("Load usage stats error:",C),C instanceof Error&&console.error("网络连接异常:",C.message)}finally{h(!1)}},g=async()=>{if(t)try{j(!0);const C=await fetch("/api/v1/api-keys/",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(C.ok){let B={api_keys:[]};try{const _=await C.text();B=_?JSON.parse(_):{api_keys:[]}}catch{console.log("Response is not JSON, using empty array")}const re=(B.api_keys||[]).map((_,H)=>({..._,balance:{total:1e4+H*5e3,available:8e3+H*4e3,currency:"USDT"},performance:{total_return:15.6+H*8.2,daily_return:.8+H*.3,win_rate:68.5+H*5.1,created_days:Math.floor(Math.random()*90)+30}}));c(re)}else console.error("Failed to load API keys:",C.status)}catch(C){console.error("Error loading API keys:",C)}finally{j(!1)}},v=(C,B)=>{var _;const re={gray:{bg:"bg-gray-50",text:"text-gray-700",border:"border-gray-200"},blue:{bg:"bg-blue-50",text:"text-blue-700",border:"border-blue-200"},purple:{bg:"bg-purple-50",text:"text-purple-700",border:"border-purple-200"},gold:{bg:"bg-yellow-50",text:"text-yellow-700",border:"border-yellow-200"}};return((_=re[C])==null?void 0:_[B])||re.gray[B]},P=(C,B)=>B===0?0:Math.min(C/B*100,100),E=()=>vr.find(C=>C.level===(s==null?void 0:s.membership_level))||vr[0],A=C=>{y(C),f(!0)},T=async()=>{try{O.success("支付成功！会员权益已更新"),f(!1),y(""),m()}catch{O.error("支付失败，请重试")}},k=()=>{window.confirm("确定要退出登录吗？")&&(r(),n("/login"))},R=()=>{n("/api-keys")},se=async(C,B)=>{if(window.confirm(`确定要删除API密钥 "${B}" 吗？`))try{if((await fetch(`/api/v1/api-keys/${C}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).ok)O.success("API密钥删除成功"),g();else throw new Error("Failed to delete API key")}catch(re){console.error("Error deleting API key:",re),O.error("删除API密钥失败")}},z=C=>{switch(C){case"active":return e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"});case"inactive":return e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"});case"error":return e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"});default:return e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"})}},K=C=>{switch(C){case"active":return"正常";case"inactive":return"无效";case"error":return"错误";default:return"未知"}},S=C=>({okx:"🟢",binance:"🟡",huobi:"🔴",bybit:"🟠",kraken:"🟣",coinbase:"🔵"})[C.toLowerCase()]||"🔧";b.useEffect(()=>{t&&s&&(m(),g())},[t,s]);const U=E(),V=vr.find(C=>C.level===x);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"账户中心"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"管理您的账户信息、会员权益和使用状况"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:s!=null&&s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:"Avatar",className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-2xl font-bold text-white",children:((le=s==null?void 0:s.username)==null?void 0:le.charAt(0).toUpperCase())||"U"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:s==null?void 0:s.username}),e.jsx("p",{className:"text-gray-500 mb-4",children:s==null?void 0:s.email}),e.jsxs("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${v(U.color,"bg")} ${v(U.color,"text")}`,children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1zM12 2a1 1 0 01.967.744L14.146 7.2 17.5 9.134a1 1 0 010 1.732L14.146 12.8l-1.179 4.456a1 1 0 01-1.934 0L9.854 12.8 6.5 10.866a1 1 0 010-1.732L9.854 7.2l1.179-4.456A1 1 0 0112 2z",clipRule:"evenodd"})}),U.name]}),(s==null?void 0:s.membership_expires_at)&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["到期时间: ",new Date(s.membership_expires_at).toLocaleDateString()]}),e.jsxs("button",{onClick:k,className:"mt-4 w-full py-2 px-4 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),e.jsx("span",{children:"退出登录"})]})]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"当前套餐权益"}),e.jsx("div",{className:"space-y-2",children:U.features.map((C,B)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-4 h-4 text-green-500 mr-2 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm text-gray-700",children:C})]},B))})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"使用情况统计"}),d?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-8 h-8 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("p",{className:"text-gray-500",children:"加载统计数据中..."})]}):i?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"API密钥"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.api_keys_count,"/",i.api_keys_limit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${P(i.api_keys_count,i.api_keys_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"今日AI对话"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["$",i.ai_usage_today,"/$",i.ai_daily_limit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${P(i.ai_usage_today,i.ai_daily_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"本月Tick回测"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.tick_backtest_today,"/",i.tick_backtest_limit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${P(i.tick_backtest_today,i.tick_backtest_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"存储空间"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.storage_used,"MB/",i.storage_limit,"MB"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-yellow-600 h-2 rounded-full transition-all duration-300",style:{width:`${P(i.storage_used,i.storage_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"指标数量"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.indicators_count,"/",i.indicators_limit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-300",style:{width:`${P(i.indicators_count,i.indicators_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"策略数量"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.strategies_count,"/",i.strategies_limit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-pink-600 h-2 rounded-full transition-all duration-300",style:{width:`${P(i.strategies_count,i.strategies_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"实盘交易"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.live_trading_count,"/",i.live_trading_limit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-red-600 h-2 rounded-full transition-all duration-300",style:{width:`${P(i.live_trading_count,i.live_trading_limit)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"K线回测"}),e.jsx("span",{className:"text-sm text-gray-500",children:"无限制"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full w-full"})})]})]}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"无法加载统计数据"})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"API密钥管理"}),e.jsx("button",{onClick:R,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all transform hover:scale-105 shadow-lg text-sm",children:"+ 添加API密钥"})]}),u?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-8 h-8 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center animate-spin",children:e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"加载API密钥中..."})]}):o.length>0?e.jsx("div",{className:"space-y-4",children:o.map(C=>{var B,re,_,H,xe,_e,$e,pe,X,W,ne,L;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:S(C.exchange)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:C.name}),e.jsx("p",{className:"text-sm text-gray-500",children:C.exchange.toUpperCase()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[z(C.status),e.jsx("span",{className:"text-sm text-gray-600",children:K(C.status)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"账户余额"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[((re=(B=C.balance)==null?void 0:B.total)==null?void 0:re.toLocaleString())||"0"," ",((_=C.balance)==null?void 0:_.currency)||"USDT"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["可用: ",((xe=(H=C.balance)==null?void 0:H.available)==null?void 0:xe.toLocaleString())||"0"]})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"总收益率"}),e.jsxs("div",{className:"font-semibold text-green-600",children:["+",(($e=(_e=C.performance)==null?void 0:_e.total_return)==null?void 0:$e.toFixed(2))||"0.00","%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["日收益: +",((X=(pe=C.performance)==null?void 0:pe.daily_return)==null?void 0:X.toFixed(2))||"0.00","%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3 text-xs",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-500",children:"胜率"}),e.jsxs("div",{className:"font-medium text-gray-900",children:[((ne=(W=C.performance)==null?void 0:W.win_rate)==null?void 0:ne.toFixed(1))||"0.0","%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-500",children:"运行天数"}),e.jsxs("div",{className:"font-medium text-gray-900",children:[((L=C.performance)==null?void 0:L.created_days)||"0","天"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-500",children:"创建时间"}),e.jsx("div",{className:"font-medium text-gray-900",children:new Date(C.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>n("/trading"),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:"查看交易"}),e.jsx("button",{onClick:()=>se(C.id,C.name),className:"px-3 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:"删除"})]})]},C.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"暂无API密钥"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"添加您的第一个交易所API密钥以开始自动交易"}),e.jsx("button",{onClick:R,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"添加API密钥"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"升级套餐"}),e.jsx("div",{className:"space-y-6",children:vr.map(C=>e.jsxs("div",{className:`relative border-2 rounded-xl p-6 transition-all duration-200 hover:shadow-md ${C.level===(s==null?void 0:s.membership_level)?`${v(C.color,"border")} ${v(C.color,"bg")}`:"border-gray-200 hover:border-gray-300"}`,children:[C.popular&&e.jsx("div",{className:"absolute -top-2 left-6",children:e.jsx("span",{className:"bg-purple-600 text-white text-xs font-medium px-3 py-1 rounded-full",children:"推荐"})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"text-center lg:text-left",children:[e.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:C.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:C.description}),e.jsx("div",{className:"mb-4",children:C.price===0?e.jsx("span",{className:"text-3xl font-bold text-gray-900",children:"免费"}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:["$",C.price]}),e.jsxs("span",{className:"text-gray-500 text-base",children:["/",C.period]})]})}),e.jsx("p",{className:"text-xs text-gray-500 mb-4 italic",children:C.highlight}),C.level===(s==null?void 0:s.membership_level)?e.jsx("button",{disabled:!0,className:"w-full py-3 px-4 bg-gray-300 text-gray-500 rounded-lg font-medium cursor-not-allowed",children:"当前套餐"}):C.price===0?e.jsx("button",{disabled:!0,className:"w-full py-3 px-4 bg-gray-300 text-gray-500 rounded-lg font-medium cursor-not-allowed",children:"免费套餐"}):e.jsx("button",{onClick:()=>A(C.level),className:"w-full py-3 px-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all transform hover:scale-105 shadow-lg",children:"立即升级"})]})}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx("h5",{className:"font-semibold text-gray-900 mb-3",children:"核心功能"}),e.jsx("div",{className:"space-y-2",children:C.features.map((B,re)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-500 mr-2 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm text-gray-700 font-medium",children:B})]},re))})]})]})]},C.level))}),e.jsx("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"💡 会员计划说明"}),e.jsxs("p",{className:"text-blue-700",children:["• ",e.jsx("strong",{children:"初级会员($19/月)"}),": AI交易员/开发者模式、AI交易心得、每日$20 AI额度、1个API、1个实盘",e.jsx("br",{}),"• ",e.jsx("strong",{children:"高级会员($99/月)"}),": 初级所有功能 + 每日$100 AI额度 + 30次/月Tick回测 + 5个API + 5个实盘",e.jsx("br",{}),"• ",e.jsx("strong",{children:"专业会员($199/月)"}),": 高级所有功能 + AI图表交易模式 + 每日$200 AI额度 + 100次/月Tick回测 + 10个API + 10个实盘",e.jsx("br",{})]}),e.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"🎯 推荐：初级会员适合新手，高级会员性价比最高，专业会员提供完整解决方案"})]})]})})]})]})]}),p&&V&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["升级到 ",V.name]}),e.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:["$",V.price]}),e.jsxs("p",{className:"text-gray-500",children:["/",V.period]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"套餐包含："}),e.jsxs("ul",{className:"space-y-1",children:[V.features.slice(0,3).map((C,B)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("svg",{className:"w-3 h-3 text-green-500 mr-2 mt-1 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),C]},B)),V.features.length>3&&e.jsxs("li",{className:"text-sm text-gray-500",children:["+ ",V.features.length-3," 项更多权益"]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"USDT收款地址"}),e.jsx("div",{className:"bg-white border border-blue-200 rounded p-3 mb-2",children:e.jsx("code",{className:"text-sm text-gray-800 break-all",children:"TQrZ8ZwgQx4Y9FpN8H3rK7LmVx9Rt2NcE8"})}),e.jsxs("p",{className:"text-xs text-blue-700",children:["请向此地址转账 $",V.price,' USDT，转账完成后点击"确认支付"']})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-2 px-4 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"取消"}),e.jsx("button",{onClick:T,className:"flex-1 py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"确认支付"})]})]})})]})},gh=()=>{var y;const s=ot(),{token:t,user:r}=et(),[a,n]=b.useState(null),[i,l]=b.useState([]),[o,c]=b.useState(!0),[d,h]=b.useState(null);b.useEffect(()=>{if(!r||r.email!=="admin@trademe.com"){s("/");return}},[r,s]);const u=async()=>{try{const m=await fetch("/api/v1/admin/stats/system",{headers:{Authorization:`Bearer ${t}`}});if(m.ok){const g=await m.json();n(g.data)}else throw new Error("获取系统统计失败")}catch(m){h(m instanceof Error?m.message:"获取系统统计失败")}},j=async()=>{try{const m=await fetch("/api/v1/admin/users?limit=5",{headers:{Authorization:`Bearer ${t}`}});if(m.ok){const g=await m.json();l(g.data.users)}else throw new Error("获取用户列表失败")}catch(m){h(m instanceof Error?m.message:"获取用户列表失败")}};b.useEffect(()=>{t&&(async()=>{c(!0),await Promise.all([u(),j()]),c(!1)})()},[t]);const p=m=>new Date(m).toLocaleString("zh-CN"),f=m=>{switch(m.toLowerCase()){case"basic":return"bg-gray-100 text-gray-700 border border-gray-300";case"premium":return"bg-blue-50 text-blue-700 border border-blue-200";case"professional":return"bg-purple-50 text-purple-700 border border-purple-200";default:return"bg-gray-100 text-gray-700 border border-gray-300"}},x=m=>{switch(m.toLowerCase()){case"basic":return"基础版";case"premium":return"高级版";case"professional":return"专业版";default:return m}};return o?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(Pt,{size:"lg"})}):d?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-600 text-lg mb-4",children:["⚠️ ",d]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"重新加载"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Trademe 管理仪表板"}),e.jsx("p",{className:"text-sm text-gray-600",children:"数据化运营管理中心"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-4 py-2 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-blue-700 text-sm font-semibold",children:(y=r==null?void 0:r.username)==null?void 0:y.charAt(0).toUpperCase()})}),e.jsxs("span",{className:"text-sm font-medium text-blue-700",children:["管理员: ",r==null?void 0:r.username]})]}),e.jsxs("button",{onClick:()=>s("/"),className:"px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{children:"返回前台"})]})]})]})})}),e.jsxs("div",{className:"p-6",children:[a&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.users.total.toLocaleString()})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"总用户数"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["活跃用户 ",a.users.active," (",a.growth.active_rate,"%)"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"w-full bg-gray-100 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-1000",style:{width:`${Math.min(100,a.users.active/a.users.total*100)}%`}})})})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.users.recent_7days})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"7天新增"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"本周新用户注册数"})]}),e.jsx("div",{className:"mt-4 flex justify-between items-end",children:[...Array(7)].map((m,g)=>e.jsx("div",{className:`w-4 rounded-sm transition-all duration-500 ${g<Math.ceil(a.users.recent_7days/7*7)?"bg-green-500":"bg-gray-200"}`,style:{height:`${20+Math.random()*30}px`,animationDelay:`${g*100}ms`}},g))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[a.growth.verification_rate,"%"]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"验证率"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["已验证: ",a.users.verified," / ",a.users.total]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex mb-2 items-center justify-between",children:[e.jsx("div",{children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-amber-600",children:["已验证: ",a.users.verified]})}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-gray-500",children:["待验证: ",a.users.unverified]})})]}),e.jsx("div",{className:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-amber-100",children:e.jsx("div",{style:{width:`${a.growth.verification_rate}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-amber-500 transition-all duration-1000"})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.membership.premium+a.membership.professional})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"付费用户"}),e.jsxs("div",{className:"flex items-center space-x-4 text-gray-600 text-sm",children:[e.jsxs("span",{children:["高级: ",a.membership.premium]}),e.jsxs("span",{children:["专业: ",a.membership.professional]})]})]}),e.jsxs("div",{className:"mt-4 flex space-x-1",children:[e.jsx("div",{className:"h-2 bg-blue-500 rounded-sm flex-1",style:{flexBasis:`${a.membership.premium/(a.membership.premium+a.membership.professional)*100}%`}}),e.jsx("div",{className:"h-2 bg-purple-500 rounded-sm flex-1",style:{flexBasis:`${a.membership.professional/(a.membership.premium+a.membership.professional)*100}%`}})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"最近用户"})]}),e.jsxs("button",{onClick:()=>s("/admin/users"),className:"group flex items-center space-x-2 text-blue-600 hover:text-blue-800 text-sm font-medium transition-all duration-300 hover:scale-105",children:[e.jsx("span",{children:"查看全部"}),e.jsx("svg",{className:"w-4 h-4 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})}),e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"会员等级"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"注册时间"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map((m,g)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-sm font-semibold",children:m.username.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:m.username}),e.jsx("div",{className:"text-sm text-gray-500",children:m.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${f(m.membership_level)}`,children:x(m.membership_level)})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${m.is_active?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:`text-sm font-medium ${m.is_active?"text-green-700":"text-red-700"}`,children:m.is_active?"活跃":"非活跃"})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${m.email_verified?"bg-blue-400":"bg-amber-400"}`}),e.jsx("span",{className:`text-xs ${m.email_verified?"text-blue-600":"text-amber-600"}`,children:m.email_verified?"已验证":"待验证"})]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:p(m.created_at)})]},m.id))})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"快捷操作"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>s("/admin/users"),className:"group w-full text-left px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center mr-4 group-hover:shadow-lg group-hover:shadow-blue-100 transition-all duration-300",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-blue-700 transition-colors duration-300",children:"用户管理"}),e.jsx("div",{className:"text-sm text-gray-600",children:"管理用户账户和会员权限"})]}),e.jsx("svg",{className:"w-5 h-5 text-blue-600 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),e.jsx("button",{onClick:()=>s("/admin/claude"),className:"group w-full text-left px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center mr-4 group-hover:shadow-lg group-hover:shadow-green-100 transition-all duration-300",children:e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-green-700 transition-colors duration-300",children:"AI服务管理"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Claude账号池和使用统计"})]}),e.jsx("svg",{className:"w-5 h-5 text-green-600 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),e.jsx("button",{onClick:()=>s("/admin/wallets"),className:"group w-full text-left px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-100 flex items-center justify-center mr-4 group-hover:shadow-lg group-hover:shadow-emerald-100 transition-all duration-300",children:e.jsx("svg",{className:"w-5 h-5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-emerald-700 transition-colors duration-300",children:"钱包池管理"}),e.jsx("div",{className:"text-sm text-gray-600",children:"USDT钱包生成和智能分配"})]}),e.jsx("svg",{className:"w-5 h-5 text-emerald-600 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),e.jsx("button",{onClick:()=>s("/admin/data"),className:"group w-full text-left px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-100 flex items-center justify-center mr-4 group-hover:shadow-lg group-hover:shadow-orange-100 transition-all duration-300",children:e.jsx("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-orange-700 transition-colors duration-300",children:"数据管理"}),e.jsx("div",{className:"text-sm text-gray-600",children:"历史数据下载和质量监控"})]}),e.jsx("svg",{className:"w-5 h-5 text-orange-600 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),e.jsx("button",{className:"group w-full text-left px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center mr-4 group-hover:shadow-lg group-hover:shadow-amber-100 transition-all duration-300",children:e.jsx("svg",{className:"w-5 h-5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-amber-700 transition-colors duration-300",children:"支付管理"}),e.jsx("div",{className:"text-sm text-gray-600",children:"USDT钱包和订单管理"})]}),e.jsx("svg",{className:"w-5 h-5 text-amber-600 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),e.jsx("button",{className:"group w-full text-left px-4 py-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 transition-all duration-300 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-pink-100 flex items-center justify-center mr-4 group-hover:shadow-lg group-hover:shadow-pink-100 transition-all duration-300",children:e.jsx("svg",{className:"w-5 h-5 text-pink-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-pink-700 transition-colors duration-300",children:"数据统计"}),e.jsx("div",{className:"text-sm text-gray-600",children:"系统运营数据和报表"})]}),e.jsx("svg",{className:"w-5 h-5 text-pink-600 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"系统状态"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-blue-50 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"用户服务"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"运行中"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-purple-50 border border-purple-100",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"交易服务"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"运行中"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-amber-50 border border-amber-100",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})})}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"数据服务"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"运行中"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-emerald-50 border border-emerald-100",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})})}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"数据库"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"正常"})]})]})]})]})]})]})]})]})},ph=()=>{var re;const s=ot(),{token:t,user:r}=et(),[a,n]=b.useState([]),[i,l]=b.useState(null),[o,c]=b.useState(null),[d,h]=b.useState(null),[u,j]=b.useState(null),[p,f]=b.useState(!0),[x,y]=b.useState(null),[m,g]=b.useState([]),[v,P]=b.useState(!1),[E,A]=b.useState(""),[T,k]=b.useState("all");b.useEffect(()=>{if(!r||r.email!=="admin@trademe.com"){s("/");return}},[r,s]);const R=async()=>{try{const _=await fetch("/api/v1/admin/users?limit=50",{headers:{Authorization:`Bearer ${t}`}});if(_.ok){const H=await _.json();n(H.data.users)}else throw new Error("获取用户列表失败")}catch(_){y(_ instanceof Error?_.message:"获取用户列表失败")}},se=async()=>{try{const _=await fetch("/api/v1/admin/stats/system",{headers:{Authorization:`Bearer ${t}`}});if(_.ok){const H=await _.json();j(H.data)}}catch(_){console.error("获取系统统计失败:",_)}},z=async()=>{try{const _=await fetch("/api/v1/admin/analytics/membership",{headers:{Authorization:`Bearer ${t}`}});if(_.ok){const H=await _.json();h(H.data)}}catch(_){console.error("获取分析数据失败:",_)}},K=async _=>{try{const H=await fetch(`/api/v1/admin/users/${_}/membership-stats`,{headers:{Authorization:`Bearer ${t}`}});if(H.ok){const xe=await H.json();c(xe.data),P(!0)}else throw new Error("获取用户详情失败")}catch(H){y(H instanceof Error?H.message:"获取用户详情失败")}},S=async(_,H)=>{if(m.length===0){alert("请选择要操作的用户");return}try{const xe=await fetch("/api/v1/admin/users/batch",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({user_ids:m,action:_,data:H})});if(xe.ok){const _e=await xe.json();alert(_e.message),await R(),g([])}else throw new Error("批量操作失败")}catch(xe){alert(xe instanceof Error?xe.message:"批量操作失败")}};b.useEffect(()=>{t&&(async()=>{f(!0),await Promise.all([R(),z(),se()]),f(!1)})()},[t]);const U=_=>{switch(_.toLowerCase()){case"basic":return"bg-gray-100 text-gray-700 border border-gray-300";case"premium":return"bg-blue-50 text-blue-700 border border-blue-200";case"professional":return"bg-purple-50 text-purple-700 border border-purple-200";default:return"bg-gray-100 text-gray-700 border border-gray-300"}},V=_=>{switch(_.toLowerCase()){case"basic":return"基础版";case"premium":return"高级版";case"professional":return"专业版";default:return _}},le=_=>new Date(_).toLocaleString("zh-CN"),C=_=>{if(!_)return null;const H=Math.ceil((new Date(_).getTime()-Date.now())/(24*60*60*1e3));return H>0?H:0},B=a.filter(_=>{const H=_.username.toLowerCase().includes(E.toLowerCase())||_.email.toLowerCase().includes(E.toLowerCase()),xe=T==="all"||T==="active"&&_.is_active||T==="inactive"&&!_.is_active||T==="verified"&&_.email_verified||T==="unverified"&&!_.email_verified;return H&&xe});return p?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsx(Pt,{size:"lg"})}):x?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-600 text-lg mb-4",children:["⚠️ ",x]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"重新加载"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"用户管理中心"}),e.jsx("p",{className:"text-sm text-gray-600",children:"数据驱动的用户运营平台"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-4 py-2 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("span",{className:"text-green-700 text-sm font-semibold",children:(re=r==null?void 0:r.username)==null?void 0:re.charAt(0).toUpperCase()})}),e.jsxs("span",{className:"text-sm font-medium text-green-700",children:["管理员: ",r==null?void 0:r.username]})]}),e.jsxs("button",{onClick:()=>s("/admin"),className:"px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{children:"返回仪表板"})]})]})]})})}),e.jsxs("div",{className:"p-6",children:[u&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总用户数"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:u.users.total.toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("span",{className:"text-green-600 font-medium",children:["活跃: ",u.users.active]}),e.jsxs("span",{className:"text-gray-500",children:["(",u.growth.active_rate,"%)"]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full bg-gray-100 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-1000",style:{width:`${Math.min(100,u.users.active/u.users.total*100)}%`}})})})]})})}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"7天新增"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:u.users.recent_7days})]})]}),e.jsx("div",{className:"flex justify-between items-end mt-4",children:[...Array(7)].map((_,H)=>e.jsx("div",{className:`w-4 rounded-sm transition-all duration-500 ${H<Math.ceil(u.users.recent_7days/7*7)?"bg-green-500":"bg-gray-200"}`,style:{height:`${20+Math.random()*30}px`,animationDelay:`${H*100}ms`}},H))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"邮箱验证率"}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[u.growth.verification_rate,"%"]})]})]}),e.jsxs("div",{className:"relative pt-1",children:[e.jsxs("div",{className:"flex mb-2 items-center justify-between",children:[e.jsx("div",{children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-amber-600",children:["已验证: ",u.users.verified]})}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-gray-500",children:["待验证: ",u.users.unverified]})})]}),e.jsx("div",{className:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-amber-100",children:e.jsx("div",{style:{width:`${u.growth.verification_rate}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-amber-500 transition-all duration-1000"})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"付费用户"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:u.membership.premium+u.membership.professional})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("span",{className:"text-blue-600 font-medium",children:["高级: ",u.membership.premium]}),e.jsxs("span",{className:"text-purple-600 font-medium",children:["专业: ",u.membership.professional]})]}),e.jsxs("div",{className:"flex mt-3 space-x-1",children:[e.jsx("div",{className:"h-2 bg-blue-500 rounded-sm flex-1",style:{flexBasis:`${u.membership.premium/(u.membership.premium+u.membership.professional)*100}%`}}),e.jsx("div",{className:"h-2 bg-purple-500 rounded-sm flex-1",style:{flexBasis:`${u.membership.professional/(u.membership.premium+u.membership.professional)*100}%`}})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"用户列表"}),m.length>0&&e.jsxs("span",{className:"px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full font-medium",children:["已选中 ",m.length," 个用户"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"搜索用户...",value:E,onChange:_=>A(_.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 absolute left-3 top-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsxs("select",{value:T,onChange:_=>k(_.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"all",children:"全部状态"}),e.jsx("option",{value:"active",children:"活跃用户"}),e.jsx("option",{value:"inactive",children:"非活跃"}),e.jsx("option",{value:"verified",children:"已验证"}),e.jsx("option",{value:"unverified",children:"未验证"})]})]})]}),m.length>0&&e.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[e.jsxs("button",{onClick:()=>S("activate"),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-green-700 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"激活用户"]}),e.jsxs("button",{onClick:()=>S("deactivate"),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-red-700 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"停用用户"]}),e.jsxs("button",{onClick:()=>S("verify_email"),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"验证邮箱"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",onChange:_=>{_.target.checked?g(B.map(H=>H.id)):g([])},checked:m.length===B.length&&B.length>0})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户信息"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"会员等级"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"最后登录"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:B.map(_=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",checked:m.includes(_.id),onChange:H=>{H.target.checked?g([...m,_.id]):g(m.filter(xe=>xe!==_.id))}})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm",children:_.username.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:_.username}),e.jsx("div",{className:"text-sm text-gray-500",children:_.email})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${U(_.membership_level)}`,children:V(_.membership_level)}),_.membership_expires_at&&e.jsxs("div",{className:"text-xs text-amber-600 mt-1",children:[C(_.membership_expires_at)," 天后到期"]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${_.is_active?"bg-green-400":"bg-gray-400"}`}),e.jsx("span",{className:`text-sm font-medium ${_.is_active?"text-green-700":"text-gray-500"}`,children:_.is_active?"活跃":"非活跃"})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${_.email_verified?"bg-blue-400":"bg-amber-400"}`}),e.jsx("span",{className:`text-xs ${_.email_verified?"text-blue-600":"text-amber-600"}`,children:_.email_verified?"已验证":"待验证"})]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_.last_login_at?le(_.last_login_at):"从未登录"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("button",{onClick:()=>{l(_),K(_.id)},className:"inline-flex items-center px-3 py-1 text-sm text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded transition-colors",children:[e.jsxs("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"详情"]})})]},_.id))})]})}),B.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"没有找到用户"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"请尝试调整搜索条件或筛选器。"})]})]})}),e.jsxs("div",{className:"space-y-6",children:[d&&d.expiring_soon.length>0&&e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"即将到期"}),e.jsx("span",{className:"px-2 py-1 text-xs bg-amber-100 text-amber-700 rounded-full font-medium",children:d.expiring_soon.length})]}),e.jsx("div",{className:"space-y-3",children:d.expiring_soon.map(_=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-amber-50 border border-amber-100 rounded-lg hover:bg-amber-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-200 flex items-center justify-center text-amber-800 font-semibold text-xs",children:_.username.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:_.username}),e.jsx("div",{className:"text-xs text-gray-600",children:V(_.membership_level)})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-semibold text-amber-700",children:[_.days_remaining," 天"]}),e.jsx("div",{className:"text-xs text-amber-600",children:"剩余时间"})]})]},_.id))})]}),d&&e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"会员分布"})]}),e.jsx("div",{className:"space-y-4",children:d.membership_distribution.map(_=>{const H=d.membership_distribution.reduce(($e,pe)=>$e+pe.count,0),xe=Math.round(_.count/H*100),_e={basic:"bg-gray-500",premium:"bg-blue-500",professional:"bg-purple-500"};return e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-100 hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:V(_.level)}),e.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[_.count," 人"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:`h-2 ${_e[_.level]||_e.basic} rounded-full transition-all duration-1000`,style:{width:`${xe}%`}})}),e.jsxs("div",{className:"text-xs text-gray-600",children:[xe,"% 占比"]})]},_.level)})}),d.revenue&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"收入概览"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"月度收入"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["$",d.revenue.monthly_revenue]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"活跃订阅"}),e.jsx("span",{className:"font-semibold text-blue-600",children:d.revenue.active_subscriptions})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"快速统计"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"今日注册"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"12"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"在线用户"}),e.jsx("span",{className:"text-sm font-semibold text-green-600",children:"1,248"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"待处理"}),e.jsx("span",{className:"text-sm font-semibold text-amber-600",children:"3"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"系统负载"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-1",children:e.jsx("div",{className:"bg-green-500 h-1 rounded-full",style:{width:"65%"}})}),e.jsx("span",{className:"text-xs text-gray-500",children:"65%"})]})]})]})]})]})]})]}),v&&o&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>P(!1)}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full sm:p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg",children:o.user.username.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:[o.user.username," 详细信息"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"用户数据详情与使用统计"})]})]}),e.jsx("button",{onClick:()=>P(!1),className:"bg-gray-100 hover:bg-gray-200 rounded-lg p-2 transition-colors",children:e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"基本信息"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"邮箱地址"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:o.user.email})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"会员等级"}),e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${U(o.user.membership_level)}`,children:o.limits.name})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"邮箱验证"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${o.user.email_verified?"bg-green-400":"bg-amber-400"}`}),e.jsx("span",{className:`text-sm font-medium ${o.user.email_verified?"text-green-600":"text-amber-600"}`,children:o.user.email_verified?"已验证":"待验证"})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"注册时间"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:le(o.user.created_at)})]}),o.user.membership_expires_at&&e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"会员到期"}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:le(o.user.membership_expires_at)}),e.jsxs("div",{className:"text-xs text-amber-600",children:[C(o.user.membership_expires_at)," 天后到期"]})]})]})]})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"使用统计"})]}),e.jsx("div",{className:"space-y-4",children:[{label:"API密钥",current:o.usage.api_keys_count,limit:o.limits.api_keys,color:"blue"},{label:"今日AI使用",current:o.usage.ai_usage_today,limit:o.limits.ai_daily,color:"green",prefix:"$"},{label:"策略数量",current:o.usage.strategies_count,limit:o.limits.strategies,color:"purple"},{label:"指标数量",current:o.usage.indicators_count,limit:o.limits.indicators,color:"amber"},{label:"实盘交易",current:o.usage.live_trading_count,limit:o.limits.live_trading,color:"emerald"},{label:"Tick回测",current:o.usage.tick_backtest_today,limit:o.limits.tick_backtest,color:"rose"}].map((_,H)=>{const xe=_.limit>0?Math.min(100,_.current/_.limit*100):0,_e={blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",amber:"bg-amber-500",emerald:"bg-emerald-500",rose:"bg-rose-500"};return e.jsxs("div",{className:"py-2 border-b border-purple-100 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:_.label}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[_.prefix,_.current,"/",_.limit]})]}),e.jsx("div",{className:"w-full bg-purple-100 rounded-full h-2",children:e.jsx("div",{className:`h-2 ${_e[_.color]} rounded-full transition-all duration-1000`,style:{width:`${xe}%`}})})]},H)})})]})]}),e.jsx("div",{className:"mt-6 flex justify-end space-x-3",children:e.jsx("button",{onClick:()=>P(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"关闭"})})]})]})})]})},fh=()=>{var tt;const s=ot(),{token:t,user:r}=et(),[a,n]=b.useState([]),[i,l]=b.useState([]),[o,c]=b.useState(null),[d,h]=b.useState([]),[u,j]=b.useState(null),[p,f]=b.useState(!0),[x,y]=b.useState(null),[m,g]=b.useState([]),[v,P]=b.useState(!1),[E,A]=b.useState(!1),[T,k]=b.useState(null),[R,se]=b.useState(""),[z,K]=b.useState("all"),[S,U]=b.useState("dashboard"),[V,le]=b.useState([]),[C,B]=b.useState([]),[re,_]=b.useState(!1),[H,xe]=b.useState([]),[_e,$e]=b.useState(!1),[pe,X]=b.useState({step:"initial",authUrl:"",sessionId:"",authCode:"",accountName:"",description:"",dailyLimit:50,priority:50,directToken:"",useManualMode:!1}),[W,ne]=b.useState({account_name:"",api_key:"",account_type:"direct",proxy_base_url:"",proxy_type:"proxy_service",daily_limit:100,proxy_id:""});b.useEffect(()=>{if(!r||r.email!=="admin@trademe.com"){s("/");return}},[r,s]);const L=async()=>{try{const w=await fetch("/api/v1/admin/claude/accounts",{headers:{Authorization:`Bearer ${t}`}});if(w.ok){const ee=await w.json();n(ee.accounts||[])}else throw new Error("获取Claude账号失败")}catch(w){y(w instanceof Error?w.message:"获取Claude账号失败")}},ae=async()=>{try{const w=await fetch("/api/v1/admin/claude/proxies",{headers:{Authorization:`Bearer ${t}`}});if(w.ok){const ee=await w.json();l(ee.proxies||[])}}catch(w){console.error("获取代理列表失败:",w)}},ge=async()=>{try{const w=await fetch("/api/v1/admin/claude/usage-stats?days=30",{headers:{Authorization:`Bearer ${t}`}});if(w.ok){const ee=await w.json();c(ee.data)}}catch(w){console.error("获取使用统计失败:",w)}},fe=async()=>{try{const w=await fetch("/api/v1/admin/claude/anomaly-detection",{headers:{Authorization:`Bearer ${t}`}});if(w.ok){const ee=await w.json();j(ee.data)}}catch(w){console.error("获取异常检测失败:",w)}},Je=async()=>{try{const w=await fetch("/api/v1/anthropic-accounts/",{headers:{Authorization:`Bearer ${t}`}});if(w.ok){const ee=await w.json();xe(ee||[])}else throw new Error("获取Anthropic账户失败")}catch(w){console.error("获取Anthropic账户失败:",w),y(w instanceof Error?w.message:"获取Anthropic账户失败")}},$=async()=>{try{f(!0);const w=await fetch("/api/v1/anthropic-accounts/generate-setup-token-url",{method:"POST",headers:{Authorization:`Bearer ${t}`}});if(w.ok){const ee=await w.json();X({...pe,step:"auth",authUrl:ee.auth_url,sessionId:ee.session_id}),y(null)}else{const ee=await w.json();throw new Error(ee.detail||"生成授权链接失败")}}catch(w){y(w instanceof Error?w.message:"生成授权链接失败")}finally{f(!1)}},ye=async()=>{try{f(!0);const w=await fetch("/api/v1/anthropic-accounts/exchange-setup-token",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({session_id:pe.sessionId,authorization_code:pe.authCode,account_name:pe.accountName,description:pe.description,daily_limit:pe.dailyLimit,priority:pe.priority})});if(w.ok){const ee=await w.json();X({...pe,step:"success"}),await Je(),y(null),setTimeout(()=>{$e(!1),De()},3e3)}else{const ee=await w.json();throw new Error(ee.detail||"Setup Token交换失败")}}catch(w){y(w instanceof Error?w.message:"Setup Token交换失败")}finally{f(!1)}},De=()=>{X({step:"initial",authUrl:"",sessionId:"",authCode:"",accountName:"",description:"",dailyLimit:50,priority:50,directToken:"",useManualMode:!1})},ie=async w=>{var ee,Pe;try{const ct=await(await fetch(`/api/v1/anthropic-accounts/${w}/test`,{method:"POST",headers:{Authorization:`Bearer ${t}`}})).json();ct.success?alert(`连接测试成功！
响应时间: ${((ee=ct.test_details)==null?void 0:ee.response_time_ms)||"N/A"}ms`):alert(`连接测试失败：${((Pe=ct.test_details)==null?void 0:Pe.error)||ct.message||"未知错误"}`),await Je()}catch(Qe){alert("测试连接失败："+(Qe instanceof Error?Qe.message:"网络错误"))}},he=async(w,ee)=>{if(confirm(`确定要删除Anthropic账户 "${ee}" 吗？`))try{const Qe=await(await fetch(`/api/v1/anthropic-accounts/${w}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).json();Qe.success?(await Je(),alert("账户删除成功")):alert("删除失败："+(Qe.message||"未知错误"))}catch(Pe){alert("删除失败："+(Pe instanceof Error?Pe.message:"网络错误"))}},ke=async()=>{var w;try{const ee=await fetch("/api/v1/admin/users/",{headers:{Authorization:`Bearer ${t}`}});if(ee.ok){const Pe=await ee.json();le(((w=Pe.data)==null?void 0:w.users)||[])}}catch(ee){console.error("获取用户列表失败:",ee)}},N=async()=>{try{const w=await fetch("/api/v1/admin/claude/users-detailed-stats",{headers:{Authorization:`Bearer ${t}`}});if(w.ok){const ee=await w.json();B(ee.data||[])}}catch(w){console.error("获取用户使用统计失败:",w)}},M=async()=>{try{const w={account_name:W.account_name,api_key:W.api_key,daily_limit:W.daily_limit,proxy_base_url:W.account_type==="direct"?"":W.proxy_base_url||"https://claude.cloudcdn7.com/api",proxy_type:W.account_type==="direct"?"":W.account_type==="custom_proxy"?"custom":"proxy_service"},ee=await fetch("/api/v1/admin/claude/accounts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(w)});if(ee.ok){const Pe=await ee.json();alert("Claude账号添加成功"),P(!1),ne({account_name:"",api_key:"",account_type:"direct",proxy_base_url:"",proxy_type:"proxy_service",daily_limit:100,proxy_id:""}),await L()}else throw new Error("添加Claude账号失败")}catch(w){alert(w instanceof Error?w.message:"添加Claude账号失败")}},I=async w=>{try{const ee=await fetch(`/api/v1/admin/claude/accounts/${w}/test`,{method:"POST",headers:{Authorization:`Bearer ${t}`}});if(ee.ok){const Pe=await ee.json();alert(`测试结果: ${Pe.status==="success"?"连接成功":"连接失败"}`),await L()}else throw new Error("账号连接测试失败")}catch(ee){alert(ee instanceof Error?ee.message:"账号连接测试失败")}},G=async w=>{if(confirm("确定要删除这个Claude账号吗？"))try{if((await fetch(`/api/v1/admin/claude/accounts/${w}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).ok)alert("Claude账号删除成功"),await L();else throw new Error("删除Claude账号失败")}catch(ee){alert(ee instanceof Error?ee.message:"删除Claude账号失败")}};b.useEffect(()=>{t&&(async()=>{f(!0),await Promise.all([L(),ae(),ge(),fe(),ke(),N(),Je()]),f(!1)})()},[t]);const q=w=>{switch(w){case"active":return"bg-green-100 text-green-700 border-green-200";case"inactive":return"bg-gray-100 text-gray-700 border-gray-200";case"error":return"bg-red-100 text-red-700 border-red-200";case"suspended":return"bg-yellow-100 text-yellow-700 border-yellow-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},Z=w=>{switch(w){case"active":return"活跃";case"inactive":return"非活跃";case"error":return"错误";case"suspended":return"暂停";default:return w}},ce=w=>new Date(w).toLocaleString("zh-CN"),Ce=w=>`$${w.toFixed(4)}`,Le=a.filter(w=>{const ee=w.account_name.toLowerCase().includes(R.toLowerCase())||w.api_key.toLowerCase().includes(R.toLowerCase()),Pe=z==="all"||w.status===z;return ee&&Pe});return p?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsx(Pt,{size:"lg"})}):x?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-600 text-lg mb-4",children:["⚠️ ",x]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"重新加载"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-green-600 to-green-700 flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Claude AI 服务管理"}),e.jsx("p",{className:"text-sm text-gray-600",children:"AI账号池与智能调度管理平台"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-4 py-2 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("span",{className:"text-green-700 text-sm font-semibold",children:(tt=r==null?void 0:r.username)==null?void 0:tt.charAt(0).toUpperCase()})}),e.jsxs("span",{className:"text-sm font-medium text-green-700",children:["管理员: ",r==null?void 0:r.username]})]}),e.jsxs("button",{onClick:()=>s("/admin"),className:"px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{children:"返回仪表板"})]})]})]})})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"px-6",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>U("dashboard"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${S==="dashboard"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("span",{children:"仪表盘"})]})}),e.jsx("button",{onClick:()=>U("accounts"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${S==="accounts"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("span",{children:"账户管理"}),e.jsx("span",{className:"ml-1 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:a.length})]})}),e.jsx("button",{onClick:()=>U("users"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${S==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})}),e.jsx("span",{children:"用户管理"}),e.jsx("span",{className:"ml-1 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:V.length})]})}),e.jsx("button",{onClick:()=>U("scheduler"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${S==="scheduler"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"智能调度"})]})}),e.jsx("button",{onClick:()=>U("anomalies"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${S==="anomalies"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.99-.833-2.75 0L4.058 18.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("span",{children:"异常监控"}),(u==null?void 0:u.anomalies.length)>0&&e.jsx("span",{className:"ml-1 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:u.anomalies.length})]})}),e.jsx("button",{onClick:()=>U("anthropic"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${S==="anthropic"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),e.jsx("span",{children:"Anthropic官方API"}),H.length>0&&e.jsx("span",{className:"ml-1 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:H.length})]})})]})})}),e.jsxs("div",{className:"p-6",children:[S==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总账户数"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:a.length}),e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[a.filter(w=>w.status==="active").length," 个活跃"]})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-green-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总请求数"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:a.reduce((w,ee)=>w+(ee.total_requests||0),0).toLocaleString()}),e.jsxs("p",{className:"text-sm text-red-600 mt-1",children:[a.reduce((w,ee)=>w+(ee.failed_requests||0),0)," 失败"]})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-yellow-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"平均响应时间"}),e.jsxs("p",{className:"text-3xl font-semibold text-gray-900",children:[a.length>0?Math.round(a.reduce((w,ee)=>w+(ee.avg_response_time||0),0)/a.length):0,"ms"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"全部账户平均"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-purple-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"平均成功率"}),e.jsxs("p",{className:"text-3xl font-semibold text-gray-900",children:[a.length>0?(a.reduce((w,ee)=>w+(ee.success_rate||0),0)/a.length).toFixed(1):"0","%"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"全部账户平均"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"账户详细统计"}),e.jsx("div",{className:"space-y-4",children:a.map(w=>{const ee=w.daily_limit>0?w.current_usage/w.daily_limit*100:0,Pe=ee<50?"bg-green-500":ee<80?"bg-yellow-500":"bg-red-500";return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:w.account_name}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${w.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:w.status})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"请求数:"}),e.jsx("span",{className:"font-medium ml-1",children:(w.total_requests||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"成功率:"}),e.jsxs("span",{className:"font-medium ml-1",children:[(w.success_rate||0).toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"响应时间:"}),e.jsxs("span",{className:"font-medium ml-1",children:[w.avg_response_time||0,"ms"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"使用率:"}),e.jsxs("span",{className:"font-medium ml-1",children:[ee.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${Pe}`,style:{width:`${Math.min(ee,100)}%`}})})]},w.id)})})]})]}),S==="accounts"&&e.jsxs("div",{children:[o&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总请求数"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:o.total_requests.toLocaleString()})]})]}),e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"30天统计"})]})})}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总成本"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:Ce(o.total_cost_usd)})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["今日: ",Ce(o.daily_cost_usd)]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"活跃账号"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.filter(w=>w.status==="active").length})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["总账号: ",a.length]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.99-.833-2.75 0L4.058 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"异常警告"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(u==null?void 0:u.anomalies.length)||0})]})]}),e.jsx("div",{className:"text-sm text-red-500",children:"需要关注"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Claude 账号池"}),m.length>0&&e.jsxs("span",{className:"px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-full font-medium",children:["已选中 ",m.length," 个账号"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"搜索账号...",value:R,onChange:w=>se(w.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 absolute left-3 top-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsxs("select",{value:z,onChange:w=>K(w.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"all",children:"全部状态"}),e.jsx("option",{value:"active",children:"活跃"}),e.jsx("option",{value:"inactive",children:"非活跃"}),e.jsx("option",{value:"error",children:"错误"}),e.jsx("option",{value:"suspended",children:"暂停"})]}),e.jsxs("button",{onClick:()=>P(!0),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"添加账号"]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",onChange:w=>{w.target.checked?g(Le.map(ee=>ee.id)):g([])},checked:m.length===Le.length&&Le.length>0})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"账号信息"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"使用情况"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"性能"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Le.map(w=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",checked:m.includes(w.id),onChange:ee=>{ee.target.checked?g([...m,w.id]):g(m.filter(Pe=>Pe!==w.id))}})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-green-500 to-blue-600 flex items-center justify-center text-white font-semibold text-sm",children:w.account_name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.account_name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[w.api_key.substring(0,8),"...",w.api_key.substring(w.api_key.length-4)]})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[Ce(w.current_usage)," / ",Ce(w.daily_limit)]}),e.jsxs("div",{className:"text-gray-500",children:["使用率: ",w.daily_limit>0?(w.current_usage/w.daily_limit*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${w.current_usage/w.daily_limit>.8?"bg-red-500":w.current_usage/w.daily_limit>.6?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(100,w.current_usage/w.daily_limit*100)}%`}})})})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${q(w.status)}`,children:Z(w.status)}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:w.last_used_at?ce(w.last_used_at):"从未使用"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-600",children:"响应:"}),e.jsxs("span",{className:`font-medium ${w.avg_response_time>3e3?"text-red-600":w.avg_response_time>1500?"text-yellow-600":"text-green-600"}`,children:[w.avg_response_time,"ms"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-600",children:"成功率:"}),e.jsxs("span",{className:`font-medium ${w.success_rate>95?"text-green-600":w.success_rate>85?"text-yellow-600":"text-red-600"}`,children:[w.success_rate.toFixed(1),"%"]})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsxs("button",{onClick:()=>I(w.id),className:"inline-flex items-center px-2 py-1 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded transition-colors",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"测试"]}),e.jsxs("button",{onClick:()=>{k(w),A(!0)},className:"inline-flex items-center px-2 py-1 text-xs text-green-600 hover:text-green-800 hover:bg-green-50 rounded transition-colors",children:[e.jsxs("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"详情"]}),e.jsxs("button",{onClick:()=>G(w.id),className:"inline-flex items-center px-2 py-1 text-xs text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"删除"]})]})]},w.id))})]})}),Le.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"没有找到Claude账号"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"请尝试调整搜索条件或筛选器。"})]})]})}),e.jsxs("div",{className:"space-y-6",children:[u&&u.anomalies.length>0&&e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.99-.833-2.75 0L4.058 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"异常警告"}),e.jsx("span",{className:"px-2 py-1 text-xs bg-red-100 text-red-700 rounded-full font-medium",children:u.anomalies.length})]}),e.jsx("div",{className:"space-y-3",children:u.anomalies.slice(0,5).map((w,ee)=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-red-50 border border-red-100 rounded-lg",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${w.severity==="high"?"bg-red-500":w.severity==="medium"?"bg-yellow-500":"bg-blue-500"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.account_name}),e.jsx("div",{className:"text-xs text-gray-600",children:w.description}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:ce(w.detected_at)})]})]},ee))}),u.recommendations.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-red-100",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"建议"}),e.jsx("ul",{className:"space-y-1",children:u.recommendations.slice(0,3).map((w,ee)=>e.jsxs("li",{className:"text-xs text-gray-600 flex items-start",children:[e.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full mt-2 mr-2 flex-shrink-0"}),w]},ee))})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"代理状态"})]}),e.jsx("div",{className:"space-y-3",children:i.slice(0,5).map(w=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 border border-purple-100 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${w.status==="active"?"bg-green-400":w.status==="error"?"bg-red-400":"bg-gray-400"}`}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.name}),e.jsxs("div",{className:"text-xs text-gray-600",children:[w.host,":",w.port]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:[w.success_rate.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"成功率"})]})]},w.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"快速统计"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"今日请求"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"1,234"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"平均响应时间"}),e.jsx("span",{className:"text-sm font-semibold text-green-600",children:"1.2s"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"错误率"}),e.jsx("span",{className:"text-sm font-semibold text-red-600",children:"0.3%"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"成本效率"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-1",children:e.jsx("div",{className:"bg-green-500 h-1 rounded-full",style:{width:"85%"}})}),e.jsx("span",{className:"text-xs text-gray-500",children:"85%"})]})]})]})]})]})]})]}),S==="users"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-indigo-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总用户数"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:V.length}),e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[V.filter(w=>w.membership_level==="professional").length," 专业版用户"]})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-purple-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"AI使用总数"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:C.reduce((w,ee)=>w+(ee.total_requests||0),0)}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"本月累计"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-orange-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"活跃用户"}),e.jsx("p",{className:"text-3xl font-semibold text-gray-900",children:V.filter(w=>new Date(w.last_login_at||0)>new Date(Date.now()-7*24*60*60*1e3)).length}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"近7天"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"用户Claude使用详情"}),e.jsx("p",{className:"text-sm text-gray-600",children:"各用户的Claude AI使用统计和费用详情"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户信息"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"会员等级"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"使用次数"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"费用"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"最后使用"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:V.map(w=>{var Pe,Qe;const ee=C.find(ct=>ct.user_id===w.id)||{};return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-indigo-600 flex items-center justify-center text-white font-semibold",children:((Pe=w.username)==null?void 0:Pe.charAt(0).toUpperCase())||((Qe=w.email)==null?void 0:Qe.charAt(0).toUpperCase())}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.username||"未设置"}),e.jsx("div",{className:"text-sm text-gray-500",children:w.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${w.membership_level==="professional"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:w.membership_level==="professional"?"专业版":"免费版"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ee.total_requests||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",(ee.total_cost||0).toFixed(4)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:w.last_login_at?new Date(w.last_login_at).toLocaleDateString("zh-CN"):"从未登录"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${w.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:w.is_active?"活跃":"已禁用"})})]},w.id)})})]})}),V.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"暂无用户数据"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"等待用户注册或检查API连接。"})]})]})]}),v&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>P(!1)}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"添加Claude账号"}),e.jsx("p",{className:"text-sm text-gray-500",children:"添加官方API账号或代理服务账号到账号池"})]}),e.jsx("button",{onClick:()=>P(!1),className:"bg-gray-100 hover:bg-gray-200 rounded-lg p-2 transition-colors",children:e.jsx("svg",{className:"h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"账号名称"}),e.jsx("input",{type:"text",value:W.account_name,onChange:w=>ne({...W,account_name:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"例如: Claude-Account-001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key"}),e.jsx("input",{type:"password",value:W.api_key,onChange:w=>ne({...W,api_key:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"sk-ant-api... 或 代理服务API密钥"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"账户类型"}),e.jsxs("select",{value:W.account_type,onChange:w=>ne({...W,account_type:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"direct",children:"直接API连接"}),e.jsx("option",{value:"proxy_service",children:"代理服务连接"}),e.jsx("option",{value:"custom_proxy",children:"自定义代理"})]})]}),(W.account_type==="proxy_service"||W.account_type==="custom_proxy")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"代理服务地址"}),W.account_type==="proxy_service"?e.jsxs("select",{value:W.proxy_base_url,onChange:w=>ne({...W,proxy_base_url:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"选择代理服务"}),e.jsx("option",{value:"https://claude.cloudcdn7.com/api",children:"CloudCDN7 代理服务"}),e.jsx("option",{value:"https://api.claude-proxy.com/api",children:"Claude Proxy 服务"}),e.jsx("option",{value:"https://claude-api.proxy.com/v1",children:"通用代理服务"}),e.jsx("option",{value:"custom",children:"自定义URL..."})]}):e.jsx("input",{type:"url",value:W.proxy_base_url,onChange:w=>ne({...W,proxy_base_url:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://your-proxy-service.com/api"}),W.account_type==="proxy_service"&&W.proxy_base_url==="custom"&&e.jsx("input",{type:"url",value:"",onChange:w=>ne({...W,proxy_base_url:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mt-2",placeholder:"输入自定义代理服务地址"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:W.account_type==="proxy_service"?"选择可信的Claude代理服务提供商，确保服务稳定性和安全性":"输入您自己搭建或信任的代理服务地址"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"每日限额 ($)"}),e.jsx("input",{type:"number",value:W.daily_limit,onChange:w=>ne({...W,daily_limit:parseFloat(w.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"代理服务器 (可选)"}),e.jsxs("select",{value:W.proxy_id,onChange:w=>ne({...W,proxy_id:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"不使用代理"}),i.map(w=>e.jsx("option",{value:w.id,children:w.name},w.id))]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>P(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"取消"}),e.jsx("button",{onClick:M,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:"添加账号"})]})]})]})}),S==="scheduler"&&e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"智能调度配置"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"高级调度算法和负载均衡配置"}),e.jsx("button",{onClick:()=>_(!0),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"配置调度规则"})]})}),S==="anomalies"&&e.jsxs("div",{className:"space-y-6",children:[u!=null&&u.anomalies&&u.anomalies.length>0?e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"系统异常警告"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["发现 ",u.anomalies.length," 个需要关注的异常"]})]}),e.jsx("div",{className:"divide-y divide-gray-200",children:u.anomalies.map((w,ee)=>e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:`flex-shrink-0 w-2 h-2 mt-2 rounded-full ${w.severity==="high"?"bg-red-500":w.severity==="medium"?"bg-yellow-500":"bg-blue-500"}`}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:w.account_name}),e.jsx("p",{className:"text-sm text-gray-600",children:w.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["检测时间: ",new Date(w.detected_at).toLocaleString()]})]})]}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w.severity==="high"?"bg-red-100 text-red-800":w.severity==="medium"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:w.severity==="high"?"高风险":w.severity==="medium"?"中等风险":"低风险"})]})},ee))})]}):e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"系统运行正常"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"暂未发现异常，所有账户运行状况良好"})]})}),(u==null?void 0:u.recommendations)&&u.recommendations.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"系统优化建议"}),e.jsx("div",{className:"space-y-3",children:u.recommendations.map((w,ee)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-500 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-gray-700",children:w})})]},ee))})]})]}),S==="anthropic"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Anthropic官方API管理"}),e.jsx("p",{className:"text-sm text-gray-600",children:"直接对接Anthropic官方API服务，无需代理中转"})]}),e.jsxs("button",{onClick:()=>$e(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{children:"添加官方API账户"})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总账户数"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:H.length})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"活跃账户"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:H.filter(w=>w.status==="active").length})]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"总使用额度"}),e.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:["$",H.reduce((w,ee)=>w+(ee.daily_limit||0),0).toFixed(2)]})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Anthropic账户列表"})}),H.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"暂无Anthropic官方API账户"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"点击上方按钮添加您的第一个Anthropic官方API账户"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:H.map((w,ee)=>{var Pe,Qe,ct;return e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${w.status==="active"?"bg-green-100":w.status==="error"?"bg-red-100":"bg-gray-100"}`,children:e.jsx("svg",{className:`w-6 h-6 ${w.status==="active"?"text-green-600":w.status==="error"?"text-red-600":"text-gray-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:w.account_name}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w.status==="active"?"bg-green-100 text-green-800":w.status==="error"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:w.status==="active"?"运行中":w.status==="error"?"错误":"停用"}),w.has_valid_api_key&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"已配置API密钥"})]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500 flex items-center space-x-4",children:[e.jsxs("span",{children:["API版本: ",w.api_version]}),e.jsxs("span",{children:["使用率: ",((Pe=w.usage_percentage)==null?void 0:Pe.toFixed(1))||0,"%"]}),e.jsxs("span",{children:["优先级: ",w.priority]}),e.jsxs("span",{children:["响应时间: ",w.avg_response_time||0,"ms"]}),w.last_check_at&&e.jsxs("span",{children:["最近检查: ",new Date(w.last_check_at).toLocaleString()]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"每日额度:"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",((Qe=w.current_usage)==null?void 0:Qe.toFixed(2))||0," / $",((ct=w.daily_limit)==null?void 0:ct.toFixed(2))||0]})]}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(w.usage_percentage||0,100)}%`}})})]})})]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>ie(w.id),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors",title:"测试连接",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("button",{onClick:()=>he(w.id,w.account_name),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors",title:"删除账户",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},w.id||ee)})})]})]})]}),E&&T&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>A(!1)}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full sm:p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-r from-green-500 to-blue-600 flex items-center justify-center text-white font-bold text-lg",children:T.account_name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:[T.account_name," 详细信息"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Claude账号使用详情和性能监控"})]})]}),e.jsx("button",{onClick:()=>A(!1),className:"bg-gray-100 hover:bg-gray-200 rounded-lg p-2 transition-colors",children:e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"基本信息"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"API密钥"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 font-mono",children:[T.api_key.substring(0,12),"...",T.api_key.substring(T.api_key.length-8)]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"状态"}),e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${q(T.status)}`,children:Z(T.status)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"每日限额"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Ce(T.daily_limit)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"当前使用"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Ce(T.current_usage)})]}),T.remaining_balance&&e.jsxs("div",{className:"flex justify-between py-2 border-b border-blue-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"剩余余额"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Ce(T.remaining_balance)})]}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"创建时间"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:ce(T.created_at)})]})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"性能统计"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-green-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"总请求数"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:T.total_requests.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-green-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"失败请求数"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:T.failed_requests.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-green-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"成功率"}),e.jsxs("span",{className:`text-sm font-medium ${T.success_rate>95?"text-green-600":T.success_rate>85?"text-yellow-600":"text-red-600"}`,children:[T.success_rate.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-green-100",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"平均响应时间"}),e.jsxs("span",{className:`text-sm font-medium ${T.avg_response_time>3e3?"text-red-600":T.avg_response_time>1500?"text-yellow-600":"text-green-600"}`,children:[T.avg_response_time,"ms"]})]}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"最后使用"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:T.last_used_at?ce(T.last_used_at):"从未使用"})]})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"关闭"}),e.jsx("button",{onClick:()=>I(T.id),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:"测试连接"})]})]})]})}),re&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>_(!1)}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full sm:p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"智能调度配置"}),e.jsx("p",{className:"text-sm text-gray-500",children:"配置Claude账号的负载均衡和智能调度规则"})]})]}),e.jsx("button",{onClick:()=>_(!1),className:"bg-gray-100 hover:bg-gray-200 rounded-lg p-2 transition-colors",children:e.jsx("svg",{className:"h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"负载均衡策略"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"strategy",className:"form-radio text-blue-600",defaultChecked:!0}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"智能权重分配 - 根据账号性能动态调整权重"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"strategy",className:"form-radio text-blue-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"轮询调度 - 依次使用每个账号"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"strategy",className:"form-radio text-blue-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"最小连接数优先 - 优先使用负载最轻的账号"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"健康检查配置"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"检查间隔(秒)"}),e.jsx("input",{type:"number",defaultValue:300,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"超时时间(秒)"}),e.jsx("input",{type:"number",defaultValue:30,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"故障转移设置"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox text-blue-600",defaultChecked:!0}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"启用自动故障转移"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox text-blue-600",defaultChecked:!0}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"账号失败后自动标记为不可用"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox text-blue-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"达到日限额时自动切换"})]})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h5",{className:"text-sm font-medium text-blue-900",children:"当前调度状态"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["智能调度器正在运行，当前有 ",a.filter(w=>w.status==="active").length," 个活跃账号参与负载均衡。"]})]})]})})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"取消"}),e.jsx("button",{onClick:()=>{alert("调度规则配置已保存"),_(!1)},className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:"保存配置"})]})]})]})}),_e&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full sm:p-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:text-left",children:[e.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900 flex items-center",children:[e.jsx("svg",{className:"w-6 h-6 text-purple-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"通过Setup Token添加Anthropic账户"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"使用OAuth2安全授权方式连接Anthropic官方API"})]}),e.jsxs("div",{className:"mt-6 space-y-6",children:[x&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.99-.833-2.75 0L4.058 18.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-800",children:x})})]})}),pe.step==="initial"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"🚀 Setup Token OAuth 流程"}),e.jsx("p",{className:"text-sm text-blue-700",children:"我们将使用Anthropic的官方OAuth2授权方式来安全地连接您的Claude账户，无需手动输入API密钥。"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["账户名称 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:pe.accountName,onChange:w=>X({...pe,accountName:w.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"例如：主要生产账户",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"每日限额 (USD)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:pe.dailyLimit,onChange:w=>X({...pe,dailyLimit:parseFloat(w.target.value)||50}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"50.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"优先级 (1-100)"}),e.jsx("input",{type:"number",min:"1",max:"100",value:pe.priority,onChange:w=>X({...pe,priority:parseInt(w.target.value)||50}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"50"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"描述 (可选)"}),e.jsx("textarea",{rows:2,value:pe.description,onChange:w=>X({...pe,description:w.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"账户用途说明..."})]})]})]}),pe.step==="auth"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-green-800 mb-2",children:"✅ 授权链接已生成"}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"请点击下面的按钮跳转到Anthropic进行授权："}),e.jsxs("a",{href:pe.authUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"打开Anthropic授权页面"]})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800 mb-2",children:"⚠️ 重要说明"}),e.jsx("p",{className:"text-sm text-yellow-700 mb-2",children:"由于Cloudflare保护，请按以下步骤操作："}),e.jsxs("ol",{className:"list-decimal list-inside text-sm text-yellow-700 space-y-1",children:[e.jsx("li",{children:"在新标签页中完成授权"}),e.jsx("li",{children:"授权后会跳转到一个回调页面"}),e.jsxs("li",{children:["复制",e.jsx("strong",{children:"整个回调URL"}),"（包含#access_token=...的完整地址）"]}),e.jsx("li",{children:"将完整URL粘贴到下方输入框"})]}),e.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"示例URL格式: https://console.anthropic.com/oauth/code/callback#access_token=xxx&token_type=Bearer..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["回调URL或授权码 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{rows:4,value:pe.authCode,onChange:w=>X({...pe,authCode:w.target.value}),className:"block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-purple-500 focus:border-purple-500 text-xs",placeholder:`请粘贴完整的回调URL，例如：
https://console.anthropic.com/oauth/code/callback#access_token=xxx&token_type=Bearer&expires_in=31536000

或者仅粘贴授权码（如果能自动交换）`,required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"支持两种模式：1) 完整回调URL（推荐） 2) 仅授权码（可能被Cloudflare阻止）"})]}),e.jsx("button",{onClick:()=>X({...pe,step:"initial"}),className:"text-sm text-gray-500 hover:text-gray-700",children:"← 返回上一步"})]}),pe.step==="success"&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"Setup Token账户创建成功！"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:['账户 "',pe.accountName,'" 已成功添加到系统中']}),e.jsx("p",{className:"mt-2 text-xs text-gray-400",children:"窗口将在 3 秒后自动关闭..."})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{$e(!1),De(),y(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",disabled:p,children:"取消"}),pe.step==="initial"&&e.jsxs("button",{onClick:$,disabled:p||!pe.accountName,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[p&&e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:"生成授权链接"})]}),pe.step==="auth"&&e.jsxs("button",{onClick:ye,disabled:p||!pe.authCode,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[p&&e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:"创建账户"})]})]})]})]})})]})},yh=()=>{var le;const s=ot(),{token:t,user:r}=et(),[a,n]=b.useState(null),[i,l]=b.useState(null),[o,c]=b.useState([]),[d,h]=b.useState(!0),[u,j]=b.useState(null),[p,f]=b.useState("dashboard"),[x,y]=b.useState({min_amount:10,network:""}),[m,g]=b.useState(!1),[v,P]=b.useState(1),[E]=b.useState(20),[A,T]=b.useState(0);b.useEffect(()=>{var B;if(!r){s("/");return}if(!(r.email==="admin@trademe.com"||r.username==="admin"||((B=r.email)==null?void 0:B.includes("admin")))){j("您没有访问用户钱包管理系统的权限");return}},[r,s]);const k=async()=>{try{const C=await fetch("/api/v1/user-wallets/admin/overview",{headers:{Authorization:`Bearer ${t}`}});if(C.ok){const B=await C.json();if(B.success)n(B.data);else throw new Error(B.message||"获取用户钱包统计失败")}else throw new Error("获取用户钱包统计失败")}catch(C){j(C instanceof Error?C.message:"获取用户钱包统计失败")}},R=async()=>{try{const C=await fetch("/api/v1/fund-consolidation/statistics",{headers:{Authorization:`Bearer ${t}`}});if(C.ok){const B=await C.json();B.success&&l(B.data)}}catch(C){console.warn("获取归集统计失败:",C)}},se=async()=>{try{if(!(a!=null&&a.users))return;const C=[],B=a.users.slice((v-1)*E,v*E);for(const re of B)try{const _=await fetch(`/api/v1/user-wallets/admin/user/${re.user_id}/wallets`,{headers:{Authorization:`Bearer ${t}`}});if(_.ok){const H=await _.json();H.success&&C.push({...re,wallets:H.data.wallets})}}catch(_){console.warn(`获取用户 ${re.user_id} 钱包失败:`,_)}c(C),T(a.users.length)}catch(C){j(C instanceof Error?C.message:"获取用户钱包列表失败")}};b.useEffect(()=>{t&&(async()=>{h(!0),await k(),await R(),h(!1)})()},[t]),b.useEffect(()=>{a&&p==="users"&&se()},[a,v,p]);const z=async C=>{C.preventDefault(),g(!0);try{const B=await fetch("/api/v1/fund-consolidation/scan",{method:"GET",headers:{Authorization:`Bearer ${t}`}});if(B.ok){const re=await B.json();if(re.success&&re.data.length>0){const _=re.data.filter(H=>!(x.network&&H.network!==x.network||parseFloat(H.amount)<x.min_amount)).slice(0,10).map(H=>H.task_id);if(_.length>0){const H=await fetch("/api/v1/fund-consolidation/execute",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({task_ids:_,strategy:"THRESHOLD"})});if(H.ok){const xe=await H.json();xe.success&&(alert(`成功发起 ${xe.data.executed_tasks} 个归集任务`),await R(),await k())}}else alert("没有符合条件的归集任务")}else alert("当前没有可归集的资金")}else throw new Error("扫描归集机会失败")}catch(B){alert(B instanceof Error?B.message:"发起归集失败")}finally{g(!1)}},K=async C=>{try{const B=await fetch(`/api/v1/user-wallets/admin/user/${C}/allocate`,{method:"POST",headers:{Authorization:`Bearer ${t}`}});if(B.ok){const re=await B.json();if(re.success)alert(`成功为用户 ${C} 分配钱包`),await se();else throw new Error(re.message||"分配钱包失败")}else throw new Error("分配钱包失败")}catch(B){alert(B instanceof Error?B.message:"分配钱包失败")}},S=async C=>{try{const B=await fetch("/api/v1/user-wallets/consolidate",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({min_amount:1})});if(B.ok){const re=await B.json();if(re.success)alert(`成功发起用户 ${C} 的资金归集`),await se(),await R();else throw new Error(re.message||"发起归集失败")}else throw new Error("发起归集失败")}catch(B){alert(B instanceof Error?B.message:"发起归集失败")}},U=C=>C?new Date(C).toLocaleString("zh-CN"):"无",V=Math.ceil(A/E);return d?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(Pt,{size:"lg"})}):u?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-600 text-lg mb-4",children:["⚠️ ",u]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"重新加载"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-green-600 to-green-700 flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 113 0m-3 0V2.25"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"用户钱包管理中心"}),e.jsx("p",{className:"text-sm text-gray-600",children:"用户钱包统计、资金归集和管理系统"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-4 py-2 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("span",{className:"text-green-700 text-sm font-semibold",children:(le=r==null?void 0:r.username)==null?void 0:le.charAt(0).toUpperCase()})}),e.jsxs("span",{className:"text-sm font-medium text-green-700",children:["管理员: ",r==null?void 0:r.username]})]}),e.jsxs("button",{onClick:()=>s("/admin"),className:"px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{children:"返回控制台"})]})]})]})})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"px-6",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"dashboard",name:"概览面板",icon:"📊"},{id:"users",name:"用户钱包",icon:"💰"},{id:"consolidation",name:"资金归集",icon:"⚡"},{id:"analytics",name:"数据分析",icon:"📈"}].map(C=>e.jsxs("button",{onClick:()=>f(C.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${p===C.id?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("span",{className:"mr-2",children:C.icon}),C.name]},C.id))})})}),e.jsxs("div",{className:"p-6",children:[p==="dashboard"&&a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 113 0m-3 0V2.25"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.summary.total_users})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"注册用户"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["已分配钱包 ",a.summary.total_user_wallets," 个"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.summary.funded_wallets})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"有资金钱包"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["占比 ",a.summary.total_user_wallets>0?(a.summary.funded_wallets/a.summary.total_user_wallets*100).toFixed(1):0,"%"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:Number(a.summary.total_user_balance).toFixed(2)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"用户总余额"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"USDT"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9"})})}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.summary.networks_count})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-900 font-semibold mb-1",children:"支持网络"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"多网络支持"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"网络分布统计"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:a.network_distribution.map(C=>e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-lg text-gray-900",children:C.network}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:C.wallet_count}),e.jsx("p",{className:"text-sm text-gray-600",children:"钱包数量"}),e.jsxs("p",{className:"text-lg font-semibold text-green-600 mt-2",children:[Number(C.total_balance).toFixed(2)," USDT"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"总余额"})]},C.network))})]}),i&&e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"资金归集统计"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"可归集钱包"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:i.total_wallets_with_funds}),e.jsx("p",{className:"text-sm text-gray-600",children:"个钱包有资金"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"可归集金额"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:Number(i.total_consolidatable_amount).toFixed(2)}),e.jsx("p",{className:"text-sm text-gray-600",children:"USDT"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"今日归集"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:i.completed_consolidations_today}),e.jsx("p",{className:"text-sm text-gray-600",children:"次归集操作"})]})]})]})]}),p==="users"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["用户钱包列表 (共 ",A," 个用户)"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"用户信息"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"钱包统计"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"钱包地址"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(C=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[C.username," (ID: ",C.user_id,")"]}),e.jsx("div",{className:"text-sm text-gray-500",children:C.email})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:["钱包数: ",C.wallet_count]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["总余额: ",C.total_balance.toFixed(2)," USDT"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["创建时间: ",U(C.last_wallet_created)]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"space-y-2",children:C.wallets&&Object.entries(C.wallets).map(([B,re])=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded bg-gray-100 text-gray-700",children:B}),e.jsxs("span",{className:"font-mono text-xs text-gray-600",children:[re.address.substring(0,8),"...",re.address.substring(re.address.length-6)]})]}),e.jsxs("div",{className:"text-xs text-gray-500 ml-2",children:["余额: ",re.balance.toFixed(2)," USDT"]})]},B))})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex space-x-2",children:[C.wallet_count===0&&e.jsx("button",{onClick:()=>K(C.user_id),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"分配钱包"}),C.total_balance>0&&e.jsx("button",{onClick:()=>S(C.user_id),className:"text-green-600 hover:text-green-800 text-sm font-medium",children:"归集资金"})]})})]},C.user_id))})]})}),V>1&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["显示第 ",(v-1)*E+1," 到"," ",Math.min(v*E,A)," 个，共 ",A," 个用户"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>P(Math.max(1,v-1)),disabled:v===1,className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-200",children:"上一页"}),e.jsxs("span",{className:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded",children:["第 ",v," / ",V," 页"]}),e.jsx("button",{onClick:()=>P(Math.min(V,v+1)),disabled:v===V,className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-200",children:"下一页"})]})]})})]})}),p==="consolidation"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"⚡"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"资金归集控制"}),e.jsx("p",{className:"text-gray-600",children:"自动扫描用户钱包并归集资金到主钱包"})]})]}),e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["最小归集金额 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",min:"0.1",max:"10000",step:"0.1",value:x.min_amount,onChange:C=>y(B=>({...B,min_amount:parseFloat(C.target.value)})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"最小归集金额 (USDT)",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"网络类型筛选"}),e.jsxs("select",{value:x.network,onChange:C=>y(B=>({...B,network:C.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"所有网络"}),e.jsx("option",{value:"TRC20",children:"TRC20 (Tron)"}),e.jsx("option",{value:"ERC20",children:"ERC20 (Ethereum)"}),e.jsx("option",{value:"BEP20",children:"BEP20 (Binance Smart Chain)"})]})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-400 mt-0.5 mr-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"归集说明"}),e.jsx("div",{className:"mt-2 text-sm text-blue-700",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"系统将自动扫描所有用户钱包的资金情况"}),e.jsx("li",{children:"只有达到最小金额阈值的钱包才会被归集"}),e.jsx("li",{children:"归集过程中会自动预留手续费"}),e.jsx("li",{children:"归集任务将在后台异步执行"}),e.jsx("li",{children:"单次最多执行10个归集任务"})]})})]})]})}),e.jsx("button",{type:"submit",disabled:m,className:"w-full px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 font-medium",children:m?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})}),e.jsx("span",{children:"扫描并执行归集中..."})]}):"开始资金归集"})]})]}),i&&e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"归集规则配置"}),e.jsx("div",{className:"space-y-4",children:Object.entries(i.network_breakdown).map(([C,B])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:[C," 网络"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[B.wallets_count," 个钱包有资金"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"总余额:"}),e.jsxs("span",{className:"font-medium ml-1",children:[Number(B.total_balance).toFixed(2)," USDT"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"归集阈值:"}),e.jsxs("span",{className:"font-medium ml-1",children:[Number(B.consolidation_threshold).toFixed(2)," USDT"]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("span",{className:"text-gray-600",children:"主钱包:"}),e.jsx("span",{className:"font-mono text-xs ml-1",children:B.master_wallet||"未配置"})]})]})]},C))})]})]})]})]})},bh=()=>{var Je;const s=ot(),{token:t,user:r}=et(),[a,n]=b.useState(null),[i,l]=b.useState(!0),[o,c]=b.useState(null),[d,h]=b.useState("overview"),[u,j]=b.useState("kline"),[p,f]=b.useState("spot"),[x,y]=b.useState(""),[m,g]=b.useState(["BTC/USDT"]),[v,P]=b.useState([]),[E,A]=b.useState(!1),[T,k]=b.useState(()=>{try{return new Date(Date.now()-7*24*60*60*1e3).toISOString().substring(0,10)}catch{return"2025-08-24"}}),[R,se]=b.useState(()=>{try{return new Date().toISOString().substring(0,10)}catch{return"2025-08-31"}}),[z,K]=b.useState([]),[S,U]=b.useState(null),[V,le]=b.useState(null),[C,B]=b.useState(!1),[re,_]=b.useState(null),[H,xe]=b.useState([]),[_e,$e]=b.useState(!1),pe=($,ye)=>$==="spot"?ye==="tick"?["BTC","ETH","LTC","XRP","BCH","SOL","ADA","AVAX","MATIC","DOGE"]:["BTC/USDT","ETH/USDT","SOL/USDT","ADA/USDT","DOT/USDT","LINK/USDT","MATIC/USDT","AVAX/USDT","XRP/USDT","DOGE/USDT"]:ye==="tick"?["BTC","ETH","LTC","XRP","BCH","SOL","ADA","AVAX"]:["BTC-USDT-SWAP","ETH-USDT-SWAP","SOL-USDT-SWAP","ADA-USDT-SWAP","DOT-USDT-SWAP","LINK-USDT-SWAP"],X=["1m","5m","15m","30m","1h","2h","4h","1d","1w"];b.useEffect(()=>{if(!t||!r){s("/login");return}if(r.membership_level!=="professional"){c("需要专业版权限才能访问数据管理中心"),l(!1);return}},[t,r,s]);const W=async()=>{try{const $=await fetch("/api/v1/data/storage/stats",{headers:{Authorization:`Bearer ${t}`}});if(!$.ok)throw new Error(`HTTP ${$.status}: ${$.statusText}`);const ye=await $.json();if(ye.success)n(ye.data);else throw new Error(ye.detail||"数据获取失败");l(!1)}catch($){console.error("获取数据统计失败:",$),c($ instanceof Error?$.message:"数据获取失败"),l(!1)}},ne=async()=>{try{const ye=await(await fetch("/api/v1/data/okx/statistics",{headers:{Authorization:`Bearer ${t}`}})).json();ye.success&&le(ye.data)}catch($){console.error("获取OKX统计失败:",$)}},L=async()=>{B(!0);try{const ye=await fetch("/api/v1/data/query?data_type=kline&exchange=okx&symbol=BTC-USDT-SWAP",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!ye.ok)throw new Error(`数据查询失败: ${ye.status}`);const De=await ye.json();if(De.success&&De.data.query_result){const ie=De.data.query_result.map(he=>({exchange:"OKX",symbol:he.symbol,timeframe:he.timeframe,record_count:he.record_count,earliest_date:he.start_date,latest_date:he.end_date,timeframes_count:1}));K(ie)}else K([])}catch($){console.error("获取数据可用性失败:",$),K([])}finally{B(!1)}},ae=async()=>{try{const ye=await(await fetch("/api/v1/data/okx/tasks",{headers:{Authorization:`Bearer ${t}`}})).json();ye.success&&Array.isArray(ye.data)?P(ye.data):(console.warn("OKX tasks data is not an array:",ye.data),P([]))}catch($){console.error("获取OKX任务列表失败:",$)}},ge=async()=>{if(!Array.isArray(m)||m.length===0){alert("请选择至少一个交易对");return}A(!0);try{const $=u==="tick"?"/api/v1/data/okx/tick/download":"/api/v1/data/okx/kline/download",ye=ke=>{try{return typeof ke!="string"||!ke?new Date().toISOString().substring(0,10).replace(/-/g,""):ke.replace(/-/g,"")}catch(N){return console.error("Date formatting error:",N),"20250831"}},De=u==="tick"?{symbols:m.filter(ke=>typeof ke=="string"&&ke.length>0),start_date:ye(T),end_date:ye(R)}:{symbols:m.filter(ke=>typeof ke=="string"&&ke.length>0),timeframes:X,start_date:ye(T),end_date:ye(R)},he=await(await fetch($,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(De)})).json();if(he.success)alert(`OKX ${u==="tick"?"Tick":"K线"}数据下载任务已启动！任务ID: ${he.data.task_id}`),await ae();else throw new Error(he.detail||"下载启动失败")}catch($){alert($ instanceof Error?$.message:"OKX下载启动失败")}finally{A(!1)}},fe=async()=>{$e(!0);try{const $=["BTC/USDT","ETH/USDT","SOL/USDT"],ye=["1h","1d"],ie=[];let he=[];for(const M of $)for(const I of ye)ie.push(fetch(`/api/v1/data/quality/check/okx/${M}/${I}?check_days=7`,{headers:{Authorization:`Bearer ${t}`}}).then(G=>G.json()).then(G=>G.success&&G.data?(G.data.missing_periods&&G.data.missing_periods.length>0&&G.data.missing_periods.forEach(q=>{he.push({symbol:M,data_type:"K线",timeframe:I,missing_period:q.period||q,missing_count:q.count||0,severity:q.count>100?"critical":"warning"})}),G.data):null).catch(()=>null));const N=(await Promise.all(ie)).filter(M=>M!==null);if(N.length>0){const M=N.length,I=N.filter(q=>q.completeness_percent>=95).length,G=M>0?I/M*100:0;_({completeness:{kline_completeness:G,tick_completeness:0,missing_dates:[]},accuracy:{price_anomalies:N.reduce((q,Z)=>{var ce;return q+(((ce=Z.anomalies)==null?void 0:ce.price_anomalies)||0)},0),volume_anomalies:N.reduce((q,Z)=>{var ce;return q+(((ce=Z.anomalies)==null?void 0:ce.volume_anomalies)||0)},0)}})}else _({completeness:{kline_completeness:0,tick_completeness:0,missing_dates:[]},accuracy:{price_anomalies:0,volume_anomalies:0}});xe(he)}catch($){console.error("质量检查失败:",$),alert("质量检查失败: "+($ instanceof Error?$.message:"未知错误"))}finally{$e(!1)}};return b.useEffect(()=>{d==="overview"&&t&&(ne(),L())},[d,t]),b.useEffect(()=>{t&&r&&(W(),ae())},[t,r]),b.useEffect(()=>{if(d==="okx-download"){const $=setInterval(ae,3e3);return()=>clearInterval($)}},[d,t]),i?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(Pt,{size:"lg"})}):o?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-600 text-lg mb-4",children:["⚠️ ",o]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"重新加载"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"数据管理中心"}),e.jsx("p",{className:"text-sm text-gray-600",children:"完全集成后端API的数据管理系统"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-4 py-2 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-blue-700 text-sm font-semibold",children:(Je=r==null?void 0:r.username)==null?void 0:Je.charAt(0).toUpperCase()})}),e.jsxs("span",{className:"text-sm font-medium text-blue-700",children:["管理员: ",r==null?void 0:r.username]})]}),e.jsxs("button",{onClick:()=>s("/admin"),className:"px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-all duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{children:"返回控制台"})]})]})]})})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"px-6",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"overview",name:"数据概览",icon:"📊"},{id:"okx-download",name:"OKX数据下载",icon:"🚀"},{id:"quality",name:"质量监控",icon:"🔍"}].map($=>e.jsxs("button",{onClick:()=>h($.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${d===$.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("span",{className:"mr-2",children:$.icon}),$.name]},$.id))})})}),e.jsxs("div",{className:"p-6",children:[d==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"真实API数据统计概览"}),e.jsxs("button",{onClick:()=>{W(),ne(),L()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{children:"刷新数据"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"数据库真实数据概览"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"显示我们后台现有的所有数据，按交易所、数据类型、市场类型分组"}),C?e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"ml-2 text-gray-600",children:"加载数据中..."})]}):e.jsxs("div",{className:"space-y-6",children:[V&&e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"OKX"})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"OKX 交易所数据统计"})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4",children:[e.jsx("h5",{className:"font-semibold text-gray-800 mb-3",children:"📊 下载统计"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:V.download_statistics.total_downloads}),e.jsx("div",{className:"text-sm text-gray-600",children:"总下载次数"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:V.download_statistics.successful_downloads}),e.jsx("div",{className:"text-sm text-gray-600",children:"成功下载"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:V.download_statistics.failed_downloads}),e.jsx("div",{className:"text-sm text-gray-600",children:"失败次数"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:V.download_statistics.total_files_processed}),e.jsx("div",{className:"text-sm text-gray-600",children:"处理文件数"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[(V.download_statistics.total_records_downloaded/1e6).toFixed(1),"M"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"下载记录数"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:"📈 K线数据支持的交易对"}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"mb-1",children:["总计: ",e.jsxs("span",{className:"font-medium text-blue-700",children:[V.supported_symbols.kline_data.length,"个"]})]}),e.jsxs("div",{className:"text-gray-600 max-h-20 overflow-y-auto",children:[V.supported_symbols.kline_data.slice(0,10).join(", "),V.supported_symbols.kline_data.length>10&&"..."]})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h5",{className:"font-semibold text-green-800 mb-2",children:"⚡ Tick数据支持的交易对"}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"mb-1",children:["总计: ",e.jsxs("span",{className:"font-medium text-green-700",children:[V.supported_symbols.tick_data.length,"个"]})]}),e.jsxs("div",{className:"text-gray-600 max-h-20 overflow-y-auto",children:[V.supported_symbols.tick_data.slice(0,10).join(", "),V.supported_symbols.tick_data.length>10&&"..."]})]})]})]}),e.jsxs("div",{className:"mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h5",{className:"font-semibold text-yellow-800 mb-2",children:"⏰ 支持的时间框架"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:V.supported_timeframes.map($=>e.jsx("span",{className:"px-2 py-1 bg-yellow-200 text-yellow-800 rounded text-sm font-medium",children:$},$))})]})]}),!V&&!C&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📊"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"数据统计信息"}),e.jsx("p",{className:"text-gray-600 mb-4",children:'请点击上方"刷新数据"按钮加载最新数据'})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"🔍 数据查询工具"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"查询数据库中的真实数据情况，了解具体的数据日期范围"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"数据类型"}),e.jsxs("select",{value:u,onChange:$=>j($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"kline",children:"K线数据"}),e.jsx("option",{value:"tick",children:"Tick数据"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"市场类型"}),e.jsxs("select",{value:p,onChange:$=>f($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"spot",children:"现货市场"}),e.jsx("option",{value:"futures",children:"合约市场"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"交易对"}),e.jsxs("select",{value:m[0]||"",onChange:$=>g($.target.value?[$.target.value]:[]),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"全部"}),pe(p,u).map($=>e.jsx("option",{value:$,children:$},$))]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsxs("button",{onClick:async()=>{B(!0);try{const $=m[0]||null,ye=$?`/api/v1/data/query?data_type=${u}&exchange=okx&symbol=${encodeURIComponent($)}`:`/api/v1/data/query?data_type=${u}&exchange=okx`,De=localStorage.getItem("auth-storage"),ie=De?JSON.parse(De).state.token:null;if(!ie)throw new Error("未找到认证令牌，请重新登录");const he=await fetch(ye,{headers:{Authorization:`Bearer ${ie}`,"Content-Type":"application/json"}});if(!he.ok)throw new Error(`HTTP错误: ${he.status}`);const ke=await he.json();ke.success?(K(ke.data.query_result||[]),U(ke.data.summary||null)):console.error("查询失败:",ke)}catch($){console.error("查询数据失败:",$)}finally{B(!1)}},disabled:C,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("span",{children:"查询数据"})]}),e.jsx("button",{onClick:()=>{K([])},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:"清除结果"})]}),C&&e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"ml-2 text-gray-600",children:"查询中..."})]}),z.length>0&&!C&&e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"📊 查询结果"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:z.map(($,ye)=>e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h5",{className:"font-semibold text-gray-800",children:$.symbol}),$.timeframe&&e.jsx("span",{className:"text-sm text-blue-600 bg-blue-100 px-2 py-1 rounded",children:$.timeframe})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[$.start_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"开始日期:"}),e.jsx("span",{className:"font-medium",children:new Date($.start_date).toLocaleDateString()})]}),$.end_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"结束日期:"}),e.jsx("span",{className:"font-medium",children:new Date($.end_date).toLocaleDateString()})]}),$.record_count&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"记录数:"}),e.jsx("span",{className:"font-medium text-blue-600",children:$.record_count.toLocaleString()})]}),$.total_records&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"总记录:"}),e.jsx("span",{className:"font-medium text-green-600",children:$.total_records.toLocaleString()})]}),$.timeframes_count&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"时间框架数:"}),e.jsx("span",{className:"font-medium text-purple-600",children:$.timeframes_count})]}),$.earliest_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"最早数据:"}),e.jsx("span",{className:"font-medium",children:new Date($.earliest_date).toLocaleDateString()})]}),$.latest_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"最新数据:"}),e.jsx("span",{className:"font-medium",children:new Date($.latest_date).toLocaleDateString()})]})]})]},ye))})]}),S&&!C&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-lg p-6 mt-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"📈 数据统计摘要"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[S.total_records&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:S.total_records.toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-600",children:"总记录数"})]}),S.data_completeness_percent!==void 0&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-2xl font-bold ${S.data_completeness_percent>=95?"text-green-600":"text-yellow-600"}`,children:[S.data_completeness_percent,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"数据完整度"})]}),S.timeframes_available&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:S.timeframes_available}),e.jsx("div",{className:"text-sm text-gray-600",children:"时间框架"})]}),S.days_span&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:S.days_span}),e.jsx("div",{className:"text-sm text-gray-600",children:"天数跨度"})]}),S.earliest_date&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800",children:new Date(S.earliest_date).toLocaleDateString()}),e.jsx("div",{className:"text-sm text-gray-600",children:"最早日期"})]}),S.latest_date&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800",children:new Date(S.latest_date).toLocaleDateString()}),e.jsx("div",{className:"text-sm text-gray-600",children:"最新日期"})]})]})]}),!C&&z.length===0&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📊"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"暂无查询结果"}),e.jsx("p",{className:"text-gray-600",children:'请点击"查询数据"按钮来查看数据库中的真实数据情况'})]})]})]}),d==="okx-download"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"OKX 数据下载中心"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"数据类型"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>j("kline"),className:`px-6 py-3 rounded-lg font-medium transition-all duration-200 ${u==="kline"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"📈 K线数据"}),e.jsx("button",{onClick:()=>j("tick"),className:`px-6 py-3 rounded-lg font-medium transition-all duration-200 ${u==="tick"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"⚡ Tick数据"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"市场类型"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>f("spot"),className:`px-6 py-3 rounded-lg font-medium transition-all duration-200 ${p==="spot"?"bg-green-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"💰 现货市场"}),e.jsx("button",{onClick:()=>f("futures"),className:`px-6 py-3 rounded-lg font-medium transition-all duration-200 ${p==="futures"?"bg-orange-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"📈 合约市场 (永续)"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"交易对选择"}),e.jsx("button",{onClick:()=>{try{const $=pe(p,u);Array.isArray($)&&g($)}catch($){console.error("Error selecting all symbols:",$),g([])}},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"全选所有"})]}),e.jsx("div",{className:"grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-2 mb-4",children:pe(p,u).map($=>e.jsxs("label",{className:"flex items-center space-x-2 p-2 border rounded cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:Array.isArray(m)&&m.includes($),onChange:ye=>{if(!Array.isArray(m)){g([]);return}ye.target.checked?g([...m,$]):g(m.filter(De=>De!==$))},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:$})]},$))}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:x,onChange:$=>y($.target.value),placeholder:p==="spot"?u==="tick"?"输入现货Tick交易对 (如: DOGE)":"输入现货K线交易对 (如: DOGE/USDT)":u==="tick"?"输入合约Tick交易对 (如: DOGE)":"输入合约K线交易对 (如: DOGE-USDT-SWAP)",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:()=>{x&&x.trim()&&Array.isArray(m)&&!m.includes(x.trim())&&(g([...m,x.trim()]),y(""))},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"添加"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["已选择 ",Array.isArray(m)?m.length:0," 个交易对："]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.isArray(m)&&m.map($=>e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm flex items-center space-x-1",children:[e.jsx("span",{children:$}),e.jsx("button",{onClick:()=>{Array.isArray(m)&&g(m.filter(ye=>ye!==$))},className:"text-blue-600 hover:text-blue-800",children:"×"})]},$))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"时间范围选择"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"开始日期"}),e.jsx("input",{type:"date",value:T,onChange:$=>k($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"结束日期"}),e.jsx("input",{type:"date",value:R,onChange:$=>se($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["选择的时间范围: ",T," 到 ",R]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{const $=new Date(Date.now()-6048e5).toISOString().substring(0,10),ye=new Date().toISOString().substring(0,10);k($),se(ye)},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200 transition-colors",children:"最近7天"}),e.jsx("button",{onClick:()=>{const $=new Date(Date.now()-2592e6).toISOString().substring(0,10),ye=new Date().toISOString().substring(0,10);k($),se(ye)},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200 transition-colors",children:"最近30天"}),e.jsx("button",{onClick:()=>{const $=new Date(Date.now()-7776e6).toISOString().substring(0,10),ye=new Date().toISOString().substring(0,10);k($),se(ye)},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200 transition-colors",children:"最近3个月"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2 text-gray-900",children:"时间框架 (自动全选)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:X.map($=>e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:["✓ ",$]},$))}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"所有时间框架将自动下载，无需手动选择"})]}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx("button",{onClick:ge,disabled:E||!Array.isArray(m)||m.length===0,className:`px-8 py-3 rounded-lg font-semibold transition-all duration-200 ${E||!Array.isArray(m)||m.length===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 shadow-lg hover:shadow-xl"}`,children:E?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white inline",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"正在启动下载..."]}):e.jsxs(e.Fragment,{children:["🚀 开始下载 ",u==="tick"?"Tick":"K线","数据 (",Array.isArray(m)?m.length:0," 个交易对)"]})})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold",children:"下载任务列表"})}),e.jsx("div",{className:"p-6",children:!Array.isArray(v)||v.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"暂无下载任务"}):e.jsx("div",{className:"space-y-4",children:Array.isArray(v)&&v.slice(0,5).map($=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${$.status==="completed"?"bg-green-500":$.status==="running"?"bg-blue-500":$.status==="failed"?"bg-red-500":"bg-gray-400"}`}),e.jsxs("span",{className:"font-medium",children:[$.data_type.toUpperCase()," - ",$.symbols.join(", ")]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${$.status==="completed"?"bg-green-100 text-green-800":$.status==="running"?"bg-blue-100 text-blue-800":$.status==="failed"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:$.status})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${$.progress}%`}})}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[$.progress,"% - ",$.processed_files,"/",$.total_files," 文件"]})]},$.task_id))})})]})]}),d==="quality"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"数据完整性检测 (真实API)"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:fe,disabled:_e,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400",children:"🔍 开始检测"}),e.jsx("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"📊 生成报告"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"使用真实API检测数据完整性，精确定位每个缺失时段"})]}),re&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"K线数据完整性"}),e.jsx("div",{className:"w-16 h-16 rounded-full bg-green-100 flex items-center justify-center",children:e.jsxs("span",{className:"text-lg font-bold text-green-600",children:[re.completeness.kline_completeness.toFixed(1),"%"]})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"检查结果:"}),e.jsx("span",{className:"font-medium",children:"真实API数据"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"完整性:"}),e.jsxs("span",{className:"font-medium",children:[re.completeness.kline_completeness.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600",children:"异常数据:"}),e.jsxs("span",{className:"font-medium text-red-600",children:[re.accuracy.price_anomalies," 处"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Tick数据完整性"}),e.jsx("div",{className:"w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[re.completeness.tick_completeness.toFixed(1),"%"]})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"检查结果:"}),e.jsx("span",{className:"font-medium",children:"待实现"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"完整性:"}),e.jsxs("span",{className:"font-medium",children:[re.completeness.tick_completeness.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600",children:"成交量异常:"}),e.jsxs("span",{className:"font-medium text-red-600",children:[re.accuracy.volume_anomalies," 处"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"数据异常检测"}),e.jsx("div",{className:"w-16 h-16 rounded-full bg-yellow-100 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"⚠️"})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"价格异常:"}),e.jsxs("span",{className:"font-medium text-yellow-600",children:[re.accuracy.price_anomalies," 处"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"成交量异常:"}),e.jsxs("span",{className:"font-medium text-yellow-600",children:[re.accuracy.volume_anomalies," 处"]})]})]})]})]}),H.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"详细缺失分析 (真实API数据)"}),e.jsx("p",{className:"text-sm text-gray-600",children:"基于真实API检测结果，精确定位每个缺失时段"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"交易对"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"数据类型"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"时间框架"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"缺失时段"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"缺失数量"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"严重程度"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"操作"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:H.map(($,ye)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:$.symbol}),e.jsx("td",{className:"px-4 py-3 text-sm",children:$.data_type}),e.jsx("td",{className:"px-4 py-3 text-sm",children:$.timeframe}),e.jsx("td",{className:"px-4 py-3 text-sm",children:$.missing_period}),e.jsx("td",{className:"px-4 py-3 text-sm text-red-600",children:$.missing_count===0?"全时段":`${$.missing_count}条`}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded ${$.severity==="critical"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:$.severity==="critical"?"Critical":"Warning"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"补全下载"})})]},ye))})]})})})]}),!re&&!_e&&e.jsxs("div",{className:"bg-white rounded-xl p-12 shadow-sm border text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"数据质量检测 (真实API)"}),e.jsx("p",{className:"text-gray-600 mb-4",children:'点击"开始检测"按钮运行真实API数据完整性分析'}),e.jsx("button",{onClick:fe,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"🚀 开始质量检测"})]}),_e&&e.jsxs("div",{className:"bg-white rounded-xl p-12 shadow-sm border text-center",children:[e.jsx("div",{className:"flex justify-center items-center mb-4",children:e.jsxs("svg",{className:"animate-spin h-12 w-12 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"正在执行质量检测..."}),e.jsx("p",{className:"text-gray-600",children:"调用真实API检测数据完整性，请稍候"})]})]})]})]})},vh=()=>e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"w-24 h-24 mx-auto bg-gray-200 rounded-full flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-4xl",children:"🔍"})}),e.jsx("h1",{className:"text-6xl font-bold text-gray-900 mb-4",children:"404"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-700 mb-2",children:"页面未找到"}),e.jsx("p",{className:"text-gray-500 mb-8",children:"抱歉，您访问的页面不存在或已被移动"})]}),e.jsxs("div",{className:"space-x-4",children:[e.jsx(Ge,{to:"/",children:e.jsx(ys,{children:"返回首页"})}),e.jsx(Ge,{to:"/overview",children:e.jsx(ys,{variant:"outline",children:"前往概览页"})})]})]})}),Nt=({children:s})=>{var f;const t=Oa(),{user:r,logout:a}=et(),{theme:n,toggleTheme:i}=Xr(),{language:l,setLanguage:o,t:c}=Wt(),d=[{path:"/ai-chat",label:"AI助手",key:"ai-chat"},{path:"/trading",label:c("chartTrading"),key:"trading"},{path:"/strategies",label:c("liveTrading"),key:"strategies"},{path:"/backtest",label:c("backtest"),key:"backtest"},{path:"/trading-notes",label:c("tradingNotes"),key:"trading-notes"},{path:"/profile",label:c("accountCenter"),key:"profile"}],h=x=>x==="/ai-chat"?t.pathname==="/ai-chat":x==="/trading"?t.pathname==="/trading":t.pathname.startsWith(x),u=()=>{a(),window.location.href="/login"},j=x=>{o(x)},p=()=>{i()};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:e.jsxs("div",{className:"max-w-[1440px] mx-auto bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden relative transition-colors",children:[e.jsxs("header",{className:"py-4 px-8 flex justify-between border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-7 h-7 rounded-full bg-brand-500 flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"T"})}),e.jsx("h1",{className:"text-xl font-bold text-brand-500 dark:text-brand-400",children:"Trademe"})]}),e.jsx("nav",{className:"flex gap-2",children:d.map(x=>e.jsx(Ge,{to:x.path,className:`nav-item ${h(x.path)?"active":""}`,children:x.label},x.key))}),e.jsxs("div",{className:"flex items-center relative group",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-gray-200 overflow-hidden cursor-pointer",children:r!=null&&r.avatar_url?e.jsx("img",{src:r.avatar_url,alt:"User avatar",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-brand-100 text-brand-600 font-medium",children:((f=r==null?void 0:r.username)==null?void 0:f.charAt(0).toUpperCase())||"U"})}),e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50",children:[e.jsxs("div",{className:"px-4 py-2 border-b border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:r==null?void 0:r.username}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:r==null?void 0:r.email}),e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200 mt-1",children:[(r==null?void 0:r.membership_level)==="basic"&&"基础版",(r==null?void 0:r.membership_level)==="premium"&&"高级版",(r==null?void 0:r.membership_level)==="professional"&&"专业版"]})]}),e.jsx(Ge,{to:"/profile",className:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:c("settings")}),e.jsx(Ge,{to:"/profile/membership",className:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:c("membershipManagement")}),e.jsx("button",{onClick:u,className:"block w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:c("logout")})]})]})]}),e.jsxs("div",{className:"absolute top-4 right-8 flex items-center space-x-4 z-40",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>j("zh"),className:`px-2 py-1 text-sm rounded-md transition-colors ${l==="zh"?"bg-blue-100 text-blue-700 dark:bg-blue-800 dark:text-blue-200":"bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-300"}`,children:"中"}),e.jsx("button",{onClick:()=>j("en"),className:`px-2 py-1 text-sm rounded-md transition-colors ${l==="en"?"bg-blue-100 text-blue-700 dark:bg-blue-800 dark:text-blue-200":"bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-300"}`,children:"EN"})]}),e.jsx("div",{className:"border-l border-gray-300 dark:border-gray-600 h-6"}),e.jsx("button",{onClick:p,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:c(n==="light"?"darkMode":"lightMode"),children:n==="light"?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]}),e.jsx("main",{className:"p-8",children:s})]})})},jh=({children:s})=>e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[e.jsx("header",{className:"py-6 px-8 flex justify-center border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-brand-500 flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-white font-bold",children:"T"})}),e.jsx("h1",{className:"text-2xl font-bold text-brand-500",children:"Trademe"})]})}),e.jsxs("div",{className:"absolute top-4 right-4 flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"lang-toggle px-2 py-1 text-sm rounded-md bg-gray-100 hover:bg-gray-200","data-lang":"zh",children:"中"}),e.jsx("button",{className:"lang-toggle px-2 py-1 text-sm rounded-md hover:bg-gray-200","data-lang":"en",children:"EN"})]}),e.jsx("div",{className:"border-l border-gray-300 h-6"}),e.jsx("button",{id:"theme-toggle",className:"p-2 rounded-full hover:bg-gray-200",title:"切换主题",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.166a.75.75 0 00-1.06-1.06l-1.591 1.59a.75.75 0 101.06 1.061l1.591-1.59zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.834 18.894a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 10-1.061 1.06l1.59 1.591zM12 18a.75.75 0 01.75.75V21a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM7.758 17.303a.75.75 0 00-1.061-1.06l-1.591 1.59a.75.75 0 001.06 1.061l1.591-1.59zM6 12a.75.75 0 01-.75.75H3a.75.75 0 010-1.5h2.25A.75.75 0 016 12zM6.697 7.757a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 00-1.061 1.06l1.59 1.591z"})})})]}),e.jsx("main",{className:"p-8",children:s}),e.jsx("footer",{className:"px-8 pb-6 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"© 2024 Trademe. 专业的数字货币策略交易平台"})})]})});function wh(){const{isLoading:s,checkAuth:t,token:r,isAuthenticated:a}=et(),{theme:n}=Xr();return b.useEffect(()=>{r&&!a&&t()},[t,r,a]),b.useEffect(()=>{n==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[n]),s?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 transition-colors",children:e.jsx(Pt,{size:"lg"})}):e.jsx(h0,{clientId:"832153922895-6hc3h1qsb72td6gd8lq9vcajq3rborpj.apps.googleusercontent.com",children:e.jsxs(El,{children:[e.jsx(Re,{path:"/login",element:e.jsx(ju,{})}),e.jsx(Re,{path:"/verification",element:e.jsx(jh,{children:e.jsx(wu,{})})}),e.jsx(Re,{path:"/",element:e.jsx(v0,{})}),e.jsx(Re,{path:"/overview",element:e.jsx(Ze,{children:e.jsx(Nt,{children:e.jsx(Eu,{})})})}),e.jsx(Re,{path:"/strategies",element:e.jsx(Ze,{children:e.jsx(Nt,{children:e.jsx(Pu,{})})})}),e.jsx(Re,{path:"/strategy/:strategyId/live",element:e.jsx(Ze,{children:e.jsx(Nt,{children:e.jsx($u,{})})})}),e.jsx(Re,{path:"/live-strategies",element:e.jsx(Ze,{children:e.jsx(Iu,{})})}),e.jsx(Re,{path:"/backtest",element:e.jsx(Ze,{children:e.jsx(Nt,{children:e.jsx(Ru,{})})})}),e.jsx(Re,{path:"/backtest/:id/details",element:e.jsx(Ze,{children:e.jsx(Nt,{children:e.jsx(Bu,{})})})}),e.jsx(Re,{path:"/trading",element:e.jsx(Ze,{children:e.jsx(lh,{})})}),e.jsx(Re,{path:"/ai-chat",element:e.jsx(Ze,{children:e.jsx(Nt,{children:e.jsx(uh,{})})})}),e.jsx(Re,{path:"/api-keys",element:e.jsx(Ze,{children:e.jsx(Nt,{children:e.jsx(ii,{})})})}),e.jsx(Re,{path:"/api-management",element:e.jsx(Ze,{children:e.jsx(Nt,{children:e.jsx(ii,{})})})}),e.jsx(Re,{path:"/trading-notes",element:e.jsx(Ze,{children:e.jsx(Nt,{children:e.jsx(mh,{})})})}),e.jsx(Re,{path:"/profile",element:e.jsx(Ze,{children:e.jsx(Nt,{children:e.jsx(xh,{})})})}),e.jsx(Re,{path:"/admin",element:e.jsx(Ze,{children:e.jsx(gh,{})})}),e.jsx(Re,{path:"/admin/users",element:e.jsx(Ze,{children:e.jsx(ph,{})})}),e.jsx(Re,{path:"/admin/claude",element:e.jsx(Ze,{children:e.jsx(fh,{})})}),e.jsx(Re,{path:"/admin/wallets",element:e.jsx(Ze,{children:e.jsx(yh,{})})}),e.jsx(Re,{path:"/admin/data",element:e.jsx(Ze,{children:e.jsx(bh,{})})}),e.jsx(Re,{path:"*",element:e.jsx(vh,{})})]})})}const Nh=new co({defaultOptions:{queries:{staleTime:5*60*1e3,retry:(s,t)=>{var r,a;return((r=t==null?void 0:t.response)==null?void 0:r.status)>=400&&((a=t==null?void 0:t.response)==null?void 0:a.status)<500?!1:s<3}},mutations:{retry:1}}});xa.createRoot(document.getElementById("root")).render(e.jsx(Ke.StrictMode,{children:e.jsxs(ho,{client:Nh,children:[e.jsxs(Pl,{children:[e.jsx(wh,{}),e.jsx(ec,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{iconTheme:{primary:"#22c55e",secondary:"#fff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]}),!1]})}));
//# sourceMappingURL=index-CToTMlqo.js.map
