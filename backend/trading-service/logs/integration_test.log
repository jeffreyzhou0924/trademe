2025-08-21 10:10:12.371 | INFO     | __main__:run_all_tests:40 - 🚀 开始实盘交易系统集成测试
2025-08-21 10:10:12.371 | INFO     | __main__:test_trading_service_basic:73 - 📊 测试交易服务基础功能...
2025-08-21 10:10:12.371 | INFO     | __main__:test_trading_service_basic:79 - ✅ 支持的交易所: ['binance', 'okx', 'bybit', 'huobi', 'bitget', 'coinbase']
2025-08-21 10:10:13.353 | INFO     | __main__:test_trading_service_basic:83 - ✅ binance 支持 2060 个交易对
2025-08-21 10:10:13.353 | INFO     | app.services.trading_service:get_order_statistics:427 - 获取用户 999 的订单统计 (30天)
2025-08-21 10:10:13.353 | INFO     | app.services.trading_service:get_order_statistics:448 - 订单统计: 0个订单, 0.0%成交率
2025-08-21 10:10:13.353 | INFO     | __main__:test_trading_service_basic:87 - ✅ 订单统计: 0 个订单
2025-08-21 10:10:13.354 | INFO     | __main__:test_live_trading_engine:97 - 🔧 测试实盘交易引擎...
2025-08-21 10:10:13.354 | INFO     | app.core.live_trading_engine:start_engine:137 - 启动实盘交易引擎...
2025-08-21 10:10:13.354 | INFO     | app.core.live_trading_engine:start_engine:145 - 实盘交易引擎启动成功
2025-08-21 10:10:13.354 | INFO     | __main__:test_live_trading_engine:102 - ✅ 交易引擎启动成功
2025-08-21 10:10:13.354 | INFO     | app.core.live_trading_engine:create_trading_session:222 - 创建交易会话: c566bd75-ffe0-4a1c-a550-19c25b4f7382, 用户: 999, 交易所: binance
2025-08-21 10:10:13.354 | INFO     | __main__:test_live_trading_engine:113 - ✅ 创建交易会话: c566bd75-ffe0-4a1c-a550-19c25b4f7382
2025-08-21 10:10:13.354 | ERROR    | __main__:test_live_trading_engine:127 - ❌ 实盘交易引擎测试失败: 应该有至少一个活跃会话
2025-08-21 10:10:13.354 | INFO     | __main__:test_order_manager:132 - 📋 测试订单管理系统...
2025-08-21 10:10:13.354 | INFO     | __main__:test_order_manager:137 - ✅ 活跃订单数量: 0
2025-08-21 10:10:13.354 | INFO     | __main__:test_order_manager:141 - ✅ 历史订单数量: 0
2025-08-21 10:10:13.354 | INFO     | __main__:test_order_manager:145 - ✅ 订单统计: {'period_days': 30, 'active_orders_count': 0, 'total_orders': 0, 'filled_orders': 0, 'canceled_orders': 0, 'failed_orders': 0, 'fill_rate': 0, 'total_volume': 0, 'total_fees': 0, 'symbols_traded': [], 'exchanges_used': [], 'avg_order_size': 0}
2025-08-21 10:10:13.354 | INFO     | __main__:test_risk_manager:155 - 🛡️ 测试风险管理机制...
2025-08-21 10:10:13.354 | INFO     | app.core.risk_manager:validate_order:116 - 开始订单风险验证: 用户999, BTC/USDT, buy, 数量0.001
2025-08-21 10:10:13.355 | ERROR    | app.core.risk_manager:_check_daily_loss_limit:351 - 日损失检查失败: 'NoneType' object has no attribute 'execute'
2025-08-21 10:10:13.355 | ERROR    | app.core.risk_manager:_check_position_limits:386 - 持仓限制检查失败: 'NoneType' object has no attribute 'execute'
2025-08-21 10:10:13.356 | ERROR    | app.core.risk_manager:_check_concentration_risk:428 - 集中度风险检查失败: 'NoneType' object has no attribute 'execute'
2025-08-21 10:10:13.356 | ERROR    | app.core.risk_manager:_calculate_optimal_position_size:464 - 仓位计算失败: float division by zero
2025-08-21 10:10:13.356 | INFO     | app.core.risk_manager:validate_order:188 - 订单风险评估完成: 批准=True, 风险等级=low, 评分=12.00
2025-08-21 10:10:13.356 | INFO     | __main__:test_risk_manager:177 - ✅ 风险评估: 批准=True, 风险等级=low
2025-08-21 10:10:13.356 | INFO     | __main__:test_trading_signals:191 - 📡 测试交易信号处理...
2025-08-21 10:10:13.356 | WARNING  | app.core.live_trading_engine:submit_trading_signal:295 - 用户 999 没有活跃的交易会话
2025-08-21 10:10:13.356 | INFO     | __main__:test_trading_signals:209 - ✅ 交易信号提交: False
2025-08-21 10:10:13.356 | INFO     | app.services.trading_service:submit_trading_signal:217 - 提交交易信号: BTC/USDT, SELL, 0.001
2025-08-21 10:10:13.356 | INFO     | app.services.trading_service:_ensure_trading_engine_started:42 - 实盘交易引擎已启动
2025-08-21 10:10:13.356 | WARNING  | app.core.live_trading_engine:submit_trading_signal:295 - 用户 999 没有活跃的交易会话
2025-08-21 10:10:13.356 | ERROR    | app.services.trading_service:submit_trading_signal:243 - 交易信号提交失败: BTC/USDT, SELL
2025-08-21 10:10:13.357 | INFO     | __main__:test_trading_signals:221 - ✅ 服务层信号提交: False
2025-08-21 10:10:13.357 | INFO     | __main__:test_integration_workflow:231 - 🔄 测试完整集成流程...
2025-08-21 10:10:13.357 | INFO     | __main__:test_integration_workflow:265 - ✅ 集成流程架构验证通过 (需要数据库连接进行完整测试)
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:294 - 
============================================================
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:295 - 📊 实盘交易系统集成测试结果汇总
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:296 - ============================================================
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:303 - trading_service_basic          ✅ 通过
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:303 - live_trading_engine            ❌ 失败
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:303 - order_manager                  ✅ 通过
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:303 - risk_manager                   ✅ 通过
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:303 - trading_signals                ✅ 通过
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:303 - integration_workflow           ✅ 通过
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:305 - ------------------------------------------------------------
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:306 - 总计测试: 6 个
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:307 - 通过测试: 5 个
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:308 - 失败测试: 1 个
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:309 - 通过率: 83.3%
2025-08-21 10:10:13.357 | WARNING  | __main__:print_test_results:314 - ⚠️  部分测试失败，请检查具体错误信息
2025-08-21 10:10:13.357 | INFO     | __main__:print_test_results:316 - ============================================================
2025-08-21 10:10:13.358 | INFO     | app.core.live_trading_engine:stop_engine:158 - 停止实盘交易引擎...
2025-08-21 10:10:13.358 | INFO     | app.core.live_trading_engine:stop_trading_session:275 - 交易会话已停止: c566bd75-ffe0-4a1c-a550-19c25b4f7382
2025-08-21 10:10:13.384 | INFO     | app.core.live_trading_engine:_monitoring_loop:684 - 交易引擎监控循环开始
2025-08-21 10:10:13.384 | INFO     | app.core.live_trading_engine:stop_engine:180 - 实盘交易引擎已停止
2025-08-21 10:10:13.384 | INFO     | __main__:cleanup:323 - 🧹 测试资源清理完成
2025-08-21 10:10:13.384 | INFO     | __main__:main:346 - 测试结束
