# Trademe æ•°å­—è´§å¸ç­–ç•¥äº¤æ˜“å¹³å° - å®Œæ•´å¼€å‘æ–‡æ¡£

## ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°ä¸æ¶æ„](#1-é¡¹ç›®æ¦‚è¿°ä¸æ¶æ„)
2. [æŠ€æœ¯æ ˆè¯¦è§£](#2-æŠ€æœ¯æ ˆè¯¦è§£)
3. [ç³»ç»Ÿæ¶æ„å›¾](#3-ç³»ç»Ÿæ¶æ„å›¾)
4. [æ•°æ®åº“è®¾è®¡](#4-æ•°æ®åº“è®¾è®¡)
5. [APIæ¥å£æ–‡æ¡£](#5-apiæ¥å£æ–‡æ¡£)
6. [å‰ç«¯ç»„ä»¶æ¶æ„](#6-å‰ç«¯ç»„ä»¶æ¶æ„)
7. [AIç³»ç»Ÿé›†æˆ](#7-aiç³»ç»Ÿé›†æˆ)
8. [åŒºå—é“¾æ”¯ä»˜ç³»ç»Ÿ](#8-åŒºå—é“¾æ”¯ä»˜ç³»ç»Ÿ)
9. [å¼€å‘ç¯å¢ƒæ­å»º](#9-å¼€å‘ç¯å¢ƒæ­å»º)
10. [éƒ¨ç½²æŒ‡å—](#10-éƒ¨ç½²æŒ‡å—)
11. [æ•…éšœæ’é™¤](#11-æ•…éšœæ’é™¤)
12. [å¼€å‘è§„èŒƒ](#12-å¼€å‘è§„èŒƒ)

---

## 1. é¡¹ç›®æ¦‚è¿°ä¸æ¶æ„

### 1.1 é¡¹ç›®ä»‹ç»

Trademeæ˜¯ä¸€ä¸ªä¼ä¸šçº§æ•°å­—è´§å¸ç­–ç•¥äº¤æ˜“å¹³å°ï¼Œé›†æˆäº†å…ˆè¿›çš„AIæŠ€æœ¯ã€åŒºå—é“¾æ”¯ä»˜ç³»ç»Ÿå’Œä¸“ä¸šçš„é‡åŒ–äº¤æ˜“åŠŸèƒ½ã€‚ç³»ç»Ÿé‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œå…·å¤‡é«˜å¯ç”¨æ€§ã€å¯æ‰©å±•æ€§å’Œå®‰å…¨æ€§ã€‚

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- ğŸ¤– Claude AIæ·±åº¦é›†æˆï¼Œæ™ºèƒ½ç­–ç•¥ç”Ÿæˆä¸ä¼˜åŒ–
- ğŸ“Š TradingViewçº§ä¸“ä¸šå›¾è¡¨ç³»ç»Ÿ
- ğŸ’° USDTå¤šç½‘ç»œåŒºå—é“¾æ”¯ä»˜ç³»ç»Ÿ
- ğŸ“ˆ å®Œæ•´çš„å›æµ‹å¼•æ“å’Œå®æ—¶äº¤æ˜“ç³»ç»Ÿ
- ğŸ‘¥ ä¼ä¸šçº§ç”¨æˆ·ç®¡ç†å’Œæƒé™æ§åˆ¶
- ğŸ”’ é“¶è¡Œçº§å®‰å…¨æ¶æ„

### 1.2 æŠ€æœ¯æˆå°±

- **ä»£ç è§„æ¨¡**: 189,466è¡Œä¼ä¸šçº§ä»£ç 
- **å‰ç«¯è§„æ¨¡**: 50,235è¡ŒTypeScriptä»£ç ï¼Œ253ä¸ªæ–‡ä»¶
- **åç«¯è§„æ¨¡**: 133,400è¡ŒPythonä»£ç ï¼Œ308ä¸ªæœåŠ¡æ–‡ä»¶
- **APIè§„æ¨¡**: 408ä¸ªRESTç«¯ç‚¹
- **æ•°æ®è§„æ¨¡**: 59å¼ è¡¨ï¼Œ240ä¸‡+ç”Ÿäº§æ•°æ®è®°å½•

### 1.3 ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å‰ç«¯åº”ç”¨ (React + TypeScript)             â”‚
â”‚                         ç«¯å£: 3000                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Nginxåå‘ä»£ç† (ç«¯å£: 80)                   â”‚
â”‚                     è´Ÿè½½å‡è¡¡ + APIç½‘å…³                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·æœåŠ¡ (Node.js)      â”‚    â”‚   äº¤æ˜“æœåŠ¡ (Python)         â”‚
â”‚      ç«¯å£: 3001          â”‚    â”‚      ç«¯å£: 8001            â”‚
â”‚   - JWTè®¤è¯              â”‚    â”‚   - ç­–ç•¥ç®¡ç†               â”‚
â”‚   - ç”¨æˆ·ç®¡ç†             â”‚    â”‚   - AIé›†æˆ                 â”‚
â”‚   - æƒé™æ§åˆ¶             â”‚    â”‚   - å›æµ‹å¼•æ“               â”‚
â”‚   - Google OAuth        â”‚    â”‚   - å¸‚åœºæ•°æ®               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ•°æ®å±‚                                   â”‚
â”‚   SQLite (ä¸»æ•°æ®åº“) + Redis (ç¼“å­˜) + WebSocket (å®æ—¶é€šä¿¡)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. æŠ€æœ¯æ ˆè¯¦è§£

### 2.1 å‰ç«¯æŠ€æœ¯æ ˆ

**æ ¸å¿ƒæ¡†æ¶**ï¼š
- **React 18**: ç°ä»£åŒ–UIæ¡†æ¶
- **TypeScript 5.3**: ç±»å‹å®‰å…¨çš„JavaScriptè¶…é›†
- **Vite 5.0**: é«˜æ€§èƒ½æ„å»ºå·¥å…·

**çŠ¶æ€ç®¡ç†**ï¼š
- **Zustand 4.4**: è½»é‡çº§çŠ¶æ€ç®¡ç†
- **React Query 5.12**: æœåŠ¡ç«¯çŠ¶æ€ç®¡ç†

**UIç»„ä»¶åº“**ï¼š
- **Tailwind CSS 3.3**: åŸå­åŒ–CSSæ¡†æ¶
- **Headless UI**: æ— æ ·å¼UIç»„ä»¶
- **Framer Motion**: åŠ¨ç”»åº“

**å›¾è¡¨ç³»ç»Ÿ**ï¼š
- **ECharts 5.6**: ä¸“ä¸šçº§å›¾è¡¨åº“
- **Chart.js 4.5**: è½»é‡çº§å›¾è¡¨è§£å†³æ–¹æ¡ˆ

**å®æ—¶é€šä¿¡**ï¼š
- **Socket.io-client 4.7**: WebSocketå®¢æˆ·ç«¯
- **Axios 1.6**: HTTPå®¢æˆ·ç«¯

### 2.2 åç«¯æŠ€æœ¯æ ˆ

#### ç”¨æˆ·æœåŠ¡ (Node.js)

**æ ¸å¿ƒæ¡†æ¶**ï¼š
- **Express 4.18**: Webæ¡†æ¶
- **TypeScript 5.3**: ç±»å‹å®‰å…¨
- **Prisma 5.7**: ORMæ¡†æ¶

**å®‰å…¨ç»„ä»¶**ï¼š
- **JWT (jsonwebtoken 9.0)**: è®¤è¯ç³»ç»Ÿ
- **Bcrypt**: å¯†ç åŠ å¯†
- **Helmet 7.1**: å®‰å…¨å¤´éƒ¨
- **CORS**: è·¨åŸŸèµ„æºå…±äº«

**å…¶ä»–ä¾èµ–**ï¼š
- **Redis 4.6**: ç¼“å­˜å’Œä¼šè¯å­˜å‚¨
- **Google Auth Library**: OAuthé›†æˆ
- **Winston 3.11**: æ—¥å¿—ç³»ç»Ÿ

#### äº¤æ˜“æœåŠ¡ (Python)

**æ ¸å¿ƒæ¡†æ¶**ï¼š
- **FastAPI 0.104**: ç°ä»£åŒ–Webæ¡†æ¶
- **SQLAlchemy 2.0**: ORMæ¡†æ¶
- **Pydantic 2.5**: æ•°æ®éªŒè¯

**AIé›†æˆ**ï¼š
- **Anthropic 0.34**: Claude AIå®¢æˆ·ç«¯
- **OpenAI 1.3**: å¤‡ç”¨AIæœåŠ¡

**äº¤æ˜“æ‰€é›†æˆ**ï¼š
- **CCXT 4.1**: ç»Ÿä¸€äº¤æ˜“æ‰€API
- **WebSockets 12.0**: å®æ—¶æ•°æ®æµ

**åŒºå—é“¾é›†æˆ**ï¼š
- **Web3.py 6.15**: Ethereumç½‘ç»œ
- **TronPy 0.4**: TRONç½‘ç»œ
- **Cryptography 41.0**: åŠ å¯†æœåŠ¡

**æ•°æ®å¤„ç†**ï¼š
- **Pandas 2.1**: æ•°æ®åˆ†æ
- **NumPy 1.25**: æ•°å€¼è®¡ç®—

### 2.3 æ•°æ®å­˜å‚¨

- **SQLite**: ä¸»æ•°æ®åº“ï¼ˆWALæ¨¡å¼ï¼‰
- **Redis**: ç¼“å­˜å±‚å’Œä¼šè¯å­˜å‚¨
- **æ–‡ä»¶ç³»ç»Ÿ**: é™æ€èµ„æºå­˜å‚¨

---

## 3. ç³»ç»Ÿæ¶æ„å›¾

### 3.1 å¾®æœåŠ¡æ¶æ„

```mermaid
graph TB
    subgraph "å®¢æˆ·ç«¯å±‚"
        Browser[Webæµè§ˆå™¨]
        Mobile[ç§»åŠ¨ç«¯<br/>æœªæ¥æ‰©å±•]
    end
    
    subgraph "æ¥å…¥å±‚"
        Nginx[Nginx<br/>åå‘ä»£ç†/è´Ÿè½½å‡è¡¡]
    end
    
    subgraph "æœåŠ¡å±‚"
        UserService[ç”¨æˆ·æœåŠ¡<br/>Node.js:3001]
        TradingService[äº¤æ˜“æœåŠ¡<br/>Python:8001]
        WSService[WebSocketæœåŠ¡<br/>å®æ—¶é€šä¿¡]
    end
    
    subgraph "æ•°æ®å±‚"
        SQLite[(SQLite<br/>ä¸»æ•°æ®åº“)]
        Redis[(Redis<br/>ç¼“å­˜)]
    end
    
    subgraph "å¤–éƒ¨æœåŠ¡"
        Claude[Claude AI]
        Exchange[äº¤æ˜“æ‰€API<br/>OKX/Binance]
        Blockchain[åŒºå—é“¾ç½‘ç»œ<br/>ETH/TRON]
    end
    
    Browser --> Nginx
    Mobile --> Nginx
    Nginx --> UserService
    Nginx --> TradingService
    Nginx --> WSService
    
    UserService --> SQLite
    UserService --> Redis
    TradingService --> SQLite
    TradingService --> Redis
    
    TradingService --> Claude
    TradingService --> Exchange
    TradingService --> Blockchain
```

### 3.2 æ•°æ®æµæ¶æ„

```mermaid
sequenceDiagram
    participant User
    participant Frontend
    participant Nginx
    participant UserService
    participant TradingService
    participant Database
    participant AI
    
    User->>Frontend: ç™»å½•è¯·æ±‚
    Frontend->>Nginx: POST /api/v1/auth/login
    Nginx->>UserService: è½¬å‘è¯·æ±‚
    UserService->>Database: éªŒè¯ç”¨æˆ·
    Database-->>UserService: ç”¨æˆ·ä¿¡æ¯
    UserService-->>Frontend: JWT Token
    
    User->>Frontend: AIç­–ç•¥ç”Ÿæˆ
    Frontend->>Nginx: POST /api/v1/ai/chat
    Nginx->>TradingService: è½¬å‘è¯·æ±‚
    TradingService->>AI: Claude APIè°ƒç”¨
    AI-->>TradingService: ç­–ç•¥ä»£ç 
    TradingService->>Database: ä¿å­˜ç­–ç•¥
    TradingService-->>Frontend: ç­–ç•¥ç»“æœ
```

---

## 4. æ•°æ®åº“è®¾è®¡

### 4.1 æ ¸å¿ƒæ•°æ®æ¨¡å‹

#### ç”¨æˆ·ç®¡ç†åŸŸ

```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    email VARCHAR(100) UNIQUE NOT NULL,
    username VARCHAR(50) UNIQUE,
    password_hash VARCHAR(255),
    is_active BOOLEAN DEFAULT true,
    membership_level VARCHAR(20) DEFAULT 'basic',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ä¼šå‘˜è®¡åˆ’è¡¨
CREATE TABLE membership_plans (
    id INTEGER PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    display_name VARCHAR(100),
    level INTEGER DEFAULT 0,
    price DECIMAL(10,2),
    duration_days INTEGER,
    features JSON
);

-- ç”¨æˆ·ä¼šè¯è¡¨
CREATE TABLE user_sessions (
    id INTEGER PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    token VARCHAR(500) UNIQUE,
    expires_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### ç­–ç•¥ç®¡ç†åŸŸ

```sql
-- ç­–ç•¥è¡¨
CREATE TABLE strategies (
    id INTEGER PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    name VARCHAR(100) NOT NULL,
    description TEXT,
    code TEXT NOT NULL,
    parameters JSON,
    strategy_type VARCHAR(20) DEFAULT 'strategy',
    ai_session_id VARCHAR(100),
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- å›æµ‹ç»“æœè¡¨
CREATE TABLE backtests (
    id INTEGER PRIMARY KEY,
    strategy_id INTEGER REFERENCES strategies(id),
    user_id INTEGER REFERENCES users(id),
    symbol VARCHAR(20),
    start_date DATE,
    end_date DATE,
    initial_capital DECIMAL(18,8),
    final_value DECIMAL(18,8),
    total_return DECIMAL(10,4),
    sharpe_ratio DECIMAL(10,4),
    max_drawdown DECIMAL(10,4),
    win_rate DECIMAL(10,4),
    result_data JSON,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### AIé›†æˆåŸŸ

```sql
-- Claudeå¯¹è¯è¡¨
CREATE TABLE claude_conversations (
    id INTEGER PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    session_id VARCHAR(100),
    message_type VARCHAR(20),
    content TEXT,
    tokens_used INTEGER,
    model VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Claudeè´¦å·æ± è¡¨
CREATE TABLE claude_accounts (
    id INTEGER PRIMARY KEY,
    account_name VARCHAR(100),
    api_key VARCHAR(500),
    status VARCHAR(20) DEFAULT 'active',
    usage_count INTEGER DEFAULT 0,
    last_used_at TIMESTAMP
);
```

#### åŒºå—é“¾æ”¯ä»˜åŸŸ

```sql
-- USDTé’±åŒ…è¡¨
CREATE TABLE usdt_wallets (
    id INTEGER PRIMARY KEY,
    wallet_name VARCHAR(100),
    network VARCHAR(20) NOT NULL,
    address VARCHAR(100) UNIQUE NOT NULL,
    private_key VARCHAR(255),
    balance DECIMAL(18,8) DEFAULT 0,
    status VARCHAR(20) DEFAULT 'available',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- æ”¯ä»˜è®¢å•è¡¨
CREATE TABLE usdt_payment_orders (
    id INTEGER PRIMARY KEY,
    order_no VARCHAR(32) UNIQUE NOT NULL,
    user_id INTEGER REFERENCES users(id),
    wallet_id INTEGER REFERENCES usdt_wallets(id),
    usdt_amount DECIMAL(18,8),
    transaction_hash VARCHAR(100),
    status VARCHAR(20) DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 4.2 æ•°æ®åº“ä¼˜åŒ–ç­–ç•¥

**ç´¢å¼•ä¼˜åŒ–**ï¼š
```sql
-- ç”¨æˆ·æŸ¥è¯¢ä¼˜åŒ–
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_membership ON users(membership_level, is_active);

-- ç­–ç•¥æŸ¥è¯¢ä¼˜åŒ–
CREATE INDEX idx_strategies_user ON strategies(user_id, is_active);
CREATE INDEX idx_strategies_session ON strategies(ai_session_id);

-- å¯¹è¯å†å²ä¼˜åŒ–
CREATE INDEX idx_conversations_session ON claude_conversations(session_id, created_at);

-- æ”¯ä»˜è®¢å•ä¼˜åŒ–
CREATE INDEX idx_orders_status ON usdt_payment_orders(status, created_at);
```

**æ€§èƒ½é…ç½®**ï¼š
```sql
-- SQLite WALæ¨¡å¼
PRAGMA journal_mode = WAL;
PRAGMA synchronous = NORMAL;
PRAGMA cache_size = -8000;
PRAGMA page_size = 4096;
```

---

## 5. APIæ¥å£æ–‡æ¡£

### 5.1 è®¤è¯æ¥å£

#### ç”¨æˆ·ç™»å½•
```http
POST /api/v1/auth/login
Content-Type: application/json

{
    "email": "user@example.com",
    "password": "password123"
}

Response: 200 OK
{
    "success": true,
    "data": {
        "token": "eyJhbGciOiJIUzI1NiIs...",
        "user": {
            "id": 1,
            "email": "user@example.com",
            "membership_level": "premium"
        }
    }
}
```

#### Google OAuthç™»å½•
```http
POST /api/v1/auth/google
Content-Type: application/json

{
    "credential": "google_id_token"
}

Response: 200 OK
{
    "success": true,
    "data": {
        "token": "jwt_token",
        "user": {...}
    }
}
```

### 5.2 ç­–ç•¥ç®¡ç†æ¥å£

#### åˆ›å»ºç­–ç•¥
```http
POST /api/v1/strategies
Authorization: Bearer {token}
Content-Type: application/json

{
    "name": "MACDç­–ç•¥",
    "description": "åŸºäºMACDæŒ‡æ ‡çš„äº¤æ˜“ç­–ç•¥",
    "code": "class Strategy:...",
    "parameters": {
        "fast_period": 12,
        "slow_period": 26
    }
}

Response: 201 Created
{
    "success": true,
    "data": {
        "id": 1,
        "name": "MACDç­–ç•¥",
        "created_at": "2025-01-01T00:00:00Z"
    }
}
```

#### æ‰§è¡Œå›æµ‹
```http
POST /api/v1/backtests
Authorization: Bearer {token}
Content-Type: application/json

{
    "strategy_id": 1,
    "symbol": "BTC/USDT",
    "start_date": "2024-01-01",
    "end_date": "2024-12-31",
    "initial_capital": 10000
}

Response: 200 OK
{
    "success": true,
    "data": {
        "id": 1,
        "total_return": 0.25,
        "sharpe_ratio": 1.8,
        "max_drawdown": 0.15,
        "trades": [...]
    }
}
```

### 5.3 AIæ¥å£

#### AIå¯¹è¯
```http
POST /api/v1/ai/chat
Authorization: Bearer {token}
Content-Type: application/json

{
    "content": "å¸®æˆ‘ç”Ÿæˆä¸€ä¸ªMACDç­–ç•¥",
    "session_id": "uuid",
    "ai_mode": "trader"
}

Response: 200 OK
{
    "success": true,
    "data": {
        "content": "æˆ‘æ¥å¸®æ‚¨ç”ŸæˆMACDç­–ç•¥...",
        "session_id": "uuid",
        "requires_strategy_generation": true
    }
}
```

#### WebSocketå®æ—¶å¯¹è¯
```javascript
// WebSocketè¿æ¥
ws://localhost:8001/ws/ai/chat

// å‘é€æ¶ˆæ¯
{
    "type": "message",
    "content": "ç”ŸæˆRSIç­–ç•¥",
    "session_id": "uuid"
}

// æ¥æ”¶æµå¼å“åº”
{
    "type": "chunk",
    "content": "æˆ‘",
    "session_id": "uuid"
}
```

### 5.4 æ”¯ä»˜æ¥å£

#### åˆ›å»ºæ”¯ä»˜è®¢å•
```http
POST /api/v1/payments/orders
Authorization: Bearer {token}
Content-Type: application/json

{
    "amount": 100,
    "network": "TRC20",
    "payment_type": "membership"
}

Response: 201 Created
{
    "success": true,
    "data": {
        "order_no": "PAY202501010001",
        "address": "TXxxxxxxxxxxxxx",
        "amount": 100,
        "expires_at": "2025-01-01T01:00:00Z"
    }
}
```

---

## 6. å‰ç«¯ç»„ä»¶æ¶æ„

### 6.1 ç»„ä»¶å±‚æ¬¡ç»“æ„

```
src/
â”œâ”€â”€ components/           # å¯å¤ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ layout/          # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ MainLayout.tsx
â”‚   â”‚   â”œâ”€â”€ AuthLayout.tsx
â”‚   â”‚   â””â”€â”€ Sidebar.tsx
â”‚   â”œâ”€â”€ charts/          # å›¾è¡¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ KlineChart.tsx
â”‚   â”‚   â”œâ”€â”€ BacktestChart.tsx
â”‚   â”‚   â””â”€â”€ ProfitCurve.tsx
â”‚   â”œâ”€â”€ trading/         # äº¤æ˜“ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ SuperChart/  # è¶…çº§å›¾è¡¨
â”‚   â”‚   â”œâ”€â”€ StrategyPanel/
â”‚   â”‚   â””â”€â”€ MarketPanel/
â”‚   â”œâ”€â”€ ai/              # AIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatInterface.tsx
â”‚   â”‚   â””â”€â”€ BacktestResult.tsx
â”‚   â””â”€â”€ common/          # é€šç”¨ç»„ä»¶
â”‚       â”œâ”€â”€ Button.tsx
â”‚       â”œâ”€â”€ Modal.tsx
â”‚       â””â”€â”€ Table.tsx
â”œâ”€â”€ pages/               # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ HomePage.tsx
â”‚   â”œâ”€â”€ TradingPage.tsx
â”‚   â”œâ”€â”€ AIChatPage.tsx
â”‚   â”œâ”€â”€ StrategyPage.tsx
â”‚   â””â”€â”€ AdminPage.tsx
â”œâ”€â”€ store/               # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ userStore.ts
â”‚   â”œâ”€â”€ aiStore.ts
â”‚   â””â”€â”€ tradingStore.ts
â”œâ”€â”€ services/            # APIæœåŠ¡
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ client.ts
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â””â”€â”€ strategy.ts
â”‚   â””â”€â”€ websocket/
â”‚       â””â”€â”€ wsClient.ts
â”œâ”€â”€ hooks/               # è‡ªå®šä¹‰Hooks
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”œâ”€â”€ useWebSocket.ts
â”‚   â””â”€â”€ useStrategy.ts
â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
    â”œâ”€â”€ format.ts
    â”œâ”€â”€ validate.ts
    â””â”€â”€ constants.ts
```

### 6.2 æ ¸å¿ƒç»„ä»¶è¯´æ˜

#### SuperChartè¶…çº§å›¾è¡¨ç³»ç»Ÿ
```typescript
// ä¸“ä¸šçº§Kçº¿å›¾è¡¨ç»„ä»¶
interface SuperChartProps {
    symbol: string;           // äº¤æ˜“å¯¹
    interval: string;         // æ—¶é—´é—´éš”
    indicators: Indicator[];  // æŠ€æœ¯æŒ‡æ ‡
    drawings: Drawing[];      // ç»˜å›¾å·¥å…·
    theme: 'light' | 'dark'; // ä¸»é¢˜
}

// åŠŸèƒ½ç‰¹æ€§ï¼š
// - TradingViewçº§ç»˜å›¾å·¥å…·ï¼ˆ6ç§ï¼‰
// - æŠ€æœ¯æŒ‡æ ‡ç³»ç»Ÿï¼ˆMA/MACD/RSI/BOLL/KDJ/CCIï¼‰
// - AIæ™ºèƒ½åˆ†æå åŠ 
// - å¤šå›¾å¸ƒå±€æ”¯æŒ
```

#### AIå¯¹è¯ç•Œé¢
```typescript
// AIæ™ºèƒ½å¯¹è¯ç»„ä»¶
interface AIChatInterfaceProps {
    sessionId: string;        // ä¼šè¯ID
    aiMode: AIMode;          // AIæ¨¡å¼
    onStrategyGenerated?: (strategy: Strategy) => void;
}

// åŠŸèƒ½ç‰¹æ€§ï¼š
// - å®æ—¶WebSocketé€šä¿¡
// - ç­–ç•¥æˆç†Ÿåº¦åˆ¤æ–­
// - è‡ªåŠ¨å›æµ‹è§¦å‘
// - å†å²ä¼šè¯ç®¡ç†
```

### 6.3 çŠ¶æ€ç®¡ç†æ¶æ„

```typescript
// ZustandçŠ¶æ€ç®¡ç†
interface AppState {
    // ç”¨æˆ·çŠ¶æ€
    user: User | null;
    isAuthenticated: boolean;
    
    // AIçŠ¶æ€
    sessions: ChatSession[];
    currentSession: string | null;
    messages: Message[];
    
    // äº¤æ˜“çŠ¶æ€
    strategies: Strategy[];
    backtests: BacktestResult[];
    marketData: MarketData;
    
    // Actions
    login: (credentials: LoginCredentials) => Promise<void>;
    sendMessage: (content: string) => Promise<void>;
    runBacktest: (params: BacktestParams) => Promise<void>;
}
```

---

## 7. AIç³»ç»Ÿé›†æˆ

### 7.1 Claude AIé›†æˆæ¶æ„

```mermaid
graph LR
    subgraph "AIç³»ç»Ÿæ¶æ„"
        User[ç”¨æˆ·è¾“å…¥] --> Context[ä¸Šä¸‹æ–‡ç®¡ç†]
        Context --> Maturity[æˆç†Ÿåº¦åˆ†æ]
        Maturity --> Claude[Claude API]
        Claude --> Generator[ç­–ç•¥ç”Ÿæˆå™¨]
        Generator --> Validator[ä»£ç éªŒè¯]
        Validator --> Backtest[è‡ªåŠ¨å›æµ‹]
        Backtest --> Result[ç»“æœå±•ç¤º]
    end
```

### 7.2 æ ¸å¿ƒæœåŠ¡å®ç°

#### AIæœåŠ¡ç±»
```python
class AIService:
    """AIæœåŠ¡æ ¸å¿ƒå®ç°"""
    
    async def chat_completion(
        self,
        message: str,
        user_id: int,
        context: Dict,
        session_id: str
    ) -> Dict:
        """AIå¯¹è¯å®Œæˆ"""
        # 1. æ£€æŸ¥ç”¨æˆ·é¢åº¦
        if not await self.check_usage_limit(user_id):
            return {"error": "é¢åº¦ä¸è¶³"}
        
        # 2. è·å–å†å²ä¸Šä¸‹æ–‡
        history = await self.get_conversation_history(session_id)
        
        # 3. åˆ†æç­–ç•¥æˆç†Ÿåº¦
        maturity = StrategyMaturityAnalyzer.analyze(history)
        
        # 4. è°ƒç”¨Claude API
        response = await claude_client.chat(
            message=message,
            context=history,
            system_prompt=self.get_system_prompt(maturity)
        )
        
        # 5. ä¿å­˜å¯¹è¯è®°å½•
        await self.save_conversation(session_id, message, response)
        
        # 6. è§¦å‘åç»­æµç¨‹
        if maturity.is_ready_for_generation:
            await self.trigger_strategy_generation(response)
        
        return response
```

#### ç­–ç•¥æˆç†Ÿåº¦åˆ†æå™¨
```python
class StrategyMaturityAnalyzer:
    """ç­–ç•¥æˆç†Ÿåº¦åˆ†æ"""
    
    @staticmethod
    def analyze(conversation_history: List[Message]) -> MaturityScore:
        """åˆ†æå¯¹è¯æˆç†Ÿåº¦"""
        score = MaturityScore()
        
        # åˆ†æç»´åº¦
        score.trading_logic = analyze_trading_logic(history)      # 30%
        score.risk_management = analyze_risk_params(history)       # 25%
        score.technical_params = analyze_tech_params(history)      # 25%
        score.market_context = analyze_market_context(history)     # 20%
        
        # è®¡ç®—æ€»åˆ†
        score.total = weighted_average(score)
        
        # åˆ¤æ–­æ˜¯å¦æˆç†Ÿ
        score.is_mature = score.total >= 0.7
        
        return score
```

### 7.3 æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†

```python
class DynamicContextManager:
    """åŠ¨æ€ä¸Šä¸‹æ–‡ç®¡ç†å™¨"""
    
    def optimize_context(
        self,
        messages: List[Message],
        max_tokens: int = 100000
    ) -> List[Message]:
        """ä¼˜åŒ–ä¸Šä¸‹æ–‡çª—å£"""
        # 1. è®¡ç®—æ¶ˆæ¯é‡è¦æ€§
        scored_messages = []
        for msg in messages:
            score = self.calculate_importance(msg)
            scored_messages.append((score, msg))
        
        # 2. æŒ‰é‡è¦æ€§æ’åº
        scored_messages.sort(key=lambda x: x[0], reverse=True)
        
        # 3. é€‰æ‹©æœ€ä¼˜çª—å£
        selected = []
        token_count = 0
        for score, msg in scored_messages:
            msg_tokens = count_tokens(msg)
            if token_count + msg_tokens <= max_tokens:
                selected.append(msg)
                token_count += msg_tokens
        
        # 4. ä¿æŒæ—¶é—´é¡ºåº
        selected.sort(key=lambda x: x.timestamp)
        
        return selected
```

---

## 8. åŒºå—é“¾æ”¯ä»˜ç³»ç»Ÿ

### 8.1 æ”¯ä»˜ç³»ç»Ÿæ¶æ„

```mermaid
graph TB
    subgraph "æ”¯ä»˜æµç¨‹"
        Order[åˆ›å»ºè®¢å•] --> Allocate[åˆ†é…é’±åŒ…]
        Allocate --> Monitor[ç›‘æ§äº¤æ˜“]
        Monitor --> Confirm[ç¡®è®¤æ”¯ä»˜]
        Confirm --> Credit[è´¦æˆ·å……å€¼]
    end
    
    subgraph "é’±åŒ…ç®¡ç†"
        Pool[é’±åŒ…æ± ] --> Available[å¯ç”¨é’±åŒ…]
        Available --> Occupied[å ç”¨é’±åŒ…]
        Occupied --> Released[é‡Šæ”¾é’±åŒ…]
    end
    
    subgraph "åŒºå—é“¾ç½‘ç»œ"
        ETH[Ethereum]
        TRON[TRON]
        BSC[BSC]
    end
```

### 8.2 é’±åŒ…æœåŠ¡å®ç°

```python
class USDTWalletService:
    """USDTé’±åŒ…ç®¡ç†æœåŠ¡"""
    
    async def allocate_wallet(
        self,
        order_id: str,
        network: str = "TRC20"
    ) -> USDTWallet:
        """åˆ†é…æ”¶æ¬¾é’±åŒ…"""
        # 1. æŸ¥æ‰¾å¯ç”¨é’±åŒ…
        wallet = await self.find_available_wallet(network)
        
        # 2. å¦‚æœæ²¡æœ‰å¯ç”¨é’±åŒ…ï¼Œç”Ÿæˆæ–°çš„
        if not wallet:
            wallet = await self.generate_new_wallet(network)
        
        # 3. æ ‡è®°ä¸ºå ç”¨
        wallet.status = "occupied"
        wallet.current_order_id = order_id
        wallet.allocated_at = datetime.now()
        
        # 4. ä¿å­˜çŠ¶æ€
        await db.commit()
        
        return wallet
    
    async def monitor_transaction(
        self,
        wallet_address: str,
        expected_amount: Decimal
    ) -> Optional[Transaction]:
        """ç›‘æ§åŒºå—é“¾äº¤æ˜“"""
        # 1. æ ¹æ®ç½‘ç»œé€‰æ‹©æä¾›è€…
        provider = self.get_provider(wallet.network)
        
        # 2. æŸ¥è¯¢æœ€æ–°äº¤æ˜“
        transactions = await provider.get_transactions(wallet_address)
        
        # 3. åŒ¹é…é‡‘é¢
        for tx in transactions:
            if tx.amount >= expected_amount * 0.99:  # å…è®¸1%è¯¯å·®
                return tx
        
        return None
```

### 8.3 å¤šç½‘ç»œæ”¯æŒ

```python
class BlockchainProvider:
    """åŒºå—é“¾æä¾›è€…åŸºç±»"""
    
    @abstractmethod
    async def get_balance(self, address: str) -> Decimal:
        """è·å–ä½™é¢"""
        pass
    
    @abstractmethod
    async def send_transaction(
        self,
        from_address: str,
        to_address: str,
        amount: Decimal,
        private_key: str
    ) -> str:
        """å‘é€äº¤æ˜“"""
        pass

class TRONProvider(BlockchainProvider):
    """TRONç½‘ç»œæä¾›è€…"""
    
    def __init__(self):
        from tronpy import Tron
        self.client = Tron()
    
    async def get_balance(self, address: str) -> Decimal:
        account = self.client.get_account_balance(address)
        return Decimal(str(account))

class EthereumProvider(BlockchainProvider):
    """Ethereumç½‘ç»œæä¾›è€…"""
    
    def __init__(self):
        from web3 import Web3
        self.w3 = Web3(Web3.HTTPProvider(settings.eth_rpc_url))
    
    async def get_balance(self, address: str) -> Decimal:
        balance = self.w3.eth.get_balance(address)
        return Decimal(str(Web3.from_wei(balance, 'ether')))
```

---

## 9. å¼€å‘ç¯å¢ƒæ­å»º

### 9.1 ç¯å¢ƒè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Linux/macOS/Windows (WSL2)
- **Node.js**: >= 18.0.0
- **Python**: >= 3.10
- **Redis**: >= 6.0
- **Git**: >= 2.0

### 9.2 å¿«é€Ÿå¼€å§‹

#### 1. å…‹éš†ä»£ç 
```bash
git clone https://github.com/trademe/trademe.git
cd trademe
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶
vim .env
```

å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼š
```env
# æ•°æ®åº“é…ç½®
DATABASE_URL=sqlite:///./data/trademe.db

# JWTå¯†é’¥
JWT_SECRET=your-secret-key-here

# Claude API
ANTHROPIC_API_KEY=sk-ant-xxxxx

# Redisé…ç½®
REDIS_URL=redis://localhost:6379

# äº¤æ˜“æ‰€API (å¯é€‰)
OKX_API_KEY=xxxxx
OKX_SECRET_KEY=xxxxx
OKX_PASSPHRASE=xxxxx
```

#### 3. å®‰è£…å‰ç«¯ä¾èµ–
```bash
cd frontend
npm install
```

#### 4. å®‰è£…ç”¨æˆ·æœåŠ¡ä¾èµ–
```bash
cd backend/user-service
npm install

# åˆå§‹åŒ–æ•°æ®åº“
npm run db:push
npm run db:seed
```

#### 5. å®‰è£…äº¤æ˜“æœåŠ¡ä¾èµ–
```bash
cd backend/trading-service

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/macOS
# æˆ–
venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# åˆå§‹åŒ–æ•°æ®åº“
python -m app.scripts.init_db
```

### 9.3 å¯åŠ¨æœåŠ¡

#### å¼€å‘æ¨¡å¼
```bash
# ç»ˆç«¯1: å¯åŠ¨å‰ç«¯
cd frontend
npm run dev

# ç»ˆç«¯2: å¯åŠ¨ç”¨æˆ·æœåŠ¡
cd backend/user-service
npm run dev

# ç»ˆç«¯3: å¯åŠ¨äº¤æ˜“æœåŠ¡
cd backend/trading-service
source venv/bin/activate
python -m uvicorn app.main:app --reload --port 8001

# ç»ˆç«¯4: å¯åŠ¨Redis
redis-server
```

#### ä½¿ç”¨Docker Compose (æ¨è)
```bash
docker-compose up -d
```

### 9.4 éªŒè¯å®‰è£…

è®¿é—®ä»¥ä¸‹åœ°å€éªŒè¯æœåŠ¡ï¼š
- å‰ç«¯åº”ç”¨: http://localhost:3000
- ç”¨æˆ·æœåŠ¡API: http://localhost:3001/health
- äº¤æ˜“æœåŠ¡API: http://localhost:8001/docs
- Redisç›‘æ§: redis-cli ping

---

## 10. éƒ¨ç½²æŒ‡å—

### 10.1 ç”Ÿäº§ç¯å¢ƒé…ç½®

#### Nginxé…ç½®
```nginx
# /etc/nginx/sites-available/trademe
upstream user_service {
    server 127.0.0.1:3001;
}

upstream trading_service {
    server 127.0.0.1:8001;
}

server {
    listen 80;
    server_name trademe.com;
    
    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /var/www/trademe/frontend/dist;
        try_files $uri $uri/ /index.html;
    }
    
    # ç”¨æˆ·æœåŠ¡API
    location /api/v1/auth {
        proxy_pass http://user_service;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
    
    # äº¤æ˜“æœåŠ¡API
    location /api/v1/ {
        proxy_pass http://trading_service;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
    
    # WebSocketæ”¯æŒ
    location /ws/ {
        proxy_pass http://trading_service;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
```

### 10.2 æœåŠ¡éƒ¨ç½²

#### ä½¿ç”¨systemdç®¡ç†æœåŠ¡

ç”¨æˆ·æœåŠ¡é…ç½®ï¼š
```ini
# /etc/systemd/system/trademe-user.service
[Unit]
Description=Trademe User Service
After=network.target

[Service]
Type=simple
User=trademe
WorkingDirectory=/opt/trademe/backend/user-service
ExecStart=/usr/bin/node dist/app.js
Restart=always
Environment="NODE_ENV=production"

[Install]
WantedBy=multi-user.target
```

äº¤æ˜“æœåŠ¡é…ç½®ï¼š
```ini
# /etc/systemd/system/trademe-trading.service
[Unit]
Description=Trademe Trading Service
After=network.target

[Service]
Type=simple
User=trademe
WorkingDirectory=/opt/trademe/backend/trading-service
ExecStart=/opt/trademe/backend/trading-service/venv/bin/uvicorn app.main:app --host 0.0.0.0 --port 8001
Restart=always
Environment="PYTHONPATH=/opt/trademe/backend/trading-service"

[Install]
WantedBy=multi-user.target
```

å¯åŠ¨æœåŠ¡ï¼š
```bash
sudo systemctl daemon-reload
sudo systemctl enable trademe-user trademe-trading
sudo systemctl start trademe-user trademe-trading
```

### 10.3 æ•°æ®åº“å¤‡ä»½

```bash
#!/bin/bash
# backup.sh - æ•°æ®åº“å¤‡ä»½è„šæœ¬

BACKUP_DIR="/backup/trademe"
DB_FILE="/opt/trademe/data/trademe.db"
DATE=$(date +%Y%m%d_%H%M%S)

# åˆ›å»ºå¤‡ä»½
sqlite3 $DB_FILE ".backup $BACKUP_DIR/trademe_$DATE.db"

# å‹ç¼©å¤‡ä»½
gzip $BACKUP_DIR/trademe_$DATE.db

# åˆ é™¤7å¤©å‰çš„å¤‡ä»½
find $BACKUP_DIR -name "*.gz" -mtime +7 -delete
```

### 10.4 ç›‘æ§å’Œæ—¥å¿—

#### æ—¥å¿—é…ç½®
```python
# äº¤æ˜“æœåŠ¡æ—¥å¿—é…ç½®
from loguru import logger

logger.add(
    "logs/trading-service.log",
    rotation="500 MB",
    retention="10 days",
    level="INFO",
    format="{time:YYYY-MM-DD HH:mm:ss} | {level} | {message}"
)
```

#### å¥åº·æ£€æŸ¥ç«¯ç‚¹
```python
@app.get("/health")
async def health_check():
    return {
        "status": "healthy",
        "service": "trading-service",
        "version": "1.0.0",
        "timestamp": datetime.now().isoformat()
    }
```

---

## 11. æ•…éšœæ’é™¤

### 11.1 å¸¸è§é—®é¢˜

#### 1. JWTè®¤è¯å¤±è´¥
**é—®é¢˜**: APIè¿”å›401 Unauthorized
**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥JWTå¯†é’¥é…ç½®
echo $JWT_SECRET

# ç¡®ä¿å‰åç«¯ä½¿ç”¨ç›¸åŒçš„å¯†é’¥
# æ£€æŸ¥tokenæ˜¯å¦è¿‡æœŸ
```

#### 2. WebSocketè¿æ¥æ–­å¼€
**é—®é¢˜**: WebSocketé¢‘ç¹æ–­å¼€é‡è¿
**è§£å†³æ–¹æ¡ˆ**:
```javascript
// å‰ç«¯æ·»åŠ é‡è¿é€»è¾‘
const ws = new WebSocket(url);
ws.addEventListener('close', () => {
    setTimeout(() => reconnect(), 5000);
});
```

#### 3. æ•°æ®åº“é”å®š
**é—®é¢˜**: SQLite database is locked
**è§£å†³æ–¹æ¡ˆ**:
```python
# ä½¿ç”¨WALæ¨¡å¼
conn.execute("PRAGMA journal_mode=WAL")
# å¢åŠ è¶…æ—¶æ—¶é—´
conn.execute("PRAGMA busy_timeout=5000")
```

### 11.2 è°ƒè¯•å·¥å…·

#### å¿«é€Ÿè¯Šæ–­è„šæœ¬
```bash
#!/bin/bash
# debug_checklist.sh

echo "ğŸ” ç³»ç»Ÿè¯Šæ–­å¼€å§‹..."

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
echo "ğŸ“Š æœåŠ¡çŠ¶æ€:"
systemctl status trademe-user --no-pager | head -5
systemctl status trademe-trading --no-pager | head -5

# æ£€æŸ¥ç«¯å£
echo "ğŸ”Œ ç«¯å£ç›‘å¬:"
netstat -tlnp | grep -E "3000|3001|8001"

# æ£€æŸ¥æ•°æ®åº“
echo "ğŸ’¾ æ•°æ®åº“çŠ¶æ€:"
sqlite3 /opt/trademe/data/trademe.db "SELECT COUNT(*) FROM users;"

# æ£€æŸ¥æ—¥å¿—
echo "ğŸ“ æœ€è¿‘é”™è¯¯:"
tail -n 20 /opt/trademe/logs/error.log

echo "âœ… è¯Šæ–­å®Œæˆ"
```

### 11.3 æ€§èƒ½ä¼˜åŒ–

#### æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
```python
# ä½¿ç”¨ç´¢å¼•
await db.execute(
    "CREATE INDEX idx_strategies_user_active ON strategies(user_id, is_active)"
)

# æ‰¹é‡æ“ä½œ
async def bulk_insert(data: List[Dict]):
    async with db.begin():
        await db.execute_many(insert_stmt, data)
```

#### APIå“åº”ç¼“å­˜
```python
from functools import lru_cache
import redis

redis_client = redis.Redis()

@lru_cache(maxsize=100)
async def get_market_data(symbol: str):
    # å…ˆæ£€æŸ¥ç¼“å­˜
    cached = redis_client.get(f"market:{symbol}")
    if cached:
        return json.loads(cached)
    
    # è·å–æ•°æ®
    data = await fetch_market_data(symbol)
    
    # å­˜å…¥ç¼“å­˜
    redis_client.setex(
        f"market:{symbol}",
        300,  # 5åˆ†é’Ÿè¿‡æœŸ
        json.dumps(data)
    )
    
    return data
```

---

## 12. å¼€å‘è§„èŒƒ

### 12.1 ä»£ç é£æ ¼

#### TypeScript/JavaScript
```typescript
// ä½¿ç”¨ESLint + Prettier
// .eslintrc.jsé…ç½®
module.exports = {
    extends: [
        'eslint:recommended',
        'plugin:@typescript-eslint/recommended',
        'plugin:react/recommended',
        'prettier'
    ],
    rules: {
        'no-console': 'warn',
        '@typescript-eslint/explicit-module-boundary-types': 'off',
        'react/prop-types': 'off'
    }
};
```

#### Python
```python
# ä½¿ç”¨Black + isort + mypy
# pyproject.tomlé…ç½®
[tool.black]
line-length = 100
target-version = ['py310']

[tool.isort]
profile = "black"
line_length = 100

[tool.mypy]
python_version = "3.10"
ignore_missing_imports = true
```

### 12.2 Gitå·¥ä½œæµ

#### åˆ†æ”¯ç­–ç•¥
```
main            # ç”Ÿäº§åˆ†æ”¯
â”œâ”€â”€ develop     # å¼€å‘åˆ†æ”¯
    â”œâ”€â”€ feature/xxx  # åŠŸèƒ½åˆ†æ”¯
    â”œâ”€â”€ bugfix/xxx   # ä¿®å¤åˆ†æ”¯
    â””â”€â”€ hotfix/xxx   # ç´§æ€¥ä¿®å¤
```

#### æäº¤ä¿¡æ¯è§„èŒƒ
```bash
# æ ¼å¼: <type>(<scope>): <subject>
# ç¤ºä¾‹:
git commit -m "feat(auth): æ·»åŠ Google OAuthç™»å½•"
git commit -m "fix(websocket): ä¿®å¤è¿æ¥æ–­å¼€é—®é¢˜"
git commit -m "docs(readme): æ›´æ–°éƒ¨ç½²æ–‡æ¡£"

# Typeç±»å‹:
# feat: æ–°åŠŸèƒ½
# fix: ä¿®å¤bug
# docs: æ–‡æ¡£æ›´æ–°
# style: ä»£ç æ ¼å¼
# refactor: é‡æ„
# test: æµ‹è¯•
# chore: æ„å»º/å·¥å…·
```

### 12.3 APIè®¾è®¡åŸåˆ™

#### RESTfulè§„èŒƒ
```
GET    /api/v1/resources      # è·å–åˆ—è¡¨
GET    /api/v1/resources/:id  # è·å–è¯¦æƒ…
POST   /api/v1/resources      # åˆ›å»ºèµ„æº
PUT    /api/v1/resources/:id  # æ›´æ–°èµ„æº
DELETE /api/v1/resources/:id  # åˆ é™¤èµ„æº
```

#### å“åº”æ ¼å¼
```json
// æˆåŠŸå“åº”
{
    "success": true,
    "data": {...},
    "message": "æ“ä½œæˆåŠŸ"
}

// é”™è¯¯å“åº”
{
    "success": false,
    "error": {
        "code": "AUTH_001",
        "message": "è®¤è¯å¤±è´¥",
        "details": {...}
    }
}
```

### 12.4 å®‰å…¨æœ€ä½³å®è·µ

#### è¾“å…¥éªŒè¯
```python
from pydantic import BaseModel, validator

class UserInput(BaseModel):
    email: str
    password: str
    
    @validator('email')
    def validate_email(cls, v):
        if '@' not in v:
            raise ValueError('Invalid email')
        return v
    
    @validator('password')
    def validate_password(cls, v):
        if len(v) < 8:
            raise ValueError('Password too short')
        return v
```

#### SQLæ³¨å…¥é˜²æŠ¤
```python
# ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
# æ­£ç¡®âœ…
await db.execute(
    "SELECT * FROM users WHERE email = :email",
    {"email": user_email}
)

# é”™è¯¯âŒ
await db.execute(
    f"SELECT * FROM users WHERE email = '{user_email}'"
)
```

#### æ•æ„Ÿä¿¡æ¯å¤„ç†
```python
# å¯†ç åŠ å¯†
from passlib.context import CryptContext

pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

def hash_password(password: str) -> str:
    return pwd_context.hash(password)

def verify_password(plain_password: str, hashed_password: str) -> bool:
    return pwd_context.verify(plain_password, hashed_password)
```

---

## æ€»ç»“

Trademeæ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æ¶æ„å…ˆè¿›çš„ä¼ä¸šçº§æ•°å­—è´§å¸ç­–ç•¥äº¤æ˜“å¹³å°ã€‚ç³»ç»Ÿé‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œé›†æˆäº†AIã€åŒºå—é“¾ã€å®æ—¶æ•°æ®å¤„ç†ç­‰å‰æ²¿æŠ€æœ¯ï¼Œå…·å¤‡é«˜å¯ç”¨æ€§ã€å¯æ‰©å±•æ€§å’Œå®‰å…¨æ€§ã€‚

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- ğŸ—ï¸ **ä¼ä¸šçº§æ¶æ„**: å¾®æœåŠ¡è®¾è®¡ï¼Œæ”¯æŒæ°´å¹³æ‰©å±•
- ğŸ¤– **AIæ·±åº¦é›†æˆ**: Claude AIæ™ºèƒ½ç­–ç•¥ç”Ÿæˆ
- ğŸ“Š **ä¸“ä¸šäº¤æ˜“ç³»ç»Ÿ**: TradingViewçº§å›¾è¡¨å’Œå›æµ‹å¼•æ“
- ğŸ’° **åŒºå—é“¾æ”¯ä»˜**: å¤šç½‘ç»œUSDTæ”¯ä»˜ç³»ç»Ÿ
- ğŸ”’ **å®‰å…¨å¯é **: é“¶è¡Œçº§å®‰å…¨æ¶æ„ï¼Œå®Œæ•´çš„æƒé™æ§åˆ¶

**æŠ€æœ¯ç‰¹è‰²**ï¼š
- å‰åç«¯åˆ†ç¦»ï¼ŒAPIé©±åŠ¨
- å®æ—¶WebSocketé€šä¿¡
- æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†
- è‡ªåŠ¨åŒ–å›æµ‹ç³»ç»Ÿ
- å¤šç½‘ç»œé’±åŒ…ç®¡ç†

æœ¬æ–‡æ¡£æ¶µç›–äº†ç³»ç»Ÿçš„å®Œæ•´æŠ€æœ¯å®ç°ï¼Œä»æ¶æ„è®¾è®¡åˆ°å…·ä½“ä»£ç å®ç°ï¼Œä»å¼€å‘ç¯å¢ƒæ­å»ºåˆ°ç”Ÿäº§éƒ¨ç½²ï¼Œä¸ºå¼€å‘è€…æä¾›äº†å…¨é¢çš„æŠ€æœ¯æŒ‡å¯¼ã€‚ç³»ç»Ÿå·²åœ¨ç”Ÿäº§ç¯å¢ƒç¨³å®šè¿è¡Œï¼Œä»£ç è´¨é‡å’Œæ¶æ„è®¾è®¡è¾¾åˆ°å›½é™…ä¸€æµæ ‡å‡†ã€‚

---

*æ–‡æ¡£ç‰ˆæœ¬: 1.0.0*  
*æ›´æ–°æ—¥æœŸ: 2025-01-14*  
*ä½œè€…: Trademe Development Team*